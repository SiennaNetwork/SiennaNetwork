<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <style>html, body {
  margin: 0;
  padding: 0;
}

.app {
  margin: 10px;
  padding: 0;
}

.files-list {
  margin: 10px 0 0;
  width: 100%;
  border-collapse: collapse;
}
.files-list__head {
  border: 1px solid #999;
}
.files-list__head > tr > th {
  padding: 10px;
  border: 1px solid #999;
  text-align: left;
  font-weight: normal;
  background: #ddd;
}
.files-list__body {
}
.files-list__file {
  cursor: pointer;
}
.files-list__file:hover {
  background: #ccf;
}
.files-list__file > td {
  padding: 10px;
  border: 1px solid #999;
}
.files-list__file > td:first-child::before {
  content: '\01F4C4';
  margin-right: 1em;
}
.files-list__file_low {
  background: #fcc;
}
.files-list__file_medium {
  background: #ffc;
}
.files-list__file_high {
  background: #cfc;
}
.files-list__file_folder > td:first-child::before {
  content: '\01F4C1';
  margin-right: 1em;
}

.file-header {
  border: 1px solid #999;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.file-header__back {
  margin: 10px;
  cursor: pointer;
  flex-shrink: 0;
  flex-grow: 0;
  text-decoration: underline;
  color: #338;
}

.file-header__name {
  margin: 10px;
  flex-shrink: 2;
  flex-grow: 2;
}

.file-header__stat {
  margin: 10px;
  flex-shrink: 0;
  flex-grow: 0;
}

.file-content {
  margin: 10px 0 0;
  border: 1px solid #999;
  padding: 10px;
}

.code-line {
  margin: 0;
  padding: 0.3em;
  height: 1em;
}
.code-line_covered {
  background: #cfc;
}
.code-line_uncovered {
  background: #fcc;
}
</style>
</head>
<body>
    <div id="root"></div>
    <script>
        var data = {"files":[{"path":["/","home","hack_lenovo_03","sienna","amm","api","schema.rs"],"content":"use std::{env::current_dir,fs::create_dir_all};\nuse cosmwasm_schema::{export_schema, remove_schemas, schema_for};\n\nuse sienna_amm_shared::msg::exchange as exchange;\nuse sienna_amm_shared::msg::factory as factory;\nuse sienna_amm_shared::msg::sienna_burner as burner;\nuse lp_token::msg as lp_token;\nuse snip20_reference_impl::msg as snip20;\n\nfn main() {\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"amm\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(exchange::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(exchange::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(exchange::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(exchange::QueryMsgResponse), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"factory\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(factory::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(factory::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(factory::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(factory::QueryResponse), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"burner\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(burner::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(burner::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(burner::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(burner::QueryAnswer), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"lp_token\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(sienna_amm_shared::msg::snip20::Snip20InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::HandleAnswer), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::QueryAnswer), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"snip20\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(snip20::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::HandleAnswer), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::QueryAnswer), \u0026out_dir);\n\n}\n","traces":[{"line":10,"address":[697457,692544],"length":1,"stats":{"Line":0},"fn_name":"main"},{"line":11,"address":[692557],"length":1,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[692599],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[692626],"length":1,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[692702],"length":1,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[692821],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[692989],"length":1,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[693114],"length":1,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[693239],"length":1,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[693364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[693481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[693530],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[693557],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[693633],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[693752],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[693920],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[694045],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[694170],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[694295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[694412],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[694461],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[694488],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[694564],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[694683],"length":1,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[694833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[694958],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[695083],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[695208],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[695325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[695374],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[695401],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[695477],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[695584],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[695728],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[695853],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[695978],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[696103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[696228],"length":1,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[696345],"length":1,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[696394],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[696421],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[696497],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[696604],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[696748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[696873],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[696998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[697123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[697248],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":48},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","contract.rs"],"content":"use std::ops::Add;\nuse cosmwasm_std::{\n    to_binary, Api, Env, Extern, HandleResponse, InitResponse, Querier,\n    StdError, Binary, StdResult, Storage, QueryResult, CosmosMsg, WasmMsg,\n    Uint128, log, HumanAddr, Decimal, QueryRequest, WasmQuery\n};\nuse secret_toolkit::snip20;\nuse sienna_amm_shared::{\n    TokenPairAmount, TokenType,\n    TokenTypeAmount, create_send_msg, Fee, ExchangeSettings,\n    msg::{\n        exchange::{InitMsg, HandleMsg, QueryMsg, QueryMsgResponse, SwapSimulationResponse},\n        snip20::{Snip20InitConfig, Snip20InitMsg},\n        factory::{QueryMsg as FactoryQueryMsg, QueryResponse as FactoryResponse},\n        sienna_burner::HandleMsg as BurnerHandleMsg,\n    },\n    u256_math, u256_math::U256, viewing_key::ViewingKey, crypto::Prng\n};\n\nuse crate::{state::{Config, store_config, load_config}, decimal_math};\nuse fadroma_scrt_migrate::get_status;\nuse fadroma_scrt_callback::{Callback, ContractInstance};\n\ntype SwapResult = StdResult\u003c(Uint128, Uint128, Uint128)\u003e;\n\n/// Pad handle responses and log attributes to blocks\n/// of 256 bytes to prevent leaking info based on response size\nconst BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n\n    if msg.pair.0 == msg.pair.1 {\n        return Err(StdError::generic_err(\"Trying to create an exchange with the same token.\"));\n    }\n\n    let mut messages = vec![];\n\n    let mut rng = Prng::new(\u0026env.message.sender.0.as_bytes(), \u0026env.block.time.to_be_bytes());\n\n    let viewing_key = ViewingKey::new(\u0026env, \u0026rng.rand_bytes(), \u0026rng.rand_bytes());\n\n    try_register_custom_token(\u0026env, \u0026mut messages, \u0026msg.pair.0, \u0026viewing_key)?;\n    try_register_custom_token(\u0026env, \u0026mut messages, \u0026msg.pair.1, \u0026viewing_key)?;\n\n    // Create LP token\n    messages.push(CosmosMsg::Wasm(WasmMsg::Instantiate {\n        code_id: msg.lp_token_contract.id,\n        msg: to_binary(\u0026Snip20InitMsg {\n            name: format!(\n                \"SiennaSwap Liquidity Provider (LP) token for {}-{}\",\n                \u0026msg.pair.0, \u0026msg.pair.1\n            ),\n            admin: Some(env.contract.address.clone()),\n            symbol: \"SWAP-LP\".to_string(),\n            decimals: 6,\n            callback: Some(Callback {\n                msg: to_binary(\u0026HandleMsg::OnLpTokenInit)?,\n                contract: ContractInstance {\n                    address: env.contract.address.clone(),\n                    code_hash: env.contract_code_hash\n                }\n            }),\n            initial_balances: None,\n            prng_seed: Binary::from(rng.rand_bytes()),\n            config: Some(Snip20InitConfig {\n                public_total_supply: Some(true)\n            })\n        })?,\n        send: vec![],\n        label: format!(\n            \"{}-{}-SiennaSwap-LP-Token-{}\",\n            \u0026msg.pair.0,\n            \u0026msg.pair.1,\n            \u0026env.contract.address\n        ),\n        callback_code_hash: msg.lp_token_contract.code_hash.clone(),\n    }));\n    \n    // Execute the HandleMsg::RegisterExchange method of\n    // the factory contract in order to register this address\n    messages.push(\n        CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr: msg.callback.contract.address,\n            callback_code_hash: msg.callback.contract.code_hash,\n            msg: msg.callback.msg,\n            send: vec![],\n        })\n    );\n\n    let config = Config {\n        factory_info: msg.factory_info,\n        lp_token_info: ContractInstance {\n            code_hash: msg.lp_token_contract.code_hash,\n            // We get the address when the instantiated LP token calls OnLpTokenInit\n            address: HumanAddr::default()\n        },\n        pair: msg.pair,\n        contract_addr: env.contract.address.clone(),\n        viewing_key,\n        pool_cache: [ Uint128::zero(), Uint128::zero() ]\n    };\n\n    store_config(deps, \u0026config)?;\n\n    Ok(InitResponse {\n        messages,\n        log: vec![\n            log(\"created_exchange_address\", env.contract.address.as_str())\n        ]\n    })\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    with_status!(deps, env, match msg {\n        HandleMsg::AddLiquidity { deposit, slippage_tolerance } =\u003e add_liquidity(deps, env, deposit, slippage_tolerance),\n        HandleMsg::RemoveLiquidity { amount, recipient } =\u003e remove_liquidity(deps, env, amount, recipient),\n        HandleMsg::OnLpTokenInit =\u003e register_lp_token(deps, env),\n        HandleMsg::Swap { offer, expected_return } =\u003e swap(deps, env, offer, expected_return)\n    })\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e QueryResult {\n    match msg {\n        QueryMsg::Status =\u003e to_binary(\u0026get_status(deps)?),\n        QueryMsg::PairInfo =\u003e {\n            let config = load_config(deps)?;\n            let result = config.pair.query_balances(\u0026deps.querier, config.contract_addr, config.viewing_key.0)?;\n            to_binary(\u0026QueryMsgResponse::PairInfo {\n                liquidity_token: config.lp_token_info,\n                factory: config.factory_info,\n                pair: config.pair,\n                amount_0: result[0],\n                amount_1: result[1]\n            })\n        },\n        QueryMsg::SwapSimulation { offer } =\u003e {\n            let config = load_config(deps)?;\n            to_binary(\u0026swap_simulation(deps, config, offer)?)\n        }\n    }\n}\n\nfn add_liquidity\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    deposit: TokenPairAmount\u003cHumanAddr\u003e,\n    slippage: Option\u003cDecimal\u003e\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    deposit.assert_sent_native_token_balance(\u0026env)?;\n\n    let config = load_config(\u0026deps)?;\n\n    let Config {\n        pair,\n        contract_addr,\n        viewing_key,\n        lp_token_info,\n        ..\n    } = config;\n    \n    if pair != deposit.pair {\n        return Err(StdError::generic_err(\"The provided tokens dont match those managed by the contract.\"));\n    }\n\n    // Because we asserted that the provided pair and the one that is managed by the contract\n    // are identical, from here on, we must only work with the one provided (deposit.pair).\n    // This is because even though pairs with orders (A,B) and (B,A) are identical, the `amount_0` and `amount_1`\n    // variables correspond directly to the pair provided and not necessarily to the one stored. So in this case, order is important.\n\n    let mut messages: Vec\u003cCosmosMsg\u003e = vec![];\n\n    let mut pool_balances = deposit.pair.query_balances(\u0026deps.querier, contract_addr, viewing_key.0)?;\n\n    for (i, (amount, token)) in deposit.into_iter().enumerate() {\n        match \u0026token {\n            TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n                messages.push(snip20::transfer_from_msg(\n                    env.message.sender.clone(),\n                    env.contract.address.clone(),\n                    amount,\n                    None,\n                    BLOCK_SIZE,\n                    token_code_hash.clone(),\n                    contract_addr.clone())?\n                );\n            },\n            TokenType::NativeToken { .. } =\u003e {\n                // If the asset is native token, balance is already increased.\n                // To calculate properly we should subtract user deposit from the pool.\n                pool_balances[i] = (pool_balances[i] - amount)?;\n            }\n        }\n    }\n\n    assert_slippage_tolerance(\n        slippage,\n        \u0026[ deposit.amount_0, deposit.amount_1 ],\n        \u0026pool_balances\n    )?;\n\n    let liquidity_supply = query_liquidity(\u0026deps.querier, \u0026lp_token_info)?;\n\n    let lp_tokens = if liquidity_supply == Uint128::zero() {\n        // If the provider is minting a new pool, the number of liquidity tokens they will\n        // receive will equal sqrt(x * y), where x and y represent the amount of each token provided.\n\n        let amount_0 = U256::from(deposit.amount_0.u128());\n        let amount_1 = U256::from(deposit.amount_1.u128());\n\n        let initial_liquidity = u256_math::mul(Some(amount_0), Some(amount_1))\n            .and_then(u256_math::sqrt)\n            .ok_or(StdError::generic_err(format!(\n                \"Cannot calculate sqrt(deposit_0 {} * deposit_1 {})\",\n                amount_0, amount_1\n            )))?;\n\n        clamp(initial_liquidity)?\n    } else {\n        // When adding to an existing pool, an equal amount of each token, proportional to the\n        // current price, must be deposited. So, determine how many LP tokens are minted.\n\n        let total_share = Some(U256::from(liquidity_supply.u128()));\n\n        let amount_0 = Some(U256::from(deposit.amount_0.u128()));\n        let pool_0 = Some(U256::from(pool_balances[0].u128()));\n\n        let share_0 = u256_math::div(u256_math::mul(amount_0, total_share), pool_0)\n            .ok_or(StdError::generic_err(format!(\n                \"Cannot calculate deposits[0] {} * total_share {} / pools[0].amount {}\",\n                amount_0.unwrap(),\n                total_share.unwrap(),\n                pool_0.unwrap()\n            )))?;\n\n        let amount_1 = Some(U256::from(deposit.amount_1.u128()));\n        let pool_1 = Some(U256::from(pool_balances[1].u128()));\n\n        let share_1 = u256_math::div(u256_math::mul(amount_1, total_share), pool_1)\n            .ok_or(StdError::generic_err(format!(\n                \"Cannot calculate deposits[1] {} * total_share {} / pools[1].amount {}\",\n                amount_1.unwrap(),\n                total_share.unwrap(),\n                pool_1.unwrap()\n            )))?;\n\n        clamp(std::cmp::min(share_0, share_1))?\n    };\n\n    messages.push(snip20::mint_msg(\n        env.message.sender,\n        lp_tokens,\n        None,\n        BLOCK_SIZE,\n        lp_token_info.code_hash,\n        lp_token_info.address,\n    )?);\n\n    Ok(HandleResponse {\n        messages,\n        log: vec![\n            log(\"action\", \"provide_liquidity\"),\n            log(\"assets\", format!(\"{}, {}\", deposit.pair.0, deposit.pair.1)),\n            log(\"share\", lp_tokens),\n        ],\n        data: None,\n    })\n}\n\nfn remove_liquidity\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n    recipient: HumanAddr\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let config = load_config(\u0026deps)?;\n\n    let Config {\n        pair,\n        lp_token_info,\n        contract_addr,\n        viewing_key,\n        ..\n    } = config;\n\n    let liquidity_supply = query_liquidity(\u0026deps.querier, \u0026lp_token_info)?;\n    let pool_balances = pair.query_balances(\u0026deps.querier, contract_addr, viewing_key.0)?;\n\n    // Calculate the withdrawn amount for each token in the pair - for each token X\n    // amount of X withdrawn = amount in pool for X * amount of LP tokens being burned / total liquidity pool amount\n\n    let withdraw_amount = Some(U256::from(amount.u128()));\n    let total_liquidity = Some(U256::from(liquidity_supply.u128()));\n\n    let mut pool_withdrawn: [Uint128; 2] = [ Uint128::zero(), Uint128::zero() ];\n\n    for (i, pool_amount) in pool_balances.iter().enumerate() {\n        let pool_amount = Some(U256::from(pool_amount.u128()));\n\n        let withdrawn_token_amount = u256_math::div(\n            u256_math::mul(pool_amount, withdraw_amount),\n            total_liquidity,\n        ).ok_or(StdError::generic_err(format!(\n            \"Cannot calculate current_pool_amount {} * withdrawn_share_amount {} / total_share {}\",\n            pool_amount.unwrap(),\n            withdraw_amount.unwrap(),\n            total_liquidity.unwrap()\n        )))?;\n\n        pool_withdrawn[i] = clamp(withdrawn_token_amount)?;\n    }\n\n    let mut messages: Vec\u003cCosmosMsg\u003e = Vec::with_capacity(2);\n\n    for (i, token) in pair.into_iter().enumerate() {\n        messages.push(\n            create_send_msg(\u0026token, env.contract.address.clone(), recipient.clone(), pool_withdrawn[i])?\n        );\n    }\n\n    messages.push(snip20::burn_from_msg(\n        env.message.sender,\n        amount,\n        None,\n        BLOCK_SIZE,\n        lp_token_info.code_hash,\n        lp_token_info.address\n    )?);\n\n    Ok(HandleResponse {\n        messages,\n        log: vec![\n            log(\"action\", \"remove_liquidity\"),\n            log(\"withdrawn_share\", amount.to_string()),\n            log(\"refund_assets\", format!(\"{}, {}\", \u0026pair.0, \u0026pair.1)),\n        ],\n        data: None\n    })\n}\n\nfn swap\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    offer: TokenTypeAmount\u003cHumanAddr\u003e,\n    expected_return: Option\u003cUint128\u003e\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut messages = vec![];\n\n    match \u0026offer.token {\n        TokenType::NativeToken { .. } =\u003e {\n            offer.assert_sent_native_token_balance(\u0026env)?;\n        },\n        TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n            messages.push(snip20::transfer_from_msg(\n                env.message.sender.clone(),\n                env.contract.address.clone(),\n                offer.amount,\n                None,\n                BLOCK_SIZE,\n                token_code_hash.clone(),\n                contract_addr.clone()\n            )?);\n        }\n    }\n\n    let mut config = load_config(deps)?;\n\n    let settings = query_exchange_settings(\u0026deps.querier, config.factory_info.clone())?;\n\n    let (mut return_amount, spread_amount, mut commission_amount) = do_swap(deps, \u0026mut config, \u0026offer, settings.swap_fee, false)?;\n    store_config(deps, \u0026config)?; // Save in order to update the pool_cache\n\n    if let Some(expected_return) = expected_return {\n        if return_amount.lt(\u0026expected_return) {\n            return Err(StdError::generic_err(\n                \"Operation fell short of expected_return\",\n            ));\n        }\n    }\n\n    // SIENNA needs to be burned on each swap in order to decrease the total supply\n    if let Some(info) = settings.sienna_burner {\n        let (result, decrease_amount) = percentage_decrease(U256::from(return_amount.u128()), settings.sienna_fee)?;\n        let decrease_amount = clamp(decrease_amount)?;\n\n        commission_amount = commission_amount + decrease_amount;\n        return_amount = clamp(result)?;\n\n        messages.push(CosmosMsg::Wasm(WasmMsg::Execute {\n            callback_code_hash: info.code_hash,\n            contract_addr: info.address,\n            msg: to_binary(\u0026BurnerHandleMsg::Burn {\n                amount: decrease_amount\n            })?,\n            send: vec![]\n        }))\n    }\n\n    let index = config.pair.get_token_index(\u0026offer.token).unwrap(); // Safe, checked in do_swap\n    let token = config.pair.get_token(index ^ 1).unwrap();\n\n    messages.push(create_send_msg(\u0026token, env.contract.address, env.message.sender, return_amount)?);\n\n    Ok(HandleResponse{\n        messages,\n        log: vec![\n            log(\"action\", \"swap\"),\n            log(\"offer_token\", offer.token.to_string()),\n            log(\"offer_amount\", offer.amount.to_string()),\n            log(\"return_amount\", return_amount.to_string()),\n            log(\"spread_amount\", spread_amount.to_string()),\n            log(\"commission_amount\", commission_amount.to_string())\n        ],\n        data: None\n    })\n}\n\n\n\nfn query_liquidity(\n    querier: \u0026impl Querier,\n    lp_token_info: \u0026ContractInstance\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cUint128\u003e {\n    let result = snip20::token_info_query(\n        querier,\n        BLOCK_SIZE,\n        lp_token_info.code_hash.clone(),\n        lp_token_info.address.clone()\n    )?;\n\n    //If this happens, the LP token has been incorrectly configured\n    if result.total_supply.is_none() {\n        unreachable!(\"LP token has no available supply.\");\n    }\n\n    Ok(result.total_supply.unwrap())\n}\n\nfn swap_simulation\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    mut config: Config\u003cHumanAddr\u003e,\n    offer: TokenTypeAmount\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cSwapSimulationResponse\u003e {\n    let settings = query_exchange_settings(\u0026deps.querier, config.factory_info.clone())?;\n\n    let (mut return_amount, spread_amount, mut commission_amount) = do_swap(deps, \u0026mut config, \u0026offer, settings.swap_fee, true)?;\n\n    if let Some(_) = settings.sienna_burner {\n        let (result, decrease_amount) = percentage_decrease(U256::from(return_amount.u128()), settings.sienna_fee)?;\n        let decrease_amount = clamp(decrease_amount)?;\n\n        commission_amount += decrease_amount;\n        return_amount = clamp(result)?;\n    }\n\n    Ok(SwapSimulationResponse { return_amount, spread_amount, commission_amount })\n}\n\nfn register_lp_token\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = load_config(\u0026deps)?;\n\n    //This should only be set once when the LP token is instantiated.\n    if config.lp_token_info.address != HumanAddr::default() {\n        return Err(StdError::unauthorized());\n    }\n\n    config.lp_token_info.address = env.message.sender.clone();\n\n    store_config(deps, \u0026config)?;\n\n    Ok(HandleResponse {\n        messages: vec![snip20::register_receive_msg(\n            env.contract_code_hash,\n            None,\n            BLOCK_SIZE,\n            config.lp_token_info.code_hash,\n            env.message.sender.clone(),\n        )?],\n        log: vec![log(\"liquidity_token_addr\", env.message.sender.as_str())],\n        data: None,\n    })\n}\n\nfn try_register_custom_token(\n    env: \u0026Env,\n    messages: \u0026mut Vec\u003cCosmosMsg\u003e,\n    token: \u0026TokenType\u003cHumanAddr\u003e,\n    viewing_key: \u0026ViewingKey\n) -\u003e StdResult\u003c()\u003e {\n    if let TokenType::CustomToken { \n        contract_addr, token_code_hash, ..\n    } = token {\n        messages.push(snip20::set_viewing_key_msg(\n            viewing_key.0.clone(),\n            None,\n            BLOCK_SIZE,\n            token_code_hash.clone(),\n            contract_addr.clone(),\n        )?);\n        messages.push(snip20::register_receive_msg(\n            env.contract_code_hash.clone(),\n            None,\n            BLOCK_SIZE,\n            token_code_hash.clone(),\n            contract_addr.clone(),\n        )?);\n    }\n\n    Ok(())\n}\n\nfn do_swap\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    config: \u0026mut Config\u003cHumanAddr\u003e,\n    offer: \u0026TokenTypeAmount\u003cHumanAddr\u003e,\n    fee: Fee,\n    is_simulation: bool\n) -\u003e SwapResult {\n    if !config.pair.contains(\u0026offer.token) {\n        return Err(StdError::generic_err(format!(\"The supplied token {}, is not managed by this contract.\", offer.token)));\n    }\n\n    let balances = config.pair.query_balances(\u0026deps.querier, config.contract_addr.clone(), config.viewing_key.0.clone())?;\n    let token_index = config.pair.get_token_index(\u0026offer.token).unwrap(); //Safe because we checked above for existence\n    \n    let mut offer_pool = balances[token_index];\n\n    if !is_simulation {\n        config.pool_cache[token_index] = config.pool_cache[token_index].add(offer.amount);\n\n        // If offer.token is not native, the balance hasn't been increased yet\n        if let TokenType::NativeToken { .. } = offer.token {\n            let result = U256::from(offer_pool.u128()).checked_sub(U256::from(offer.amount.u128()))\n                .ok_or(StdError::generic_err(\"This can't really happen.\"))?;\n\n            offer_pool = clamp(result)?\n        }\n    }\n\n    compute_swap(\n        offer_pool,\n        balances[token_index ^ 1],\n        offer.amount,\n        fee\n    )\n}\n\n// Copied from https://github.com/enigmampc/SecretSwap/blob/ffd72d1c94096ac3a78aaf8e576f22584f49fe7a/contracts/secretswap_pair/src/contract.rs#L768\nfn compute_swap(\n    offer_pool: Uint128,\n    ask_pool: Uint128,\n    offer_amount: Uint128,\n    fee: Fee\n) -\u003e SwapResult {\n    // offer =\u003e ask\n    let offer_pool = Some(U256::from(offer_pool.u128()));\n    let ask_pool = Some(U256::from(ask_pool.u128()));\n    let offer_amount = Some(U256::from(offer_amount.u128()));\n\n    // cp = offer_pool * ask_pool\n    let cp = u256_math::mul(offer_pool, ask_pool).ok_or(StdError::generic_err(format!(\n        \"Cannot calculate cp = offer_pool {} * ask_pool {}\",\n        offer_pool.unwrap(),\n        ask_pool.unwrap()\n    )))?;\n\n    // return_amount = (ask_pool - cp / (offer_pool + offer_amount))\n    // ask_amount = return_amount * (1 - commission_rate)\n    let return_amount = u256_math::sub(ask_pool, u256_math::div(Some(cp), u256_math::add(offer_pool, offer_amount)))\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate return_amount = (ask_pool {} - cp {} / (offer_pool {} + offer_amount {}))\",\n            ask_pool.unwrap(),\n            cp,\n            offer_pool.unwrap(),\n            offer_amount.unwrap(),\n        )))?;\n\n    // calculate spread \u0026 commission\n    // spread = offer_amount * ask_pool / offer_pool - return_amount\n    let spread_amount = u256_math::div(u256_math::mul(offer_amount, ask_pool), offer_pool)\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate offer_amount {} * ask_pool {} / offer_pool {}\",\n            offer_amount.unwrap(),\n            ask_pool.unwrap(),\n            offer_pool.unwrap()\n        )))?\n        .saturating_sub(return_amount);\n\n    // commission_amount = return_amount * fee.nom / fee.denom\n    let (return_amount, commission_amount) = percentage_decrease(return_amount, fee)?;\n\n    Ok((clamp(return_amount)?, clamp(spread_amount)?, clamp(commission_amount)?))\n}\n\nfn percentage_decrease(amount: U256, fee: Fee) -\u003e StdResult\u003c(U256, U256)\u003e {\n    let amount = Some(amount);\n    let nom = Some(U256::from(fee.nom));\n    let denom = Some(U256::from(fee.denom));\n\n    let decrease_amount = u256_math::div(u256_math::mul(amount, nom), denom,)\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate return_amount {} * commission_rate_nom {} / commission_rate_denom {}\",\n            amount.unwrap(),\n            nom.unwrap(),\n            denom.unwrap()\n        )))?;\n\n    let result = u256_math::sub(amount, Some(decrease_amount))\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate return_amount {} - commission_amount {}\",\n            amount.unwrap(),\n            decrease_amount\n        )))?;\n\n    Ok((result, decrease_amount))\n}\n\n/// The amount the price moves in a trading pair between when a transaction is submitted and when it is executed.\n/// Returns an `StdError` if the range of the expected tokens to be received is exceeded.\nfn assert_slippage_tolerance(\n    slippage: Option\u003cDecimal\u003e,\n    deposits: \u0026[Uint128; 2],\n    pools: \u0026[Uint128; 2]\n) -\u003e StdResult\u003c()\u003e {\n    if slippage.is_none() {\n        return Ok(());\n    }\n\n    let one_minus_slippage_tolerance = decimal_math::decimal_subtraction(Decimal::one(), slippage.unwrap())?;\n\n    // Ensure each prices are not dropped as much as slippage tolerance rate\n    if decimal_math::decimal_multiplication(\n        Decimal::from_ratio(deposits[0], deposits[1]),\n        one_minus_slippage_tolerance,\n    ) \u003e Decimal::from_ratio(pools[0], pools[1]) || \n    decimal_math::decimal_multiplication(\n        Decimal::from_ratio(deposits[1], deposits[0]),\n        one_minus_slippage_tolerance,\n    ) \u003e Decimal::from_ratio(pools[1], pools[0])\n    {\n        return Err(StdError::generic_err(\n            \"Operation exceeds max slippage tolerance\",\n        ));\n    }\n\n    Ok(())\n}\n\nfn query_exchange_settings (\n    querier: \u0026impl Querier,\n    factory: ContractInstance\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cExchangeSettings\u003cHumanAddr\u003e\u003e {\n    let result: FactoryResponse = querier.query(\u0026QueryRequest::Wasm(WasmQuery::Smart {\n        callback_code_hash: factory.code_hash,\n        contract_addr: factory.address,\n        msg: to_binary(\u0026FactoryQueryMsg::GetExchangeSettings)?\n    }))?;\n\n    match result {\n        FactoryResponse::GetExchangeSettings { settings } =\u003e Ok(settings),\n        _ =\u003e Err(StdError::generic_err(\"An error occurred while trying to retrieve exchange settings.\"))\n    }\n}\n\n/*\n#[cfg(test)]\nmod tests {\n    use super::*;\n*/\n\nfn clamp(val: U256) -\u003e StdResult\u003cUint128\u003e {\n    if val \u003e u128::MAX.into() {\n        Err(StdError::generic_err(format!(\"cannot represent {} in 128 bits\", \u0026val)))\n    } else {\n        Ok(Uint128(val.low_u128()))\n    }\n}\n","traces":[{"line":497,"address":[632768,633304],"length":1,"stats":{"Line":0},"fn_name":"try_register_custom_token"},{"line":503,"address":[634067,632961,632837,634072],"length":1,"stats":{"Line":0},"fn_name":null},{"line":504,"address":[632901],"length":1,"stats":{"Line":0},"fn_name":null},{"line":506,"address":[633352,633485,633234,633092],"length":1,"stats":{"Line":0},"fn_name":null},{"line":507,"address":[632937],"length":1,"stats":{"Line":0},"fn_name":null},{"line":508,"address":[632985],"length":1,"stats":{"Line":0},"fn_name":null},{"line":510,"address":[633005],"length":1,"stats":{"Line":0},"fn_name":null},{"line":511,"address":[633044],"length":1,"stats":{"Line":0},"fn_name":null},{"line":513,"address":[634049,633910,633659,633801],"length":1,"stats":{"Line":0},"fn_name":null},{"line":514,"address":[633518],"length":1,"stats":{"Line":0},"fn_name":null},{"line":515,"address":[633552],"length":1,"stats":{"Line":0},"fn_name":null},{"line":517,"address":[633572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":518,"address":[633611],"length":1,"stats":{"Line":0},"fn_name":null},{"line":522,"address":[632968],"length":1,"stats":{"Line":0},"fn_name":null},{"line":562,"address":[634080],"length":1,"stats":{"Line":0},"fn_name":"compute_swap"},{"line":569,"address":[634248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":570,"address":[634387],"length":1,"stats":{"Line":0},"fn_name":null},{"line":571,"address":[634526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":574,"address":[635255,634665,634855,635699],"length":1,"stats":{"Line":0},"fn_name":null},{"line":576,"address":[634747],"length":1,"stats":{"Line":0},"fn_name":null},{"line":577,"address":[634801],"length":1,"stats":{"Line":0},"fn_name":null},{"line":582,"address":[636824,635730,636546,636475,635385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":583,"address":[635952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":585,"address":[635790],"length":1,"stats":{"Line":0},"fn_name":null},{"line":587,"address":[635844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":588,"address":[635898],"length":1,"stats":{"Line":0},"fn_name":null},{"line":593,"address":[636676,637810,637449,636842,637520,637714],"length":1,"stats":{"Line":0},"fn_name":null},{"line":594,"address":[637060],"length":1,"stats":{"Line":0},"fn_name":null},{"line":596,"address":[636898],"length":1,"stats":{"Line":0},"fn_name":null},{"line":597,"address":[636952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":598,"address":[637006],"length":1,"stats":{"Line":0},"fn_name":null},{"line":600,"address":[637650],"length":1,"stats":{"Line":0},"fn_name":null},{"line":603,"address":[637843,638248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":605,"address":[638584,638837,639029,638161,638330],"length":1,"stats":{"Line":0},"fn_name":null},{"line":608,"address":[639120],"length":1,"stats":{"Line":0},"fn_name":"percentage_decrease"},{"line":609,"address":[639165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":610,"address":[639288],"length":1,"stats":{"Line":0},"fn_name":null},{"line":611,"address":[639386],"length":1,"stats":{"Line":0},"fn_name":null},{"line":613,"address":[639479,640239,640168,640628],"length":1,"stats":{"Line":0},"fn_name":null},{"line":614,"address":[639779],"length":1,"stats":{"Line":0},"fn_name":null},{"line":616,"address":[639617],"length":1,"stats":{"Line":0},"fn_name":null},{"line":617,"address":[639671],"length":1,"stats":{"Line":0},"fn_name":null},{"line":618,"address":[639725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":621,"address":[641083,641574,641012,640369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":622,"address":[640713],"length":1,"stats":{"Line":0},"fn_name":null},{"line":624,"address":[640659],"length":1,"stats":{"Line":0},"fn_name":null},{"line":628,"address":[641218],"length":1,"stats":{"Line":0},"fn_name":null},{"line":633,"address":[641600],"length":1,"stats":{"Line":0},"fn_name":"assert_slippage_tolerance"},{"line":638,"address":[641670],"length":1,"stats":{"Line":0},"fn_name":null},{"line":639,"address":[641726],"length":1,"stats":{"Line":0},"fn_name":null},{"line":642,"address":[641749,641703,641963],"length":1,"stats":{"Line":0},"fn_name":null},{"line":645,"address":[642333,642062,642124,642197],"length":1,"stats":{"Line":0},"fn_name":null},{"line":646,"address":[641931],"length":1,"stats":{"Line":0},"fn_name":null},{"line":648,"address":[642088],"length":1,"stats":{"Line":0},"fn_name":null},{"line":649,"address":[642303,642241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":650,"address":[642165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":652,"address":[642267],"length":1,"stats":{"Line":0},"fn_name":null},{"line":654,"address":[642364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":659,"address":[642352],"length":1,"stats":{"Line":0},"fn_name":null},{"line":684,"address":[642432],"length":1,"stats":{"Line":0},"fn_name":"clamp"},{"line":685,"address":[642861,642466,642863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":686,"address":[642534],"length":1,"stats":{"Line":0},"fn_name":null},{"line":688,"address":[642814,642509],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":63},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","decimal_math.rs"],"content":"// Copied from https://github.com/enigmampc/SecretSwap/blob/master/contracts/secretswap_pair/src/math.rs\n\nuse cosmwasm_std::{Decimal, StdResult, Uint128};\n\nconst DECIMAL_FRACTIONAL: Uint128 = Uint128(1_000_000_000u128);\n/*\npub fn reverse_decimal(decimal: Decimal) -\u003e Decimal {\n    if decimal.is_zero() {\n        return Decimal::zero();\n    }\n\n    Decimal::from_ratio(DECIMAL_FRACTIONAL, decimal * DECIMAL_FRACTIONAL)\n}\n*/\npub fn decimal_subtraction(a: Decimal, b: Decimal) -\u003e StdResult\u003cDecimal\u003e {\n    Ok(Decimal::from_ratio(\n        (a * DECIMAL_FRACTIONAL - b * DECIMAL_FRACTIONAL)?,\n        DECIMAL_FRACTIONAL,\n    ))\n}\n\npub fn decimal_multiplication(a: Decimal, b: Decimal) -\u003e Decimal {\n    Decimal::from_ratio(a * DECIMAL_FRACTIONAL * b, DECIMAL_FRACTIONAL)\n}\n","traces":[{"line":15,"address":[611328],"length":1,"stats":{"Line":0},"fn_name":"decimal_subtraction"},{"line":16,"address":[611700,611581],"length":1,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[611598,611413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[611728],"length":1,"stats":{"Line":0},"fn_name":"decimal_multiplication"},{"line":23,"address":[611762],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":5},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","lib.rs"],"content":"#[macro_use] extern crate fadroma_scrt_migrate;\npub mod contract;\npub mod state;\nmod decimal_math;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","state.rs"],"content":"use cosmwasm_std::{\n    Api, CanonicalAddr, Extern, HumanAddr, Querier,\n    StdResult, Storage, Uint128, StdError\n};\nuse serde::{Serialize,Deserialize};\n\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstance;\nuse fadroma_scrt_storage::{load, save};\nuse cosmwasm_utils::viewing_key::ViewingKey;\nuse sienna_amm_shared::TokenPair;\n\nconst CONFIG_KEY: \u0026[u8] = b\"config\";\n\n#[derive(Serialize, Deserialize, PartialEq, Debug)]\npub(crate) struct Config\u003cA: Clone\u003e {\n    pub factory_info:  ContractInstance\u003cA\u003e,\n    pub lp_token_info: ContractInstance\u003cA\u003e,\n    pub pair:          TokenPair\u003cA\u003e,\n    /// The address of the current contract.\n    pub contract_addr: A,\n    /// Viewing key used for custom SNIP20 tokens.\n    pub viewing_key:   ViewingKey,\n    /// Typically, smart contracts which need tokens to perform some functionality\n    /// require callers to first make an approval on the token contract,\n    /// then call a function that in turn calls transferFrom on the token contract.\n    ///\n    /// This is not how Uniswap pairs accept tokens.\n    /// Instead, pairs check their token balances at the end of every interaction.\n    ///\n    /// Then, at the beginning of the next interaction, current balances are differenced\n    /// against the stored values to determine the amount of tokens that were sent by the\n    /// current interactor.\n    pub pool_cache: [Uint128; 2]\n}\nimpl Canonize\u003cConfig\u003cCanonicalAddr\u003e\u003e for Config\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cCanonicalAddr\u003e\u003e {\n        Ok(Config {\n            factory_info:  self.factory_info.canonize(api)?,\n            lp_token_info: self.lp_token_info.canonize(api)?,\n            pair:          self.pair.canonize(api)?,\n            contract_addr: self.contract_addr.canonize(api)?,\n            viewing_key:   self.viewing_key.clone(),\n            pool_cache:    self.pool_cache\n        })\n    }\n}\nimpl Humanize\u003cConfig\u003cHumanAddr\u003e\u003e for Config\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n        Ok(Config {\n            factory_info:  self.factory_info.humanize(api)?,\n            lp_token_info: self.lp_token_info.humanize(api)?,\n            pair:          self.pair.humanize(api)?,\n            contract_addr: self.contract_addr.humanize(api)?,\n            viewing_key:   self.viewing_key.clone(),\n            pool_cache:    self.pool_cache\n        })\n    }\n}\n\npub(crate) fn store_config \u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:   \u0026mut Extern\u003cS, A, Q\u003e,\n    config: \u0026Config\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, CONFIG_KEY, \u0026config.canonize(\u0026deps.api)?)\n}\n\npub(crate) fn load_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n    let result: Config\u003cCanonicalAddr\u003e = load(\u0026deps.storage, CONFIG_KEY)?.ok_or(\n        StdError::generic_err(\"Config doesn't exist in storage.\")\n    )?;\n    result.humanize(\u0026deps.api)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::testing::mock_dependencies;\n    use sienna_amm_shared::TokenType;\n\n    #[test]\n    fn properly_stores_config() -\u003e StdResult\u003c()\u003e {\n        let mut deps = mock_dependencies(10, \u0026[]);\n\n        let config = Config {\n            factory_info: ContractInstance {\n                code_hash: \"factory_hash\".into(),\n                address: HumanAddr(\"factory\".into())\n            },\n            lp_token_info: ContractInstance {\n                code_hash: \"token_hash\".into(),\n                address: HumanAddr(\"lp_token\".into())\n            },\n            pair: TokenPair(\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"first_addr\".into()),\n                    token_code_hash: \"13123adasd\".into()\n                },\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"scnd_addr\".into()),\n                    token_code_hash: \"4534qwerqqw\".into()\n                }\n            ),\n            contract_addr: HumanAddr(\"this\".into()),\n            viewing_key: ViewingKey(\"vk\".into()),\n            pool_cache: [ Uint128::zero(), Uint128(123) ]\n        };\n\n        store_config(\u0026mut deps, \u0026config)?;\n\n        let result = load_config(\u0026deps)?;\n\n        assert_eq!(config, result);\n\n        Ok(())\n    }\n}\n","traces":[{"line":37,"address":[571834,571456],"length":1,"stats":{"Line":1},"fn_name":"canonize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":38,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":41,"address":[572595,571956,572266,572310],"length":1,"stats":{"Line":3},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[576656,576304],"length":1,"stats":{"Line":1},"fn_name":"store_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":65,"address":[576350],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[576688,577091],"length":1,"stats":{"Line":1},"fn_name":"load_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":71,"address":[576987,577138,576718,577297,577068,576900],"length":1,"stats":{"Line":3},"fn_name":null},{"line":72,"address":[576869],"length":1,"stats":{"Line":1},"fn_name":null},{"line":74,"address":[577225],"length":1,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[596361,596352],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":85,"address":[643617],"length":1,"stats":{"Line":1},"fn_name":null},{"line":88,"address":[643775],"length":1,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[644015],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[644583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[644711,644783],"length":1,"stats":{"Line":2},"fn_name":null},{"line":107,"address":[644887,644815],"length":1,"stats":{"Line":2},"fn_name":null},{"line":108,"address":[644994,644919],"length":1,"stats":{"Line":2},"fn_name":null},{"line":111,"address":[645391,645455,645765,645502,645556],"length":1,"stats":{"Line":3},"fn_name":null},{"line":113,"address":[645541,646232,646020,645826],"length":1,"stats":{"Line":2},"fn_name":null},{"line":115,"address":[645941,646286,646371],"length":1,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[646339],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":34,"coverable":34},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","tests","integration.rs"],"content":"//! This integration test tries to run and call the generated wasm.\n//! It depends on a Wasm build being available, which you can create with `cargo wasm`.\n//! Then running `cargo integration-test` will validate we can properly call into that generated Wasm.\n//!\n//! You can easily convert unit tests to integration tests.\n//! 1. First copy them over verbatum,\n//! 2. Then change\n//!      let mut deps = mock_dependencies(20, \u0026[]);\n//!    to\n//!      let mut deps = mock_instance(WASM, \u0026[]);\n//! 3. If you access raw storage, where ever you see something like:\n//!      deps.storage.get(CONFIG_KEY).expect(\"no data stored\");\n//!    replace it with:\n//!      deps.with_storage(|store| {\n//!          let data = store.get(CONFIG_KEY).expect(\"no data stored\");\n//!          //...\n//!      });\n//! 4. Anywhere you see query(\u0026deps, ...) you must replace it with query(\u0026mut deps, ...)\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","contract.rs"],"content":"use cosmwasm_std::{\n    Api, Binary, CosmosMsg, Env, Extern, HandleResponse, InitResponse,\n    Querier, StdError, StdResult, Storage, WasmMsg, log, to_binary, HumanAddr\n};\nuse sienna_amm_shared::{\n    TokenPair,\n    Pagination,\n    msg::{\n        exchange::InitMsg as ExchangeInitMsg,\n        ido::{IdoInitMsg, IdoInitConfig},\n        factory::{InitMsg, HandleMsg, QueryMsg, QueryResponse},\n        sienna_burner::HandleMsg as BurnerHandleMsg\n    },\n    admin::{\n        require_admin,\n        admin::{\n            DefaultHandleImpl as AdminHandle, DefaultQueryImpl as AdminQuery,\n            save_admin, admin_handle, admin_query, assert_admin\n        }\n    }\n};\nuse fadroma_scrt_callback::{ContractInstance, Callback};\nuse fadroma_scrt_storage::{load, save, remove};\nuse crate::state::{\n    save_config, load_config, Config, pair_exists, store_exchange,\n    get_address_for_pair, get_idos, store_ido_address, get_exchanges\n};\nuse fadroma_scrt_migrate::{is_operational, can_set_status, set_status, get_status};\n\npub const EPHEMERAL_STORAGE_KEY: \u0026[u8] = b\"ephemeral_storage\";\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    save_config(deps, \u0026Config::from_init_msg(msg))?;\n    save_admin(deps, \u0026env.message.sender)?;\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    with_status!(deps, env, match msg {\n        HandleMsg::SetConfig { .. }          =\u003e set_config(deps, env, msg),\n        HandleMsg::CreateExchange { pair }   =\u003e create_exchange(deps, env, pair),\n        HandleMsg::CreateIdo { info }        =\u003e create_ido(deps, env, info),\n        HandleMsg::RegisterIdo { signature } =\u003e register_ido(deps, env, signature),\n        HandleMsg::RegisterExchange { pair, signature } =\u003e\n            register_exchange(deps, env, pair, signature),\n\n        HandleMsg::Admin(msg) =\u003e admin_handle(deps, env, msg, AdminHandle),\n    })\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::Status                       =\u003e to_binary(\u0026get_status(deps)?),\n        QueryMsg::GetConfig {}                 =\u003e get_config(deps),\n        QueryMsg::GetExchangeAddress { pair }  =\u003e query_exchange_address(deps, pair),\n        QueryMsg::ListExchanges { pagination } =\u003e list_exchanges(deps, pagination),\n        QueryMsg::ListIdos { pagination }      =\u003e list_idos(deps, pagination),\n        QueryMsg::GetExchangeSettings          =\u003e query_exchange_settings(deps),\n\n        QueryMsg::Admin(msg) =\u003e admin_query(deps, msg, AdminQuery),\n    }\n}\n\n#[require_admin]\npub fn set_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env:  Env,\n    msg:  HandleMsg\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    if let HandleMsg::SetConfig {\n        snip20_contract, lp_token_contract, pair_contract, ido_contract,\n        exchange_settings\n    } = msg {\n        let mut config = load_config(deps)?;\n        if let Some(new_value) = snip20_contract   { config.snip20_contract   = new_value; }\n        if let Some(new_value) = lp_token_contract { config.lp_token_contract = new_value; }\n        if let Some(new_value) = pair_contract     { config.pair_contract     = new_value; }\n        if let Some(new_value) = ido_contract      { config.ido_contract      = new_value; }\n        if let Some(new_value) = exchange_settings { config.exchange_settings = new_value; }\n        save_config(deps, \u0026config)?;\n        Ok(HandleResponse::default())\n    } else {\n        unreachable!()\n    }\n}\n\npub fn get_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n) -\u003e StdResult\u003cBinary\u003e {\n    let Config::\u003cHumanAddr\u003e {\n        snip20_contract, lp_token_contract, pair_contract, ido_contract,\n        exchange_settings, ..\n    } = load_config(deps)?;\n    to_binary(\u0026QueryResponse::Config {\n        snip20_contract, lp_token_contract, pair_contract, ido_contract,\n        exchange_settings\n    })\n}\n\npub fn create_exchange\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pair: TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cHandleResponse\u003e {\n\n    if pair.0 == pair.1 {\n        return Err(StdError::generic_err(\"Cannot create an exchange with the same token.\"));\n    }\n\n    if pair_exists(deps, \u0026pair)? {\n        return Err(StdError::generic_err(\"Pair already exists\"));\n    }\n\n    let config = load_config(deps)?;\n\n    // We take advantage of the serialized execution model to create a signature\n    // and remove it at the end of the transaction. This signature is passed to\n    // the created pair which it then returns to HandleMsg::RegisterExchange so that\n    // it can be compared to the one we stored. This way, we ensure that exchanges \n    // can only be created through this method.\n    let signature = create_signature(\u0026env)?;\n    save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n    // Actually creating the exchange happens when the instantiated contract calls\n    // us back via the HandleMsg::RegisterExchange so that we can get its address.\n\n    Ok(HandleResponse{\n        messages: vec![\n            CosmosMsg::Wasm(\n                WasmMsg::Instantiate {\n                    code_id: config.pair_contract.id,\n                    callback_code_hash: config.pair_contract.code_hash,\n                    send: vec![],\n                    label: format!(\n                        \"{}-{}-pair-{}-{}\",\n                        pair.0,\n                        pair.1,\n                        env.contract.address,\n                        config.pair_contract.id\n                    ),\n                    msg: to_binary(\n                        \u0026ExchangeInitMsg {\n                            pair: pair.clone(),\n                            lp_token_contract: config.lp_token_contract.clone(),\n                            factory_info: ContractInstance {\n                                code_hash: env.contract_code_hash.clone(),\n                                address:   env.contract.address.clone()\n                            },\n                            callback: Callback {\n                                contract: ContractInstance {\n                                    address:   env.contract.address,\n                                    code_hash: env.contract_code_hash,\n                                },\n                                msg: to_binary(\u0026HandleMsg::RegisterExchange {\n                                    pair: pair.clone(),\n                                    signature\n                                })?,\n                            }\n                        }\n                    )?\n                }\n            )\n        ],\n        log: vec![\n            log(\"action\", \"create_exchange\"),\n            log(\"pair\", pair),\n        ],\n        data: None\n    })\n}\n\nfn register_exchange\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pair: TokenPair\u003cHumanAddr\u003e,\n    signature: Binary\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    ensure_correct_signature(\u0026mut deps.storage, signature)?;\n\n    store_exchange(deps, \u0026pair, \u0026env.message.sender)?;\n\n    let config = load_config(\u0026deps)?;\n    let mut messages = vec![];\n\n    if let Some(info) = config.exchange_settings.sienna_burner {\n        let pairs = vec![ env.message.sender.clone() ];\n        messages.push(CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr:      info.address,\n            callback_code_hash: info.code_hash,\n            msg: to_binary(\u0026BurnerHandleMsg::AddPairs { pairs })?,\n            send: vec![]\n        }))\n    }\n\n    Ok(HandleResponse {\n        messages,\n        log: vec![\n            log(\"action\", \"register_exchange\"),\n            log(\"address\", env.message.sender),\n            log(\"pair\", pair)\n        ],\n        data: None\n    })\n}\n\nfn query_exchange_address\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pair: TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = get_address_for_pair(deps, \u0026pair)?;\n    \n    to_binary(\u0026QueryResponse::GetExchangeAddress {\n        address\n    })\n}\n\nfn create_ido\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    info: IdoInitConfig\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let signature = create_signature(\u0026env)?;\n    save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n    \n    // Again, creating the IDO happens when the instantiated contract calls\n    // us back via the HandleMsg::RegisterIdo so that we can get its address.\n    \n    let config = load_config(deps)?;\n\n    Ok(HandleResponse {\n        messages: vec![\n            CosmosMsg::Wasm(WasmMsg::Instantiate {\n                code_id: config.ido_contract.id,\n                callback_code_hash: config.ido_contract.code_hash.clone(),\n                send: vec![],\n                label: format!(\n                    \"IDO for {}({}), id: {}\",\n                    info.snip20_init_info.name,\n                    info.snip20_init_info.symbol,\n                    config.ido_contract.id\n                ),\n                msg: to_binary(\u0026IdoInitMsg {\n                    info,\n                    snip20_contract: config.snip20_contract,\n                    callback: Callback {\n                        contract: ContractInstance {\n                            address:   env.contract.address,\n                            code_hash: env.contract_code_hash,\n                        },\n                        msg: to_binary(\u0026HandleMsg::RegisterIdo {\n                            signature\n                        })?\n                    }\n                })?\n            })\n        ],\n        log: vec![\n            log(\"action\", \"create_exchange\")\n        ],\n        data: None\n    })\n}\n\nfn register_ido\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    signature: Binary\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    ensure_correct_signature(\u0026mut deps.storage, signature)?;\n\n    let mut config = load_config(deps)?;\n\n    store_ido_address(deps, \u0026env.message.sender, \u0026mut config)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![\n            log(\"created IDO\", env.message.sender)\n        ],\n        data: None\n    })\n}\n\nfn list_idos\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cBinary\u003e {\n    let config = load_config(deps)?;\n    let idos = get_idos(deps, \u0026config, pagination)?;\n\n    to_binary(\u0026QueryResponse::ListIdos { idos })\n}\n\nfn list_exchanges\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cBinary\u003e {\n    let exchanges = get_exchanges(deps, pagination)?;\n\n    to_binary(\u0026QueryResponse::ListExchanges { exchanges })\n}\n\nfn query_exchange_settings\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cBinary\u003e {\n    let config = load_config(deps)?;\n\n    Ok(to_binary(\u0026QueryResponse::GetExchangeSettings {\n        settings: config.exchange_settings\n    })?)\n}\n\npub fn create_signature(env: \u0026Env) -\u003e StdResult\u003cBinary\u003e {\n    to_binary(\u0026[\n        env.message.sender.0.as_bytes(),\n        \u0026env.block.height.to_be_bytes(),\n        \u0026env.block.time.to_be_bytes()\n    ].concat())\n}\n\nfn ensure_correct_signature(storage: \u0026mut impl Storage, signature: Binary) -\u003e StdResult\u003c()\u003e {\n    let stored_signature: Binary =\n        load(storage, EPHEMERAL_STORAGE_KEY)?.unwrap_or_default();\n\n    if stored_signature != signature {\n        return  Err(StdError::unauthorized());\n    }\n\n    remove(storage, EPHEMERAL_STORAGE_KEY);\n\n    Ok(())\n}\n","traces":[{"line":32,"address":[775073,774144,775058],"length":1,"stats":{"Line":1},"fn_name":"init\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":37,"address":[774216,774316],"length":1,"stats":{"Line":2},"fn_name":null},{"line":38,"address":[774967,774664,774755],"length":1,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[775012,774740],"length":1,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[779460,775088],"length":1,"stats":{"Line":1},"fn_name":"handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":47,"address":[775909,775543,778345,778225,775829,777892,778926,777410,775135],"length":1,"stats":{"Line":3},"fn_name":null},{"line":48,"address":[777390,775952],"length":1,"stats":{"Line":2},"fn_name":null},{"line":49,"address":[776183,777388],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[777386,776491],"length":1,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[777382,777052],"length":1,"stats":{"Line":2},"fn_name":null},{"line":52,"address":[776673],"length":1,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[776800,777384],"length":1,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[777216],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[780122,779504],"length":1,"stats":{"Line":1},"fn_name":"query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":63,"address":[780137,779568,780142],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[779822,779575,779539,780076],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[779603],"length":1,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[779618],"length":1,"stats":{"Line":1},"fn_name":null},{"line":67,"address":[779753],"length":1,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[779706],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[779795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[779812],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[807424,807475,807224,807669],"length":1,"stats":{"Line":2},"fn_name":null},{"line":76,"address":[811994,807184,812009],"length":1,"stats":{"Line":1},"fn_name":"set_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":81,"address":[807452],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[807729],"length":1,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[807889],"length":1,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[808192,808077,808028,807973,808401],"length":1,"stats":{"Line":3},"fn_name":null},{"line":86,"address":[808448,808576,808152],"length":1,"stats":{"Line":3},"fn_name":null},{"line":87,"address":[808748,808541,808876],"length":1,"stats":{"Line":3},"fn_name":null},{"line":88,"address":[809161,808841,809033],"length":1,"stats":{"Line":3},"fn_name":null},{"line":89,"address":[809431,809318,809126],"length":1,"stats":{"Line":3},"fn_name":null},{"line":90,"address":[809411,809773,809588],"length":1,"stats":{"Line":3},"fn_name":null},{"line":91,"address":[809884,809965,809766,810190],"length":1,"stats":{"Line":2},"fn_name":null},{"line":92,"address":[811208,809950],"length":1,"stats":{"Line":2},"fn_name":null},{"line":98,"address":[781017,780144,781032],"length":1,"stats":{"Line":1},"fn_name":"get_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":101,"address":[780169,780873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[780300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":103,"address":[780413],"length":1,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[780654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[780477],"length":1,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[780590],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[781040,788157],"length":1,"stats":{"Line":1},"fn_name":"create_exchange\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":117,"address":[781115],"length":1,"stats":{"Line":1},"fn_name":null},{"line":118,"address":[781283],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[781276,781397,781674],"length":1,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[781724],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[781977,781821,782186,781717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[782431,781959,782294,782226,782640],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[782887,782749,783116,782385,782701],"length":1,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[788685],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[782785,787494,784849,784564,786010,786969,786520],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[786845],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[786697],"length":1,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[782801],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[782817],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[782857],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[783178,783404,783501],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[783159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[783166],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[783170],"length":1,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[785386,786623,787316,786403],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[785098],"length":1,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[783803],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[783822],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[784039],"length":1,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[783894],"length":1,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[783966],"length":1,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[785018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[784173],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[784103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[784135],"length":1,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[784676,784329,785604,784952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[784237],"length":1,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[784297],"length":1,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[788459,788244],"length":1,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[788260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[788333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":179,"address":[788673],"length":1,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[794018,789472],"length":1,"stats":{"Line":1},"fn_name":"register_exchange\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":189,"address":[789746,789681,789946,789504],"length":1,"stats":{"Line":3},"fn_name":null},{"line":191,"address":[790281,790008,789714,790069],"length":1,"stats":{"Line":2},"fn_name":null},{"line":193,"address":[790660,790451,790041,790324],"length":1,"stats":{"Line":2},"fn_name":null},{"line":194,"address":[790436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":196,"address":[792603,790902,790700,790780],"length":1,"stats":{"Line":2},"fn_name":null},{"line":197,"address":[790862,791013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[792240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[791128],"length":1,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[791168],"length":1,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[791393,791208,791536,791443],"length":1,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[791509],"length":1,"stats":{"Line":0},"fn_name":null},{"line":206,"address":[793186],"length":1,"stats":{"Line":2},"fn_name":null},{"line":207,"address":[790904],"length":1,"stats":{"Line":2},"fn_name":null},{"line":208,"address":[790954,792747,792918],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[790970],"length":1,"stats":{"Line":2},"fn_name":null},{"line":210,"address":[792680],"length":1,"stats":{"Line":2},"fn_name":null},{"line":211,"address":[792792],"length":1,"stats":{"Line":2},"fn_name":null},{"line":213,"address":[793174],"length":1,"stats":{"Line":2},"fn_name":null},{"line":217,"address":[794900,794885,794288],"length":1,"stats":{"Line":1},"fn_name":"query_exchange_address\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":221,"address":[794326,794391,794560,794772],"length":1,"stats":{"Line":2},"fn_name":null},{"line":223,"address":[794493],"length":1,"stats":{"Line":1},"fn_name":null},{"line":224,"address":[794467],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[800522,794912],"length":1,"stats":{"Line":0},"fn_name":"create_ido\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":233,"address":[795255,795464,794987,795118],"length":1,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[795209,795574,795634,795843,795526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":239,"address":[796087,795616,795908,796299],"length":1,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[800836],"length":1,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[798867,796017,797385,798363,799320,799844,796345],"length":1,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[799048],"length":1,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[796033],"length":1,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[796057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[796326],"length":1,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[796412,796594,796691],"length":1,"stats":{"Line":0},"fn_name":null},{"line":249,"address":[796393],"length":1,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[796400],"length":1,"stats":{"Line":0},"fn_name":null},{"line":251,"address":[796404],"length":1,"stats":{"Line":0},"fn_name":null},{"line":253,"address":[797638,798974,798750,799666],"length":1,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[796909],"length":1,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[796947],"length":1,"stats":{"Line":0},"fn_name":null},{"line":256,"address":[797558],"length":1,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[797049],"length":1,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[796979],"length":1,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[797011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[797226,797492,798014,797145],"length":1,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[797113],"length":1,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[800609,800690],"length":1,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[800625],"length":1,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[800824],"length":1,"stats":{"Line":0},"fn_name":null},{"line":275,"address":[801616,803391],"length":1,"stats":{"Line":1},"fn_name":"register_ido\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":280,"address":[802019,801771,801651,801822],"length":1,"stats":{"Line":3},"fn_name":null},{"line":282,"address":[802219,801807,802078,802431],"length":1,"stats":{"Line":2},"fn_name":null},{"line":284,"address":[802192,802570,802474,802795,802521],"length":1,"stats":{"Line":3},"fn_name":null},{"line":286,"address":[803076],"length":1,"stats":{"Line":1},"fn_name":null},{"line":287,"address":[802555],"length":1,"stats":{"Line":1},"fn_name":null},{"line":288,"address":[802933,802845],"length":1,"stats":{"Line":2},"fn_name":null},{"line":289,"address":[802866],"length":1,"stats":{"Line":1},"fn_name":null},{"line":291,"address":[803064],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[804477,803664],"length":1,"stats":{"Line":0},"fn_name":"list_idos\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":299,"address":[803884,803720],"length":1,"stats":{"Line":0},"fn_name":null},{"line":300,"address":[803865,803990,804034,804450,804224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[804125],"length":1,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[804983,804998,804608],"length":1,"stats":{"Line":0},"fn_name":"list_exchanges\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":309,"address":[804649,804843],"length":1,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[804758],"length":1,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[806397,805008],"length":1,"stats":{"Line":0},"fn_name":"query_exchange_settings\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":317,"address":[805033,805319],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[805409,805220,805873,805555],"length":1,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[805156],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[1016163,1015872],"length":1,"stats":{"Line":1},"fn_name":"create_signature"},{"line":325,"address":[1016040],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[1015910],"length":1,"stats":{"Line":1},"fn_name":null},{"line":327,"address":[1015934],"length":1,"stats":{"Line":1},"fn_name":null},{"line":328,"address":[1015984],"length":1,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[807154,806432,807169],"length":1,"stats":{"Line":1},"fn_name":"ensure_correct_signature\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":333,"address":[806552,806848,806467],"length":1,"stats":{"Line":4},"fn_name":null},{"line":336,"address":[806901],"length":1,"stats":{"Line":2},"fn_name":null},{"line":337,"address":[806986],"length":1,"stats":{"Line":2},"fn_name":null},{"line":340,"address":[806967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":342,"address":[807118],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":74,"coverable":159},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","lib.rs"],"content":"#[macro_use] extern crate fadroma_scrt_migrate;\npub mod contract;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n\n#[cfg(test)] mod test;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","state.rs"],"content":"use cosmwasm_std::{Api, CanonicalAddr, Extern, HumanAddr, Querier, StdError, StdResult, Storage};\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstantiationInfo;\nuse serde::{Deserialize, Serialize};\nuse sienna_amm_shared::{\n    Exchange, ExchangeSettings, TokenPair, TokenType, Pagination,\n    msg::factory::{InitMsg, HandleMsg, QueryResponse},\n    storage::{save, load},\n};\nuse std::usize;\n\nconst CONFIG_KEY: \u0026[u8] = b\"config\";\nconst IDO_PREFIX: \u0026[u8; 1] = b\"I\";\nconst EXCHANGES_KEY: \u0026[u8] = b\"exchanges\";\n\npub const PAGINATION_LIMIT: u8 = 30;\n\n#[derive(Serialize, Deserialize, PartialEq, Debug, Clone)]\npub(crate) struct Config\u003cA\u003e {\n    pub snip20_contract:   ContractInstantiationInfo,\n    pub lp_token_contract: ContractInstantiationInfo,\n    pub pair_contract:     ContractInstantiationInfo,\n    pub ido_contract:      ContractInstantiationInfo,\n    pub exchange_settings: ExchangeSettings\u003cA\u003e,\n    pub pair_count:        u64,\n    pub ido_count:         u64\n}\nimpl Config\u003cHumanAddr\u003e {\n    pub fn from_init_msg(msg: InitMsg) -\u003e Self {\n        Self {\n            snip20_contract:   msg.snip20_contract,\n            lp_token_contract: msg.lp_token_contract,\n            pair_contract:     msg.pair_contract,\n            ido_contract:      msg.ido_contract,\n            exchange_settings: msg.exchange_settings,\n            pair_count:        0,\n            ido_count:         0\n        }\n    }\n}\nimpl Canonize\u003cConfig\u003cCanonicalAddr\u003e\u003e for Config\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cCanonicalAddr\u003e\u003e {\n        Ok(Config {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.canonize(api)?,\n            pair_count:        self.pair_count,\n            ido_count:         self.ido_count\n        })\n    }\n}\nimpl Humanize\u003cConfig\u003cHumanAddr\u003e\u003e for Config\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n        Ok(Config {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.clone().humanize(api)?,\n            pair_count:        self.pair_count,\n            ido_count:         self.ido_count\n        })\n    }\n}\nimpl Into\u003cInitMsg\u003e for \u0026Config\u003cHumanAddr\u003e {\n    fn into (self) -\u003e InitMsg {\n        InitMsg {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.clone()\n        }\n    }\n}\nimpl Into\u003cHandleMsg\u003e for \u0026Config\u003cHumanAddr\u003e {\n    fn into (self) -\u003e HandleMsg {\n        HandleMsg::SetConfig {\n            snip20_contract:   Some(self.snip20_contract.clone()),\n            lp_token_contract: Some(self.lp_token_contract.clone()),\n            pair_contract:     Some(self.pair_contract.clone()),\n            ido_contract:      Some(self.ido_contract.clone()),\n            exchange_settings: Some(self.exchange_settings.clone())\n        }\n    }\n}\nimpl Into\u003cQueryResponse\u003e for \u0026Config\u003cHumanAddr\u003e {\n    fn into (self) -\u003e QueryResponse {\n        QueryResponse::Config {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.clone()\n        }\n    }\n}\n\n/// Returns StdResult\u003c()\u003e resulting from saving the config to storage\npub(crate) fn save_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:   \u0026mut Extern\u003cS, A, Q\u003e,\n    config: \u0026Config\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, CONFIG_KEY, \u0026config.canonize(\u0026deps.api)?)\n}\n\n/// Returns StdResult\u003cConfig\u003e resulting from retrieving the config from storage\npub(crate) fn load_config \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n    let config: Option\u003cConfig\u003cCanonicalAddr\u003e\u003e = load(\u0026deps.storage, CONFIG_KEY)?;\n    config.ok_or(StdError::generic_err(\"Config doesn't exist in storage.\"))?.humanize(\u0026deps.api)\n}\n\n/// Returns StdResult\u003cbool\u003e indicating whether a pair has been created before or not.\n/// Note that TokenPair(A, B) and TokenPair(B, A) is considered to be same.\npub(crate) fn pair_exists\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    pair: \u0026TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cbool\u003e {\n    let key = generate_pair_key(\u0026pair.canonize(\u0026deps.api)?);\n    Ok(deps.storage.get(\u0026key).is_some())\n}\n\n/// Stores information about an exchange contract. Returns an `StdError` if the exchange\n/// already exists or if something else goes wrong.\npub(crate) fn store_exchange\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:    \u0026mut Extern\u003cS, A, Q\u003e,\n    pair:    \u0026TokenPair\u003cHumanAddr\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003c()\u003e {\n    let pair = pair.canonize(\u0026deps.api)?;\n    let key = generate_pair_key(\u0026pair);\n    if deps.storage.get(\u0026key).is_some() {\n        return Err(StdError::generic_err(\"Exchange already exists\"));\n    }\n\n    let address = address.canonize(\u0026deps.api)?;\n    save(\u0026mut deps.storage, \u0026key, \u0026address)?;\n\n    let mut exchanges = load_exchanges(\u0026deps.storage)?;\n    if exchanges.iter().any(|e| e.address == address) {\n        return Err(StdError::generic_err(\"Exchange address already exists\"));\n    }\n\n    exchanges.push(Exchange { pair, address });\n    save_exchanges(\u0026mut deps.storage, \u0026exchanges)\n}\n\n/// Get the address of an exchange contract which manages the given pair.\npub(crate) fn get_address_for_pair\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pair: \u0026TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cHumanAddr\u003e {\n    let key = generate_pair_key(\u0026pair.canonize(\u0026deps.api)?);\n\n    let canonical = load(\u0026deps.storage, \u0026key)?.ok_or_else(||\n        StdError::generic_err(\"Address doesn't exist in storage.\")\n    )?;\n\n    deps.api.human_address(\u0026canonical)\n}\n\npub(crate) fn store_ido_address\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:    \u0026mut Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr,\n    config:  \u0026mut Config\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let address = deps.api.canonical_address(\u0026address)?;\n    let index = generate_ido_index(\u0026config.ido_count);\n\n    save(\u0026mut deps.storage, index.as_slice(), \u0026address)?;\n\n    config.ido_count += 1;\n    save_config(deps, \u0026config)\n}\n\npub(crate) fn get_idos\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:       \u0026Extern\u003cS, A, Q\u003e,\n    config:     \u0026Config\u003cHumanAddr\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cVec\u003cHumanAddr\u003e\u003e {\n    if pagination.start \u003e= config.ido_count {\n        return Ok(vec![]);\n    }\n\n    let limit = pagination.limit.min(PAGINATION_LIMIT);\n    let end = (pagination.start + limit as u64).min(config.ido_count);\n\n    let mut result = Vec::with_capacity((end - pagination.start) as usize);\n\n    for i in pagination.start..end {\n        let index = generate_ido_index(\u0026i);\n        let addr: CanonicalAddr = load(\u0026deps.storage, index.as_slice())?.ok_or_else(||\n            StdError::generic_err(\"IDO address doesn't exist in storage.\")\n        )?;\n\n        let human_addr = deps.api.human_address(\u0026addr)?;\n        result.push(human_addr);\n    }\n\n    Ok(result)\n}\n\npub(crate) fn get_exchanges\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cVec\u003cExchange\u003cHumanAddr\u003e\u003e\u003e {\n    let mut exchanges = load_exchanges(\u0026deps.storage)?;\n\n    if pagination.start as usize \u003e= exchanges.len() {\n        return Ok(vec![]);\n    }\n\n    let limit = pagination.limit.min(PAGINATION_LIMIT);\n    let end = (pagination.start + limit as u64).min(exchanges.len() as u64);\n\n    let mut result = Vec::with_capacity((end - pagination.start) as usize);\n\n    let exchanges = exchanges\n        .drain((pagination.start as usize)..(end as usize))\n        .collect::\u003cVec\u003cExchange\u003cCanonicalAddr\u003e\u003e\u003e();\n    for exchange in exchanges {\n        result.push(exchange.humanize(\u0026deps.api)?)\n    }\n\n    Ok(result)\n}\n\nfn load_exchanges(storage: \u0026impl Storage) -\u003e StdResult\u003cVec\u003cExchange\u003cCanonicalAddr\u003e\u003e\u003e {\n    let result: Option\u003cVec\u003cExchange\u003cCanonicalAddr\u003e\u003e\u003e = load(storage, EXCHANGES_KEY)?;\n    Ok(result.unwrap_or(vec![]))\n}\n\nfn save_exchanges(\n    storage: \u0026mut impl Storage,\n    exchanges: \u0026Vec\u003cExchange\u003cCanonicalAddr\u003e\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(storage, EXCHANGES_KEY, exchanges)\n}\n\nfn generate_ido_index(index: \u0026u64) -\u003e Vec\u003cu8\u003e {\n    [ IDO_PREFIX, index.to_string().as_bytes() ].concat()\n}\n\npub fn generate_pair_key(\n    pair: \u0026TokenPair\u003cCanonicalAddr\u003e\n) -\u003e Vec\u003cu8\u003e {\n    let mut bytes: Vec\u003c\u0026[u8]\u003e = Vec::new();\n\n    match \u0026pair.0 {\n        TokenType::NativeToken { denom } =\u003e bytes.push(denom.as_bytes()),\n        TokenType::CustomToken { contract_addr, .. } =\u003e bytes.push(contract_addr.as_slice())\n    }\n\n    match \u0026pair.1 {\n        TokenType::NativeToken { denom } =\u003e bytes.push(denom.as_bytes()),\n        TokenType::CustomToken { contract_addr, .. } =\u003e bytes.push(contract_addr.as_slice())\n    }\n\n    bytes.sort();\n\n    bytes.concat()\n}\n","traces":[{"line":29,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[679248,678896],"length":1,"stats":{"Line":1},"fn_name":"save_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":106,"address":[678942],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[679280,679814],"length":1,"stats":{"Line":1},"fn_name":"load_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":113,"address":[679546,679310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":114,"address":[679641,679489,679757,679841],"length":1,"stats":{"Line":5},"fn_name":null},{"line":119,"address":[680112,680590],"length":1,"stats":{"Line":1},"fn_name":"pair_exists\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":123,"address":[680163,680549,680650],"length":1,"stats":{"Line":2},"fn_name":null},{"line":124,"address":[680610,680697],"length":1,"stats":{"Line":2},"fn_name":null},{"line":129,"address":[683764,680944],"length":1,"stats":{"Line":1},"fn_name":"store_exchange\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":134,"address":[681345,681014],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[681338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":136,"address":[681604,681447,681538],"length":1,"stats":{"Line":3},"fn_name":null},{"line":137,"address":[681713],"length":1,"stats":{"Line":1},"fn_name":null},{"line":140,"address":[681694,681962,682171,681808],"length":1,"stats":{"Line":2},"fn_name":null},{"line":141,"address":[682370,682579,682306,682242,681916],"length":1,"stats":{"Line":3},"fn_name":null},{"line":143,"address":[682644,682352,682776,682988],"length":1,"stats":{"Line":2},"fn_name":null},{"line":144,"address":[683025,683098,683808,682742,683835],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":145,"address":[683503],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[683173],"length":1,"stats":{"Line":1},"fn_name":null},{"line":149,"address":[683686],"length":1,"stats":{"Line":1},"fn_name":null},{"line":153,"address":[683872,684351],"length":1,"stats":{"Line":1},"fn_name":"get_address_for_pair\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":157,"address":[683923,684310,684411],"length":1,"stats":{"Line":2},"fn_name":null},{"line":159,"address":[684968,684458,685267,684944,685408,684371],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":160,"address":[685420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[685044],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[686358,686343,685456],"length":1,"stats":{"Line":1},"fn_name":"store_ido_address\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":171,"address":[685635,685496],"length":1,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[685608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":174,"address":[685731,686194,685832,685893,685968],"length":1,"stats":{"Line":3},"fn_name":null},{"line":176,"address":[685926,686252,686276],"length":1,"stats":{"Line":2},"fn_name":null},{"line":177,"address":[686264],"length":1,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[686368,688653,688638],"length":1,"stats":{"Line":1},"fn_name":"get_idos\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":185,"address":[686444],"length":1,"stats":{"Line":1},"fn_name":null},{"line":186,"address":[686494],"length":1,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[686468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":190,"address":[686580],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[686675],"length":1,"stats":{"Line":1},"fn_name":null},{"line":194,"address":[688633,687059,686750,686878],"length":1,"stats":{"Line":4},"fn_name":null},{"line":195,"address":[687107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":196,"address":[687246,687124,687648,687624,688656,687958],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":197,"address":[688668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[688248,687719,688035,688485,688083],"length":1,"stats":{"Line":3},"fn_name":null},{"line":201,"address":[688177],"length":1,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[686963],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[688704,690609,690624],"length":1,"stats":{"Line":2},"fn_name":"get_exchanges\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":211,"address":[688775,688926],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[688908,689037],"length":1,"stats":{"Line":2},"fn_name":null},{"line":214,"address":[689120],"length":1,"stats":{"Line":1},"fn_name":null},{"line":217,"address":[689208,689091],"length":1,"stats":{"Line":2},"fn_name":null},{"line":218,"address":[689215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[689334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":222,"address":[689428],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[689412],"length":1,"stats":{"Line":1},"fn_name":null},{"line":225,"address":[689531,690454,689738,689809],"length":1,"stats":{"Line":3},"fn_name":null},{"line":226,"address":[690012,689930],"length":1,"stats":{"Line":2},"fn_name":null},{"line":229,"address":[690500],"length":1,"stats":{"Line":1},"fn_name":null},{"line":232,"address":[691099,690624],"length":1,"stats":{"Line":1},"fn_name":"load_exchanges\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":233,"address":[690648,690840],"length":1,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[690783,690931,691084],"length":1,"stats":{"Line":2},"fn_name":null},{"line":237,"address":[691136],"length":1,"stats":{"Line":1},"fn_name":"save_exchanges\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":241,"address":[691160],"length":1,"stats":{"Line":1},"fn_name":null},{"line":244,"address":[1037187,1037024],"length":1,"stats":{"Line":1},"fn_name":"generate_ido_index"},{"line":245,"address":[1037043],"length":1,"stats":{"Line":1},"fn_name":null},{"line":248,"address":[1037216,1037777],"length":1,"stats":{"Line":1},"fn_name":"generate_pair_key"},{"line":251,"address":[1037249],"length":1,"stats":{"Line":2},"fn_name":null},{"line":253,"address":[1037288,1037268],"length":1,"stats":{"Line":2},"fn_name":null},{"line":254,"address":[1037276,1037342,1037447],"length":1,"stats":{"Line":4},"fn_name":null},{"line":255,"address":[1037295,1037489],"length":1,"stats":{"Line":4},"fn_name":null},{"line":258,"address":[1037510,1037454],"length":1,"stats":{"Line":2},"fn_name":null},{"line":259,"address":[1037466,1037561],"length":1,"stats":{"Line":3},"fn_name":null},{"line":260,"address":[1037517,1037668],"length":1,"stats":{"Line":4},"fn_name":null},{"line":263,"address":[1037635,1037699],"length":1,"stats":{"Line":4},"fn_name":null},{"line":265,"address":[1037706],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":112,"coverable":115},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","test.rs"],"content":"pub use cosmwasm_std::{\n    StdResult, StdError, Extern, Storage, Api, Querier, Env, Binary, to_binary,\n    HandleResponse, from_binary, HumanAddr,\n    testing::{mock_dependencies, mock_env, MockApi, MockQuerier, MockStorage}\n};\npub use sienna_amm_shared::{\n    Exchange, ExchangeSettings, Fee,\n    TokenPair, TokenType,\n    Pagination,\n    msg::factory::{InitMsg, HandleMsg, QueryMsg, QueryResponse},\n};\npub use fadroma_scrt_addr::{Humanize, Canonize};\npub use fadroma_scrt_callback::ContractInstantiationInfo;\npub use fadroma_scrt_storage::{load, save, remove};\npub use crate::{contract::*, state::*};\n\nfn mkenv (sender: impl Into\u003cHumanAddr\u003e) -\u003e Env {\n    mock_env(sender, \u0026[])\n}\n\nfn mkdeps () -\u003e Extern\u003cimpl Storage, impl Api, impl Querier\u003e {\n    mock_dependencies(10, \u0026[])\n}\n\nfn mkconfig (id: u64) -\u003e Config\u003cHumanAddr\u003e {\n    Config::from_init_msg(InitMsg {\n        snip20_contract:   ContractInstantiationInfo { id, code_hash: \"snip20\".into() },\n        lp_token_contract: ContractInstantiationInfo { id, code_hash: \"lptoken\".into(), },\n        pair_contract:     ContractInstantiationInfo { id, code_hash: \"2341586789\".into(), },\n        ido_contract:      ContractInstantiationInfo { id,  code_hash: \"348534835\".into(), },\n        exchange_settings: ExchangeSettings {\n            swap_fee: Fee::new(28, 10000),\n            sienna_fee: Fee::new(2, 10000),\n            sienna_burner: None\n        }\n    })\n}\n\nfn assert_unauthorized(response: StdResult\u003cHandleResponse\u003e) {\n    assert!(response.is_err());\n    let err = response.unwrap_err();\n    assert_eq!(err, StdError::unauthorized())\n}\n\nmod test_contract {\n    use super::*;\n\n    #[test] fn ok_init () -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let env = mkenv(\"sender1111\");\n        let config = mkconfig(0);\n        assert!(init(deps, env, (\u0026config).into()).is_ok());\n        assert_eq!(config, load_config(deps)?);\n        Ok(())\n    }\n\n    #[test] fn ok_get_set_config () -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let config1 = mkconfig(1);\n        let env = mkenv(\"sender1111\");\n        // init with some config\n        assert!(init(deps, env.clone(), (\u0026config1).into()).is_ok());\n        // get current config\n        let response: QueryResponse = from_binary(\u0026query(deps, QueryMsg::GetConfig {})?)?;\n        assert_eq!(response, (\u0026config1).into());\n        // set config to something else\n        let config2 = mkconfig(2);\n        assert!(handle(deps, env, (\u0026config2).into()).is_ok());\n        // updated config is returned\n        let response: QueryResponse = from_binary(\u0026query(deps, QueryMsg::GetConfig {})?)?;\n        assert_eq!(response, (\u0026config2).into());\n        Ok(())\n    }\n\n    #[test] fn create_exchange_for_the_same_tokens_returns_error() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n        );\n\n        let result = create_exchange(deps, mkenv(\"sender\"), pair);\n\n        let error: StdError = result.unwrap_err();\n\n        let result = match error {\n            StdError::GenericErr { msg, .. } =\u003e {\n                if msg.as_str() == \"Cannot create an exchange with the same token.\" {\n                    true\n                } else {\n                    false\n                }\n            }\n            _ =\u003e false\n        };\n\n        assert!(result);\n\n        let pair = TokenPair (\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n        );\n\n        let result = create_exchange(deps, mkenv(\"sender\"), pair);\n\n        let error: StdError = result.unwrap_err();\n\n        let result = match error {\n            StdError::GenericErr { msg, .. } =\u003e {\n                if msg.as_str() == \"Cannot create an exchange with the same token.\" {\n                    true\n                } else {\n                    false\n                }\n            }\n            _ =\u003e false\n        };\n\n        assert!(result);\n\n        Ok(())\n    }\n\n    #[test] fn test_register_exchange() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n        );\n\n        let sender_addr = HumanAddr(\"sender1111\".into());\n\n        let result = handle(\n            deps,\n            mkenv(sender_addr.clone()),\n            HandleMsg::RegisterExchange {\n                pair: pair.clone(),\n                signature: to_binary(\"whatever\")?\n            }\n        );\n\n        assert_unauthorized(result);\n\n        let config = mkconfig(0);\n        save_config(deps, \u0026config)?;\n\n        let env = mkenv(sender_addr.clone());\n\n        let signature = create_signature(\u0026env)?;\n        save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n        handle(\n            deps,\n            env,\n            HandleMsg::RegisterExchange {\n                pair: pair.clone(),\n                signature\n            }\n        )?;\n\n        //Ensure that the ephemeral storage is empty after the message\n        let result: Option\u003cBinary\u003e = load(\u0026deps.storage, EPHEMERAL_STORAGE_KEY)?;\n        \n        match result {\n            None =\u003e { },\n            _ =\u003e panic!(\"Ephemeral storage should be empty!\")\n        }\n\n        Ok(())\n    }\n\n    #[test] fn test_register_ido() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let sender_addr = HumanAddr(\"sender1111\".into());\n\n        let result = handle(\n            deps,\n            mkenv(sender_addr.clone()),\n            HandleMsg::RegisterIdo {\n                signature: to_binary(\"whatever\")?\n            }\n        );\n\n        assert_unauthorized(result);\n\n        let config = mkconfig(0);\n        save_config(deps, \u0026config)?;\n\n        let env = mkenv(sender_addr.clone());\n\n        let signature = create_signature(\u0026env)?;\n        save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n        handle(\n            deps,\n            env,\n            HandleMsg::RegisterIdo {\n                signature\n            }\n        )?;\n        //Ensure that the ephemeral storage is empty after the message\n        let result: Option\u003cBinary\u003e = load(\u0026deps.storage, EPHEMERAL_STORAGE_KEY)?;\n        \n        match result {\n            None =\u003e { },\n            _ =\u003e panic!(\"Ephemeral storage should be empty!\")\n        }\n\n        Ok(())\n    }\n\n    #[test] fn query_exchange() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n        );\n\n        let config = mkconfig(0);\n        save_config(deps, \u0026config)?;\n\n        let sender_addr = HumanAddr(\"sender1111\".into());\n        let env = mkenv(sender_addr.clone());\n\n        let signature = create_signature(\u0026env)?;\n        save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n        handle(\n            deps,\n            env,\n            HandleMsg::RegisterExchange {\n                pair: pair.clone(),\n                signature\n            }\n        ).unwrap();\n        \n        let result = query(\n            deps,\n            QueryMsg::GetExchangeAddress {\n                pair: pair.clone()\n            }\n        )?;\n\n        let response: QueryResponse = from_binary(\u0026result)?;\n\n        match response {\n            QueryResponse::GetExchangeAddress { address } =\u003e assert_eq!(sender_addr, address),\n            _ =\u003e return Err(StdError::generic_err(\"Wrong response. Expected: QueryResponse::GetExchangeAddress.\"))\n        };\n        \n        Ok(())\n    }\n}\n\nmod test_state {\n    use super::*;\n\n    fn swap_pair\u003cA: Clone\u003e (pair: \u0026TokenPair\u003cA\u003e) -\u003e TokenPair\u003cA\u003e {\n        TokenPair(pair.1.clone(), pair.0.clone())\n    }\n\n    fn pagination(start: u64, limit: u8) -\u003e Pagination {\n        Pagination { start, limit }\n    }\n\n    fn mock_config() -\u003e Config\u003cHumanAddr\u003e {\n        Config::from_init_msg(InitMsg {\n            snip20_contract: ContractInstantiationInfo {\n                id: 1,\n                code_hash: \"snip20_contract\".into()\n            },\n            lp_token_contract: ContractInstantiationInfo {\n                id: 2,\n                code_hash: \"lp_token_contract\".into()\n            },\n            ido_contract: ContractInstantiationInfo {\n                id: 3,\n                code_hash: \"ido_contract\".into()\n            },\n            pair_contract: ContractInstantiationInfo {\n                id: 4,\n                code_hash: \"pair_contract\".into()\n            },\n            exchange_settings: ExchangeSettings {\n                swap_fee: Fee::new(28, 10000),\n                sienna_fee: Fee::new(2, 10000),\n                sienna_burner: None\n            }\n        })\n    }\n\n    #[test]\n    fn generates_the_same_key_for_swapped_pairs() -\u003e StdResult\u003c()\u003e {\n        fn cmp_pair\u003cS: Storage, A: Api, Q: Querier\u003e(\n            deps: \u0026Extern\u003cS, A, Q\u003e,\n            pair: TokenPair\u003cHumanAddr\u003e\n        ) -\u003e StdResult\u003c()\u003e {\n            let stored_pair = pair.canonize(\u0026deps.api)?;\n            let key = generate_pair_key(\u0026stored_pair);\n\n            let pair = swap_pair(\u0026pair);\n\n            let stored_pair = pair.canonize(\u0026deps.api)?;\n            let swapped_key = generate_pair_key(\u0026stored_pair);\n\n            assert_eq!(key, swapped_key);\n\n            Ok(())\n        }\n\n        let ref deps = mkdeps();\n\n        cmp_pair(\n            deps,\n            TokenPair(\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"first_addr\".into()),\n                    token_code_hash: \"13123adasd\".into()\n                },\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"scnd_addr\".into()),\n                    token_code_hash: \"4534qwerqqw\".into()\n                }\n            )\n        )?;\n\n        cmp_pair(\n            deps,\n            TokenPair(\n                TokenType::NativeToken {\n                    denom: \"test1\".into()\n                },\n                TokenType::NativeToken {\n                    denom: \"test2\".into()\n                },\n            )\n        )?;\n\n        cmp_pair(\n            deps,\n            TokenPair(\n                TokenType::NativeToken {\n                    denom: \"test3\".into()\n                },\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"third_addr\".into()),\n                    token_code_hash: \"asd21312asd\".into()\n                }\n            )\n        )?;\n\n        Ok(())\n    }\n\n    #[test]\n    fn query_correct_exchange_info() -\u003e StdResult\u003c()\u003e {\n        let mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"first_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"scnd_addr\".into()),\n                token_code_hash: \"4534qwerqqw\".into()\n            }\n        );\n\n        let address = HumanAddr(\"ctrct_addr\".into());\n\n        store_exchange(\u0026mut deps, \u0026pair, \u0026address)?;\n\n        let retrieved_address = get_address_for_pair(\u0026deps, \u0026pair)?;\n\n        assert!(pair_exists(\u0026mut deps, \u0026pair)?);\n        assert_eq!(address, retrieved_address);\n\n        Ok(())\n    }\n\n    #[test]\n    fn only_one_exchange_per_factory() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"first_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"scnd_addr\".into()),\n                token_code_hash: \"4534qwerqqw\".into()\n            }\n        );\n\n        store_exchange(deps, \u0026pair, \u0026\"first_addr\".into())?;\n\n        let swapped = swap_pair(\u0026pair);\n\n        match store_exchange(deps, \u0026swapped, \u0026\"other_addr\".into()) {\n            Ok(_) =\u003e Err(StdError::generic_err(\"Exchange already exists\")),\n            Err(_) =\u003e Ok(())\n        }\n    }\n\n    #[test]\n    fn test_get_idos() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let mut config = mock_config();\n\n        save_config(deps, \u0026config)?;\n\n        let mut addresses = vec![];\n\n        for i in 0..33 {\n            let addr = HumanAddr::from(format!(\"addr_{}\", i));\n\n            store_ido_address(deps, \u0026addr, \u0026mut config)?;\n            addresses.push(addr);\n        }\n\n        let mut config = load_config(deps)?;\n\n        let result = get_idos(deps, \u0026mut config, pagination(addresses.len() as u64, 20))?;\n        assert_eq!(result.len(), 0);\n\n        let result = get_idos(deps, \u0026mut config, pagination((addresses.len() - 1) as u64, 20))?;\n        assert_eq!(result.len(), 1);\n\n        let result = get_idos(deps, \u0026mut config, pagination(0, PAGINATION_LIMIT + 10))?;\n        assert_eq!(result.len(), PAGINATION_LIMIT as usize);\n\n        let result = get_idos(deps, \u0026mut config, pagination(3, PAGINATION_LIMIT))?;\n        assert_eq!(result, addresses[3..]);\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_get_exchanges() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let mut exchanges = vec![];\n\n        for i in 0..33 {\n            let pair = TokenPair (\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(format!(\"addr_{}\", i)),\n                    token_code_hash: format!(\"code_hash_{}\", i)\n                },\n                TokenType::NativeToken {\n                    denom: format!(\"denom_{}\", i)\n                },\n            );\n            let address = HumanAddr(format!(\"address_{}\", i));\n\n            store_exchange(deps, \u0026pair, \u0026address)?;\n\n            exchanges.push(Exchange { pair, address });\n        }\n\n        let result = get_exchanges(deps, pagination(exchanges.len() as u64, 20))?;\n        assert_eq!(result.len(), 0);\n\n        let result = get_exchanges(deps, pagination((exchanges.len() - 1) as u64, 20))?;\n        assert_eq!(result.len(), 1);\n\n        let result = get_exchanges(deps, pagination(0, PAGINATION_LIMIT + 10))?;\n        assert_eq!(result.len(), PAGINATION_LIMIT as usize);\n\n        let result = get_exchanges(deps, pagination(3, PAGINATION_LIMIT))?;\n        assert_eq!(result, exchanges[3..]);\n\n        Ok(())\n    }\n}\n","traces":[{"line":17,"address":[819248,819200],"length":1,"stats":{"Line":2},"fn_name":"mkenv\u003c\u0026str\u003e"},{"line":18,"address":[819221,819260],"length":1,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[1037872],"length":1,"stats":{"Line":4},"fn_name":"mkdeps"},{"line":22,"address":[1037880],"length":1,"stats":{"Line":4},"fn_name":null},{"line":25,"address":[1038858,1037920],"length":1,"stats":{"Line":1},"fn_name":"mkconfig"},{"line":26,"address":[1038588],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[1037950],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[1038021],"length":1,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[1038097,1038174],"length":1,"stats":{"Line":3},"fn_name":null},{"line":30,"address":[1038214,1038291],"length":1,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[1038532],"length":1,"stats":{"Line":2},"fn_name":null},{"line":32,"address":[1038331],"length":1,"stats":{"Line":2},"fn_name":null},{"line":33,"address":[1038427],"length":1,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[1038520],"length":1,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[1039468,1038896],"length":1,"stats":{"Line":1},"fn_name":"assert_unauthorized"},{"line":40,"address":[1038908,1039105],"length":1,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[1038999],"length":1,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[1039137,1039285,1039353],"length":1,"stats":{"Line":4},"fn_name":null},{"line":48,"address":[916218,914976,916203],"length":1,"stats":{"Line":3},"fn_name":"ok_init"},{"line":49,"address":[914993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[915032],"length":1,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[915059],"length":1,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[915230,915123,915355,915489],"length":1,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[915955,915537,916017,915482],"length":1,"stats":{"Line":3},"fn_name":null},{"line":54,"address":[916139],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[919749,916224,919734],"length":1,"stats":{"Line":3},"fn_name":"ok_get_set_config"},{"line":58,"address":[916250],"length":1,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[916316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[916323],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[916390,916775,916458,916527],"length":1,"stats":{"Line":3},"fn_name":null},{"line":64,"address":[916732,916807,917205,917680],"length":1,"stats":{"Line":3},"fn_name":null},{"line":65,"address":[917723,917649],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[917974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[918335,917981,918178],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[919328,918368,918779,918292],"length":1,"stats":{"Line":3},"fn_name":null},{"line":71,"address":[919297,919371],"length":1,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[919614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[922675,919760],"length":1,"stats":{"Line":3},"fn_name":"create_exchange_for_the_same_tokens_returns_error"},{"line":76,"address":[919777],"length":1,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[919963],"length":1,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[919832],"length":1,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[919895],"length":1,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[920215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[920111,920039],"length":1,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[920143],"length":1,"stats":{"Line":1},"fn_name":null},{"line":89,"address":[920495,920427],"length":1,"stats":{"Line":2},"fn_name":null},{"line":91,"address":[920692],"length":1,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[920826],"length":1,"stats":{"Line":1},"fn_name":null},{"line":95,"address":[920948,921038,921072,920885],"length":1,"stats":{"Line":3},"fn_name":null},{"line":96,"address":[921074],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[921064],"length":1,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[920908],"length":1,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[920916,921157],"length":1,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[921189],"length":1,"stats":{"Line":1},"fn_name":null},{"line":108,"address":[921126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[921264],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[921233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[921444,921512],"length":1,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[921709],"length":1,"stats":{"Line":1},"fn_name":null},{"line":120,"address":[921843],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[921965,921902,922085,922055],"length":1,"stats":{"Line":3},"fn_name":null},{"line":122,"address":[922087],"length":1,"stats":{"Line":1},"fn_name":null},{"line":124,"address":[922077],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[921925],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[921933,922164],"length":1,"stats":{"Line":1},"fn_name":null},{"line":132,"address":[922144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[922704,927443,927458],"length":1,"stats":{"Line":3},"fn_name":"test_register_exchange"},{"line":136,"address":[922727],"length":1,"stats":{"Line":1},"fn_name":null},{"line":139,"address":[922921],"length":1,"stats":{"Line":1},"fn_name":null},{"line":140,"address":[922790],"length":1,"stats":{"Line":1},"fn_name":null},{"line":141,"address":[922853],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[923069],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[922997],"length":1,"stats":{"Line":1},"fn_name":null},{"line":148,"address":[923313,923241],"length":1,"stats":{"Line":2},"fn_name":null},{"line":152,"address":[923361,923425,923470],"length":1,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[923721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":154,"address":[923478],"length":1,"stats":{"Line":1},"fn_name":null},{"line":155,"address":[923505,923570,923925,923635],"length":1,"stats":{"Line":3},"fn_name":null},{"line":159,"address":[924329],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[924479],"length":1,"stats":{"Line":1},"fn_name":null},{"line":162,"address":[924548,924881,924672,924615],"length":1,"stats":{"Line":2},"fn_name":null},{"line":164,"address":[924657,924942],"length":1,"stats":{"Line":2},"fn_name":null},{"line":166,"address":[925396,925048,925187,924973],"length":1,"stats":{"Line":2},"fn_name":null},{"line":167,"address":[925621,925514,925139,925466,925830],"length":1,"stats":{"Line":3},"fn_name":null},{"line":171,"address":[925540],"length":1,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[925916],"length":1,"stats":{"Line":1},"fn_name":null},{"line":173,"address":[925586],"length":1,"stats":{"Line":1},"fn_name":null},{"line":174,"address":[925876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[926643,927068,926856],"length":1,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[926816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[927222],"length":1,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[927196],"length":1,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[927472,931219,931234],"length":1,"stats":{"Line":3},"fn_name":"test_register_ido"},{"line":190,"address":[927495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[927550],"length":1,"stats":{"Line":1},"fn_name":null},{"line":196,"address":[927629,927734,927689],"length":1,"stats":{"Line":3},"fn_name":null},{"line":197,"address":[927920],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[928012,927834,927742],"length":1,"stats":{"Line":2},"fn_name":null},{"line":202,"address":[928359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[928509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":205,"address":[928578,928645,928702,928911],"length":1,"stats":{"Line":2},"fn_name":null},{"line":207,"address":[928687,928972],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[929003,929078,929217,929426],"length":1,"stats":{"Line":2},"fn_name":null},{"line":210,"address":[929496,929544,929735,929169,929944],"length":1,"stats":{"Line":3},"fn_name":null},{"line":214,"address":[929573],"length":1,"stats":{"Line":1},"fn_name":null},{"line":215,"address":[929659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":216,"address":[929619],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[930882,930670,930457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[930630],"length":1,"stats":{"Line":1},"fn_name":null},{"line":224,"address":[931017],"length":1,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[930991],"length":1,"stats":{"Line":1},"fn_name":null},{"line":230,"address":[935475,935460,931248],"length":1,"stats":{"Line":3},"fn_name":"query_exchange"},{"line":231,"address":[931271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[931457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":235,"address":[931326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":236,"address":[931389],"length":1,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[931605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":239,"address":[931533],"length":1,"stats":{"Line":1},"fn_name":null},{"line":243,"address":[931789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":244,"address":[931858,932031,932240,931966,931922],"length":1,"stats":{"Line":3},"fn_name":null},{"line":246,"address":[931992,932285],"length":1,"stats":{"Line":2},"fn_name":null},{"line":247,"address":[932333,932404],"length":1,"stats":{"Line":2},"fn_name":null},{"line":249,"address":[932428,932639,932500,932848],"length":1,"stats":{"Line":2},"fn_name":null},{"line":250,"address":[933073,932591,932918,933282,932966],"length":1,"stats":{"Line":3},"fn_name":null},{"line":254,"address":[932992],"length":1,"stats":{"Line":1},"fn_name":null},{"line":255,"address":[933368],"length":1,"stats":{"Line":1},"fn_name":null},{"line":256,"address":[933038],"length":1,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[933328],"length":1,"stats":{"Line":1},"fn_name":null},{"line":263,"address":[933700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":264,"address":[933673],"length":1,"stats":{"Line":1},"fn_name":null},{"line":268,"address":[934613,934248,933978,934404,934296],"length":1,"stats":{"Line":3},"fn_name":null},{"line":271,"address":[934670,934379,935087],"length":1,"stats":{"Line":3},"fn_name":null},{"line":272,"address":[934799],"length":1,"stats":{"Line":0},"fn_name":null},{"line":275,"address":[935215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":282,"address":[1205662,1205677,1205504],"length":1,"stats":{"Line":1},"fn_name":"swap_pair\u003ccosmwasm_std::addresses::HumanAddr\u003e"},{"line":283,"address":[1205534,1205627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[1097488],"length":1,"stats":{"Line":1},"fn_name":"pagination"},{"line":290,"address":[1097536,1098457],"length":1,"stats":{"Line":1},"fn_name":"mock_config"},{"line":291,"address":[1098187],"length":1,"stats":{"Line":1},"fn_name":null},{"line":292,"address":[1097579],"length":1,"stats":{"Line":1},"fn_name":null},{"line":294,"address":[1097553],"length":1,"stats":{"Line":1},"fn_name":null},{"line":296,"address":[1097654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":298,"address":[1097623],"length":1,"stats":{"Line":1},"fn_name":null},{"line":300,"address":[1097770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[1097698],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[1097886],"length":1,"stats":{"Line":1},"fn_name":null},{"line":306,"address":[1097814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":308,"address":[1098131],"length":1,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[1097930],"length":1,"stats":{"Line":1},"fn_name":null},{"line":310,"address":[1098026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":311,"address":[1098119],"length":1,"stats":{"Line":1},"fn_name":null},{"line":317,"address":[1098496,1100946],"length":1,"stats":{"Line":3},"fn_name":"generates_the_same_key_for_swapped_pairs"},{"line":318,"address":[1205728,1207494,1207479],"length":1,"stats":{"Line":1},"fn_name":"cmp_pair\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":322,"address":[1205851,1206113,1205771,1206322],"length":1,"stats":{"Line":2},"fn_name":null},{"line":323,"address":[1206098],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[1206378],"length":1,"stats":{"Line":1},"fn_name":null},{"line":327,"address":[1206553,1206508,1206830,1207056,1206427],"length":1,"stats":{"Line":3},"fn_name":null},{"line":328,"address":[1206815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":330,"address":[1207138,1207265,1207352],"length":1,"stats":{"Line":2},"fn_name":null},{"line":332,"address":[1207316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[1098513],"length":1,"stats":{"Line":1},"fn_name":null},{"line":339,"address":[1098995],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[1098667],"length":1,"stats":{"Line":1},"fn_name":null},{"line":341,"address":[1098536],"length":1,"stats":{"Line":1},"fn_name":null},{"line":342,"address":[1098599],"length":1,"stats":{"Line":1},"fn_name":null},{"line":344,"address":[1098919],"length":1,"stats":{"Line":1},"fn_name":null},{"line":345,"address":[1098743,1098815],"length":1,"stats":{"Line":2},"fn_name":null},{"line":346,"address":[1098847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":353,"address":[1099650],"length":1,"stats":{"Line":1},"fn_name":null},{"line":354,"address":[1099531],"length":1,"stats":{"Line":1},"fn_name":null},{"line":355,"address":[1099241],"length":1,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[1099606],"length":1,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[1099575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":365,"address":[1100429],"length":1,"stats":{"Line":1},"fn_name":null},{"line":366,"address":[1100174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[1099896],"length":1,"stats":{"Line":1},"fn_name":null},{"line":369,"address":[1100353],"length":1,"stats":{"Line":1},"fn_name":null},{"line":370,"address":[1100218],"length":1,"stats":{"Line":1},"fn_name":null},{"line":371,"address":[1100281],"length":1,"stats":{"Line":1},"fn_name":null},{"line":376,"address":[1100680],"length":1,"stats":{"Line":1},"fn_name":null},{"line":380,"address":[1100976,1103232,1103217],"length":1,"stats":{"Line":4},"fn_name":"query_correct_exchange_info"},{"line":381,"address":[1100993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":384,"address":[1101134],"length":1,"stats":{"Line":1},"fn_name":null},{"line":385,"address":[1101003],"length":1,"stats":{"Line":1},"fn_name":null},{"line":386,"address":[1101066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":388,"address":[1101386],"length":1,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[1101282,1101210],"length":1,"stats":{"Line":2},"fn_name":null},{"line":390,"address":[1101314],"length":1,"stats":{"Line":1},"fn_name":null},{"line":394,"address":[1101662,1101590],"length":1,"stats":{"Line":2},"fn_name":null},{"line":396,"address":[1101894,1101787,1101723,1101832,1102103],"length":1,"stats":{"Line":3},"fn_name":null},{"line":398,"address":[1102294,1101879,1102168,1102506],"length":1,"stats":{"Line":2},"fn_name":null},{"line":400,"address":[1102883,1102279,1102549,1102597,1103038],"length":1,"stats":{"Line":3},"fn_name":null},{"line":401,"address":[1103074,1103120,1102960],"length":1,"stats":{"Line":2},"fn_name":null},{"line":403,"address":[1103085],"length":1,"stats":{"Line":1},"fn_name":null},{"line":407,"address":[1103232,1104540],"length":1,"stats":{"Line":3},"fn_name":"only_one_exchange_per_factory"},{"line":408,"address":[1103249],"length":1,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[1103403],"length":1,"stats":{"Line":1},"fn_name":null},{"line":411,"address":[1103272],"length":1,"stats":{"Line":1},"fn_name":null},{"line":412,"address":[1103335],"length":1,"stats":{"Line":1},"fn_name":null},{"line":414,"address":[1103655],"length":1,"stats":{"Line":1},"fn_name":null},{"line":415,"address":[1103479,1103551],"length":1,"stats":{"Line":2},"fn_name":null},{"line":416,"address":[1103583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[1104020,1103859,1103956],"length":1,"stats":{"Line":3},"fn_name":null},{"line":422,"address":[1104429],"length":1,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[1104744,1104657,1104436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":425,"address":[1104726,1104555,1104659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[1104695],"length":1,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[1110074,1110089,1104992],"length":1,"stats":{"Line":3},"fn_name":"test_get_idos"},{"line":432,"address":[1105021],"length":1,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[1105066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":435,"address":[1105256,1105465,1105204,1105160,1105097],"length":1,"stats":{"Line":3},"fn_name":null},{"line":437,"address":[1105238],"length":1,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[1105510,1106510,1105755,1105646],"length":1,"stats":{"Line":4},"fn_name":null},{"line":440,"address":[1105791],"length":1,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[1106048,1106119,1106445,1106219],"length":1,"stats":{"Line":2},"fn_name":null},{"line":443,"address":[1106145],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[1105745,1106913,1106550,1106701],"length":1,"stats":{"Line":2},"fn_name":null},{"line":448,"address":[1106672,1107424,1107037,1106953,1107215],"length":1,"stats":{"Line":3},"fn_name":null},{"line":449,"address":[1107477,1107186,1107662],"length":1,"stats":{"Line":2},"fn_name":null},{"line":451,"address":[1108214,1107628,1107721,1108005],"length":1,"stats":{"Line":2},"fn_name":null},{"line":452,"address":[1108450,1108271,1107976],"length":1,"stats":{"Line":2},"fn_name":null},{"line":454,"address":[1108895,1108686,1108417,1108511],"length":1,"stats":{"Line":2},"fn_name":null},{"line":455,"address":[1108949,1108660,1109129],"length":1,"stats":{"Line":2},"fn_name":null},{"line":457,"address":[1109629,1109400,1109096,1109190],"length":1,"stats":{"Line":2},"fn_name":null},{"line":458,"address":[1109331,1109848,1109903,1109703],"length":1,"stats":{"Line":3},"fn_name":null},{"line":460,"address":[1109862],"length":1,"stats":{"Line":1},"fn_name":null},{"line":464,"address":[1115585,1115600,1110096],"length":1,"stats":{"Line":3},"fn_name":"test_get_exchanges"},{"line":465,"address":[1110125],"length":1,"stats":{"Line":1},"fn_name":null},{"line":467,"address":[1110178],"length":1,"stats":{"Line":1},"fn_name":null},{"line":469,"address":[1110470,1112537,1110358,1110304,1110185],"length":1,"stats":{"Line":5},"fn_name":null},{"line":471,"address":[1110967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":472,"address":[1110506],"length":1,"stats":{"Line":1},"fn_name":null},{"line":473,"address":[1110736,1110908],"length":1,"stats":{"Line":2},"fn_name":null},{"line":475,"address":[1111282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[1111051,1111223],"length":1,"stats":{"Line":2},"fn_name":null},{"line":479,"address":[1111642,1111470],"length":1,"stats":{"Line":2},"fn_name":null},{"line":481,"address":[1112437,1111773,1112211,1111844],"length":1,"stats":{"Line":2},"fn_name":null},{"line":483,"address":[1111873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":486,"address":[1112593,1113018,1112806,1110449],"length":1,"stats":{"Line":2},"fn_name":null},{"line":487,"address":[1113053,1113238,1112777],"length":1,"stats":{"Line":2},"fn_name":null},{"line":489,"address":[1113204,1113297,1113778,1113569],"length":1,"stats":{"Line":2},"fn_name":null},{"line":490,"address":[1114011,1113543,1113832],"length":1,"stats":{"Line":2},"fn_name":null},{"line":492,"address":[1114238,1113978,1114072,1114447],"length":1,"stats":{"Line":2},"fn_name":null},{"line":493,"address":[1114212,1114501,1114681],"length":1,"stats":{"Line":2},"fn_name":null},{"line":495,"address":[1115172,1114648,1114943,1114742],"length":1,"stats":{"Line":2},"fn_name":null},{"line":496,"address":[1115444,1114874,1115390,1115246],"length":1,"stats":{"Line":3},"fn_name":null},{"line":498,"address":[1115404],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":240,"coverable":247},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","tests","integration.rs"],"content":"//! This integration test tries to run and call the generated wasm.\n//! It depends on a Wasm build being available, which you can create with `cargo wasm`.\n//! Then running `cargo integration-test` will validate we can properly call into that generated Wasm.\n//!\n//! You can easily convert unit tests to integration tests.\n//! 1. First copy them over verbatum,\n//! 2. Then change\n//!      let mut deps = mock_dependencies(20, \u0026[]);\n//!    to\n//!      let mut deps = mock_instance(WASM, \u0026[]);\n//! 3. If you access raw storage, where ever you see something like:\n//!      deps.storage.get(CONFIG_KEY).expect(\"no data stored\");\n//!    replace it with:\n//!      deps.with_storage(|store| {\n//!          let data = store.get(CONFIG_KEY).expect(\"no data stored\");\n//!          //...\n//!      });\n//! 4. Anywhere you see query(\u0026deps, ...) you must replace it with query(\u0026mut deps, ...)\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","contract.rs"],"content":"/// This contract implements SNIP-20 standard:\n/// https://github.com/SecretFoundation/SNIPs/blob/master/SNIP-20.md\nuse cosmwasm_std::{\n    log, to_binary, Api, BankMsg, Binary, CanonicalAddr, Coin, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, QueryResult, ReadonlyStorage, StdError,\n    StdResult, Storage, Uint128, WasmMsg\n};\n\nuse sienna_amm_shared::msg::snip20::Snip20InitMsg;\n\nuse crate::msg::{\n    space_pad, ContractStatusLevel, HandleAnswer, HandleMsg, QueryAnswer, QueryMsg,\n    ResponseStatus::Success,\n};\nuse crate::rand::sha_256;\nuse crate::receiver::Snip20ReceiveMsg;\nuse crate::state::{\n    get_receiver_hash, get_transfers, read_allowance, read_viewing_key, set_receiver_hash,\n    store_transfer, write_allowance, write_viewing_key, Balances, Config, Constants,\n    ReadonlyBalances, ReadonlyConfig,\n};\nuse crate::viewing_key::{ViewingKey, VIEWING_KEY_SIZE};\n\n/// We make sure that responses from `handle` are padded to a multiple of this size.\npub const RESPONSE_BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: Snip20InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let init_config = msg.config();\n    let mut total_supply: u128 = 0;\n    {\n        let mut balances = Balances::from_storage(\u0026mut deps.storage);\n        let initial_balances = msg.initial_balances.unwrap_or_default();\n        for balance in initial_balances {\n            let balance_address = deps.api.canonical_address(\u0026balance.address)?;\n            let amount = balance.amount.u128();\n            balances.set_account_balance(\u0026balance_address, amount);\n            if let Some(new_total_supply) = total_supply.checked_add(amount) {\n                total_supply = new_total_supply;\n            } else {\n                return Err(StdError::generic_err(\n                    \"The sum of all initial balances exceeds the maximum possible total supply\",\n                ));\n            }\n        }\n    }\n\n    // Check name, symbol, decimals\n    if !is_valid_name(\u0026msg.name) {\n        return Err(StdError::generic_err(\n            \"Name is not in the expected format (3-200 UTF-8 bytes)\",\n        ));\n    }\n    if !is_valid_symbol(\u0026msg.symbol) {\n        return Err(StdError::generic_err(\n            \"Ticker symbol is not in expected format [A-Za-z-]{3,12}\",\n        ));\n    }\n    if msg.decimals \u003e 18 {\n        return Err(StdError::generic_err(\"Decimals must not exceed 18\"));\n    }\n\n    let admin = msg.admin.unwrap_or_else(|| env.message.sender.clone());\n\n    let prng_seed_hashed = sha_256(\u0026msg.prng_seed.0);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    config.set_constants(\u0026Constants {\n        name: msg.name,\n        symbol: msg.symbol,\n        decimals: msg.decimals,\n        admin: admin.clone(),\n        prng_seed: prng_seed_hashed.to_vec(),\n        total_supply_is_public: init_config.public_total_supply(),\n    })?;\n    config.set_total_supply(total_supply);\n    config.set_contract_status(ContractStatusLevel::NormalRun);\n    config.set_minters(Vec::from([admin]))?;\n\n    let mut messages = vec![];\n\n    if let Some(callback) = msg.callback {\n        messages.push(\n            CosmosMsg::Wasm(WasmMsg::Execute {\n                contract_addr: callback.contract.address,\n                callback_code_hash: callback.contract.code_hash,\n                msg: callback.msg,\n                send: vec![],\n            })\n        )\n    }\n    \n    Ok(InitResponse {\n        messages,\n        log: vec![\n            log(\"token_address\", env.contract.address),\n            log(\"token_code_hash\", env.contract_code_hash)\n        ]\n    })\n}\n\nfn pad_response(response: StdResult\u003cHandleResponse\u003e) -\u003e StdResult\u003cHandleResponse\u003e {\n    response.map(|mut response| {\n        response.data = response.data.map(|mut data| {\n            space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n            data\n        });\n        response\n    })\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n\n    match contract_status {\n        ContractStatusLevel::StopAll | ContractStatusLevel::StopAllButRedeems =\u003e {\n            let response = match msg {\n                HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n                HandleMsg::Redeem { .. }\n                    if contract_status == ContractStatusLevel::StopAllButRedeems =\u003e\n                {\n                    return cmd_unavailable();\n                    //try_redeem(deps, env, amount)\n                }\n                _ =\u003e Err(StdError::generic_err(\n                    \"This contract is stopped and this action is not allowed\",\n                )),\n            };\n            return pad_response(response);\n        }\n        ContractStatusLevel::NormalRun =\u003e {} // If it's a normal run just continue\n    }\n\n    let response = match msg {\n        // Native\n        HandleMsg::Deposit { .. } =\u003e /* try_deposit(deps, env) */ cmd_unavailable(),\n        HandleMsg::Redeem { .. } =\u003e /* try_redeem(deps, env, amount) */ cmd_unavailable(),\n\n        // Base\n        HandleMsg::Transfer { .. } =\u003e /*try_transfer(deps, env, \u0026recipient, amount)*/ cmd_unavailable(),\n        HandleMsg::Send { .. } =\u003e /* try_send(deps, env, \u0026recipient, amount, msg)*/ cmd_unavailable(),\n        HandleMsg::Burn { .. } =\u003e /* try_burn(deps, env, amount)*/ cmd_unavailable(),\n        HandleMsg::RegisterReceive { code_hash, .. } =\u003e try_register_receive(deps, env, code_hash),\n        HandleMsg::CreateViewingKey { entropy, .. } =\u003e try_create_key(deps, env, entropy),\n        HandleMsg::SetViewingKey { key, .. } =\u003e try_set_key(deps, env, key),\n\n        // Allowance\n        HandleMsg::IncreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_increase_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::DecreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_decrease_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::TransferFrom {\n            owner,\n            recipient,\n            amount,\n            ..\n        } =\u003e try_transfer_from(deps, env, \u0026owner, \u0026recipient, amount),\n        HandleMsg::SendFrom { .. } =\u003e /*try_send_from(deps, env, \u0026owner, \u0026recipient, amount, msg)*/ cmd_unavailable(),\n        HandleMsg::BurnFrom { owner, amount, .. } =\u003e try_burn_from(deps, env, \u0026owner, amount),\n\n        // Mint\n        HandleMsg::Mint {\n            recipient, amount, ..\n        } =\u003e try_mint(deps, env, recipient, amount),\n\n        // Other\n        HandleMsg::ChangeAdmin { address, .. } =\u003e change_admin(deps, env, address),\n        HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n        HandleMsg::AddMinters { minters, .. } =\u003e add_minters(deps, env, minters),\n        HandleMsg::RemoveMinters { minters, .. } =\u003e remove_minters(deps, env, minters),\n        HandleMsg::SetMinters { minters, .. } =\u003e set_minters(deps, env, minters),\n    };\n\n    pad_response(response)\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e, msg: QueryMsg) -\u003e QueryResult {\n    match msg {\n        QueryMsg::TokenInfo {} =\u003e query_token_info(\u0026deps.storage),\n        QueryMsg::ExchangeRate {} =\u003e query_exchange_rate(),\n        QueryMsg::Minters { .. } =\u003e query_minters(deps),\n        _ =\u003e authenticated_queries(deps, msg),\n    }\n}\n\npub fn authenticated_queries\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e QueryResult {\n    let (addresses, key) = msg.get_validation_params();\n\n    for address in addresses {\n        let canonical_addr = deps.api.canonical_address(address)?;\n\n        let expected_key = read_viewing_key(\u0026deps.storage, \u0026canonical_addr);\n\n        if expected_key.is_none() {\n            // Checking the key will take significant time. We don't want to exit immediately if it isn't set\n            // in a way which will allow to time the command and determine if a viewing key doesn't exist\n            key.check_viewing_key(\u0026[0u8; VIEWING_KEY_SIZE]);\n        } else if key.check_viewing_key(expected_key.unwrap().as_slice()) {\n            return match msg {\n                // Base\n                QueryMsg::Balance { address, .. } =\u003e query_balance(\u0026deps, \u0026address),\n                QueryMsg::TransferHistory {\n                    address,\n                    page,\n                    page_size,\n                    ..\n                } =\u003e query_transactions(\u0026deps, \u0026address, page.unwrap_or(0), page_size),\n                QueryMsg::Allowance { owner, spender, .. } =\u003e {\n                    try_check_allowance(deps, owner, spender)\n                }\n                _ =\u003e panic!(\"This query type does not require authentication\"),\n            };\n        }\n    }\n\n    Ok(to_binary(\u0026QueryAnswer::ViewingKeyError {\n        msg: \"Wrong viewing key for this address or viewing key not set\".to_string(),\n    })?)\n}\n\n/// This function just returns a constant 1:1 rate to uscrt, since that's the purpose of this\n/// contract.\nfn query_exchange_rate() -\u003e QueryResult {\n    to_binary(\u0026QueryAnswer::ExchangeRate {\n        rate: Uint128(1),\n        denom: \"uscrt\".to_string(),\n    })\n}\n\nfn query_token_info\u003cS: ReadonlyStorage\u003e(storage: \u0026S) -\u003e QueryResult {\n    let config = ReadonlyConfig::from_storage(storage);\n    let constants = config.constants()?;\n\n    let total_supply = if constants.total_supply_is_public {\n        Some(Uint128(config.total_supply()))\n    } else {\n        None\n    };\n\n    to_binary(\u0026QueryAnswer::TokenInfo {\n        name: constants.name,\n        symbol: constants.symbol,\n        decimals: constants.decimals,\n        total_supply,\n    })\n}\n\npub fn query_transactions\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account).unwrap();\n    let txs = get_transfers(\u0026deps.api, \u0026deps.storage, \u0026address, page, page_size)?;\n\n    let result = QueryAnswer::TransferHistory { txs };\n    to_binary(\u0026result)\n}\n\npub fn query_balance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account)?;\n\n    let amount = Uint128(ReadonlyBalances::from_storage(\u0026deps.storage).account_amount(\u0026address));\n    let response = QueryAnswer::Balance { amount };\n    to_binary(\u0026response)\n}\n\nfn query_minters\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let minters = ReadonlyConfig::from_storage(\u0026deps.storage).minters();\n\n    let response = QueryAnswer::Minters { minters };\n    to_binary(\u0026response)\n}\n\nfn change_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    let mut consts = config.constants()?;\n    consts.admin = address;\n    config.set_constants(\u0026consts)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::ChangeAdmin { status: Success })?),\n    })\n}\n\nfn try_mint\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    let minters = config.minters();\n    if !minters.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(\n            \"Minting is allowed to minter accounts only\",\n        ));\n    }\n\n    let amount = amount.u128();\n\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_add(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the total supply above the supported maximum\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let receipient_account = \u0026deps.api.canonical_address(\u0026address)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n\n    let mut account_balance = balances.balance(receipient_account);\n\n    if let Some(new_balance) = account_balance.checked_add(amount) {\n        account_balance = new_balance;\n    } else {\n        // This error literally can not happen, since the account's funds are a subset\n        // of the total supply, both are stored as u128, and we check for overflow of\n        // the total supply just a couple lines before.\n        // Still, writing this to cover all overflows.\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the account's balance above the supported maximum\",\n        ));\n    }\n\n    balances.set_account_balance(receipient_account, account_balance);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Mint { status: Success })?),\n    };\n\n    Ok(res)\n}\n\npub fn try_set_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    key: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let vk = ViewingKey(key);\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026vk);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetViewingKey { status: Success })?),\n    })\n}\n\npub fn try_create_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    entropy: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let constants = ReadonlyConfig::from_storage(\u0026deps.storage).constants()?;\n    let prng_seed = constants.prng_seed;\n\n    let key = ViewingKey::new(\u0026env, \u0026prng_seed, (\u0026entropy).as_ref());\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026key);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::CreateViewingKey { key })?),\n    })\n}\n\nfn set_contract_status\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    status_level: ContractStatusLevel,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_contract_status(status_level);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetContractStatus {\n            status: Success,\n        })?),\n    })\n}\n\npub fn try_check_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    owner: HumanAddr,\n    spender: HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let owner_address = deps.api.canonical_address(\u0026owner)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    let response = QueryAnswer::Allowance {\n        owner,\n        spender,\n        allowance: Uint128(allowance.amount),\n        expiration: allowance.expiration,\n    };\n    to_binary(\u0026response)\n}\n\n#[allow(dead_code)]\nfn try_deposit\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut amount = Uint128::zero();\n\n    for coin in \u0026env.message.sent_funds {\n        if coin.denom == \"uscrt\" {\n            amount = coin.amount\n        }\n    }\n\n    if amount.is_zero() {\n        return Err(StdError::generic_err(\"No funds were sent to be deposited\"));\n    }\n\n    let amount = amount.u128();\n\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n    if let Some(account_balance) = account_balance.checked_add(amount) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow your balance\",\n        ));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_add(amount) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow the currency's total supply\",\n        ));\n    }\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Deposit { status: Success })?),\n    };\n\n    Ok(res)\n}\n\n#[allow(dead_code)]\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount_raw = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(account_balance) = account_balance.checked_sub(amount_raw) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to redeem: balance={}, required={}\",\n            account_balance, amount_raw\n        )));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_sub(amount_raw) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"You are tyring to redeem more tokens than what is available in the total supply\",\n        ));\n    }\n\n    let withdrawl_coins: Vec\u003cCoin\u003e = vec![Coin {\n        denom: \"uscrt\".to_string(),\n        amount,\n    }];\n\n    let res = HandleResponse {\n        messages: vec![CosmosMsg::Bank(BankMsg::Send {\n            from_address: env.contract.address,\n            to_address: env.message.sender,\n            amount: withdrawl_coins,\n        })],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Redeem { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_transfer_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount.u128(),\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\n#[allow(dead_code)]\nfn try_transfer\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Transfer { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_add_receiver_api_callback\u003cS: ReadonlyStorage\u003e(\n    messages: \u0026mut Vec\u003cCosmosMsg\u003e,\n    storage: \u0026S,\n    recipient: \u0026HumanAddr,\n    msg: Option\u003cBinary\u003e,\n    sender: HumanAddr,\n    from: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let receiver_hash = get_receiver_hash(storage, recipient);\n    if let Some(receiver_hash) = receiver_hash {\n        let receiver_hash = receiver_hash?;\n        let receiver_msg = Snip20ReceiveMsg::new(sender, from, amount, msg);\n        let callback_msg = receiver_msg.into_cosmos_msg(receiver_hash, recipient.clone())?;\n\n        messages.push(callback_msg);\n    }\n    Ok(())\n}\n\n#[allow(dead_code)]\nfn try_send\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender.clone(),\n        sender,\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Send { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_register_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    code_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    set_receiver_hash(\u0026mut deps.storage, \u0026env.message.sender, code_hash);\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![log(\"register_status\", \"success\")],\n        data: Some(to_binary(\u0026HandleAnswer::RegisterReceive {\n            status: Success,\n        })?),\n    };\n    Ok(res)\n}\n\nfn insufficient_allowance(allowance: u128, required: u128) -\u003e StdError {\n    StdError::generic_err(format!(\n        \"insufficient allowance: allowance={}, required={}\",\n        allowance, required\n    ))\n}\n\nfn try_transfer_from_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let spender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let owner_address = deps.api.canonical_address(owner)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n    let amount_raw = amount.u128();\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    if allowance.expiration.map(|ex| ex \u003c env.block.time) == Some(true) {\n        allowance.amount = 0;\n        write_allowance(\n            \u0026mut deps.storage,\n            \u0026owner_address,\n            \u0026spender_address,\n            allowance,\n        )?;\n        return Err(insufficient_allowance(0, amount_raw));\n    }\n\n    if let Some(new_allowance) = allowance.amount.checked_sub(amount_raw) {\n        allowance.amount = new_allowance;\n    } else {\n        return Err(insufficient_allowance(allowance.amount, amount_raw));\n    }\n\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026recipient_address,\n        amount_raw,\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\nfn try_transfer_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::TransferFrom { status: Success })?),\n    };\n    Ok(res)\n}\n#[allow(dead_code)]\nfn try_send_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender,\n        owner.clone(),\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SendFrom { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_burn_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    \n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    let amount = amount.u128();\n\n    // remove from supply\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    // subtract from owner account\n    let owner_address = deps.api.canonical_address(owner)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026owner_address);\n\n    if let Some(new_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n    balances.set_account_balance(\u0026owner_address, account_balance);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::BurnFrom { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_increase_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_add(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::IncreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn try_decrease_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_sub(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::DecreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn add_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_add: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.add_minters(minters_to_add)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::AddMinters { status: Success })?),\n    })\n}\n\nfn remove_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_remove: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.remove_minters(minters_to_remove)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::RemoveMinters { status: Success })?),\n    })\n}\n\nfn set_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_set: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_minters(minters_to_set)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetMinters { status: Success })?),\n    })\n}\n\n/// Burn tokens\n///\n/// Remove `amount` tokens from the system irreversibly, from signer account\n///\n/// @param amount the amount of money to burn\n#[allow(dead_code)]\nfn try_burn\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(new_account_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_account_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n\n    balances.set_account_balance(\u0026sender_address, account_balance);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Burn { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn perform_transfer\u003cT: Storage\u003e(\n    store: \u0026mut T,\n    from: \u0026CanonicalAddr,\n    to: \u0026CanonicalAddr,\n    amount: u128,\n) -\u003e StdResult\u003c()\u003e {\n    let mut balances = Balances::from_storage(store);\n\n    let mut from_balance = balances.balance(from);\n    if let Some(new_from_balance) = from_balance.checked_sub(amount) {\n        from_balance = new_from_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds: balance={}, required={}\",\n            from_balance, amount\n        )));\n    }\n    balances.set_account_balance(from, from_balance);\n\n    let mut to_balance = balances.balance(to);\n    to_balance = to_balance.checked_add(amount).ok_or_else(|| {\n        StdError::generic_err(\"This tx will literally make them too rich. Try transferring less\")\n    })?;\n    balances.set_account_balance(to, to_balance);\n\n    Ok(())\n}\n\nfn is_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003cbool\u003e {\n    let consts = config.constants()?;\n    if \u0026consts.admin != account {\n        return Ok(false);\n    }\n\n    Ok(true)\n}\n\nfn check_if_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003c()\u003e {\n    if !is_admin(config, account)? {\n        return Err(StdError::generic_err(\n            \"This is an admin command. Admin commands can only be run from admin address\",\n        ));\n    }\n\n    Ok(())\n}\n\nfn is_valid_name(name: \u0026str) -\u003e bool {\n    let len = name.len();\n    3 \u003c= len \u0026\u0026 len \u003c= 200\n}\n\nfn is_valid_symbol(symbol: \u0026str) -\u003e bool {\n    let len = symbol.len();\n    let len_is_valid = 3 \u003c= len \u0026\u0026 len \u003c= 12;\n\n    len_is_valid \u0026\u0026 symbol.bytes().all(|byte| {\n        (b'A' \u003c= byte \u0026\u0026 byte \u003c= b'Z') || (b'a' \u003c= byte \u0026\u0026 byte \u003c= b'z') || byte == b'-'\n    })\n}\n\nfn cmd_unavailable() -\u003e StdResult\u003cHandleResponse\u003e {\n    Err(StdError::unauthorized())\n}\n\n// pub fn migrate\u003cS: Storage, A: Api, Q: Querier\u003e(\n//     _deps: \u0026mut Extern\u003cS, A, Q\u003e,\n//     _env: Env,\n//     _msg: MigrateMsg,\n// ) -\u003e StdResult\u003cMigrateResponse\u003e {\n//     Ok(MigrateResponse::default())\n// }\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::testing::*;\n    use cosmwasm_std::{from_binary, BlockInfo, ContractInfo, MessageInfo, QueryResponse};\n    use std::any::Any;\n\n    use sienna_amm_shared::msg::snip20::{Snip20InitConfig as InitConfig, Snip20InitialBalance as InitialBalance};\n\n    use crate::msg::ResponseStatus;\n\n    // Helper functions\n\n    fn init_helper(\n        initial_balances: Vec\u003cInitialBalance\u003e,\n    ) -\u003e (\n        StdResult\u003cInitResponse\u003e,\n        Extern\u003cMockStorage, MockApi, MockQuerier\u003e,\n    ) {\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n\n        let init_msg = Snip20InitMsg {\n            name: \"sec-sec\".to_string(),\n            admin: Some(HumanAddr(\"admin\".to_string())),\n            symbol: \"SECSEC\".to_string(),\n            decimals: 8,\n            initial_balances: Some(initial_balances),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: None,\n            callback: None\n        };\n\n        (init(\u0026mut deps, env, init_msg), deps)\n    }\n    /*\n    /// Will return a ViewingKey only for the first account in `initial_balances`\n    fn auth_query_helper(\n        initial_balances: Vec\u003cInitialBalance\u003e,\n    ) -\u003e (ViewingKey, Extern\u003cMockStorage, MockApi, MockQuerier\u003e) {\n        let (init_result, mut deps) = init_helper(initial_balances.clone());\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let account = initial_balances[0].address.clone();\n        let create_vk_msg = HandleMsg::CreateViewingKey {\n            entropy: \"42\".to_string(),\n            padding: None,\n        };\n        let handle_response = handle(\u0026mut deps, mock_env(account.0, \u0026[]), create_vk_msg).unwrap();\n        let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"Unexpected result from handle\"),\n        };\n\n        (vk, deps)\n    }\n    */\n    fn extract_error_msg\u003cT: Any\u003e(error: StdResult\u003cT\u003e) -\u003e String {\n        match error {\n            Ok(response) =\u003e {\n                let bin_err = (\u0026response as \u0026dyn Any)\n                    .downcast_ref::\u003cQueryResponse\u003e()\n                    .expect(\"An error was expected, but no error could be extracted\");\n                match from_binary(bin_err).unwrap() {\n                    QueryAnswer::ViewingKeyError { msg } =\u003e msg,\n                    _ =\u003e panic!(\"Unexpected query answer\"),\n                }\n            }\n            Err(err) =\u003e match err {\n                StdError::GenericErr { msg, .. } =\u003e msg,\n                _ =\u003e panic!(\"Unexpected result from init\"),\n            },\n        }\n    }\n\n    fn ensure_success(handle_result: HandleResponse) -\u003e bool {\n        let handle_result: HandleAnswer = from_binary(\u0026handle_result.data.unwrap()).unwrap();\n\n        match handle_result {\n            HandleAnswer::Deposit { status }\n            | HandleAnswer::Redeem { status }\n            | HandleAnswer::Transfer { status }\n            | HandleAnswer::Send { status }\n            | HandleAnswer::Burn { status }\n            | HandleAnswer::RegisterReceive { status }\n            | HandleAnswer::SetViewingKey { status }\n            | HandleAnswer::TransferFrom { status }\n            | HandleAnswer::SendFrom { status }\n            | HandleAnswer::BurnFrom { status }\n            | HandleAnswer::Mint { status }\n            | HandleAnswer::ChangeAdmin { status }\n            | HandleAnswer::SetContractStatus { status }\n            | HandleAnswer::SetMinters { status }\n            | HandleAnswer::AddMinters { status }\n            | HandleAnswer::RemoveMinters { status } =\u003e {\n                matches!(status, ResponseStatus::Success {..})\n            }\n            _ =\u003e panic!(\"HandleAnswer not supported for success extraction\"),\n        }\n    }\n\n    // Init tests\n\n    #[test]\n    fn test_init_sanity() {\n        let (init_result, deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert_ne!(init_result.unwrap(), InitResponse::default());\n        \n        let config = ReadonlyConfig::from_storage(\u0026deps.storage);\n        let constants = config.constants().unwrap();\n        assert_eq!(config.total_supply(), 5000);\n        assert_eq!(config.contract_status(), ContractStatusLevel::NormalRun);\n        assert_eq!(constants.name, \"sec-sec\".to_string());\n        assert_eq!(constants.admin, HumanAddr(\"admin\".to_string()));\n        assert_eq!(constants.symbol, \"SECSEC\".to_string());\n        assert_eq!(constants.decimals, 8);\n        assert_eq!(\n            constants.prng_seed,\n            sha_256(\"lolz fun yay\".to_owned().as_bytes())\n        );\n        assert_eq!(constants.total_supply_is_public, false);\n    }\n\n    #[test]\n    fn test_total_supply_overflow() {\n        let (init_result, _deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(u128::max_value()),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let (init_result, _deps) = init_helper(vec![\n            InitialBalance {\n                address: HumanAddr(\"lebron\".to_string()),\n                amount: Uint128(u128::max_value()),\n            },\n            InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: Uint128(1),\n            },\n        ]);\n        let error = extract_error_msg(init_result);\n        assert_eq!(\n            error,\n            \"The sum of all initial balances exceeds the maximum possible total supply\"\n        );\n    }\n\n    // Handle tests\n    /*\n    #[test]\n    fn test_handle_transfer() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        assert_eq!(5000 - 1000, balances.account_amount(\u0026bob_canonical));\n        assert_eq!(1000, balances.account_amount(\u0026alice_canonical));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(10000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient funds\"));\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_send() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let handle_msg = HandleMsg::Send {\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n            msg: Some(to_binary(\"hey hey you you\").unwrap()),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result.clone()));\n        assert!(result.messages.contains(\u0026CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr: HumanAddr(\"contract\".to_string()),\n            callback_code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            msg: Snip20ReceiveMsg::new(\n                HumanAddr(\"bob\".to_string()),\n                HumanAddr(\"bob\".to_string()),\n                Uint128(100),\n                Some(to_binary(\"hey hey you you\").unwrap())\n            )\n            .into_binary()\n            .unwrap(),\n            send: vec![]\n        })));\n    }\n    */\n    #[test]\n    fn test_handle_register_receive() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let hash = get_receiver_hash(\u0026deps.storage, \u0026HumanAddr(\"contract\".to_string()))\n            .unwrap()\n            .unwrap();\n        assert_eq!(hash, \"this_is_a_hash_of_a_code\".to_string());\n    }\n    \n    #[test]\n    fn test_handle_create_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::CreateViewingKey {\n            entropy: \"\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let answer: HandleAnswer = from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n\n        let key = match answer {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"NOPE\"),\n        };\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(key.check_viewing_key(saved_vk.as_slice()));\n    }\n    \n    #[test]\n    fn test_handle_set_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Set VK\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"hi lol\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        // Set valid VK\n        let actual_vk = ViewingKey(\"x\".to_string().repeat(VIEWING_KEY_SIZE));\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: actual_vk.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey { status: Success }).unwrap(),\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(actual_vk.check_viewing_key(\u0026saved_vk));\n    }\n    \n    #[test]\n    fn test_handle_transfer_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Transfer before allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: Some(1_571_797_420),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer after allowance expired\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\n            \u0026mut deps,\n            Env {\n                block: BlockInfo {\n                    height: 12_345,\n                    time: 1_571_797_420,\n                    chain_id: \"cosmos-testnet-14002\".to_string(),\n                },\n                message: MessageInfo {\n                    sender: HumanAddr(\"bob\".to_string()),\n                    sent_funds: vec![],\n                },\n                contract: ContractInfo {\n                    address: HumanAddr::from(MOCK_CONTRACT_ADDR),\n                },\n                contract_key: Some(\"\".to_string()),\n                contract_code_hash: \"\".to_string(),\n            },\n            handle_msg,\n        );\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let alice_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026alice_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(alice_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n    /*\n    #[test]\n    fn test_handle_send_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Send before allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Send more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"lolz\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let send_msg = Binary::from(r#\"{ \"some_msg\": { \"some_key\": \"some_val\" } }\"#.as_bytes());\n        let snip20_msg = Snip20ReceiveMsg::new(\n            HumanAddr(\"alice\".to_string()),\n            HumanAddr(\"bob\".to_string()),\n            Uint128(2000),\n            Some(send_msg.clone()),\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(2000),\n            msg: Some(send_msg),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        assert!(handle_result.unwrap().messages.contains(\n            \u0026snip20_msg\n                .into_cosmos_msg(\"lolz\".to_string(), HumanAddr(\"contract\".to_string()))\n                .unwrap()\n        ));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let contract_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"contract\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let contract_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026contract_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(contract_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_burn_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Burn before allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Burn more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000 - 2000);\n\n        // Second burn more than allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n    */\n    #[test]\n    fn test_handle_decrease_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 0,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(50),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 1950,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_increase_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 2000,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 4000,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_change_admin() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"bob\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let admin = ReadonlyConfig::from_storage(\u0026deps.storage)\n            .constants()\n            .unwrap()\n            .admin;\n        assert_eq!(admin, HumanAddr(\"bob\".to_string()));\n    }\n\n    #[test]\n    fn test_handle_set_contract_status() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"admin\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n        assert!(matches!(contract_status, ContractStatusLevel::StopAll{..}));\n    }\n    /*\n    #[test]\n    fn test_handle_redeem() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"butler\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Redeem {\n            amount: Uint128(1000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"butler\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"butler\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 4000)\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_deposit() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Deposit { padding: None };\n        let handle_result = handle(\n            \u0026mut deps,\n            mock_env(\n                \"lebron\",\n                \u0026[Coin {\n                    denom: \"uscrt\".to_string(),\n                    amount: Uint128(1000),\n                }],\n            ),\n            handle_msg,\n        );\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"lebron\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 6000)\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_burn() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let burn_amount: u128 = 100;\n        let handle_msg = HandleMsg::Burn {\n            amount: Uint128(burn_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply - burn_amount);\n    }\n    */\n    #[test]\n    fn test_handle_mint() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let mint_amount: u128 = 100;\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(mint_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply + mint_amount);\n    }\n\n    #[test]\n    fn test_handle_admin_commands() {\n        let admin_err = \"Admin commands can only be run from admin address\".to_string();\n\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), pause_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let change_admin_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"not_admin\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), change_admin_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n    }\n    /*\n    #[test]\n    fn test_handle_pause_with_withdrawals() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Withdraw failed: {}\",\n            handle_result.err().unwrap()\n        );\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_pause_all() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n    }\n    */\n    #[test]\n    fn test_handle_set_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    #[test]\n    fn test_handle_add_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n    }\n\n    #[test]\n    fn test_handle_remove_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        // Removing another extra time to ensure nothing funky happens\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    // Query tests\n    /* \n    #[test]\n    fn test_authenticated_queries() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let no_vk_yet_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"no_vk_yet\".to_string(),\n        };\n        let query_result = query(\u0026deps, no_vk_yet_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n\n        let create_vk_msg = HandleMsg::CreateViewingKey {\n            entropy: \"34\".to_string(),\n            padding: None,\n        };\n        let handle_response = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), create_vk_msg).unwrap();\n        let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"Unexpected result from handle\"),\n        };\n\n        let query_balance_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: vk.0,\n        };\n\n        let query_response = query(\u0026deps, query_balance_msg).unwrap();\n        let balance = match from_binary(\u0026query_response).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected result from query\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n\n        let wrong_vk_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"wrong_vk\".to_string(),\n        };\n        let query_result = query(\u0026deps, wrong_vk_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n    }\n    */\n    #[test]\n    fn test_query_token_info() {\n        let init_name = \"sec-sec\".to_string();\n        let init_admin = HumanAddr(\"admin\".to_string());\n        let init_symbol = \"SECSEC\".to_string();\n        let init_decimals = 8;\n        let init_config: InitConfig = from_binary(\u0026Binary::from(\n            r#\"{ \"public_total_supply\": true }\"#.as_bytes(),\n        ))\n        .unwrap();\n        let init_supply = Uint128(5000);\n\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n        let init_msg = Snip20InitMsg {\n            name: init_name.clone(),\n            admin: Some(init_admin.clone()),\n            symbol: init_symbol.clone(),\n            decimals: init_decimals.clone(),\n            initial_balances: Some(vec![InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: init_supply,\n            }]),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: Some(init_config),\n            callback: None\n        };\n        let init_result = init(\u0026mut deps, env, init_msg);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let query_msg = QueryMsg::TokenInfo {};\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Init failed: {}\",\n            query_result.err().unwrap()\n        );\n        let query_answer: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        match query_answer {\n            QueryAnswer::TokenInfo {\n                name,\n                symbol,\n                decimals,\n                total_supply,\n            } =\u003e {\n                assert_eq!(name, init_name);\n                assert_eq!(symbol, init_symbol);\n                assert_eq!(decimals, init_decimals);\n                assert_eq!(total_supply, Some(Uint128(5000)));\n            }\n            _ =\u003e panic!(\"unexpected\"),\n        }\n    }\n    /*\n    #[test]\n    fn test_query_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let vk1 = ViewingKey(\"key1\".to_string());\n        let vk2 = ViewingKey(\"key2\".to_string());\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Query failed: {}\",\n            query_result.err().unwrap()\n        );\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk1.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk2.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"lebron\".to_string()),\n            spender: HumanAddr(\"giannis\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(0));\n    }\n    */\n    /*\n    #[test]\n    fn test_query_balance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"wrong_key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let balance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n    }\n    */\n    /*\n    #[test]\n    fn test_query_transfer_history() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"banana\".to_string()),\n            amount: Uint128(500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"mango\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 0,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        // let a: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        // println!(\"{:?}\", a);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert!(transfers.is_empty());\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 10,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 3);\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 2,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 2);\n    }\n    */\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\nmod rand;\npub mod receiver;\npub mod state;\nmod utils;\nmod viewing_key;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","msg.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{Binary, HumanAddr, StdError, StdResult, Uint128};\n\nuse crate::state::Tx;\nuse crate::viewing_key::ViewingKey;\n\n#[derive(Serialize, Deserialize, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    // Native coin interactions\n    Redeem {\n        amount: Uint128,\n        denom: Option\u003cString\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Deposit {\n        padding: Option\u003cString\u003e,\n    },\n\n    // Base ERC-20 stuff\n    Transfer {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    Send {\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Burn {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    CreateViewingKey {\n        entropy: String,\n        padding: Option\u003cString\u003e,\n    },\n    SetViewingKey {\n        key: String,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    TransferFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    SendFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    BurnFrom {\n        owner: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Mint\n    Mint {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    AddMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    RemoveMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    SetMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Admin\n    ChangeAdmin {\n        address: HumanAddr,\n        padding: Option\u003cString\u003e,\n    },\n    SetContractStatus {\n        level: ContractStatusLevel,\n        padding: Option\u003cString\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleAnswer {\n    // Native\n    Deposit {\n        status: ResponseStatus,\n    },\n    Redeem {\n        status: ResponseStatus,\n    },\n\n    // Base\n    Transfer {\n        status: ResponseStatus,\n    },\n    Send {\n        status: ResponseStatus,\n    },\n    Burn {\n        status: ResponseStatus,\n    },\n    RegisterReceive {\n        status: ResponseStatus,\n    },\n    CreateViewingKey {\n        key: ViewingKey,\n    },\n    SetViewingKey {\n        status: ResponseStatus,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    TransferFrom {\n        status: ResponseStatus,\n    },\n    SendFrom {\n        status: ResponseStatus,\n    },\n    BurnFrom {\n        status: ResponseStatus,\n    },\n\n    // Mint\n    Mint {\n        status: ResponseStatus,\n    },\n    AddMinters {\n        status: ResponseStatus,\n    },\n    RemoveMinters {\n        status: ResponseStatus,\n    },\n    SetMinters {\n        status: ResponseStatus,\n    },\n\n    // Other\n    ChangeAdmin {\n        status: ResponseStatus,\n    },\n    SetContractStatus {\n        status: ResponseStatus,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    TokenInfo {},\n    ExchangeRate {},\n    Allowance {\n        owner: HumanAddr,\n        spender: HumanAddr,\n        key: String,\n    },\n    Balance {\n        address: HumanAddr,\n        key: String,\n    },\n    TransferHistory {\n        address: HumanAddr,\n        key: String,\n        page: Option\u003cu32\u003e,\n        page_size: u32,\n    },\n    Minters {},\n}\n\nimpl QueryMsg {\n    pub fn get_validation_params(\u0026self) -\u003e (Vec\u003c\u0026HumanAddr\u003e, ViewingKey) {\n        match self {\n            Self::Balance { address, key } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::TransferHistory { address, key, .. } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::Allowance {\n                owner,\n                spender,\n                key,\n                ..\n            } =\u003e (vec![owner, spender], ViewingKey(key.clone())),\n            _ =\u003e panic!(\"This query type does not require authentication\"),\n        }\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryAnswer {\n    TokenInfo {\n        name: String,\n        symbol: String,\n        decimals: u8,\n        total_supply: Option\u003cUint128\u003e,\n    },\n    ExchangeRate {\n        rate: Uint128,\n        denom: String,\n    },\n    Allowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n        expiration: Option\u003cu64\u003e,\n    },\n    Balance {\n        amount: Uint128,\n    },\n    TransferHistory {\n        txs: Vec\u003cTx\u003e,\n    },\n\n    ViewingKeyError {\n        msg: String,\n    },\n    Minters {\n        minters: Vec\u003cHumanAddr\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct CreateViewingKeyResponse {\n    pub key: String,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ResponseStatus {\n    Success,\n    Failure,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ContractStatusLevel {\n    NormalRun,\n    StopAllButRedeems,\n    StopAll,\n}\n\npub fn status_level_to_u8(status_level: ContractStatusLevel) -\u003e u8 {\n    match status_level {\n        ContractStatusLevel::NormalRun =\u003e 0,\n        ContractStatusLevel::StopAllButRedeems =\u003e 1,\n        ContractStatusLevel::StopAll =\u003e 2,\n    }\n}\n\npub fn u8_to_status_level(status_level: u8) -\u003e StdResult\u003cContractStatusLevel\u003e {\n    match status_level {\n        0 =\u003e Ok(ContractStatusLevel::NormalRun),\n        1 =\u003e Ok(ContractStatusLevel::StopAllButRedeems),\n        2 =\u003e Ok(ContractStatusLevel::StopAll),\n        _ =\u003e Err(StdError::generic_err(\"Invalid state level\")),\n    }\n}\n\n// Take a Vec\u003cu8\u003e and pad it up to a multiple of `block_size`, using spaces at the end.\npub fn space_pad(block_size: usize, message: \u0026mut Vec\u003cu8\u003e) -\u003e \u0026mut Vec\u003cu8\u003e {\n    let len = message.len();\n    let surplus = len % block_size;\n    if surplus == 0 {\n        return message;\n    }\n\n    let missing = block_size - surplus;\n    message.reserve(missing);\n    message.extend(std::iter::repeat(b' ').take(missing));\n    message\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::{from_slice, StdResult};\n\n    #[derive(Serialize, Deserialize, JsonSchema, Debug, PartialEq)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum Something {\n        Var { padding: Option\u003cString\u003e },\n    }\n\n    #[test]\n    fn test_deserialization_of_missing_option_fields() -\u003e StdResult\u003c()\u003e {\n        let input = b\"{ \\\"var\\\": {} }\";\n        let obj: Something = from_slice(input)?;\n        assert_eq!(\n            obj,\n            Something::Var { padding: None },\n            \"unexpected value: {:?}\",\n            obj\n        );\n        Ok(())\n    }\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","rand.rs"],"content":"use rand_chacha::ChaChaRng;\nuse rand_core::{RngCore, SeedableRng};\n\nuse sha2::{Digest, Sha256};\n\npub fn sha_256(data: \u0026[u8]) -\u003e [u8; 32] {\n    let mut hasher = Sha256::new();\n    hasher.update(data);\n    let hash = hasher.finalize();\n\n    let mut result = [0u8; 32];\n    result.copy_from_slice(hash.as_slice());\n    result\n}\n\npub struct Prng {\n    rng: ChaChaRng,\n}\n\nimpl Prng {\n    pub fn new(seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        let mut hasher = Sha256::new();\n\n        // write input message\n        hasher.update(\u0026seed);\n        hasher.update(\u0026entropy);\n        let hash = hasher.finalize();\n\n        let mut hash_bytes = [0u8; 32];\n        hash_bytes.copy_from_slice(hash.as_slice());\n\n        let rng: ChaChaRng = ChaChaRng::from_seed(hash_bytes);\n\n        Self { rng }\n    }\n\n    pub fn rand_bytes(\u0026mut self) -\u003e [u8; 32] {\n        let mut bytes = [0u8; 32];\n        self.rng.fill_bytes(\u0026mut bytes);\n\n        bytes\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    /// This test checks that the rng is stateful and generates\n    /// different random bytes every time it is called.\n    #[test]\n    fn test_rng() {\n        let mut rng = Prng::new(b\"foo\", b\"bar!\");\n        let r1: [u8; 32] = [\n            155, 11, 21, 97, 252, 65, 160, 190, 100, 126, 85, 251, 47, 73, 160, 49, 216, 182, 93,\n            30, 185, 67, 166, 22, 34, 10, 213, 112, 21, 136, 49, 214,\n        ];\n        let r2: [u8; 32] = [\n            46, 135, 19, 242, 111, 125, 59, 215, 114, 130, 122, 155, 202, 23, 36, 118, 83, 11, 6,\n            180, 97, 165, 218, 136, 134, 243, 191, 191, 149, 178, 7, 149,\n        ];\n        let r3: [u8; 32] = [\n            9, 2, 131, 50, 199, 170, 6, 68, 168, 28, 242, 182, 35, 114, 15, 163, 65, 139, 101, 221,\n            207, 147, 119, 110, 81, 195, 6, 134, 14, 253, 245, 244,\n        ];\n        let r4: [u8; 32] = [\n            68, 196, 114, 205, 225, 64, 201, 179, 18, 77, 216, 197, 211, 13, 21, 196, 11, 102, 106,\n            195, 138, 250, 29, 185, 51, 38, 183, 0, 5, 169, 65, 190,\n        ];\n        assert_eq!(r1, rng.rand_bytes());\n        assert_eq!(r2, rng.rand_bytes());\n        assert_eq!(r3, rng.rand_bytes());\n        assert_eq!(r4, rng.rand_bytes());\n    }\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","receiver.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{to_binary, Binary, CosmosMsg, HumanAddr, StdResult, Uint128, WasmMsg};\n\nuse crate::{contract::RESPONSE_BLOCK_SIZE, msg::space_pad};\n\n/// Snip20ReceiveMsg should be de/serialized under `Receive()` variant in a HandleMsg\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub struct Snip20ReceiveMsg {\n    pub sender: HumanAddr,\n    pub from: HumanAddr,\n    pub amount: Uint128,\n    pub msg: Option\u003cBinary\u003e,\n}\n\nimpl Snip20ReceiveMsg {\n    pub fn new(sender: HumanAddr, from: HumanAddr, amount: Uint128, msg: Option\u003cBinary\u003e) -\u003e Self {\n        Self {\n            sender,\n            from,\n            amount,\n            msg,\n        }\n    }\n\n    /// serializes the message, and pads it to 256 bytes\n    pub fn into_binary(self) -\u003e StdResult\u003cBinary\u003e {\n        let msg = ReceiverHandleMsg::Receive(self);\n        let mut data = to_binary(\u0026msg)?;\n        space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n        Ok(data)\n    }\n\n    /// creates a cosmos_msg sending this struct to the named contract\n    pub fn into_cosmos_msg(\n        self,\n        callback_code_hash: String,\n        contract_addr: HumanAddr,\n    ) -\u003e StdResult\u003cCosmosMsg\u003e {\n        let msg = self.into_binary()?;\n        let execute = WasmMsg::Execute {\n            msg,\n            callback_code_hash,\n            contract_addr,\n            send: vec![],\n        };\n        Ok(execute.into())\n    }\n}\n\n// This is just a helper to properly serialize the above message\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\nenum ReceiverHandleMsg {\n    Receive(Snip20ReceiveMsg),\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","state.rs"],"content":"use std::any::type_name;\nuse std::convert::TryFrom;\n\nuse cosmwasm_std::{\n    Api, CanonicalAddr, Coin, HumanAddr, ReadonlyStorage, StdError, StdResult, Storage, Uint128,\n};\nuse cosmwasm_storage::{PrefixedStorage, ReadonlyPrefixedStorage};\n\nuse secret_toolkit::storage::{AppendStore, AppendStoreMut, TypedStore, TypedStoreMut};\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse crate::msg::{status_level_to_u8, u8_to_status_level, ContractStatusLevel};\nuse crate::viewing_key::ViewingKey;\nuse serde::de::DeserializeOwned;\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\npub const PREFIX_TXS: \u0026[u8] = b\"transfers\";\n\npub const KEY_CONSTANTS: \u0026[u8] = b\"constants\";\npub const KEY_TOTAL_SUPPLY: \u0026[u8] = b\"total_supply\";\npub const KEY_CONTRACT_STATUS: \u0026[u8] = b\"contract_status\";\npub const KEY_MINTERS: \u0026[u8] = b\"minters\";\npub const KEY_TX_COUNT: \u0026[u8] = b\"tx-count\";\n\npub const PREFIX_CONFIG: \u0026[u8] = b\"config\";\npub const PREFIX_BALANCES: \u0026[u8] = b\"balances\";\npub const PREFIX_ALLOWANCES: \u0026[u8] = b\"allowances\";\npub const PREFIX_VIEW_KEY: \u0026[u8] = b\"viewingkey\";\npub const PREFIX_RECEIVERS: \u0026[u8] = b\"receivers\";\n\n// Note that id is a globally incrementing counter.\n// Since it's 64 bits long, even at 50 tx/s it would take\n// over 11 billion years for it to rollback. I'm pretty sure\n// we'll have bigger issues by then.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct Tx {\n    pub id: u64,\n    pub from: HumanAddr,\n    pub sender: HumanAddr,\n    pub receiver: HumanAddr,\n    pub coins: Coin,\n}\n\nimpl Tx {\n    pub fn into_stored\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cStoredTx\u003e {\n        let tx = StoredTx {\n            id: self.id,\n            from: api.canonical_address(\u0026self.from)?,\n            sender: api.canonical_address(\u0026self.sender)?,\n            receiver: api.canonical_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug)]\npub struct StoredTx {\n    pub id: u64,\n    pub from: CanonicalAddr,\n    pub sender: CanonicalAddr,\n    pub receiver: CanonicalAddr,\n    pub coins: Coin,\n}\n\nimpl StoredTx {\n    pub fn into_humanized\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cTx\u003e {\n        let tx = Tx {\n            id: self.id,\n            from: api.human_address(\u0026self.from)?,\n            sender: api.human_address(\u0026self.sender)?,\n            receiver: api.human_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\npub fn store_transfer\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    sender: \u0026CanonicalAddr,\n    receiver: \u0026CanonicalAddr,\n    amount: Uint128,\n    denom: String,\n) -\u003e StdResult\u003c()\u003e {\n    let mut config = Config::from_storage(store);\n    let id = config.tx_count() + 1;\n    config.set_tx_count(id)?;\n\n    let coins = Coin { denom, amount };\n    let tx = StoredTx {\n        id,\n        from: owner.clone(),\n        sender: sender.clone(),\n        receiver: receiver.clone(),\n        coins,\n    };\n\n    if owner != sender {\n        append_tx(store, tx.clone(), \u0026owner)?;\n    }\n    append_tx(store, tx.clone(), \u0026sender)?;\n    append_tx(store, tx, \u0026receiver)?;\n\n    Ok(())\n}\n\nfn append_tx\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    tx: StoredTx,\n    for_address: \u0026CanonicalAddr,\n) -\u003e StdResult\u003c()\u003e {\n    let mut store = PrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], store);\n    let mut store = AppendStoreMut::attach_or_create(\u0026mut store)?;\n    store.push(\u0026tx)\n}\n\npub fn get_transfers\u003cA: Api, S: ReadonlyStorage\u003e(\n    api: \u0026A,\n    storage: \u0026S,\n    for_address: \u0026CanonicalAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cVec\u003cTx\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], storage);\n\n    // Try to access the storage of txs for the account.\n    // If it doesn't exist yet, return an empty list of transfers.\n    let store = if let Some(result) = AppendStore::\u003cStoredTx, _\u003e::attach(\u0026store) {\n        result?\n    } else {\n        return Ok(vec![]);\n    };\n\n    // Take `page_size` txs starting from the latest tx, potentially skipping `page * page_size`\n    // txs from the start.\n    let tx_iter = store\n        .iter()\n        .rev()\n        .skip((page * page_size) as _)\n        .take(page_size as _);\n    // The `and_then` here flattens the `StdResult\u003cStdResult\u003cTx\u003e\u003e` to an `StdResult\u003cTx\u003e`\n    let txs: StdResult\u003cVec\u003cTx\u003e\u003e = tx_iter\n        .map(|tx| tx.map(|tx| tx.into_humanized(api)).and_then(|x| x))\n        .collect();\n    txs\n}\n\n// Config\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct Constants {\n    pub name: String,\n    pub admin: HumanAddr,\n    pub symbol: String,\n    pub decimals: u8,\n    pub prng_seed: Vec\u003cu8\u003e,\n    // privacy configuration\n    pub total_supply_is_public: bool,\n}\n\npub struct ReadonlyConfig\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfig\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n}\n\nfn set_bin_data\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, key: \u0026[u8], data: \u0026T) -\u003e StdResult\u003c()\u003e {\n    let bin_data =\n        bincode2::serialize(\u0026data).map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?;\n\n    storage.set(key, \u0026bin_data);\n    Ok(())\n}\n\nfn get_bin_data\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cT\u003e {\n    let bin_data = storage.get(key);\n\n    match bin_data {\n        None =\u003e Err(StdError::not_found(\"Key not found in storage\")),\n        Some(bin_data) =\u003e Ok(bincode2::deserialize::\u003cT\u003e(\u0026bin_data)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?),\n    }\n}\n\npub struct Config\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Config\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn set_constants(\u0026mut self, constants: \u0026Constants) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_CONSTANTS, constants)\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn set_total_supply(\u0026mut self, supply: u128) {\n        self.storage.set(KEY_TOTAL_SUPPLY, \u0026supply.to_be_bytes());\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn set_contract_status(\u0026mut self, status: ContractStatusLevel) {\n        let status_u8 = status_level_to_u8(status);\n        self.storage\n            .set(KEY_CONTRACT_STATUS, \u0026status_u8.to_be_bytes());\n    }\n\n    pub fn set_minters(\u0026mut self, minters_to_set: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_MINTERS, \u0026minters_to_set)\n    }\n\n    pub fn add_minters(\u0026mut self, minters_to_add: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n        minters.extend(minters_to_add);\n\n        self.set_minters(minters)\n    }\n\n    pub fn remove_minters(\u0026mut self, minters_to_remove: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n\n        for minter in minters_to_remove {\n            minters.retain(|x| x != \u0026minter);\n        }\n\n        self.set_minters(minters)\n    }\n\n    pub fn minters(\u0026mut self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n\n    pub fn set_tx_count(\u0026mut self, count: u64) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_TX_COUNT, \u0026count)\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Config` and `ReadonlyConfig`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyConfigImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfigImpl\u003c'a, S\u003e {\n    fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        let consts_bytes = self\n            .0\n            .get(KEY_CONSTANTS)\n            .ok_or_else(|| StdError::generic_err(\"no constants stored in configuration\"))?;\n        bincode2::deserialize::\u003cConstants\u003e(\u0026consts_bytes)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cConstants\u003e(), e))\n    }\n\n    fn total_supply(\u0026self) -\u003e u128 {\n        let supply_bytes = self\n            .0\n            .get(KEY_TOTAL_SUPPLY)\n            .expect(\"no total supply stored in config\");\n        // This unwrap is ok because we know we stored things correctly\n        slice_to_u128(\u0026supply_bytes).unwrap()\n    }\n\n    fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        let supply_bytes = self\n            .0\n            .get(KEY_CONTRACT_STATUS)\n            .expect(\"no contract status stored in config\");\n\n        // These unwraps are ok because we know we stored things correctly\n        let status = slice_to_u8(\u0026supply_bytes).unwrap();\n        u8_to_status_level(status).unwrap()\n    }\n\n    fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        get_bin_data(self.0, KEY_MINTERS).unwrap()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        get_bin_data(self.0, KEY_TX_COUNT).unwrap_or_default()\n    }\n}\n\n// Balances\n\npub struct ReadonlyBalances\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n}\n\npub struct Balances\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Balances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn balance(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n\n    pub fn set_account_balance(\u0026mut self, account: \u0026CanonicalAddr, amount: u128) {\n        self.storage.set(account.as_slice(), \u0026amount.to_be_bytes())\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Balances` and `ReadonlyBalances`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyBalancesImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalancesImpl\u003c'a, S\u003e {\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        let account_bytes = account.as_slice();\n        let result = self.0.get(account_bytes);\n        match result {\n            // This unwrap is ok because we know we stored things correctly\n            Some(balance_bytes) =\u003e slice_to_u128(\u0026balance_bytes).unwrap(),\n            None =\u003e 0,\n        }\n    }\n}\n\n// Allowances\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, Default, JsonSchema)]\npub struct Allowance {\n    pub amount: u128,\n    pub expiration: Option\u003cu64\u003e,\n}\n\npub fn read_allowance\u003cS: Storage\u003e(\n    store: \u0026S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n) -\u003e StdResult\u003cAllowance\u003e {\n    let owner_store =\n        ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let owner_store = TypedStore::attach(\u0026owner_store);\n    let allowance = owner_store.may_load(spender.as_slice());\n    allowance.map(Option::unwrap_or_default)\n}\n\npub fn write_allowance\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n    allowance: Allowance,\n) -\u003e StdResult\u003c()\u003e {\n    let mut owner_store =\n        PrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let mut owner_store = TypedStoreMut::attach(\u0026mut owner_store);\n\n    owner_store.store(spender.as_slice(), \u0026allowance)\n}\n\n// Viewing Keys\n\npub fn write_viewing_key\u003cS: Storage\u003e(store: \u0026mut S, owner: \u0026CanonicalAddr, key: \u0026ViewingKey) {\n    let mut balance_store = PrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.set(owner.as_slice(), \u0026key.to_hashed());\n}\n\npub fn read_viewing_key\u003cS: Storage\u003e(store: \u0026S, owner: \u0026CanonicalAddr) -\u003e Option\u003cVec\u003cu8\u003e\u003e {\n    let balance_store = ReadonlyPrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.get(owner.as_slice())\n}\n\n// Receiver Interface\n\npub fn get_receiver_hash\u003cS: ReadonlyStorage\u003e(\n    store: \u0026S,\n    account: \u0026HumanAddr,\n) -\u003e Option\u003cStdResult\u003cString\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.get(account.as_str().as_bytes()).map(|data| {\n        String::from_utf8(data)\n            .map_err(|_err| StdError::invalid_utf8(\"stored code hash was not a valid String\"))\n    })\n}\n\npub fn set_receiver_hash\u003cS: Storage\u003e(store: \u0026mut S, account: \u0026HumanAddr, code_hash: String) {\n    let mut store = PrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.set(account.as_str().as_bytes(), code_hash.as_bytes());\n}\n\n// Helpers\n\n/// Converts 16 bytes value into u128\n/// Errors if data found that is not 16 bytes\nfn slice_to_u128(data: \u0026[u8]) -\u003e StdResult\u003cu128\u003e {\n    match \u003c[u8; 16]\u003e::try_from(data) {\n        Ok(bytes) =\u003e Ok(u128::from_be_bytes(bytes)),\n        Err(_) =\u003e Err(StdError::generic_err(\n            \"Corrupted data found. 16 byte expected.\",\n        )),\n    }\n}\n\n/// Converts 1 byte value into u8\n/// Errors if data found that is not 1 byte\nfn slice_to_u8(data: \u0026[u8]) -\u003e StdResult\u003cu8\u003e {\n    if data.len() == 1 {\n        Ok(data[0])\n    } else {\n        Err(StdError::generic_err(\n            \"Corrupted data found. 1 byte expected.\",\n        ))\n    }\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","utils.rs"],"content":"use crate::viewing_key::VIEWING_KEY_SIZE;\nuse sha2::{Digest, Sha256};\nuse std::convert::TryInto;\nuse subtle::ConstantTimeEq;\n\npub fn ct_slice_compare(s1: \u0026[u8], s2: \u0026[u8]) -\u003e bool {\n    bool::from(s1.ct_eq(s2))\n}\n\npub fn create_hashed_password(s1: \u0026str) -\u003e [u8; VIEWING_KEY_SIZE] {\n    Sha256::digest(s1.as_bytes())\n        .as_slice()\n        .try_into()\n        .expect(\"Wrong password length\")\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","viewing_key.rs"],"content":"use std::fmt;\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::Env;\n\nuse crate::rand::{sha_256, Prng};\nuse crate::utils::{create_hashed_password, ct_slice_compare};\n\npub const VIEWING_KEY_SIZE: usize = 32;\npub const VIEWING_KEY_PREFIX: \u0026str = \"api_key_\";\n\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct ViewingKey(pub String);\n\nimpl ViewingKey {\n    pub fn check_viewing_key(\u0026self, hashed_pw: \u0026[u8]) -\u003e bool {\n        let mine_hashed = create_hashed_password(\u0026self.0);\n\n        ct_slice_compare(\u0026mine_hashed, hashed_pw)\n    }\n\n    pub fn new(env: \u0026Env, seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        // 16 here represents the lengths in bytes of the block height and time.\n        let entropy_len = 16 + env.message.sender.len() + entropy.len();\n        let mut rng_entropy = Vec::with_capacity(entropy_len);\n        rng_entropy.extend_from_slice(\u0026env.block.height.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.block.time.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.message.sender.0.as_bytes());\n        rng_entropy.extend_from_slice(entropy);\n\n        let mut rng = Prng::new(seed, \u0026rng_entropy);\n\n        let rand_slice = rng.rand_bytes();\n\n        let key = sha_256(\u0026rand_slice);\n\n        Self(VIEWING_KEY_PREFIX.to_string() + \u0026base64::encode(key))\n    }\n\n    pub fn to_hashed(\u0026self) -\u003e [u8; VIEWING_KEY_SIZE] {\n        create_hashed_password(\u0026self.0)\n    }\n\n    pub fn as_bytes(\u0026self) -\u003e \u0026[u8] {\n        self.0.as_bytes()\n    }\n}\n\nimpl fmt::Display for ViewingKey {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","contract.rs"],"content":"use cosmwasm_std::{\n    from_binary, to_binary, Api, BankMsg, Binary, Coin, Context, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, StdError, StdResult, Storage, Uint128,\n    WasmMsg,\n};\n\nuse crate::msg::{CountResponse, HandleMsg, InitMsg, QueryMsg, Snip20Msg};\nuse crate::state::{config, config_read, State};\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let state = State {\n        count: msg.count,\n        owner: deps.api.canonical_address(\u0026env.message.sender)?,\n        known_snip_20: vec![],\n    };\n\n    config(\u0026mut deps.storage).save(\u0026state)?;\n\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        HandleMsg::Increment {} =\u003e try_increment(deps, env),\n        HandleMsg::Reset { count } =\u003e try_reset(deps, env, count),\n        HandleMsg::Register { reg_addr, reg_hash } =\u003e try_register(deps, env, reg_addr, reg_hash),\n        HandleMsg::Receive {\n            sender,\n            from,\n            amount,\n            msg,\n        } =\u003e try_receive(deps, env, sender, from, amount, msg),\n        HandleMsg::Redeem {\n            addr,\n            hash,\n            to,\n            amount,\n        } =\u003e try_redeem(deps, env, addr, hash, to, amount),\n        HandleMsg::Fail {} =\u003e try_fail(),\n    }\n}\n\npub fn try_increment\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    _env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut count = 0;\n    config(\u0026mut deps.storage).update(|mut state| {\n        state.count += 1;\n        count = state.count;\n        Ok(state)\n    })?;\n\n    let mut context = Context::new();\n    context.add_log(\"count\", count.to_string());\n\n    Ok(context.into())\n}\n\npub fn try_reset\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    count: i32,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address_raw = deps.api.canonical_address(\u0026env.message.sender)?;\n    config(\u0026mut deps.storage).update(|mut state| {\n        if sender_address_raw != state.owner {\n            return Err(StdError::Unauthorized { backtrace: None });\n        }\n        state.count = count;\n        Ok(state)\n    })?;\n    Ok(HandleResponse::default())\n}\n\npub fn try_register\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    reg_addr: HumanAddr,\n    reg_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut conf = config(\u0026mut deps.storage);\n    let mut state = conf.load()?;\n    if !state.known_snip_20.contains(\u0026reg_addr) {\n        state.known_snip_20.push(reg_addr.clone());\n    }\n    conf.save(\u0026state)?;\n\n    let msg = to_binary(\u0026Snip20Msg::register_receive(env.contract_code_hash))?;\n    let message = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: reg_addr,\n        callback_code_hash: reg_hash,\n        msg,\n        send: vec![],\n    });\n\n    Ok(HandleResponse {\n        messages: vec![message],\n        log: vec![],\n        data: None,\n    })\n}\n\npub fn try_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    _sender: HumanAddr,\n    _from: HumanAddr,\n    _amount: Uint128,\n    msg: Binary,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let msg: HandleMsg = from_binary(\u0026msg)?;\n\n    if matches!(msg, HandleMsg::Receive { .. }) {\n        return Err(StdError::generic_err(\n            \"Recursive call to receive() is not allowed\",\n        ));\n    }\n\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            env.message.sender\n        )));\n    }\n\n    /* use sender \u0026 amount */\n    handle(deps, env, msg)\n}\n\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    addr: HumanAddr,\n    hash: String,\n    to: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026addr) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            addr\n        )));\n    }\n\n    let msg = to_binary(\u0026Snip20Msg::redeem(amount))?;\n    let secret_redeem = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: addr,\n        callback_code_hash: hash,\n        msg,\n        send: vec![],\n    });\n    let redeem = CosmosMsg::Bank(BankMsg::Send {\n        amount: vec![Coin::new(amount.u128(), \"uscrt\")],\n        from_address: env.contract.address,\n        to_address: to,\n    });\n\n    Ok(HandleResponse {\n        messages: vec![secret_redeem, redeem],\n        log: vec![],\n        data: None,\n    })\n}\n\nfn try_fail() -\u003e StdResult\u003cHandleResponse\u003e {\n    Err(StdError::generic_err(\"intentional failure\"))\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::GetCount {} =\u003e to_binary(\u0026query_count(deps)?),\n    }\n}\n\nfn query_count\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cCountResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    Ok(CountResponse { count: state.count })\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","msg.rs"],"content":"use cosmwasm_std::{Binary, HumanAddr, Uint128};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct InitMsg {\n    pub count: i32,\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    Increment {},\n    Reset {\n        count: i32,\n    },\n    Register {\n        reg_addr: HumanAddr,\n        reg_hash: String,\n    },\n    Receive {\n        sender: HumanAddr,\n        from: HumanAddr,\n        amount: Uint128,\n        msg: Binary,\n    },\n    Redeem {\n        addr: HumanAddr,\n        hash: String,\n        to: HumanAddr,\n        amount: Uint128,\n    },\n    Fail {},\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    // GetCount returns the current count as a json-encoded number\n    GetCount {},\n}\n\n// We define a custom struct for each query response\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct CountResponse {\n    pub count: i32,\n}\n\n// Messages sent to SNIP-20 contracts\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum Snip20Msg {\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    Redeem {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n}\n\nimpl Snip20Msg {\n    pub fn register_receive(code_hash: String) -\u003e Self {\n        Snip20Msg::RegisterReceive {\n            code_hash,\n            padding: None, // TODO add padding calculation\n        }\n    }\n\n    pub fn redeem(amount: Uint128) -\u003e Self {\n        Snip20Msg::Redeem {\n            amount,\n            padding: None, // TODO add padding calculation\n        }\n    }\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","state.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{CanonicalAddr, HumanAddr, Storage};\nuse cosmwasm_storage::{singleton, singleton_read, ReadonlySingleton, Singleton};\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct State {\n    pub count: i32,\n    pub owner: CanonicalAddr,\n    pub known_snip_20: Vec\u003cHumanAddr\u003e,\n}\n\npub fn config\u003cS: Storage\u003e(storage: \u0026mut S) -\u003e Singleton\u003cS, State\u003e {\n    singleton(storage, CONFIG_KEY)\n}\n\npub fn config_read\u003cS: Storage\u003e(storage: \u0026S) -\u003e ReadonlySingleton\u003cS, State\u003e {\n    singleton_read(storage, CONFIG_KEY)\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","integration.rs"],"content":"#[test]\n#[ignore]\nfn empty_test() {}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","src","contract.rs"],"content":"use cosmwasm_std::{\n    to_binary, Api, Binary, Env, Extern, HandleResponse, HumanAddr,\n    InitResponse, Querier, StdError, StdResult, Storage, Uint128, log\n};\nuse crate::state::*;\nuse fadroma_scrt_callback::ContractInstance;\nuse fadroma_scrt_migrate::{is_operational, can_set_status, set_status, get_status};\nuse sienna_amm_shared::{\n    snip20,\n    msg::sienna_burner::{HandleMsg, InitMsg, QueryAnswer, QueryMsg, ResponseStatus},\n    admin::{\n        require_admin,\n        multi_admin::{\n            assert_admin, save_admins, multi_admin_handle,\n            multi_admin_query, DefaultHandleImpl, DefaultQueryImpl\n        }\n    }\n};\n\nconst BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    save_token_info(deps, \u0026msg.sienna_token)?;\n    save_burn_pool(deps, \u0026msg.burn_pool)?;\n    \n    let admins = if let Some(mut admins) = msg.admins {\n        admins.push(msg.factory_address);\n        admins\n    } else {\n        vec![ msg.factory_address, env.message.sender ]\n    };\n\n    save_admins(deps, \u0026admins)?;\n\n    if let Some(pairs) = msg.pairs {\n        save_pair_addresses(deps, \u0026pairs)?;\n    }\n\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    with_status!(deps, env, match msg {\n        HandleMsg::Burn { amount } =\u003e burn(deps, env, amount),\n        HandleMsg::AddPairs { pairs } =\u003e add_pairs(deps, env, pairs),\n        HandleMsg::RemovePairs { pairs } =\u003e remove_pairs(deps, env, pairs),\n        HandleMsg::SetBurnPool {address } =\u003e set_burn_pool(deps, env, address),\n        HandleMsg::SetSiennaToken { info } =\u003e set_token(deps, env, info),\n        HandleMsg::Admin(admin_msg) =\u003e multi_admin_handle(deps, env, admin_msg, DefaultHandleImpl)\n    })\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::Status =\u003e to_binary(\u0026get_status(deps)?),\n        QueryMsg::BurnPool =\u003e query_burn_pool(deps),\n        QueryMsg::SiennaToken =\u003e query_token(deps),\n        QueryMsg::Admin(admin_msg) =\u003e multi_admin_query(deps, admin_msg, DefaultQueryImpl)\n    }\n}\n\nfn burn\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    if !pair_address_exists(\u0026deps, \u0026env.message.sender)? {\n        return Err(StdError::unauthorized());\n    }\n\n    let burn_pool = load_burn_pool(\u0026deps)?;\n    let sienna_token = load_token_info(\u0026deps)?;\n\n    Ok(HandleResponse {\n        messages: vec![\n            snip20::burn_from_msg(\n                burn_pool,\n                amount,\n                None,\n                BLOCK_SIZE,\n                sienna_token.code_hash,\n                sienna_token.address\n            )?\n        ],\n        log: vec![\n            log(\"sienna_burned\", amount)\n        ],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn add_pairs\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pairs: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    save_pair_addresses(deps, \u0026pairs)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn remove_pairs\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pairs: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    remove_pair_addresses(deps, \u0026pairs)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn set_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    save_burn_pool(deps, \u0026address)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn set_token\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    info: ContractInstance\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    save_token_info(deps, \u0026info)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\nfn query_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let address = load_burn_pool(deps)?;\n\n    to_binary(\u0026QueryAnswer::BurnPool {\n        address,\n    })\n}\n\nfn query_token\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let info = load_token_info(deps)?;\n\n    to_binary(\u0026QueryAnswer::SiennaToken { \n        info \n    })\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::from_binary;\n    use cosmwasm_std::testing::{\n        MockApi, MockQuerier, MockStorage, mock_dependencies, mock_env\n    };\n    use sienna_amm_shared::admin::multi_admin::{\n        MultiAdminHandleMsg, MultiAdminQueryMsg, MultiAdminQueryResponse, load_admins\n    };\n\n    const FACTORY: \u0026'static str = \"factory_address\";\n    const BURN_POOL: \u0026'static str = \"burn_pool\";\n    const SENDER: \u0026'static str = \"sender\";\n\n    fn initialize(\n        pairs: Option\u003cVec\u003cHumanAddr\u003e\u003e,\n        admins: Option\u003cVec\u003cHumanAddr\u003e\u003e\n    ) -\u003e StdResult\u003cExtern\u003cMockStorage, MockApi, MockQuerier\u003e\u003e {\n        let env = mock_env(SENDER, \u0026[]);\n        let mut deps = mock_dependencies(20, \u0026[]);\n\n        let msg = InitMsg {\n            sienna_token: ContractInstance {\n                address: \"sienna_token\".into(),\n                code_hash: \"sienna_token_hash\".into()\n            },\n            pairs,\n            burn_pool: HumanAddr(BURN_POOL.into()),\n            factory_address: HumanAddr(FACTORY.into()),\n            admins\n        };\n\n        init(\u0026mut deps, env.clone(), msg)?;\n\n        Ok(deps)\n    }\n\n    fn assert_unauthorized(response: StdResult\u003cHandleResponse\u003e) {\n        assert!(response.is_err());\n\n        let err = response.unwrap_err();\n        assert_eq!(err, StdError::unauthorized())\n    }\n\n    #[test]\n    fn test_proper_init() -\u003e StdResult\u003c()\u003e {\n        let sienna_token = ContractInstance {\n            address: \"sienna_token\".into(),\n            code_hash: \"sienna_token_hash\".into()\n        };\n\n        let pairs = vec![ \n            HumanAddr(\"pair1\".into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        assert_eq!(sienna_token, load_token_info(deps)?);\n        assert_eq!(HumanAddr(BURN_POOL.into()), load_burn_pool(deps)?);\n        assert_eq!(\n            vec![ HumanAddr(FACTORY.into()), SENDER.into() ],\n            load_admins(deps)?\n        );\n\n        for i in 0..pairs.len() {\n            assert!(pair_address_exists(deps, \u0026pairs[i])?);\n        }\n\n        let admins = vec![\n            HumanAddr(\"admin1\".into()),\n            HumanAddr(\"admin2\".into()),\n            HumanAddr(\"admin3\".into())\n        ];\n        \n        let ref mut deps = initialize(None, Some(admins.clone()))?;\n\n        assert_eq!(\n            [ admins, vec![ HumanAddr(FACTORY.into()) ] ].concat(),\n            load_admins(deps)?\n        );\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_burn() -\u003e StdResult\u003c()\u003e {\n        let pair_1 = \"pair1\";\n\n        let pairs = vec![ \n            HumanAddr(pair_1.into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        let result = handle(\n            deps,\n            mock_env(pair_1, \u0026[]),\n            HandleMsg::Burn {\n                amount: Uint128(100)\n            }\n        );\n\n        assert!(result.is_ok());\n\n        let result = handle(\n            deps,\n            mock_env(\"unauthorized\", \u0026[]),\n            HandleMsg::Burn {\n                amount: Uint128(100)\n            }\n        );\n\n        assert_unauthorized(result);\n\n        let new_pair = HumanAddr(\"new_pair\".into());\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::AddPairs {\n                pairs: vec![ new_pair.clone() ]\n            }\n        )?;\n\n        let result = handle(\n            deps,\n            mock_env(new_pair, \u0026[]),\n            HandleMsg::Burn {\n                amount: Uint128(100)\n            }\n        );\n\n        assert!(result.is_ok());\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_add_pairs() -\u003e StdResult\u003c()\u003e {\n        let pairs = vec![ \n            HumanAddr(\"pair1\".into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        let new_pairs = vec![ \n            HumanAddr(\"pair4\".into()),\n            HumanAddr(\"pair5\".into())\n        ];\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::AddPairs {\n                pairs: new_pairs.clone()\n            }\n        )?;\n\n        let all_pairs = [ pairs, new_pairs ].concat();\n\n        for i in 0..all_pairs.len() {\n            assert!(pair_address_exists(deps, \u0026all_pairs[i])?);\n        }\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::AddPairs {\n                pairs: vec![ HumanAddr(\"whatever\".into()) ]\n            }\n        );\n        \n        assert_unauthorized(result);\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_remove_pairs() -\u003e StdResult\u003c()\u003e {\n        let pairs = vec![ \n            HumanAddr(\"pair1\".into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        let remove_pairs = vec![ \n            HumanAddr(\"pair3\".into()),\n            HumanAddr(\"non_existant\".into())\n        ];\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::RemovePairs {\n                pairs: remove_pairs.clone()\n            }\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::RemovePairs {\n                pairs: remove_pairs.clone()\n            }\n        )?;\n\n        assert!(pair_address_exists(deps, \u0026pairs[0])?);\n        assert!(pair_address_exists(deps, \u0026pairs[1])?);\n        assert!(!pair_address_exists(deps, \u0026pairs[2])?);\n        assert!(!pair_address_exists(deps, \u0026remove_pairs[1])?);\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_add_admins() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = initialize(None, None)?;\n\n        let new_admins = vec![\n            HumanAddr(\"new_admin1\".into()),\n            HumanAddr(\"new_admin2\".into())\n        ];\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::Admin(MultiAdminHandleMsg::AddAdmins {\n                addresses: new_admins.clone()\n            })\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::Admin(MultiAdminHandleMsg::AddAdmins {\n                addresses: new_admins.clone()\n            })\n        )?;\n\n        let result = query(deps, QueryMsg::Admin(MultiAdminQueryMsg::Admins))?;\n        let result: MultiAdminQueryResponse = from_binary(\u0026result)?;\n\n        assert_eq!(\n            result.addresses,\n            [ \n                vec![ HumanAddr(FACTORY.into()), HumanAddr(SENDER.into()) ],\n                new_admins.clone()\n            ].concat()\n        );\n\n        handle(\n            deps,\n            mock_env(new_admins[0].clone(), \u0026[]),\n            HandleMsg::Admin(MultiAdminHandleMsg::AddAdmins {\n                addresses: new_admins.clone()\n            })\n        )?;\n\n        let result = query(deps, QueryMsg::Admin(MultiAdminQueryMsg::Admins))?;\n        let result: MultiAdminQueryResponse = from_binary(\u0026result)?;\n        assert!(result.addresses.len() == new_admins.len() * 2 + 2);\n        \n        Ok(())\n    }\n\n    #[test]\n    fn test_set_burn_pool() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = initialize(None, None)?;\n        \n        let pool = HumanAddr(\"pool\".into());\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::SetBurnPool {\n                address: pool.clone()\n            }\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::SetBurnPool {\n                address: pool.clone()\n            }\n        )?;\n\n        let result = query(deps, QueryMsg::BurnPool)?;\n        let result: QueryAnswer = from_binary(\u0026result)?;\n\n        match result {\n            QueryAnswer::BurnPool { address } =\u003e {\n                assert_eq!(pool, address)\n            },\n            _ =\u003e panic!(\"Expected QueryAnswer::BurnPool\")\n        }\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_set_sienna_token() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = initialize(None, None)?;\n        \n        let token = ContractInstance {\n            address: \"new_token\".into(),\n            code_hash: \"new_token_hash\".into()\n        };\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::SetSiennaToken {\n                info: token.clone()\n            }\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::SetSiennaToken {\n                info: token.clone()\n            }\n        )?;\n\n        let result = query(deps, QueryMsg::SiennaToken)?;\n        let result: QueryAnswer = from_binary(\u0026result)?;\n\n        match result {\n            QueryAnswer::SiennaToken { info } =\u003e {\n                assert_eq!(token, info)\n            },\n            _ =\u003e panic!(\"Expected QueryAnswer::SiennaToken\")\n        }\n\n        Ok(())\n    }\n}\n","traces":[{"line":22,"address":[598795,595936],"length":1,"stats":{"Line":7},"fn_name":"init\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":27,"address":[595984,596375,596121,596181],"length":1,"stats":{"Line":14},"fn_name":null},{"line":28,"address":[596723,596154,596437,596511],"length":1,"stats":{"Line":14},"fn_name":null},{"line":30,"address":[596475,597085,596755],"length":1,"stats":{"Line":9},"fn_name":null},{"line":31,"address":[596790],"length":1,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[597037],"length":1,"stats":{"Line":1},"fn_name":null},{"line":34,"address":[596858],"length":1,"stats":{"Line":7},"fn_name":null},{"line":37,"address":[597468,597144,597030,597192,597259],"length":1,"stats":{"Line":21},"fn_name":null},{"line":39,"address":[597223,597582,597527],"length":1,"stats":{"Line":14},"fn_name":null},{"line":40,"address":[597945,597575,597618,597666,597716],"length":1,"stats":{"Line":12},"fn_name":null},{"line":43,"address":[598828,597592],"length":1,"stats":{"Line":6},"fn_name":null},{"line":46,"address":[599904,603540],"length":1,"stats":{"Line":2},"fn_name":"handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":51,"address":[600361,600647,602599,602266,599951,601784,602719,603174,600727],"length":1,"stats":{"Line":8},"fn_name":null},{"line":52,"address":[600778,601764],"length":1,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[601762,600920],"length":1,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[601084,601760],"length":1,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[601248,601758],"length":1,"stats":{"Line":2},"fn_name":null},{"line":56,"address":[601412,601756],"length":1,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[601604],"length":1,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[604025,603584],"length":1,"stats":{"Line":1},"fn_name":"query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":65,"address":[603651,604040,604045],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[603620,603979,603658,603735],"length":1,"stats":{"Line":1},"fn_name":null},{"line":67,"address":[603700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[603683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[603717],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[607624,604048],"length":1,"stats":{"Line":1},"fn_name":"burn\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":78,"address":[604101,604458,604207],"length":1,"stats":{"Line":2},"fn_name":null},{"line":79,"address":[604521],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[604597,604501,604932,604723],"length":1,"stats":{"Line":2},"fn_name":null},{"line":83,"address":[604988,605414,604695,605659,605036],"length":1,"stats":{"Line":3},"fn_name":null},{"line":85,"address":[607034],"length":1,"stats":{"Line":1},"fn_name":null},{"line":86,"address":[606107,605180,605709,606458],"length":1,"stats":{"Line":2},"fn_name":null},{"line":87,"address":[605338,606451,605849,605702],"length":1,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[605206],"length":1,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[605246],"length":1,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[605258],"length":1,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[605298],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[606629,606554],"length":1,"stats":{"Line":2},"fn_name":null},{"line":97,"address":[606580],"length":1,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[606755,606863,607257],"length":1,"stats":{"Line":2},"fn_name":null},{"line":103,"address":[608528,608649,608593,608843],"length":1,"stats":{"Line":3},"fn_name":null},{"line":104,"address":[610068,610083,608480],"length":1,"stats":{"Line":1},"fn_name":"add_pairs\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":109,"address":[608905,609173,608634,608961],"length":1,"stats":{"Line":2},"fn_name":null},{"line":111,"address":[609469],"length":1,"stats":{"Line":1},"fn_name":null},{"line":112,"address":[608946],"length":1,"stats":{"Line":1},"fn_name":null},{"line":113,"address":[609208],"length":1,"stats":{"Line":1},"fn_name":null},{"line":114,"address":[609215,609341,609277,609651],"length":1,"stats":{"Line":3},"fn_name":null},{"line":118,"address":[610144,610209,610265,610459],"length":1,"stats":{"Line":3},"fn_name":null},{"line":119,"address":[610096,611684,611699],"length":1,"stats":{"Line":1},"fn_name":"remove_pairs\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":124,"address":[610250,610521,610577,610789],"length":1,"stats":{"Line":2},"fn_name":null},{"line":126,"address":[611085],"length":1,"stats":{"Line":1},"fn_name":null},{"line":127,"address":[610562],"length":1,"stats":{"Line":1},"fn_name":null},{"line":128,"address":[610824],"length":1,"stats":{"Line":1},"fn_name":null},{"line":129,"address":[610893,610831,611267,610957],"length":1,"stats":{"Line":3},"fn_name":null},{"line":133,"address":[611760,611825,611881,612075],"length":1,"stats":{"Line":3},"fn_name":null},{"line":134,"address":[613315,611712,613300],"length":1,"stats":{"Line":1},"fn_name":"set_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":139,"address":[612405,612137,611866,612193],"length":1,"stats":{"Line":2},"fn_name":null},{"line":141,"address":[612701],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[612178],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[612440],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[612447,612573,612509,612883],"length":1,"stats":{"Line":3},"fn_name":null},{"line":148,"address":[613376,613691,613497,613441],"length":1,"stats":{"Line":3},"fn_name":null},{"line":149,"address":[613328,614931,614916],"length":1,"stats":{"Line":1},"fn_name":"set_token\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":154,"address":[613482,613753,613809,614021],"length":1,"stats":{"Line":2},"fn_name":null},{"line":156,"address":[614317],"length":1,"stats":{"Line":1},"fn_name":null},{"line":157,"address":[613794],"length":1,"stats":{"Line":1},"fn_name":null},{"line":158,"address":[614056],"length":1,"stats":{"Line":1},"fn_name":null},{"line":159,"address":[614125,614499,614063,614189],"length":1,"stats":{"Line":3},"fn_name":null},{"line":163,"address":[608019,607664,608034],"length":1,"stats":{"Line":1},"fn_name":"query_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":164,"address":[607688,607879],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[607820],"length":1,"stats":{"Line":1},"fn_name":null},{"line":167,"address":[607794],"length":1,"stats":{"Line":1},"fn_name":null},{"line":171,"address":[608048,608473,608458],"length":1,"stats":{"Line":1},"fn_name":"query_token\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":172,"address":[608072,608318],"length":1,"stats":{"Line":1},"fn_name":null},{"line":174,"address":[608243],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[608204],"length":1,"stats":{"Line":1},"fn_name":null},{"line":194,"address":[649488,651122],"length":1,"stats":{"Line":2},"fn_name":"initialize"},{"line":198,"address":[649515],"length":1,"stats":{"Line":2},"fn_name":null},{"line":199,"address":[649591],"length":1,"stats":{"Line":5},"fn_name":null},{"line":202,"address":[649801],"length":1,"stats":{"Line":7},"fn_name":null},{"line":207,"address":[649896,649968],"length":1,"stats":{"Line":14},"fn_name":null},{"line":208,"address":[650077,650000],"length":1,"stats":{"Line":14},"fn_name":null},{"line":212,"address":[650915,650337,650404,650540],"length":1,"stats":{"Line":17},"fn_name":null},{"line":214,"address":[651014],"length":1,"stats":{"Line":3},"fn_name":null},{"line":217,"address":[651724,651152],"length":1,"stats":{"Line":1},"fn_name":"assert_unauthorized"},{"line":218,"address":[651164,651361],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[651255],"length":1,"stats":{"Line":4},"fn_name":null},{"line":221,"address":[651541,651393,651609],"length":1,"stats":{"Line":8},"fn_name":null},{"line":225,"address":[583728,583737],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":227,"address":[651805],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[651830],"length":1,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[652098,652201,652271,651935],"length":1,"stats":{"Line":2},"fn_name":null},{"line":232,"address":[651951,652035],"length":1,"stats":{"Line":2},"fn_name":null},{"line":233,"address":[652067,652138],"length":1,"stats":{"Line":2},"fn_name":null},{"line":234,"address":[652239,652170],"length":1,"stats":{"Line":2},"fn_name":null},{"line":237,"address":[652619,652995,652786,652438],"length":1,"stats":{"Line":2},"fn_name":null},{"line":239,"address":[652768,653597,653107,653545,653060],"length":1,"stats":{"Line":4},"fn_name":null},{"line":240,"address":[653724],"length":1,"stats":{"Line":1},"fn_name":null},{"line":241,"address":[655239,654938,654803],"length":1,"stats":{"Line":1},"fn_name":null},{"line":242,"address":[654487],"length":1,"stats":{"Line":1},"fn_name":null},{"line":243,"address":[654844,655032,654773],"length":1,"stats":{"Line":2},"fn_name":null},{"line":246,"address":[656102,655441,655690],"length":1,"stats":{"Line":3},"fn_name":null},{"line":247,"address":[656075,656107,655722],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[655640,656376,656306,656203],"length":1,"stats":{"Line":2},"fn_name":null},{"line":251,"address":[655656,656140],"length":1,"stats":{"Line":2},"fn_name":null},{"line":252,"address":[656172,656243],"length":1,"stats":{"Line":2},"fn_name":null},{"line":253,"address":[656344,656275],"length":1,"stats":{"Line":2},"fn_name":null},{"line":256,"address":[656734,656990,657199,656532],"length":1,"stats":{"Line":1},"fn_name":null},{"line":258,"address":[658209,658039,657607,657547,657739],"length":1,"stats":{"Line":2},"fn_name":null},{"line":259,"address":[657245,656882],"length":1,"stats":{"Line":2},"fn_name":null},{"line":260,"address":[657540,657645,657600,657832],"length":1,"stats":{"Line":3},"fn_name":null},{"line":263,"address":[658375],"length":1,"stats":{"Line":1},"fn_name":null},{"line":267,"address":[583776,583785],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":268,"address":[658497],"length":1,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[658757,658840,658555,658657],"length":1,"stats":{"Line":2},"fn_name":null},{"line":271,"address":[658573],"length":1,"stats":{"Line":1},"fn_name":null},{"line":272,"address":[658694,658626],"length":1,"stats":{"Line":2},"fn_name":null},{"line":273,"address":[658792,658726],"length":1,"stats":{"Line":2},"fn_name":null},{"line":276,"address":[659343,659029,659179,659552],"length":1,"stats":{"Line":2},"fn_name":null},{"line":280,"address":[659296],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[659595],"length":1,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[659714,659815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":290,"address":[659776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":291,"address":[659847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":296,"address":[659918],"length":1,"stats":{"Line":1},"fn_name":null},{"line":298,"address":[660029],"length":1,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[660100],"length":1,"stats":{"Line":1},"fn_name":null},{"line":303,"address":[660352],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[660157,660237],"length":1,"stats":{"Line":2},"fn_name":null},{"line":310,"address":[661023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":311,"address":[661095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":316,"address":[661174,661266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":318,"address":[661244],"length":1,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[583824,583833],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":323,"address":[661734,661648,661393,661935,661545],"length":1,"stats":{"Line":3},"fn_name":null},{"line":324,"address":[661451],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[661585,661514],"length":1,"stats":{"Line":2},"fn_name":null},{"line":326,"address":[661686,661617],"length":1,"stats":{"Line":2},"fn_name":null},{"line":329,"address":[662099,662281,662490,661943],"length":1,"stats":{"Line":2},"fn_name":null},{"line":331,"address":[662671,662226,662599,662813],"length":1,"stats":{"Line":3},"fn_name":null},{"line":332,"address":[662242,662536],"length":1,"stats":{"Line":2},"fn_name":null},{"line":333,"address":[662568,662639],"length":1,"stats":{"Line":2},"fn_name":null},{"line":338,"address":[662821],"length":1,"stats":{"Line":1},"fn_name":null},{"line":339,"address":[662958],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[662890],"length":1,"stats":{"Line":1},"fn_name":null},{"line":344,"address":[663592],"length":1,"stats":{"Line":1},"fn_name":null},{"line":346,"address":[663824,664603,664096,663885],"length":1,"stats":{"Line":4},"fn_name":null},{"line":347,"address":[664128,664608,664495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":352,"address":[664640,664054],"length":1,"stats":{"Line":2},"fn_name":null},{"line":353,"address":[664855],"length":1,"stats":{"Line":1},"fn_name":null},{"line":354,"address":[664662],"length":1,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[664972],"length":1,"stats":{"Line":1},"fn_name":null},{"line":360,"address":[665107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[583881,583872],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":365,"address":[665239,665558,665372,665472],"length":1,"stats":{"Line":2},"fn_name":null},{"line":366,"address":[665278],"length":1,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[665409,665341],"length":1,"stats":{"Line":2},"fn_name":null},{"line":368,"address":[665441,665510],"length":1,"stats":{"Line":2},"fn_name":null},{"line":371,"address":[666294,665753,666085,665903],"length":1,"stats":{"Line":2},"fn_name":null},{"line":373,"address":[666472,666030,666400],"length":1,"stats":{"Line":2},"fn_name":null},{"line":374,"address":[666046,666337],"length":1,"stats":{"Line":2},"fn_name":null},{"line":375,"address":[666369,666440],"length":1,"stats":{"Line":2},"fn_name":null},{"line":380,"address":[666614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":381,"address":[666751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":382,"address":[666683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":386,"address":[666887],"length":1,"stats":{"Line":1},"fn_name":null},{"line":390,"address":[667017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":391,"address":[667091],"length":1,"stats":{"Line":1},"fn_name":null},{"line":392,"address":[667064],"length":1,"stats":{"Line":1},"fn_name":null},{"line":396,"address":[668079,668138,667728],"length":1,"stats":{"Line":1},"fn_name":null},{"line":397,"address":[668490,668106,668191,668549],"length":1,"stats":{"Line":2},"fn_name":null},{"line":398,"address":[668966,668904,668517,668603],"length":1,"stats":{"Line":2},"fn_name":null},{"line":399,"address":[669020,669410,669321,668931],"length":1,"stats":{"Line":2},"fn_name":null},{"line":401,"address":[669384],"length":1,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[583920,583929],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":406,"address":[669495,669760],"length":1,"stats":{"Line":1},"fn_name":null},{"line":408,"address":[669713,669984,669912],"length":1,"stats":{"Line":2},"fn_name":null},{"line":409,"address":[669729,669849],"length":1,"stats":{"Line":2},"fn_name":null},{"line":410,"address":[669881,669952],"length":1,"stats":{"Line":2},"fn_name":null},{"line":415,"address":[670126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[670263],"length":1,"stats":{"Line":1},"fn_name":null},{"line":417,"address":[670195],"length":1,"stats":{"Line":1},"fn_name":null},{"line":421,"address":[670431],"length":1,"stats":{"Line":1},"fn_name":null},{"line":425,"address":[670561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[670635],"length":1,"stats":{"Line":1},"fn_name":null},{"line":427,"address":[670608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[671304,671484,671696],"length":1,"stats":{"Line":1},"fn_name":null},{"line":432,"address":[672160,671787,671469,671739,671951],"length":1,"stats":{"Line":3},"fn_name":null},{"line":434,"address":[672674],"length":1,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[671896,672209],"length":1,"stats":{"Line":2},"fn_name":null},{"line":438,"address":[672487],"length":1,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[672628],"length":1,"stats":{"Line":0},"fn_name":null},{"line":444,"address":[672937],"length":1,"stats":{"Line":1},"fn_name":null},{"line":445,"address":[673058],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[673031],"length":1,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[674119,673907,673727],"length":1,"stats":{"Line":1},"fn_name":null},{"line":451,"address":[674162,674210,674553,673892,674324],"length":1,"stats":{"Line":3},"fn_name":null},{"line":452,"address":[674301,674606,674831,674667],"length":1,"stats":{"Line":3},"fn_name":null},{"line":454,"address":[674805],"length":1,"stats":{"Line":1},"fn_name":null},{"line":458,"address":[583968,583977],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":459,"address":[674993,675226],"length":1,"stats":{"Line":1},"fn_name":null},{"line":461,"address":[675315,675195],"length":1,"stats":{"Line":2},"fn_name":null},{"line":465,"address":[675347,675423],"length":1,"stats":{"Line":2},"fn_name":null},{"line":466,"address":[675492],"length":1,"stats":{"Line":1},"fn_name":null},{"line":467,"address":[675447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":471,"address":[675625],"length":1,"stats":{"Line":1},"fn_name":null},{"line":475,"address":[675755],"length":1,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[675825],"length":1,"stats":{"Line":1},"fn_name":null},{"line":477,"address":[675818],"length":1,"stats":{"Line":1},"fn_name":null},{"line":481,"address":[676848,676459,676636],"length":1,"stats":{"Line":1},"fn_name":null},{"line":482,"address":[677284,676621,676939,676891,677047],"length":1,"stats":{"Line":3},"fn_name":null},{"line":485,"address":[677022,677326],"length":1,"stats":{"Line":2},"fn_name":null},{"line":486,"address":[677374,677606,677531],"length":1,"stats":{"Line":2},"fn_name":null},{"line":488,"address":[677453],"length":1,"stats":{"Line":0},"fn_name":null},{"line":491,"address":[677658],"length":1,"stats":{"Line":1},"fn_name":null},{"line":495,"address":[584025,584016],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":496,"address":[677857,678086],"length":1,"stats":{"Line":1},"fn_name":null},{"line":499,"address":[678059],"length":1,"stats":{"Line":1},"fn_name":null},{"line":500,"address":[678175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":505,"address":[678387,678307],"length":1,"stats":{"Line":2},"fn_name":null},{"line":506,"address":[678463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":507,"address":[678395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":511,"address":[678612],"length":1,"stats":{"Line":1},"fn_name":null},{"line":515,"address":[678742],"length":1,"stats":{"Line":1},"fn_name":null},{"line":516,"address":[678816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":517,"address":[678789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":521,"address":[679643,679855,679466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":522,"address":[680291,680054,679946,679628,679898],"length":1,"stats":{"Line":3},"fn_name":null},{"line":525,"address":[680029,680333],"length":1,"stats":{"Line":2},"fn_name":null},{"line":526,"address":[680397,680558,680633],"length":1,"stats":{"Line":2},"fn_name":null},{"line":528,"address":[680480],"length":1,"stats":{"Line":0},"fn_name":null},{"line":531,"address":[680685],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":228,"coverable":232},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","src","lib.rs"],"content":"#[macro_use] extern crate fadroma_scrt_migrate;\npub mod contract;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","src","state.rs"],"content":"use cosmwasm_std::{\n    Api, CanonicalAddr, Extern, HumanAddr, Querier,\n    ReadonlyStorage, StdResult, Storage, StdError\n};\nuse cosmwasm_storage::{PrefixedStorage, ReadonlyPrefixedStorage};\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstance;\nuse fadroma_scrt_storage::{save, load};\n\nconst SIENNA_TOKEN_KEY: \u0026[u8] = b\"sienna_token\";\nconst BURN_POOL_KEY: \u0026[u8] = b\"burn_pool\";\nconst PAIRS_PREFIX: \u0026[u8] = b\"pairs\";\n\npub fn save_token_info\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    info: \u0026ContractInstance\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, SIENNA_TOKEN_KEY, \u0026info.canonize(\u0026deps.api)?)\n}\n\npub fn load_token_info\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cContractInstance\u003cHumanAddr\u003e\u003e {\n    let stored: ContractInstance\u003cCanonicalAddr\u003e = load(\u0026deps.storage, SIENNA_TOKEN_KEY)?.ok_or(\n        StdError::generic_err(\"Token info doesn't exist in storage.\")\n    )?;\n    stored.humanize(\u0026deps.api)\n}\n\npub fn save_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, BURN_POOL_KEY, \u0026address.canonize(\u0026deps.api)?)\n}\n\npub fn load_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cHumanAddr\u003e {\n    let address: CanonicalAddr = load(\u0026deps.storage, BURN_POOL_KEY)?.ok_or_else(||\n        StdError::generic_err(\"Burn pool address doesn't exist in storage.\")\n    )?;\n    address.humanize(\u0026deps.api)\n}\n\npub fn save_pair_addresses\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    addresses: \u0026Vec\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let mut storage = PrefixedStorage::new(PAIRS_PREFIX, \u0026mut deps.storage);\n    for address in addresses {\n        let canonical = address.canonize(\u0026deps.api)?;\n        storage.set(\u0026canonical.as_slice(), \u0026[1]);\n    }\n    Ok(())\n}\n\npub fn remove_pair_addresses\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    addresses: \u0026Vec\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let mut storage = PrefixedStorage::new(PAIRS_PREFIX, \u0026mut deps.storage);\n    for address in addresses {\n        let canonical = address.canonize(\u0026deps.api)?;\n        storage.remove(canonical.as_slice());\n    }\n    Ok(())\n}\n\npub fn pair_address_exists\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003cbool\u003e {\n    let storage = ReadonlyPrefixedStorage::new(PAIRS_PREFIX, \u0026deps.storage);\n    let canonical = address.canonize(\u0026deps.api)?;\n    let result = storage.get(canonical.as_slice());\n    Ok(result.is_some())\n}\n","traces":[{"line":14,"address":[538491,538144],"length":1,"stats":{"Line":7},"fn_name":"save_token_info\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":18,"address":[538188],"length":1,"stats":{"Line":7},"fn_name":null},{"line":21,"address":[538512,538941],"length":1,"stats":{"Line":1},"fn_name":"load_token_info\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":24,"address":[538753,538921,538985,539149,538542,538840],"length":1,"stats":{"Line":5},"fn_name":null},{"line":25,"address":[538722],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[539075],"length":1,"stats":{"Line":2},"fn_name":null},{"line":30,"address":[539232,539555],"length":1,"stats":{"Line":7},"fn_name":"save_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":34,"address":[539276],"length":1,"stats":{"Line":7},"fn_name":null},{"line":37,"address":[540128,539584,540143],"length":1,"stats":{"Line":1},"fn_name":"load_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":40,"address":[539878,539910,540048,539614,540144],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":41,"address":[540156],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[539974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[541040,541025,540192],"length":1,"stats":{"Line":5},"fn_name":"save_pair_addresses\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":50,"address":[540238],"length":1,"stats":{"Line":4},"fn_name":null},{"line":51,"address":[541020,540351,540439,540265],"length":1,"stats":{"Line":16},"fn_name":null},{"line":52,"address":[540468,540635,540854],"length":1,"stats":{"Line":4},"fn_name":null},{"line":53,"address":[540593,540903],"length":1,"stats":{"Line":8},"fn_name":null},{"line":55,"address":[540412],"length":1,"stats":{"Line":4},"fn_name":null},{"line":58,"address":[541843,541828,541040],"length":1,"stats":{"Line":1},"fn_name":"remove_pair_addresses\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":62,"address":[541086],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[541287,541113,541199,541823],"length":1,"stats":{"Line":4},"fn_name":null},{"line":64,"address":[541316,541483,541702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[541441,541756],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[541260],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[542587,542602,541856],"length":1,"stats":{"Line":1},"fn_name":"pair_address_exists\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":74,"address":[541902],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[542130,542013,541934,542349],"length":1,"stats":{"Line":2},"fn_name":null},{"line":76,"address":[542090,542412],"length":1,"stats":{"Line":2},"fn_name":null},{"line":77,"address":[542465],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":28,"coverable":29},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","tests","integration.rs"],"content":"//! This integration test tries to run and call the generated wasm.\n//! It depends on a Wasm build being available, which you can create with `cargo wasm`.\n//! Then running `cargo integration-test` will validate we can properly call into that generated Wasm.\n//!\n//! You can easily convert unit tests to integration tests.\n//! 1. First copy them over verbatum,\n//! 2. Then change\n//!      let mut deps = mock_dependencies(20, \u0026[]);\n//!    to\n//!      let mut deps = mock_instance(WASM, \u0026[]);\n//! 3. If you access raw storage, where ever you see something like:\n//!      deps.storage.get(CONFIG_KEY).expect(\"no data stored\");\n//!    replace it with:\n//!      deps.with_storage(|store| {\n//!          let data = store.get(CONFIG_KEY).expect(\"no data stored\");\n//!          //...\n//!      });\n//! 4. Anywhere you see query(\u0026deps, ...) you must replace it with query(\u0026mut deps, ...)\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","examples","schema.rs"],"content":"use std::env::current_dir;\nuse std::fs::create_dir_all;\n\nuse cosmwasm_schema::{export_schema, remove_schemas, schema_for};\n\nuse snip20_reference_impl::msg::{HandleAnswer, HandleMsg, InitMsg, QueryAnswer, QueryMsg};\n\nfn main() {\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"schema\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n\n    export_schema(\u0026schema_for!(InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(HandleAnswer), \u0026out_dir);\n    export_schema(\u0026schema_for!(QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(QueryAnswer), \u0026out_dir);\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","contract.rs"],"content":"/// This contract implements SNIP-20 standard:\n/// https://github.com/SecretFoundation/SNIPs/blob/master/SNIP-20.md\nuse cosmwasm_std::{\n    log, to_binary, Api, BankMsg, Binary, CanonicalAddr, Coin, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, QueryResult, ReadonlyStorage, StdError,\n    StdResult, Storage, Uint128,\n};\n\nuse crate::msg::{\n    space_pad, ContractStatusLevel, HandleAnswer, HandleMsg, InitMsg, QueryAnswer, QueryMsg,\n    ResponseStatus::Success,\n};\nuse crate::rand::sha_256;\nuse crate::receiver::Snip20ReceiveMsg;\nuse crate::state::{\n    get_receiver_hash, get_transfers, read_allowance, read_viewing_key, set_receiver_hash,\n    store_transfer, write_allowance, write_viewing_key, Balances, Config, Constants,\n    ReadonlyBalances, ReadonlyConfig,\n};\nuse crate::viewing_key::{ViewingKey, VIEWING_KEY_SIZE};\n\n/// We make sure that responses from `handle` are padded to a multiple of this size.\npub const RESPONSE_BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let init_config = msg.config();\n    let mut total_supply: u128 = 0;\n    {\n        let mut balances = Balances::from_storage(\u0026mut deps.storage);\n        let initial_balances = msg.initial_balances.unwrap_or_default();\n        for balance in initial_balances {\n            let balance_address = deps.api.canonical_address(\u0026balance.address)?;\n            let amount = balance.amount.u128();\n            balances.set_account_balance(\u0026balance_address, amount);\n            if let Some(new_total_supply) = total_supply.checked_add(amount) {\n                total_supply = new_total_supply;\n            } else {\n                return Err(StdError::generic_err(\n                    \"The sum of all initial balances exceeds the maximum possible total supply\",\n                ));\n            }\n        }\n    }\n\n    // Check name, symbol, decimals\n    if !is_valid_name(\u0026msg.name) {\n        return Err(StdError::generic_err(\n            \"Name is not in the expected format (3-30 UTF-8 bytes)\",\n        ));\n    }\n    if !is_valid_symbol(\u0026msg.symbol) {\n        return Err(StdError::generic_err(\n            \"Ticker symbol is not in expected format [A-Z]{3,6}\",\n        ));\n    }\n    if msg.decimals \u003e 18 {\n        return Err(StdError::generic_err(\"Decimals must not exceed 18\"));\n    }\n\n    let admin = msg.admin.unwrap_or_else(|| env.message.sender);\n\n    let prng_seed_hashed = sha_256(\u0026msg.prng_seed.0);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    config.set_constants(\u0026Constants {\n        name: msg.name,\n        symbol: msg.symbol,\n        decimals: msg.decimals,\n        admin: admin.clone(),\n        prng_seed: prng_seed_hashed.to_vec(),\n        total_supply_is_public: init_config.public_total_supply(),\n    })?;\n    config.set_total_supply(total_supply);\n    config.set_contract_status(ContractStatusLevel::NormalRun);\n    config.set_minters(Vec::from([admin]))?;\n\n    Ok(InitResponse::default())\n}\n\nfn pad_response(response: StdResult\u003cHandleResponse\u003e) -\u003e StdResult\u003cHandleResponse\u003e {\n    response.map(|mut response| {\n        response.data = response.data.map(|mut data| {\n            space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n            data\n        });\n        response\n    })\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n\n    match contract_status {\n        ContractStatusLevel::StopAll | ContractStatusLevel::StopAllButRedeems =\u003e {\n            let response = match msg {\n                HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n                HandleMsg::Redeem { amount, .. }\n                    if contract_status == ContractStatusLevel::StopAllButRedeems =\u003e\n                {\n                    try_redeem(deps, env, amount)\n                }\n                _ =\u003e Err(StdError::generic_err(\n                    \"This contract is stopped and this action is not allowed\",\n                )),\n            };\n            return pad_response(response);\n        }\n        ContractStatusLevel::NormalRun =\u003e {} // If it's a normal run just continue\n    }\n\n    let response = match msg {\n        // Native\n        HandleMsg::Deposit { .. } =\u003e try_deposit(deps, env),\n        HandleMsg::Redeem { amount, .. } =\u003e try_redeem(deps, env, amount),\n\n        // Base\n        HandleMsg::Transfer {\n            recipient, amount, ..\n        } =\u003e try_transfer(deps, env, \u0026recipient, amount),\n        HandleMsg::Send {\n            recipient,\n            amount,\n            msg,\n            ..\n        } =\u003e try_send(deps, env, \u0026recipient, amount, msg),\n        HandleMsg::Burn { amount, .. } =\u003e try_burn(deps, env, amount),\n        HandleMsg::RegisterReceive { code_hash, .. } =\u003e try_register_receive(deps, env, code_hash),\n        HandleMsg::CreateViewingKey { entropy, .. } =\u003e try_create_key(deps, env, entropy),\n        HandleMsg::SetViewingKey { key, .. } =\u003e try_set_key(deps, env, key),\n\n        // Allowance\n        HandleMsg::IncreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_increase_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::DecreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_decrease_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::TransferFrom {\n            owner,\n            recipient,\n            amount,\n            ..\n        } =\u003e try_transfer_from(deps, env, \u0026owner, \u0026recipient, amount),\n        HandleMsg::SendFrom {\n            owner,\n            recipient,\n            amount,\n            msg,\n            ..\n        } =\u003e try_send_from(deps, env, \u0026owner, \u0026recipient, amount, msg),\n        HandleMsg::BurnFrom { owner, amount, .. } =\u003e try_burn_from(deps, env, \u0026owner, amount),\n\n        // Mint\n        HandleMsg::Mint {\n            recipient, amount, ..\n        } =\u003e try_mint(deps, env, recipient, amount),\n\n        // Other\n        HandleMsg::ChangeAdmin { address, .. } =\u003e change_admin(deps, env, address),\n        HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n        HandleMsg::AddMinters { minters, .. } =\u003e add_minters(deps, env, minters),\n        HandleMsg::RemoveMinters { minters, .. } =\u003e remove_minters(deps, env, minters),\n        HandleMsg::SetMinters { minters, .. } =\u003e set_minters(deps, env, minters),\n    };\n\n    pad_response(response)\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e, msg: QueryMsg) -\u003e QueryResult {\n    match msg {\n        QueryMsg::TokenInfo {} =\u003e query_token_info(\u0026deps.storage),\n        QueryMsg::ExchangeRate {} =\u003e query_exchange_rate(),\n        QueryMsg::Minters { .. } =\u003e query_minters(deps),\n        _ =\u003e authenticated_queries(deps, msg),\n    }\n}\n\npub fn authenticated_queries\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e QueryResult {\n    let (addresses, key) = msg.get_validation_params();\n\n    for address in addresses {\n        let canonical_addr = deps.api.canonical_address(address)?;\n\n        let expected_key = read_viewing_key(\u0026deps.storage, \u0026canonical_addr);\n\n        if expected_key.is_none() {\n            // Checking the key will take significant time. We don't want to exit immediately if it isn't set\n            // in a way which will allow to time the command and determine if a viewing key doesn't exist\n            key.check_viewing_key(\u0026[0u8; VIEWING_KEY_SIZE]);\n        } else if key.check_viewing_key(expected_key.unwrap().as_slice()) {\n            return match msg {\n                // Base\n                QueryMsg::Balance { address, .. } =\u003e query_balance(\u0026deps, \u0026address),\n                QueryMsg::TransferHistory {\n                    address,\n                    page,\n                    page_size,\n                    ..\n                } =\u003e query_transactions(\u0026deps, \u0026address, page.unwrap_or(0), page_size),\n                QueryMsg::Allowance { owner, spender, .. } =\u003e {\n                    try_check_allowance(deps, owner, spender)\n                }\n                _ =\u003e panic!(\"This query type does not require authentication\"),\n            };\n        }\n    }\n\n    Ok(to_binary(\u0026QueryAnswer::ViewingKeyError {\n        msg: \"Wrong viewing key for this address or viewing key not set\".to_string(),\n    })?)\n}\n\n/// This function just returns a constant 1:1 rate to uscrt, since that's the purpose of this\n/// contract.\nfn query_exchange_rate() -\u003e QueryResult {\n    to_binary(\u0026QueryAnswer::ExchangeRate {\n        rate: Uint128(1),\n        denom: \"uscrt\".to_string(),\n    })\n}\n\nfn query_token_info\u003cS: ReadonlyStorage\u003e(storage: \u0026S) -\u003e QueryResult {\n    let config = ReadonlyConfig::from_storage(storage);\n    let constants = config.constants()?;\n\n    let total_supply = if constants.total_supply_is_public {\n        Some(Uint128(config.total_supply()))\n    } else {\n        None\n    };\n\n    to_binary(\u0026QueryAnswer::TokenInfo {\n        name: constants.name,\n        symbol: constants.symbol,\n        decimals: constants.decimals,\n        total_supply,\n    })\n}\n\npub fn query_transactions\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account).unwrap();\n    let txs = get_transfers(\u0026deps.api, \u0026deps.storage, \u0026address, page, page_size)?;\n\n    let result = QueryAnswer::TransferHistory { txs };\n    to_binary(\u0026result)\n}\n\npub fn query_balance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account)?;\n\n    let amount = Uint128(ReadonlyBalances::from_storage(\u0026deps.storage).account_amount(\u0026address));\n    let response = QueryAnswer::Balance { amount };\n    to_binary(\u0026response)\n}\n\nfn query_minters\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let minters = ReadonlyConfig::from_storage(\u0026deps.storage).minters();\n\n    let response = QueryAnswer::Minters { minters };\n    to_binary(\u0026response)\n}\n\nfn change_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    let mut consts = config.constants()?;\n    consts.admin = address;\n    config.set_constants(\u0026consts)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::ChangeAdmin { status: Success })?),\n    })\n}\n\nfn try_mint\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    let minters = config.minters();\n    if !minters.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(\n            \"Minting is allowed to minter accounts only\",\n        ));\n    }\n\n    let amount = amount.u128();\n\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_add(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the total supply above the supported maximum\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let receipient_account = \u0026deps.api.canonical_address(\u0026address)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n\n    let mut account_balance = balances.balance(receipient_account);\n\n    if let Some(new_balance) = account_balance.checked_add(amount) {\n        account_balance = new_balance;\n    } else {\n        // This error literally can not happen, since the account's funds are a subset\n        // of the total supply, both are stored as u128, and we check for overflow of\n        // the total supply just a couple lines before.\n        // Still, writing this to cover all overflows.\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the account's balance above the supported maximum\",\n        ));\n    }\n\n    balances.set_account_balance(receipient_account, account_balance);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Mint { status: Success })?),\n    };\n\n    Ok(res)\n}\n\npub fn try_set_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    key: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let vk = ViewingKey(key);\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026vk);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetViewingKey { status: Success })?),\n    })\n}\n\npub fn try_create_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    entropy: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let constants = ReadonlyConfig::from_storage(\u0026deps.storage).constants()?;\n    let prng_seed = constants.prng_seed;\n\n    let key = ViewingKey::new(\u0026env, \u0026prng_seed, (\u0026entropy).as_ref());\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026key);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::CreateViewingKey { key })?),\n    })\n}\n\nfn set_contract_status\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    status_level: ContractStatusLevel,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_contract_status(status_level);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetContractStatus {\n            status: Success,\n        })?),\n    })\n}\n\npub fn try_check_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    owner: HumanAddr,\n    spender: HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let owner_address = deps.api.canonical_address(\u0026owner)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    let response = QueryAnswer::Allowance {\n        owner,\n        spender,\n        allowance: Uint128(allowance.amount),\n        expiration: allowance.expiration,\n    };\n    to_binary(\u0026response)\n}\n\nfn try_deposit\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut amount = Uint128::zero();\n\n    for coin in \u0026env.message.sent_funds {\n        if coin.denom == \"uscrt\" {\n            amount = coin.amount\n        }\n    }\n\n    if amount.is_zero() {\n        return Err(StdError::generic_err(\"No funds were sent to be deposited\"));\n    }\n\n    let amount = amount.u128();\n\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n    if let Some(account_balance) = account_balance.checked_add(amount) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow your balance\",\n        ));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_add(amount) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow the currency's total supply\",\n        ));\n    }\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Deposit { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount_raw = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(account_balance) = account_balance.checked_sub(amount_raw) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to redeem: balance={}, required={}\",\n            account_balance, amount_raw\n        )));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_sub(amount_raw) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"You are tyring to redeem more tokens than what is available in the total supply\",\n        ));\n    }\n\n    let withdrawl_coins: Vec\u003cCoin\u003e = vec![Coin {\n        denom: \"uscrt\".to_string(),\n        amount,\n    }];\n\n    let res = HandleResponse {\n        messages: vec![CosmosMsg::Bank(BankMsg::Send {\n            from_address: env.contract.address,\n            to_address: env.message.sender,\n            amount: withdrawl_coins,\n        })],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Redeem { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_transfer_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount.u128(),\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\nfn try_transfer\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Transfer { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_add_receiver_api_callback\u003cS: ReadonlyStorage\u003e(\n    messages: \u0026mut Vec\u003cCosmosMsg\u003e,\n    storage: \u0026S,\n    recipient: \u0026HumanAddr,\n    msg: Option\u003cBinary\u003e,\n    sender: HumanAddr,\n    from: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let receiver_hash = get_receiver_hash(storage, recipient);\n    if let Some(receiver_hash) = receiver_hash {\n        let receiver_hash = receiver_hash?;\n        let receiver_msg = Snip20ReceiveMsg::new(sender, from, amount, msg);\n        let callback_msg = receiver_msg.into_cosmos_msg(receiver_hash, recipient.clone())?;\n\n        messages.push(callback_msg);\n    }\n    Ok(())\n}\n\nfn try_send\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender.clone(),\n        sender,\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Send { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_register_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    code_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    set_receiver_hash(\u0026mut deps.storage, \u0026env.message.sender, code_hash);\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![log(\"register_status\", \"success\")],\n        data: Some(to_binary(\u0026HandleAnswer::RegisterReceive {\n            status: Success,\n        })?),\n    };\n    Ok(res)\n}\n\nfn insufficient_allowance(allowance: u128, required: u128) -\u003e StdError {\n    StdError::generic_err(format!(\n        \"insufficient allowance: allowance={}, required={}\",\n        allowance, required\n    ))\n}\n\nfn try_transfer_from_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let spender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let owner_address = deps.api.canonical_address(owner)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n    let amount_raw = amount.u128();\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    if allowance.expiration.map(|ex| ex \u003c env.block.time) == Some(true) {\n        allowance.amount = 0;\n        write_allowance(\n            \u0026mut deps.storage,\n            \u0026owner_address,\n            \u0026spender_address,\n            allowance,\n        )?;\n        return Err(insufficient_allowance(0, amount_raw));\n    }\n\n    if let Some(new_allowance) = allowance.amount.checked_sub(amount_raw) {\n        allowance.amount = new_allowance;\n    } else {\n        return Err(insufficient_allowance(allowance.amount, amount_raw));\n    }\n\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026recipient_address,\n        amount_raw,\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\nfn try_transfer_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::TransferFrom { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_send_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender,\n        owner.clone(),\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SendFrom { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_burn_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let spender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let owner_address = deps.api.canonical_address(owner)?;\n    let amount = amount.u128();\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    if allowance.expiration.map(|ex| ex \u003c env.block.time) == Some(true) {\n        allowance.amount = 0;\n        write_allowance(\n            \u0026mut deps.storage,\n            \u0026owner_address,\n            \u0026spender_address,\n            allowance,\n        )?;\n        return Err(insufficient_allowance(0, amount));\n    }\n\n    if let Some(new_allowance) = allowance.amount.checked_sub(amount) {\n        allowance.amount = new_allowance;\n    } else {\n        return Err(insufficient_allowance(allowance.amount, amount));\n    }\n\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    // subtract from owner account\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026owner_address);\n\n    if let Some(new_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n    balances.set_account_balance(\u0026owner_address, account_balance);\n\n    // remove from supply\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::BurnFrom { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_increase_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_add(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::IncreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn try_decrease_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_sub(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::DecreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn add_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_add: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.add_minters(minters_to_add)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::AddMinters { status: Success })?),\n    })\n}\n\nfn remove_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_remove: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.remove_minters(minters_to_remove)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::RemoveMinters { status: Success })?),\n    })\n}\n\nfn set_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_set: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_minters(minters_to_set)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetMinters { status: Success })?),\n    })\n}\n\n/// Burn tokens\n///\n/// Remove `amount` tokens from the system irreversibly, from signer account\n///\n/// @param amount the amount of money to burn\nfn try_burn\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(new_account_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_account_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n\n    balances.set_account_balance(\u0026sender_address, account_balance);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Burn { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn perform_transfer\u003cT: Storage\u003e(\n    store: \u0026mut T,\n    from: \u0026CanonicalAddr,\n    to: \u0026CanonicalAddr,\n    amount: u128,\n) -\u003e StdResult\u003c()\u003e {\n    let mut balances = Balances::from_storage(store);\n\n    let mut from_balance = balances.balance(from);\n    if let Some(new_from_balance) = from_balance.checked_sub(amount) {\n        from_balance = new_from_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds: balance={}, required={}\",\n            from_balance, amount\n        )));\n    }\n    balances.set_account_balance(from, from_balance);\n\n    let mut to_balance = balances.balance(to);\n    to_balance = to_balance.checked_add(amount).ok_or_else(|| {\n        StdError::generic_err(\"This tx will literally make them too rich. Try transferring less\")\n    })?;\n    balances.set_account_balance(to, to_balance);\n\n    Ok(())\n}\n\nfn is_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003cbool\u003e {\n    let consts = config.constants()?;\n    if \u0026consts.admin != account {\n        return Ok(false);\n    }\n\n    Ok(true)\n}\n\nfn check_if_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003c()\u003e {\n    if !is_admin(config, account)? {\n        return Err(StdError::generic_err(\n            \"This is an admin command. Admin commands can only be run from admin address\",\n        ));\n    }\n\n    Ok(())\n}\n\nfn is_valid_name(name: \u0026str) -\u003e bool {\n    let len = name.len();\n    3 \u003c= len \u0026\u0026 len \u003c= 30\n}\n\nfn is_valid_symbol(symbol: \u0026str) -\u003e bool {\n    let len = symbol.len();\n    let len_is_valid = 3 \u003c= len \u0026\u0026 len \u003c= 6;\n\n    len_is_valid \u0026\u0026 symbol.bytes().all(|byte| b'A' \u003c= byte \u0026\u0026 byte \u003c= b'Z')\n}\n\n// pub fn migrate\u003cS: Storage, A: Api, Q: Querier\u003e(\n//     _deps: \u0026mut Extern\u003cS, A, Q\u003e,\n//     _env: Env,\n//     _msg: MigrateMsg,\n// ) -\u003e StdResult\u003cMigrateResponse\u003e {\n//     Ok(MigrateResponse::default())\n// }\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use crate::msg::ResponseStatus;\n    use crate::msg::{InitConfig, InitialBalance};\n    use cosmwasm_std::testing::*;\n    use cosmwasm_std::{from_binary, BlockInfo, ContractInfo, MessageInfo, QueryResponse, WasmMsg};\n    use std::any::Any;\n\n    // Helper functions\n\n    fn init_helper(\n        initial_balances: Vec\u003cInitialBalance\u003e,\n    ) -\u003e (\n        StdResult\u003cInitResponse\u003e,\n        Extern\u003cMockStorage, MockApi, MockQuerier\u003e,\n    ) {\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n\n        let init_msg = InitMsg {\n            name: \"sec-sec\".to_string(),\n            admin: Some(HumanAddr(\"admin\".to_string())),\n            symbol: \"SECSEC\".to_string(),\n            decimals: 8,\n            initial_balances: Some(initial_balances),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: None,\n        };\n\n        (init(\u0026mut deps, env, init_msg), deps)\n    }\n\n    // Never used. Only triggers a persistent compile-time warning.\n    ///// Will return a ViewingKey only for the first account in `initial_balances`\n    //fn auth_query_helper(\n        //initial_balances: Vec\u003cInitialBalance\u003e,\n    //) -\u003e (ViewingKey, Extern\u003cMockStorage, MockApi, MockQuerier\u003e) {\n        //let (init_result, mut deps) = init_helper(initial_balances.clone());\n        //assert!(\n            //init_result.is_ok(),\n            //\"Init failed: {}\",\n            //init_result.err().unwrap()\n        //);\n\n        //let account = initial_balances[0].address.clone();\n        //let create_vk_msg = HandleMsg::CreateViewingKey {\n            //entropy: \"42\".to_string(),\n            //padding: None,\n        //};\n        //let handle_response = handle(\u0026mut deps, mock_env(account.0, \u0026[]), create_vk_msg).unwrap();\n        //let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            //HandleAnswer::CreateViewingKey { key } =\u003e key,\n            //_ =\u003e panic!(\"Unexpected result from handle\"),\n        //};\n\n        //(vk, deps)\n    //}\n\n    fn extract_error_msg\u003cT: Any\u003e(error: StdResult\u003cT\u003e) -\u003e String {\n        match error {\n            Ok(response) =\u003e {\n                let bin_err = (\u0026response as \u0026dyn Any)\n                    .downcast_ref::\u003cQueryResponse\u003e()\n                    .expect(\"An error was expected, but no error could be extracted\");\n                match from_binary(bin_err).unwrap() {\n                    QueryAnswer::ViewingKeyError { msg } =\u003e msg,\n                    _ =\u003e panic!(\"Unexpected query answer\"),\n                }\n            }\n            Err(err) =\u003e match err {\n                StdError::GenericErr { msg, .. } =\u003e msg,\n                _ =\u003e panic!(\"Unexpected result from init\"),\n            },\n        }\n    }\n\n    fn ensure_success(handle_result: HandleResponse) -\u003e bool {\n        let handle_result: HandleAnswer = from_binary(\u0026handle_result.data.unwrap()).unwrap();\n\n        match handle_result {\n            HandleAnswer::Deposit { status }\n            | HandleAnswer::Redeem { status }\n            | HandleAnswer::Transfer { status }\n            | HandleAnswer::Send { status }\n            | HandleAnswer::Burn { status }\n            | HandleAnswer::RegisterReceive { status }\n            | HandleAnswer::SetViewingKey { status }\n            | HandleAnswer::TransferFrom { status }\n            | HandleAnswer::SendFrom { status }\n            | HandleAnswer::BurnFrom { status }\n            | HandleAnswer::Mint { status }\n            | HandleAnswer::ChangeAdmin { status }\n            | HandleAnswer::SetContractStatus { status }\n            | HandleAnswer::SetMinters { status }\n            | HandleAnswer::AddMinters { status }\n            | HandleAnswer::RemoveMinters { status } =\u003e {\n                matches!(status, ResponseStatus::Success {..})\n            }\n            _ =\u003e panic!(\"HandleAnswer not supported for success extraction\"),\n        }\n    }\n\n    // Init tests\n\n    #[test]\n    fn test_init_sanity() {\n        let (init_result, deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert_eq!(init_result.unwrap(), InitResponse::default());\n\n        let config = ReadonlyConfig::from_storage(\u0026deps.storage);\n        let constants = config.constants().unwrap();\n        assert_eq!(config.total_supply(), 5000);\n        assert_eq!(config.contract_status(), ContractStatusLevel::NormalRun);\n        assert_eq!(constants.name, \"sec-sec\".to_string());\n        assert_eq!(constants.admin, HumanAddr(\"admin\".to_string()));\n        assert_eq!(constants.symbol, \"SECSEC\".to_string());\n        assert_eq!(constants.decimals, 8);\n        assert_eq!(\n            constants.prng_seed,\n            sha_256(\"lolz fun yay\".to_owned().as_bytes())\n        );\n        assert_eq!(constants.total_supply_is_public, false);\n    }\n\n    #[test]\n    fn test_total_supply_overflow() {\n        let (init_result, _deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(u128::max_value()),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let (init_result, _deps) = init_helper(vec![\n            InitialBalance {\n                address: HumanAddr(\"lebron\".to_string()),\n                amount: Uint128(u128::max_value()),\n            },\n            InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: Uint128(1),\n            },\n        ]);\n        let error = extract_error_msg(init_result);\n        assert_eq!(\n            error,\n            \"The sum of all initial balances exceeds the maximum possible total supply\"\n        );\n    }\n\n    // Handle tests\n\n    #[test]\n    fn test_handle_transfer() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        assert_eq!(5000 - 1000, balances.account_amount(\u0026bob_canonical));\n        assert_eq!(1000, balances.account_amount(\u0026alice_canonical));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(10000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient funds\"));\n    }\n\n    #[test]\n    fn test_handle_send() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let handle_msg = HandleMsg::Send {\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n            msg: Some(to_binary(\"hey hey you you\").unwrap()),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result.clone()));\n        assert!(result.messages.contains(\u0026CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr: HumanAddr(\"contract\".to_string()),\n            callback_code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            msg: Snip20ReceiveMsg::new(\n                HumanAddr(\"bob\".to_string()),\n                HumanAddr(\"bob\".to_string()),\n                Uint128(100),\n                Some(to_binary(\"hey hey you you\").unwrap())\n            )\n            .into_binary()\n            .unwrap(),\n            send: vec![]\n        })));\n    }\n\n    #[test]\n    fn test_handle_register_receive() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let hash = get_receiver_hash(\u0026deps.storage, \u0026HumanAddr(\"contract\".to_string()))\n            .unwrap()\n            .unwrap();\n        assert_eq!(hash, \"this_is_a_hash_of_a_code\".to_string());\n    }\n\n    #[test]\n    fn test_handle_create_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::CreateViewingKey {\n            entropy: \"\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let answer: HandleAnswer = from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n\n        let key = match answer {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"NOPE\"),\n        };\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(key.check_viewing_key(saved_vk.as_slice()));\n    }\n\n    #[test]\n    fn test_handle_set_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Set VK\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"hi lol\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        // Set valid VK\n        let actual_vk = ViewingKey(\"x\".to_string().repeat(VIEWING_KEY_SIZE));\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: actual_vk.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey { status: Success }).unwrap(),\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(actual_vk.check_viewing_key(\u0026saved_vk));\n    }\n\n    #[test]\n    fn test_handle_transfer_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Transfer before allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: Some(1_571_797_420),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer after allowance expired\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\n            \u0026mut deps,\n            Env {\n                block: BlockInfo {\n                    height: 12_345,\n                    time: 1_571_797_420,\n                    chain_id: \"cosmos-testnet-14002\".to_string(),\n                },\n                message: MessageInfo {\n                    sender: HumanAddr(\"bob\".to_string()),\n                    sent_funds: vec![],\n                },\n                contract: ContractInfo {\n                    address: HumanAddr::from(MOCK_CONTRACT_ADDR),\n                },\n                contract_key: Some(\"\".to_string()),\n                contract_code_hash: \"\".to_string(),\n            },\n            handle_msg,\n        );\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let alice_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026alice_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(alice_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n\n    #[test]\n    fn test_handle_send_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Send before allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Send more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"lolz\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let send_msg = Binary::from(r#\"{ \"some_msg\": { \"some_key\": \"some_val\" } }\"#.as_bytes());\n        let snip20_msg = Snip20ReceiveMsg::new(\n            HumanAddr(\"alice\".to_string()),\n            HumanAddr(\"bob\".to_string()),\n            Uint128(2000),\n            Some(send_msg.clone()),\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(2000),\n            msg: Some(send_msg),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        assert!(handle_result.unwrap().messages.contains(\n            \u0026snip20_msg\n                .into_cosmos_msg(\"lolz\".to_string(), HumanAddr(\"contract\".to_string()))\n                .unwrap()\n        ));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let contract_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"contract\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let contract_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026contract_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(contract_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n\n    #[test]\n    fn test_handle_burn_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Burn before allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Burn more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000 - 2000);\n\n        // Second burn more than allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n\n    #[test]\n    fn test_handle_decrease_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 0,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(50),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 1950,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_increase_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 2000,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 4000,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_change_admin() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"bob\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let admin = ReadonlyConfig::from_storage(\u0026deps.storage)\n            .constants()\n            .unwrap()\n            .admin;\n        assert_eq!(admin, HumanAddr(\"bob\".to_string()));\n    }\n\n    #[test]\n    fn test_handle_set_contract_status() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"admin\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n        assert!(matches!(contract_status, ContractStatusLevel::StopAll{..}));\n    }\n\n    #[test]\n    fn test_handle_redeem() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"butler\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Redeem {\n            amount: Uint128(1000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"butler\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"butler\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 4000)\n    }\n\n    #[test]\n    fn test_handle_deposit() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Deposit { padding: None };\n        let handle_result = handle(\n            \u0026mut deps,\n            mock_env(\n                \"lebron\",\n                \u0026[Coin {\n                    denom: \"uscrt\".to_string(),\n                    amount: Uint128(1000),\n                }],\n            ),\n            handle_msg,\n        );\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"lebron\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 6000)\n    }\n\n    #[test]\n    fn test_handle_burn() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let burn_amount: u128 = 100;\n        let handle_msg = HandleMsg::Burn {\n            amount: Uint128(burn_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply - burn_amount);\n    }\n\n    #[test]\n    fn test_handle_mint() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let mint_amount: u128 = 100;\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(mint_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply + mint_amount);\n    }\n\n    #[test]\n    fn test_handle_admin_commands() {\n        let admin_err = \"Admin commands can only be run from admin address\".to_string();\n\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), pause_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let change_admin_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"not_admin\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), change_admin_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n    }\n\n    #[test]\n    fn test_handle_pause_with_withdrawals() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Withdraw failed: {}\",\n            handle_result.err().unwrap()\n        );\n    }\n\n    #[test]\n    fn test_handle_pause_all() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n    }\n\n    #[test]\n    fn test_handle_set_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    #[test]\n    fn test_handle_add_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n    }\n\n    #[test]\n    fn test_handle_remove_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        // Removing another extra time to ensure nothing funky happens\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    // Query tests\n\n    #[test]\n    fn test_authenticated_queries() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let no_vk_yet_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"no_vk_yet\".to_string(),\n        };\n        let query_result = query(\u0026deps, no_vk_yet_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n\n        let create_vk_msg = HandleMsg::CreateViewingKey {\n            entropy: \"34\".to_string(),\n            padding: None,\n        };\n        let handle_response = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), create_vk_msg).unwrap();\n        let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"Unexpected result from handle\"),\n        };\n\n        let query_balance_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: vk.0,\n        };\n\n        let query_response = query(\u0026deps, query_balance_msg).unwrap();\n        let balance = match from_binary(\u0026query_response).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected result from query\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n\n        let wrong_vk_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"wrong_vk\".to_string(),\n        };\n        let query_result = query(\u0026deps, wrong_vk_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n    }\n\n    #[test]\n    fn test_query_token_info() {\n        let init_name = \"sec-sec\".to_string();\n        let init_admin = HumanAddr(\"admin\".to_string());\n        let init_symbol = \"SECSEC\".to_string();\n        let init_decimals = 8;\n        let init_config: InitConfig = from_binary(\u0026Binary::from(\n            r#\"{ \"public_total_supply\": true }\"#.as_bytes(),\n        ))\n        .unwrap();\n        let init_supply = Uint128(5000);\n\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n        let init_msg = InitMsg {\n            name: init_name.clone(),\n            admin: Some(init_admin.clone()),\n            symbol: init_symbol.clone(),\n            decimals: init_decimals.clone(),\n            initial_balances: Some(vec![InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: init_supply,\n            }]),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: Some(init_config),\n        };\n        let init_result = init(\u0026mut deps, env, init_msg);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let query_msg = QueryMsg::TokenInfo {};\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Init failed: {}\",\n            query_result.err().unwrap()\n        );\n        let query_answer: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        match query_answer {\n            QueryAnswer::TokenInfo {\n                name,\n                symbol,\n                decimals,\n                total_supply,\n            } =\u003e {\n                assert_eq!(name, init_name);\n                assert_eq!(symbol, init_symbol);\n                assert_eq!(decimals, init_decimals);\n                assert_eq!(total_supply, Some(Uint128(5000)));\n            }\n            _ =\u003e panic!(\"unexpected\"),\n        }\n    }\n\n    #[test]\n    fn test_query_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let vk1 = ViewingKey(\"key1\".to_string());\n        let vk2 = ViewingKey(\"key2\".to_string());\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Query failed: {}\",\n            query_result.err().unwrap()\n        );\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk1.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk2.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"lebron\".to_string()),\n            spender: HumanAddr(\"giannis\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(0));\n    }\n\n    #[test]\n    fn test_query_balance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"wrong_key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let balance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n    }\n\n    #[test]\n    fn test_query_transfer_history() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"banana\".to_string()),\n            amount: Uint128(500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"mango\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 0,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        // let a: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        // println!(\"{:?}\", a);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert!(transfers.is_empty());\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 10,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 3);\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 2,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 2);\n    }\n}\n","traces":[{"line":85,"address":[1288112,1288267,1288279],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":86,"address":[1287984,1288090,1288102,1288130],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":87,"address":[1288003],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[1288034],"length":1,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[1288205],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1060,"address":[1288288,1288308],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"}],"covered":0,"coverable":6},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\nmod rand;\npub mod receiver;\npub mod state;\nmod utils;\nmod viewing_key;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","msg.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{Binary, HumanAddr, StdError, StdResult, Uint128};\n\nuse crate::state::Tx;\nuse crate::viewing_key::ViewingKey;\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct InitialBalance {\n    pub address: HumanAddr,\n    pub amount: Uint128,\n}\n\n#[derive(Serialize, Deserialize, JsonSchema)]\npub struct InitMsg {\n    pub name: String,\n    pub admin: Option\u003cHumanAddr\u003e,\n    pub symbol: String,\n    pub decimals: u8,\n    pub initial_balances: Option\u003cVec\u003cInitialBalance\u003e\u003e,\n    pub prng_seed: Binary,\n    pub config: Option\u003cInitConfig\u003e,\n}\n\nimpl InitMsg {\n    pub fn config(\u0026self) -\u003e InitConfig {\n        self.config.clone().unwrap_or_default()\n    }\n}\n\n/// This type represents optional configuration values which can be overridden.\n/// All values are optional and have defaults which are more private by default,\n/// but can be overridden if necessary\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Default, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub struct InitConfig {\n    /// Indicates whether the total supply is public or should be kept secret.\n    /// default: False\n    public_total_supply: Option\u003cbool\u003e,\n}\n\nimpl InitConfig {\n    pub fn public_total_supply(\u0026self) -\u003e bool {\n        self.public_total_supply.unwrap_or(false)\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    // Native coin interactions\n    Redeem {\n        amount: Uint128,\n        denom: Option\u003cString\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Deposit {\n        padding: Option\u003cString\u003e,\n    },\n\n    // Base ERC-20 stuff\n    Transfer {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    Send {\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Burn {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    CreateViewingKey {\n        entropy: String,\n        padding: Option\u003cString\u003e,\n    },\n    SetViewingKey {\n        key: String,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    TransferFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    SendFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    BurnFrom {\n        owner: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Mint\n    Mint {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    AddMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    RemoveMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    SetMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Admin\n    ChangeAdmin {\n        address: HumanAddr,\n        padding: Option\u003cString\u003e,\n    },\n    SetContractStatus {\n        level: ContractStatusLevel,\n        padding: Option\u003cString\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleAnswer {\n    // Native\n    Deposit {\n        status: ResponseStatus,\n    },\n    Redeem {\n        status: ResponseStatus,\n    },\n\n    // Base\n    Transfer {\n        status: ResponseStatus,\n    },\n    Send {\n        status: ResponseStatus,\n    },\n    Burn {\n        status: ResponseStatus,\n    },\n    RegisterReceive {\n        status: ResponseStatus,\n    },\n    CreateViewingKey {\n        key: ViewingKey,\n    },\n    SetViewingKey {\n        status: ResponseStatus,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    TransferFrom {\n        status: ResponseStatus,\n    },\n    SendFrom {\n        status: ResponseStatus,\n    },\n    BurnFrom {\n        status: ResponseStatus,\n    },\n\n    // Mint\n    Mint {\n        status: ResponseStatus,\n    },\n    AddMinters {\n        status: ResponseStatus,\n    },\n    RemoveMinters {\n        status: ResponseStatus,\n    },\n    SetMinters {\n        status: ResponseStatus,\n    },\n\n    // Other\n    ChangeAdmin {\n        status: ResponseStatus,\n    },\n    SetContractStatus {\n        status: ResponseStatus,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    TokenInfo {},\n    ExchangeRate {},\n    Allowance {\n        owner: HumanAddr,\n        spender: HumanAddr,\n        key: String,\n    },\n    Balance {\n        address: HumanAddr,\n        key: String,\n    },\n    TransferHistory {\n        address: HumanAddr,\n        key: String,\n        page: Option\u003cu32\u003e,\n        page_size: u32,\n    },\n    Minters {},\n}\n\nimpl QueryMsg {\n    pub fn get_validation_params(\u0026self) -\u003e (Vec\u003c\u0026HumanAddr\u003e, ViewingKey) {\n        match self {\n            Self::Balance { address, key } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::TransferHistory { address, key, .. } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::Allowance {\n                owner,\n                spender,\n                key,\n                ..\n            } =\u003e (vec![owner, spender], ViewingKey(key.clone())),\n            _ =\u003e panic!(\"This query type does not require authentication\"),\n        }\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryAnswer {\n    TokenInfo {\n        name: String,\n        symbol: String,\n        decimals: u8,\n        total_supply: Option\u003cUint128\u003e,\n    },\n    ExchangeRate {\n        rate: Uint128,\n        denom: String,\n    },\n    Allowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n        expiration: Option\u003cu64\u003e,\n    },\n    Balance {\n        amount: Uint128,\n    },\n    TransferHistory {\n        txs: Vec\u003cTx\u003e,\n    },\n\n    ViewingKeyError {\n        msg: String,\n    },\n    Minters {\n        minters: Vec\u003cHumanAddr\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct CreateViewingKeyResponse {\n    pub key: String,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ResponseStatus {\n    Success,\n    Failure,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ContractStatusLevel {\n    NormalRun,\n    StopAllButRedeems,\n    StopAll,\n}\n\npub fn status_level_to_u8(status_level: ContractStatusLevel) -\u003e u8 {\n    match status_level {\n        ContractStatusLevel::NormalRun =\u003e 0,\n        ContractStatusLevel::StopAllButRedeems =\u003e 1,\n        ContractStatusLevel::StopAll =\u003e 2,\n    }\n}\n\npub fn u8_to_status_level(status_level: u8) -\u003e StdResult\u003cContractStatusLevel\u003e {\n    match status_level {\n        0 =\u003e Ok(ContractStatusLevel::NormalRun),\n        1 =\u003e Ok(ContractStatusLevel::StopAllButRedeems),\n        2 =\u003e Ok(ContractStatusLevel::StopAll),\n        _ =\u003e Err(StdError::generic_err(\"Invalid state level\")),\n    }\n}\n\n// Take a Vec\u003cu8\u003e and pad it up to a multiple of `block_size`, using spaces at the end.\npub fn space_pad(block_size: usize, message: \u0026mut Vec\u003cu8\u003e) -\u003e \u0026mut Vec\u003cu8\u003e {\n    let len = message.len();\n    let surplus = len % block_size;\n    if surplus == 0 {\n        return message;\n    }\n\n    let missing = block_size - surplus;\n    message.reserve(missing);\n    message.extend(std::iter::repeat(b' ').take(missing));\n    message\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::{from_slice, StdResult};\n\n    #[derive(Serialize, Deserialize, JsonSchema, Debug, PartialEq)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum Something {\n        Var { padding: Option\u003cString\u003e },\n    }\n\n    #[test]\n    fn test_deserialization_of_missing_option_fields() -\u003e StdResult\u003c()\u003e {\n        let input = b\"{ \\\"var\\\": {} }\";\n        let obj: Something = from_slice(input)?;\n        assert_eq!(\n            obj,\n            Something::Var { padding: None },\n            \"unexpected value: {:?}\",\n            obj\n        );\n        Ok(())\n    }\n}\n","traces":[{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":252,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[979136],"length":1,"stats":{"Line":0},"fn_name":"status_level_to_u8"},{"line":322,"address":[979177,979184,979191],"length":1,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[979147,979179],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[979186],"length":1,"stats":{"Line":0},"fn_name":null},{"line":325,"address":[979193],"length":1,"stats":{"Line":0},"fn_name":null},{"line":329,"address":[979216],"length":1,"stats":{"Line":0},"fn_name":"u8_to_status_level"},{"line":330,"address":[979328,979302,979315],"length":1,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[979295,979240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[979308],"length":1,"stats":{"Line":0},"fn_name":null},{"line":333,"address":[979321],"length":1,"stats":{"Line":0},"fn_name":null},{"line":334,"address":[979266,979334],"length":1,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[979376],"length":1,"stats":{"Line":0},"fn_name":"space_pad"},{"line":340,"address":[979413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":341,"address":[979434,979478],"length":1,"stats":{"Line":0},"fn_name":null},{"line":342,"address":[979470],"length":1,"stats":{"Line":0},"fn_name":null},{"line":343,"address":[979513],"length":1,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[979533,979571],"length":1,"stats":{"Line":0},"fn_name":null},{"line":347,"address":[979563],"length":1,"stats":{"Line":0},"fn_name":null},{"line":348,"address":[979601],"length":1,"stats":{"Line":0},"fn_name":null},{"line":349,"address":[979671],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":35},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","rand.rs"],"content":"use rand_chacha::ChaChaRng;\nuse rand_core::{RngCore, SeedableRng};\n\nuse sha2::{Digest, Sha256};\n\npub fn sha_256(data: \u0026[u8]) -\u003e [u8; 32] {\n    let mut hasher = Sha256::new();\n    hasher.update(data);\n    let hash = hasher.finalize();\n\n    let mut result = [0u8; 32];\n    result.copy_from_slice(hash.as_slice());\n    result\n}\n\npub struct Prng {\n    rng: ChaChaRng,\n}\n\nimpl Prng {\n    pub fn new(seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        let mut hasher = Sha256::new();\n\n        // write input message\n        hasher.update(\u0026seed);\n        hasher.update(\u0026entropy);\n        let hash = hasher.finalize();\n\n        let mut hash_bytes = [0u8; 32];\n        hash_bytes.copy_from_slice(hash.as_slice());\n\n        let rng: ChaChaRng = ChaChaRng::from_seed(hash_bytes);\n\n        Self { rng }\n    }\n\n    pub fn rand_bytes(\u0026mut self) -\u003e [u8; 32] {\n        let mut bytes = [0u8; 32];\n        self.rng.fill_bytes(\u0026mut bytes);\n\n        bytes\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    /// This test checks that the rng is stateful and generates\n    /// different random bytes every time it is called.\n    #[test]\n    fn test_rng() {\n        let mut rng = Prng::new(b\"foo\", b\"bar!\");\n        let r1: [u8; 32] = [\n            155, 11, 21, 97, 252, 65, 160, 190, 100, 126, 85, 251, 47, 73, 160, 49, 216, 182, 93,\n            30, 185, 67, 166, 22, 34, 10, 213, 112, 21, 136, 49, 214,\n        ];\n        let r2: [u8; 32] = [\n            46, 135, 19, 242, 111, 125, 59, 215, 114, 130, 122, 155, 202, 23, 36, 118, 83, 11, 6,\n            180, 97, 165, 218, 136, 134, 243, 191, 191, 149, 178, 7, 149,\n        ];\n        let r3: [u8; 32] = [\n            9, 2, 131, 50, 199, 170, 6, 68, 168, 28, 242, 182, 35, 114, 15, 163, 65, 139, 101, 221,\n            207, 147, 119, 110, 81, 195, 6, 134, 14, 253, 245, 244,\n        ];\n        let r4: [u8; 32] = [\n            68, 196, 114, 205, 225, 64, 201, 179, 18, 77, 216, 197, 211, 13, 21, 196, 11, 102, 106,\n            195, 138, 250, 29, 185, 51, 38, 183, 0, 5, 169, 65, 190,\n        ];\n        assert_eq!(r1, rng.rand_bytes());\n        assert_eq!(r2, rng.rand_bytes());\n        assert_eq!(r3, rng.rand_bytes());\n        assert_eq!(r4, rng.rand_bytes());\n    }\n}\n","traces":[{"line":6,"address":[1228576],"length":1,"stats":{"Line":0},"fn_name":"sha_256"},{"line":7,"address":[1228619],"length":1,"stats":{"Line":0},"fn_name":null},{"line":8,"address":[1228640],"length":1,"stats":{"Line":0},"fn_name":null},{"line":9,"address":[1228651],"length":1,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[1228701],"length":1,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[1228722],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":18},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","receiver.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{to_binary, Binary, CosmosMsg, HumanAddr, StdResult, Uint128, WasmMsg};\n\nuse crate::{contract::RESPONSE_BLOCK_SIZE, msg::space_pad};\n\n/// Snip20ReceiveMsg should be de/serialized under `Receive()` variant in a HandleMsg\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub struct Snip20ReceiveMsg {\n    pub sender: HumanAddr,\n    pub from: HumanAddr,\n    pub amount: Uint128,\n    pub msg: Option\u003cBinary\u003e,\n}\n\nimpl Snip20ReceiveMsg {\n    pub fn new(sender: HumanAddr, from: HumanAddr, amount: Uint128, msg: Option\u003cBinary\u003e) -\u003e Self {\n        Self {\n            sender,\n            from,\n            amount,\n            msg,\n        }\n    }\n\n    /// serializes the message, and pads it to 256 bytes\n    pub fn into_binary(self) -\u003e StdResult\u003cBinary\u003e {\n        let msg = ReceiverHandleMsg::Receive(self);\n        let mut data = to_binary(\u0026msg)?;\n        space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n        Ok(data)\n    }\n\n    /// creates a cosmos_msg sending this struct to the named contract\n    pub fn into_cosmos_msg(\n        self,\n        callback_code_hash: String,\n        contract_addr: HumanAddr,\n    ) -\u003e StdResult\u003cCosmosMsg\u003e {\n        let msg = self.into_binary()?;\n        let execute = WasmMsg::Execute {\n            msg,\n            callback_code_hash,\n            contract_addr,\n            send: vec![],\n        };\n        Ok(execute.into())\n    }\n}\n\n// This is just a helper to properly serialize the above message\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\nenum ReceiverHandleMsg {\n    Receive(Snip20ReceiveMsg),\n}\n","traces":[{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":10},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","state.rs"],"content":"use std::any::type_name;\nuse std::convert::TryFrom;\n\nuse cosmwasm_std::{\n    Api, CanonicalAddr, Coin, HumanAddr, ReadonlyStorage, StdError, StdResult, Storage, Uint128,\n};\nuse cosmwasm_storage::{PrefixedStorage, ReadonlyPrefixedStorage};\n\nuse secret_toolkit::storage::{AppendStore, AppendStoreMut, TypedStore, TypedStoreMut};\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse crate::msg::{status_level_to_u8, u8_to_status_level, ContractStatusLevel};\nuse crate::viewing_key::ViewingKey;\nuse serde::de::DeserializeOwned;\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\npub const PREFIX_TXS: \u0026[u8] = b\"transfers\";\n\npub const KEY_CONSTANTS: \u0026[u8] = b\"constants\";\npub const KEY_TOTAL_SUPPLY: \u0026[u8] = b\"total_supply\";\npub const KEY_CONTRACT_STATUS: \u0026[u8] = b\"contract_status\";\npub const KEY_MINTERS: \u0026[u8] = b\"minters\";\npub const KEY_TX_COUNT: \u0026[u8] = b\"tx-count\";\n\npub const PREFIX_CONFIG: \u0026[u8] = b\"config\";\npub const PREFIX_BALANCES: \u0026[u8] = b\"balances\";\npub const PREFIX_ALLOWANCES: \u0026[u8] = b\"allowances\";\npub const PREFIX_VIEW_KEY: \u0026[u8] = b\"viewingkey\";\npub const PREFIX_RECEIVERS: \u0026[u8] = b\"receivers\";\n\n// Note that id is a globally incrementing counter.\n// Since it's 64 bits long, even at 50 tx/s it would take\n// over 11 billion years for it to rollback. I'm pretty sure\n// we'll have bigger issues by then.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct Tx {\n    pub id: u64,\n    pub from: HumanAddr,\n    pub sender: HumanAddr,\n    pub receiver: HumanAddr,\n    pub coins: Coin,\n}\n\nimpl Tx {\n    pub fn into_stored\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cStoredTx\u003e {\n        let tx = StoredTx {\n            id: self.id,\n            from: api.canonical_address(\u0026self.from)?,\n            sender: api.canonical_address(\u0026self.sender)?,\n            receiver: api.canonical_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug)]\npub struct StoredTx {\n    pub id: u64,\n    pub from: CanonicalAddr,\n    pub sender: CanonicalAddr,\n    pub receiver: CanonicalAddr,\n    pub coins: Coin,\n}\n\nimpl StoredTx {\n    pub fn into_humanized\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cTx\u003e {\n        let tx = Tx {\n            id: self.id,\n            from: api.human_address(\u0026self.from)?,\n            sender: api.human_address(\u0026self.sender)?,\n            receiver: api.human_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\npub fn store_transfer\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    sender: \u0026CanonicalAddr,\n    receiver: \u0026CanonicalAddr,\n    amount: Uint128,\n    denom: String,\n) -\u003e StdResult\u003c()\u003e {\n    let mut config = Config::from_storage(store);\n    let id = config.tx_count() + 1;\n    config.set_tx_count(id)?;\n\n    let coins = Coin { denom, amount };\n    let tx = StoredTx {\n        id,\n        from: owner.clone(),\n        sender: sender.clone(),\n        receiver: receiver.clone(),\n        coins,\n    };\n\n    if owner != sender {\n        append_tx(store, tx.clone(), \u0026owner)?;\n    }\n    append_tx(store, tx.clone(), \u0026sender)?;\n    append_tx(store, tx, \u0026receiver)?;\n\n    Ok(())\n}\n\nfn append_tx\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    tx: StoredTx,\n    for_address: \u0026CanonicalAddr,\n) -\u003e StdResult\u003c()\u003e {\n    let mut store = PrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], store);\n    let mut store = AppendStoreMut::attach_or_create(\u0026mut store)?;\n    store.push(\u0026tx)\n}\n\npub fn get_transfers\u003cA: Api, S: ReadonlyStorage\u003e(\n    api: \u0026A,\n    storage: \u0026S,\n    for_address: \u0026CanonicalAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cVec\u003cTx\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], storage);\n\n    // Try to access the storage of txs for the account.\n    // If it doesn't exist yet, return an empty list of transfers.\n    let store = if let Some(result) = AppendStore::\u003cStoredTx, _\u003e::attach(\u0026store) {\n        result?\n    } else {\n        return Ok(vec![]);\n    };\n\n    // Take `page_size` txs starting from the latest tx, potentially skipping `page * page_size`\n    // txs from the start.\n    let tx_iter = store\n        .iter()\n        .rev()\n        .skip((page * page_size) as _)\n        .take(page_size as _);\n    // The `and_then` here flattens the `StdResult\u003cStdResult\u003cTx\u003e\u003e` to an `StdResult\u003cTx\u003e`\n    let txs: StdResult\u003cVec\u003cTx\u003e\u003e = tx_iter\n        .map(|tx| tx.map(|tx| tx.into_humanized(api)).and_then(|x| x))\n        .collect();\n    txs\n}\n\n// Config\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct Constants {\n    pub name: String,\n    pub admin: HumanAddr,\n    pub symbol: String,\n    pub decimals: u8,\n    pub prng_seed: Vec\u003cu8\u003e,\n    // privacy configuration\n    pub total_supply_is_public: bool,\n}\n\npub struct ReadonlyConfig\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfig\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n}\n\nfn set_bin_data\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, key: \u0026[u8], data: \u0026T) -\u003e StdResult\u003c()\u003e {\n    let bin_data =\n        bincode2::serialize(\u0026data).map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?;\n\n    storage.set(key, \u0026bin_data);\n    Ok(())\n}\n\nfn get_bin_data\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cT\u003e {\n    let bin_data = storage.get(key);\n\n    match bin_data {\n        None =\u003e Err(StdError::not_found(\"Key not found in storage\")),\n        Some(bin_data) =\u003e Ok(bincode2::deserialize::\u003cT\u003e(\u0026bin_data)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?),\n    }\n}\n\npub struct Config\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Config\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn set_constants(\u0026mut self, constants: \u0026Constants) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_CONSTANTS, constants)\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn set_total_supply(\u0026mut self, supply: u128) {\n        self.storage.set(KEY_TOTAL_SUPPLY, \u0026supply.to_be_bytes());\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn set_contract_status(\u0026mut self, status: ContractStatusLevel) {\n        let status_u8 = status_level_to_u8(status);\n        self.storage\n            .set(KEY_CONTRACT_STATUS, \u0026status_u8.to_be_bytes());\n    }\n\n    pub fn set_minters(\u0026mut self, minters_to_set: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_MINTERS, \u0026minters_to_set)\n    }\n\n    pub fn add_minters(\u0026mut self, minters_to_add: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n        minters.extend(minters_to_add);\n\n        self.set_minters(minters)\n    }\n\n    pub fn remove_minters(\u0026mut self, minters_to_remove: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n\n        for minter in minters_to_remove {\n            minters.retain(|x| x != \u0026minter);\n        }\n\n        self.set_minters(minters)\n    }\n\n    pub fn minters(\u0026mut self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n\n    pub fn set_tx_count(\u0026mut self, count: u64) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_TX_COUNT, \u0026count)\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Config` and `ReadonlyConfig`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyConfigImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfigImpl\u003c'a, S\u003e {\n    fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        let consts_bytes = self\n            .0\n            .get(KEY_CONSTANTS)\n            .ok_or_else(|| StdError::generic_err(\"no constants stored in configuration\"))?;\n        bincode2::deserialize::\u003cConstants\u003e(\u0026consts_bytes)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cConstants\u003e(), e))\n    }\n\n    fn total_supply(\u0026self) -\u003e u128 {\n        let supply_bytes = self\n            .0\n            .get(KEY_TOTAL_SUPPLY)\n            .expect(\"no total supply stored in config\");\n        // This unwrap is ok because we know we stored things correctly\n        slice_to_u128(\u0026supply_bytes).unwrap()\n    }\n\n    fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        let supply_bytes = self\n            .0\n            .get(KEY_CONTRACT_STATUS)\n            .expect(\"no contract status stored in config\");\n\n        // These unwraps are ok because we know we stored things correctly\n        let status = slice_to_u8(\u0026supply_bytes).unwrap();\n        u8_to_status_level(status).unwrap()\n    }\n\n    fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        get_bin_data(self.0, KEY_MINTERS).unwrap()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        get_bin_data(self.0, KEY_TX_COUNT).unwrap_or_default()\n    }\n}\n\n// Balances\n\npub struct ReadonlyBalances\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n}\n\npub struct Balances\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Balances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn balance(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n\n    pub fn set_account_balance(\u0026mut self, account: \u0026CanonicalAddr, amount: u128) {\n        self.storage.set(account.as_slice(), \u0026amount.to_be_bytes())\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Balances` and `ReadonlyBalances`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyBalancesImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalancesImpl\u003c'a, S\u003e {\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        let account_bytes = account.as_slice();\n        let result = self.0.get(account_bytes);\n        match result {\n            // This unwrap is ok because we know we stored things correctly\n            Some(balance_bytes) =\u003e slice_to_u128(\u0026balance_bytes).unwrap(),\n            None =\u003e 0,\n        }\n    }\n}\n\n// Allowances\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, Default, JsonSchema)]\npub struct Allowance {\n    pub amount: u128,\n    pub expiration: Option\u003cu64\u003e,\n}\n\npub fn read_allowance\u003cS: Storage\u003e(\n    store: \u0026S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n) -\u003e StdResult\u003cAllowance\u003e {\n    let owner_store =\n        ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let owner_store = TypedStore::attach(\u0026owner_store);\n    let allowance = owner_store.may_load(spender.as_slice());\n    allowance.map(Option::unwrap_or_default)\n}\n\npub fn write_allowance\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n    allowance: Allowance,\n) -\u003e StdResult\u003c()\u003e {\n    let mut owner_store =\n        PrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let mut owner_store = TypedStoreMut::attach(\u0026mut owner_store);\n\n    owner_store.store(spender.as_slice(), \u0026allowance)\n}\n\n// Viewing Keys\n\npub fn write_viewing_key\u003cS: Storage\u003e(store: \u0026mut S, owner: \u0026CanonicalAddr, key: \u0026ViewingKey) {\n    let mut balance_store = PrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.set(owner.as_slice(), \u0026key.to_hashed());\n}\n\npub fn read_viewing_key\u003cS: Storage\u003e(store: \u0026S, owner: \u0026CanonicalAddr) -\u003e Option\u003cVec\u003cu8\u003e\u003e {\n    let balance_store = ReadonlyPrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.get(owner.as_slice())\n}\n\n// Receiver Interface\n\npub fn get_receiver_hash\u003cS: ReadonlyStorage\u003e(\n    store: \u0026S,\n    account: \u0026HumanAddr,\n) -\u003e Option\u003cStdResult\u003cString\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.get(account.as_str().as_bytes()).map(|data| {\n        String::from_utf8(data)\n            .map_err(|_err| StdError::invalid_utf8(\"stored code hash was not a valid String\"))\n    })\n}\n\npub fn set_receiver_hash\u003cS: Storage\u003e(store: \u0026mut S, account: \u0026HumanAddr, code_hash: String) {\n    let mut store = PrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.set(account.as_str().as_bytes(), code_hash.as_bytes());\n}\n\n// Helpers\n\n/// Converts 16 bytes value into u128\n/// Errors if data found that is not 16 bytes\nfn slice_to_u128(data: \u0026[u8]) -\u003e StdResult\u003cu128\u003e {\n    match \u003c[u8; 16]\u003e::try_from(data) {\n        Ok(bytes) =\u003e Ok(u128::from_be_bytes(bytes)),\n        Err(_) =\u003e Err(StdError::generic_err(\n            \"Corrupted data found. 16 byte expected.\",\n        )),\n    }\n}\n\n/// Converts 1 byte value into u8\n/// Errors if data found that is not 1 byte\nfn slice_to_u8(data: \u0026[u8]) -\u003e StdResult\u003cu8\u003e {\n    if data.len() == 1 {\n        Ok(data[0])\n    } else {\n        Err(StdError::generic_err(\n            \"Corrupted data found. 1 byte expected.\",\n        ))\n    }\n}\n","traces":[{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":224,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":290,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":303,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":354,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":357,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":373,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":472,"address":[1279104],"length":1,"stats":{"Line":0},"fn_name":"slice_to_u128"},{"line":473,"address":[1279161,1279314,1279312,1279137],"length":1,"stats":{"Line":0},"fn_name":null},{"line":474,"address":[1279163,1279148,1279297],"length":1,"stats":{"Line":0},"fn_name":null},{"line":475,"address":[1279210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[1279328],"length":1,"stats":{"Line":0},"fn_name":"slice_to_u8"},{"line":484,"address":[1279514,1279387],"length":1,"stats":{"Line":0},"fn_name":null},{"line":485,"address":[1279414,1279506,1279521,1279543],"length":1,"stats":{"Line":0},"fn_name":null},{"line":487,"address":[1279428],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":113},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","utils.rs"],"content":"use crate::viewing_key::VIEWING_KEY_SIZE;\nuse sha2::{Digest, Sha256};\nuse std::convert::TryInto;\nuse subtle::ConstantTimeEq;\n\npub fn ct_slice_compare(s1: \u0026[u8], s2: \u0026[u8]) -\u003e bool {\n    bool::from(s1.ct_eq(s2))\n}\n\npub fn create_hashed_password(s1: \u0026str) -\u003e [u8; VIEWING_KEY_SIZE] {\n    Sha256::digest(s1.as_bytes())\n        .as_slice()\n        .try_into()\n        .expect(\"Wrong password length\")\n}\n","traces":[{"line":6,"address":[1229520],"length":1,"stats":{"Line":0},"fn_name":"ct_slice_compare"},{"line":7,"address":[1229544],"length":1,"stats":{"Line":0},"fn_name":null},{"line":10,"address":[1229584],"length":1,"stats":{"Line":0},"fn_name":"create_hashed_password"},{"line":11,"address":[1229682],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":4},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","viewing_key.rs"],"content":"use std::fmt;\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::Env;\n\nuse crate::rand::{sha_256, Prng};\nuse crate::utils::{create_hashed_password, ct_slice_compare};\n\npub const VIEWING_KEY_SIZE: usize = 32;\npub const VIEWING_KEY_PREFIX: \u0026str = \"api_key_\";\n\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct ViewingKey(pub String);\n\nimpl ViewingKey {\n    pub fn check_viewing_key(\u0026self, hashed_pw: \u0026[u8]) -\u003e bool {\n        let mine_hashed = create_hashed_password(\u0026self.0);\n\n        ct_slice_compare(\u0026mine_hashed, hashed_pw)\n    }\n\n    pub fn new(env: \u0026Env, seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        // 16 here represents the lengths in bytes of the block height and time.\n        let entropy_len = 16 + env.message.sender.len() + entropy.len();\n        let mut rng_entropy = Vec::with_capacity(entropy_len);\n        rng_entropy.extend_from_slice(\u0026env.block.height.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.block.time.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.message.sender.0.as_bytes());\n        rng_entropy.extend_from_slice(entropy);\n\n        let mut rng = Prng::new(seed, \u0026rng_entropy);\n\n        let rand_slice = rng.rand_bytes();\n\n        let key = sha_256(\u0026rand_slice);\n\n        Self(VIEWING_KEY_PREFIX.to_string() + \u0026base64::encode(key))\n    }\n\n    pub fn to_hashed(\u0026self) -\u003e [u8; VIEWING_KEY_SIZE] {\n        create_hashed_password(\u0026self.0)\n    }\n\n    pub fn as_bytes(\u0026self) -\u003e \u0026[u8] {\n        self.0.as_bytes()\n    }\n}\n\nimpl fmt::Display for ViewingKey {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[1180781],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[1180826],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[1180864,1181769],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":26,"address":[1181117,1180960],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[1181101],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","contract.rs"],"content":"use cosmwasm_std::{\n    from_binary, to_binary, Api, BankMsg, Binary, Coin, Context, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, StdError, StdResult, Storage, Uint128,\n    WasmMsg,\n};\n\nuse crate::msg::{CountResponse, HandleMsg, InitMsg, QueryMsg, Snip20Msg};\nuse crate::state::{config, config_read, State};\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let state = State {\n        count: msg.count,\n        owner: deps.api.canonical_address(\u0026env.message.sender)?,\n        known_snip_20: vec![],\n    };\n\n    config(\u0026mut deps.storage).save(\u0026state)?;\n\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        HandleMsg::Increment {} =\u003e try_increment(deps, env),\n        HandleMsg::Reset { count } =\u003e try_reset(deps, env, count),\n        HandleMsg::Register { reg_addr, reg_hash } =\u003e try_register(deps, env, reg_addr, reg_hash),\n        HandleMsg::Receive {\n            sender,\n            from,\n            amount,\n            msg,\n        } =\u003e try_receive(deps, env, sender, from, amount, msg),\n        HandleMsg::Redeem {\n            addr,\n            hash,\n            to,\n            amount,\n        } =\u003e try_redeem(deps, env, addr, hash, to, amount),\n        HandleMsg::Fail {} =\u003e try_fail(),\n    }\n}\n\npub fn try_increment\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    _env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut count = 0;\n    config(\u0026mut deps.storage).update(|mut state| {\n        state.count += 1;\n        count = state.count;\n        Ok(state)\n    })?;\n\n    let mut context = Context::new();\n    context.add_log(\"count\", count.to_string());\n\n    Ok(context.into())\n}\n\npub fn try_reset\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    count: i32,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address_raw = deps.api.canonical_address(\u0026env.message.sender)?;\n    config(\u0026mut deps.storage).update(|mut state| {\n        if sender_address_raw != state.owner {\n            return Err(StdError::Unauthorized { backtrace: None });\n        }\n        state.count = count;\n        Ok(state)\n    })?;\n    Ok(HandleResponse::default())\n}\n\npub fn try_register\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    reg_addr: HumanAddr,\n    reg_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut conf = config(\u0026mut deps.storage);\n    let mut state = conf.load()?;\n    if !state.known_snip_20.contains(\u0026reg_addr) {\n        state.known_snip_20.push(reg_addr.clone());\n    }\n    conf.save(\u0026state)?;\n\n    let msg = to_binary(\u0026Snip20Msg::register_receive(env.contract_code_hash))?;\n    let message = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: reg_addr,\n        callback_code_hash: reg_hash,\n        msg,\n        send: vec![],\n    });\n\n    Ok(HandleResponse {\n        messages: vec![message],\n        log: vec![],\n        data: None,\n    })\n}\n\npub fn try_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    _sender: HumanAddr,\n    _from: HumanAddr,\n    _amount: Uint128,\n    msg: Binary,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let msg: HandleMsg = from_binary(\u0026msg)?;\n\n    if matches!(msg, HandleMsg::Receive { .. }) {\n        return Err(StdError::generic_err(\n            \"Recursive call to receive() is not allowed\",\n        ));\n    }\n\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            env.message.sender\n        )));\n    }\n\n    /* use sender \u0026 amount */\n    handle(deps, env, msg)\n}\n\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    addr: HumanAddr,\n    hash: String,\n    to: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026addr) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            addr\n        )));\n    }\n\n    let msg = to_binary(\u0026Snip20Msg::redeem(amount))?;\n    let secret_redeem = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: addr,\n        callback_code_hash: hash,\n        msg,\n        send: vec![],\n    });\n    let redeem = CosmosMsg::Bank(BankMsg::Send {\n        amount: vec![Coin::new(amount.u128(), \"uscrt\")],\n        from_address: env.contract.address,\n        to_address: to,\n    });\n\n    Ok(HandleResponse {\n        messages: vec![secret_redeem, redeem],\n        log: vec![],\n        data: None,\n    })\n}\n\nfn try_fail() -\u003e StdResult\u003cHandleResponse\u003e {\n    Err(StdError::generic_err(\"intentional failure\"))\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::GetCount {} =\u003e to_binary(\u0026query_count(deps)?),\n    }\n}\n\nfn query_count\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cCountResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    Ok(CountResponse { count: state.count })\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","msg.rs"],"content":"use cosmwasm_std::{Binary, HumanAddr, Uint128};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct InitMsg {\n    pub count: i32,\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    Increment {},\n    Reset {\n        count: i32,\n    },\n    Register {\n        reg_addr: HumanAddr,\n        reg_hash: String,\n    },\n    Receive {\n        sender: HumanAddr,\n        from: HumanAddr,\n        amount: Uint128,\n        msg: Binary,\n    },\n    Redeem {\n        addr: HumanAddr,\n        hash: String,\n        to: HumanAddr,\n        amount: Uint128,\n    },\n    Fail {},\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    // GetCount returns the current count as a json-encoded number\n    GetCount {},\n}\n\n// We define a custom struct for each query response\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct CountResponse {\n    pub count: i32,\n}\n\n// Messages sent to SNIP-20 contracts\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum Snip20Msg {\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    Redeem {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n}\n\nimpl Snip20Msg {\n    pub fn register_receive(code_hash: String) -\u003e Self {\n        Snip20Msg::RegisterReceive {\n            code_hash,\n            padding: None, // TODO add padding calculation\n        }\n    }\n\n    pub fn redeem(amount: Uint128) -\u003e Self {\n        Snip20Msg::Redeem {\n            amount,\n            padding: None, // TODO add padding calculation\n        }\n    }\n}\n","traces":[{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","state.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{CanonicalAddr, HumanAddr, Storage};\nuse cosmwasm_storage::{singleton, singleton_read, ReadonlySingleton, Singleton};\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct State {\n    pub count: i32,\n    pub owner: CanonicalAddr,\n    pub known_snip_20: Vec\u003cHumanAddr\u003e,\n}\n\npub fn config\u003cS: Storage\u003e(storage: \u0026mut S) -\u003e Singleton\u003cS, State\u003e {\n    singleton(storage, CONFIG_KEY)\n}\n\npub fn config_read\u003cS: Storage\u003e(storage: \u0026S) -\u003e ReadonlySingleton\u003cS, State\u003e {\n    singleton_read(storage, CONFIG_KEY)\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","integration.rs"],"content":"#[test]\n#[ignore]\nfn empty_test() {}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","data.rs"],"content":"use cosmwasm_std::{HumanAddr, StdResult, Uint128, CosmosMsg, WasmMsg, BankMsg, Coin, to_binary};\nuse crate::token_type::TokenType;\nuse schemars::JsonSchema;\nuse secret_toolkit::snip20;\nuse serde::{Serialize, Deserialize};\n\n#[derive(Serialize, Deserialize, JsonSchema)]\npub struct Pagination {\n    pub start: u64,\n    pub limit: u8\n}\n\npub fn create_send_msg (\n    token:     \u0026TokenType\u003cHumanAddr\u003e,\n    sender:    HumanAddr,\n    recipient: HumanAddr,\n    amount:    Uint128\n) -\u003e StdResult\u003cCosmosMsg\u003e {\n    let msg = match token {\n        TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n            CosmosMsg::Wasm(WasmMsg::Execute {\n                contract_addr: contract_addr.clone(),\n                callback_code_hash: token_code_hash.to_string(),\n                msg: to_binary(\u0026snip20::HandleMsg::Send {\n                    recipient,\n                    amount,\n                    padding: None,\n                    msg: None,\n                })?,\n                send: vec![]\n            })\n        },\n        TokenType::NativeToken { denom } =\u003e {            \n            CosmosMsg::Bank(BankMsg::Send {\n                from_address: sender,\n                to_address: recipient,\n                amount: vec![Coin {\n                    denom: denom.to_string(),\n                    amount: amount\n                }],\n            })\n        }\n    };\n\n    Ok(msg)\n}\n","traces":[{"line":13,"address":[1285412,1283344],"length":1,"stats":{"Line":0},"fn_name":"create_send_msg"},{"line":19,"address":[789766,787838,788403,787794],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[1813269,1813250],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[1814878],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[1813309],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[1284173],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[1814275,1814390,1814083,1814675],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[1284220],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[1814059],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[788647],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[1814456],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[1813334],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[1283839],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[787926],"length":1,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[787957],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[787998,788043],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[788026],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[788463],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":18},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","display.rs"],"content":"use std::fmt::{Display, Formatter, Result};\nuse crate::{TokenType, TokenTypeAmount, TokenPair, TokenPairAmount, msg::ido::IdoInitConfig};\n\nimpl\u003cA: Display\u003e Display for TokenType\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        match self {\n            TokenType::NativeToken { denom } =\u003e write!(f, \"{}\", denom),\n            TokenType::CustomToken { contract_addr, .. } =\u003e write!(f, \"{}\", contract_addr),\n        }\n    }\n}\n\nimpl\u003cA: Display\u003e Display for TokenTypeAmount\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        write!(f, \"Token type: {} \\n Amount: {}\", self.token, self.amount)\n    }\n}\n\nimpl\u003cA: Display\u003e Display for TokenPair\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        write!(f, \"Token 1: {} \\n Token 2: {}\", self.0, self.1)\n    }\n}\n\nimpl\u003cA: Display + Clone\u003e Display for TokenPairAmount\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        write!(\n            f, \"Token 1: {} {} \\n Token 2: {} {}\",\n            self.pair.0, self.amount_0, self.pair.1, self.amount_1\n        )\n    }\n}\n\nimpl Display for IdoInitConfig {\n    fn fmt(\u0026self, f: \u0026mut Formatter\u003c'_\u003e) -\u003e Result {\n        write!(\n            f,\n            \"Input token: {}, Rate: {}, Created token: {}({})\",\n            self.input_token, self.rate,\n            self.snip20_init_info.name, self.snip20_init_info.symbol\n        )\n    }\n}\n","traces":[{"line":5,"address":[1216464],"length":1,"stats":{"Line":2},"fn_name":"fmt\u003ccosmwasm_std::addresses::HumanAddr\u003e"},{"line":6,"address":[1689245],"length":1,"stats":{"Line":0},"fn_name":null},{"line":7,"address":[1058049,1058145],"length":1,"stats":{"Line":4},"fn_name":null},{"line":8,"address":[1689488,1689252],"length":1,"stats":{"Line":4},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[1189024],"length":1,"stats":{"Line":2},"fn_name":"fmt\u003ccosmwasm_std::addresses::HumanAddr\u003e"},{"line":21,"address":[1189052],"length":1,"stats":{"Line":2},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[1742376],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":5,"coverable":17},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","exchange.rs"],"content":"use cosmwasm_std::{HumanAddr, StdResult, Api, CanonicalAddr};\nuse crate::token_pair::TokenPair;\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstance;\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\n\n/// Represents the address of an exchange and the pair that it manages\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct Exchange \u003cA: Clone\u003e {\n    /// The pair that the contract manages.\n    pub pair:    TokenPair\u003cA\u003e,\n    /// Address of the contract that manages the exchange.\n    pub address: A\n}\n\nimpl Canonize\u003cExchange\u003cCanonicalAddr\u003e\u003e for Exchange\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cExchange\u003cCanonicalAddr\u003e\u003e {\n        Ok(Exchange {\n            pair:    self.pair.canonize(api)?,\n            address: self.address.canonize(api)?\n        })\n    }\n}\n\nimpl Humanize\u003cExchange\u003cHumanAddr\u003e\u003e for Exchange\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cExchange\u003cHumanAddr\u003e\u003e {\n        Ok(Exchange {\n            pair:    self.pair.humanize(api)?,\n            address: api.human_address(\u0026self.address)?\n        })\n    }\n}\n\n#[deprecated(note=\"please use Exchange\u003cCanonicalAddr\u003e instead\")]\npub type ExchangeStored = Exchange\u003cCanonicalAddr\u003e;\n\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Debug, Clone)]\npub struct ExchangeSettings\u003cA\u003e {\n    pub swap_fee:      Fee,\n    pub sienna_fee:    Fee,\n    pub sienna_burner: Option\u003cContractInstance\u003cA\u003e\u003e\n}\n\n#[deprecated(note=\"please use ExchangeSettings\u003cCanonicalAddr\u003e instead\")]\npub type ExchangeSettingsStored = ExchangeSettings\u003cCanonicalAddr\u003e;\n\nimpl ExchangeSettings\u003cHumanAddr\u003e {\n    pub fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cExchangeSettings\u003cCanonicalAddr\u003e\u003e {\n        Ok(ExchangeSettings {\n            swap_fee:   self.swap_fee,\n            sienna_fee: self.sienna_fee,\n            sienna_burner: if let Some(info) = \u0026self.sienna_burner { \n                Some(info.canonize(api)?) \n            } else {\n                None\n            }\n        })\n    }\n}\n\nimpl ExchangeSettings\u003cCanonicalAddr\u003e {\n    pub fn humanize (self, api: \u0026impl Api) -\u003e StdResult\u003cExchangeSettings\u003cHumanAddr\u003e\u003e {\n        Ok(ExchangeSettings {\n            swap_fee:   self.swap_fee,\n            sienna_fee: self.sienna_fee,\n            sienna_burner: if let Some(info) = self.sienna_burner { \n                Some(info.humanize(api)?)\n            } else {\n                None\n            }\n        })\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Clone, Copy, Debug)]\npub struct Fee {\n    pub nom: u8,\n    pub denom: u16\n}\n\nimpl Fee {\n    pub fn new(nom: u8, denom: u16) -\u003e Self {\n        Self {\n            nom,\n            denom\n        }\n    }\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[1076868,1076352],"length":1,"stats":{"Line":1},"fn_name":"humanize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":28,"address":[1076981],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[1076708,1076395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[1076685,1076803,1076883,1076848,1077098],"length":1,"stats":{"Line":3},"fn_name":null},{"line":49,"address":[1059840],"length":1,"stats":{"Line":2},"fn_name":"canonize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":1},"fn_name":null}],"covered":17,"coverable":23},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","lib.rs"],"content":"pub use cosmwasm_utils::*;\npub use fadroma_scrt_callback::*;\npub use secret_toolkit::snip20;\npub use composable_admin as admin;\n\npub mod msg;\npub use u256_math;\n\nmod data; pub use data::*;\nmod token_pair; pub use token_pair::*;\nmod token_pair_amount; pub use token_pair_amount::*;\nmod token_type; pub use token_type::*;\nmod token_type_amount; pub use token_type_amount::*;\nmod exchange; pub use exchange::*;\n\nmod display; pub use display::*;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","msg.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\nuse cosmwasm_std::{HumanAddr, Binary, Uint128, Decimal};\n\nuse crate::{TokenPair, TokenType, TokenTypeAmount, TokenPairAmount};\n\nuse fadroma_scrt_callback::{ContractInstantiationInfo, ContractInstance, Callback};\nuse fadroma_scrt_migrate::types::ContractStatusLevel;\n\npub mod factory {\n    use super::*;\n    use super::ido::IdoInitConfig;\n    use crate::{Pagination, Exchange, ExchangeSettings};\n    use composable_admin::admin::{AdminHandleMsg, AdminQueryMsg};\n\n    #[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n    pub struct InitMsg {\n        pub snip20_contract:   ContractInstantiationInfo,\n        pub lp_token_contract: ContractInstantiationInfo,\n        pub pair_contract:     ContractInstantiationInfo,\n        pub ido_contract:      ContractInstantiationInfo,\n        pub exchange_settings: ExchangeSettings\u003cHumanAddr\u003e\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level: ContractStatusLevel,\n            reason: String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        /// Set contract templates and exchange settings\n        SetConfig {\n            snip20_contract:   Option\u003cContractInstantiationInfo\u003e,\n            lp_token_contract: Option\u003cContractInstantiationInfo\u003e,\n            pair_contract:     Option\u003cContractInstantiationInfo\u003e,\n            ido_contract:      Option\u003cContractInstantiationInfo\u003e,\n            exchange_settings: Option\u003cExchangeSettings\u003cHumanAddr\u003e\u003e\n        },\n        /// Instantiates an exchange pair contract\n        CreateExchange {\n            pair: TokenPair\u003cHumanAddr\u003e\n        },\n        /// Instantiates an IDO contract\n        CreateIdo {\n            info: IdoInitConfig\n        },\n        /// Used by a newly instantiated exchange contract to register\n        /// itself with the factory\n        RegisterExchange {\n            pair: TokenPair\u003cHumanAddr\u003e,\n            signature: Binary\n        },\n        /// Used by a newly instantiated IDO contract to register\n        /// itself with the factory\n        RegisterIdo {\n            signature: Binary\n        },\n\n        Admin(AdminHandleMsg)\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        /// Get configuration (contract templates and exchange settings)\n        GetConfig {},\n        GetExchangeAddress { pair: TokenPair\u003cHumanAddr\u003e },\n        ListIdos { pagination: Pagination },\n        ListExchanges { pagination: Pagination },\n        GetExchangeSettings,\n\n        Admin(AdminQueryMsg)\n    }\n\n    #[derive(Serialize, Deserialize, Debug, JsonSchema, PartialEq)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryResponse {\n        GetExchangeAddress {\n            address: HumanAddr\n        },\n        ListIdos {\n            idos: Vec\u003cHumanAddr\u003e\n        },\n        ListExchanges {\n            exchanges: Vec\u003cExchange\u003cHumanAddr\u003e\u003e\n        },\n        GetExchangeSettings {\n            settings: ExchangeSettings\u003cHumanAddr\u003e\n        },\n        Config {\n            snip20_contract:   ContractInstantiationInfo,\n            lp_token_contract: ContractInstantiationInfo,\n            pair_contract:     ContractInstantiationInfo,\n            ido_contract:      ContractInstantiationInfo,\n            exchange_settings: ExchangeSettings\u003cHumanAddr\u003e\n        }\n    }\n}\n\npub mod exchange {\n    use super::*;\n\n    #[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n    pub struct InitMsg {\n        /// The tokens that will be managed by the exchange\n        pub pair: TokenPair\u003cHumanAddr\u003e,\n        /// LP token instantiation info\n        pub lp_token_contract: ContractInstantiationInfo,\n        /// Used by the exchange contract to\n        /// send back its address to the factory on init\n        pub factory_info: ContractInstance\u003cHumanAddr\u003e,\n        pub callback: Callback\u003cHumanAddr\u003e\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level: ContractStatusLevel,\n            reason: String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        AddLiquidity {\n            deposit: TokenPairAmount\u003cHumanAddr\u003e,\n            /// The amount the price moves in a trading pair between when a transaction is submitted and when it is executed.\n            /// Transactions that exceed this threshold will be rejected.\n            slippage_tolerance: Option\u003cDecimal\u003e\n        },\n        RemoveLiquidity {\n            /// The amount of LP tokens burned.\n            amount: Uint128,\n            /// The account to refund the tokens to.\n            recipient: HumanAddr\n        },\n        Swap {\n            /// The token type to swap from.\n            offer: TokenTypeAmount\u003cHumanAddr\u003e,\n            expected_return: Option\u003cUint128\u003e,\n        },\n        /// Sent by the LP token contract so that we can record its address.\n        OnLpTokenInit\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        PairInfo,\n        SwapSimulation {\n            /// The token type to swap from.\n            offer: TokenTypeAmount\u003cHumanAddr\u003e\n        }\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsgResponse {\n        PairInfo {\n            liquidity_token: ContractInstance\u003cHumanAddr\u003e,\n            factory:         ContractInstance\u003cHumanAddr\u003e,\n            pair:            TokenPair\u003cHumanAddr\u003e,\n            amount_0:        Uint128,\n            amount_1:        Uint128,\n        }\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct SwapSimulationResponse {\n        pub return_amount: Uint128,\n        pub spread_amount: Uint128,\n        pub commission_amount: Uint128,\n    }\n}\n\npub mod ido {\n    use super::*;\n    use super::snip20::Snip20InitConfig;\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct IdoInitMsg {\n        pub snip20_contract: ContractInstantiationInfo,\n        pub info: IdoInitConfig,\n        /// Used by the IDO to register itself with the factory.\n        pub callback: Callback\u003cHumanAddr\u003e\n    }\n    \n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct IdoInitConfig {\n        /// The token that will be used to buy the instantiated SNIP20\n        pub input_token: TokenType\u003cHumanAddr\u003e,\n        pub rate: Uint128,\n        pub snip20_init_info: Snip20TokenInitInfo\n    }\n    \n    #[derive(Serialize, Deserialize, JsonSchema)]\n    /// Used to provide only the essential info\n    /// to an IDO that instantiates a snip20 token\n    pub struct Snip20TokenInitInfo {\n        pub name: String,\n        pub prng_seed: Binary,\n        pub symbol: String,\n        pub decimals: u8,\n        pub config: Option\u003cSnip20InitConfig\u003e\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level: ContractStatusLevel,\n            reason: String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        OnSnip20Init,\n        Swap {\n            amount: Uint128\n        }\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        GetRate\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsgResponse {\n        GetRate { \n            rate: Uint128 \n        }\n    }\n}\n\npub mod sienna_burner {\n    use super::*;\n    use composable_admin::multi_admin::{\n        MultiAdminHandleMsg, MultiAdminQueryMsg, MultiAdminQueryResponse\n    };\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct InitMsg {\n        /// SIENNA token\n        pub sienna_token: ContractInstance\u003cHumanAddr\u003e,\n        pub pairs: Option\u003cVec\u003cHumanAddr\u003e\u003e,\n        /// The account to burn SIENNA from\n        pub burn_pool: HumanAddr,\n        /// Needs to be added as an admin in order to allow\n        /// it to add new pair addresses.\n        pub factory_address: HumanAddr,\n        pub admins: Option\u003cVec\u003cHumanAddr\u003e\u003e\n    }\n    \n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level:       ContractStatusLevel,\n            reason:      String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        Burn           { amount: Uint128 },\n        AddPairs       { pairs: Vec\u003cHumanAddr\u003e, },\n        RemovePairs    { pairs: Vec\u003cHumanAddr\u003e, },\n        SetBurnPool    { address: HumanAddr },\n        SetSiennaToken { info: ContractInstance\u003cHumanAddr\u003e },\n        Admin(MultiAdminHandleMsg),\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, Debug, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        SiennaToken,\n        BurnPool,\n        Admin(MultiAdminQueryMsg),\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, Debug, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryAnswer {\n        SiennaToken { info: ContractInstance\u003cHumanAddr\u003e },\n        BurnPool { address: HumanAddr },\n        Admin(MultiAdminQueryResponse)\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, Debug, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum ResponseStatus {\n        Success,\n        Failure,\n    }\n}\n\npub mod snip20 {\n    use super::*;\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct Snip20InitMsg {\n        pub name: String,\n        pub admin: Option\u003cHumanAddr\u003e,\n        pub symbol: String,\n        pub decimals: u8,\n        pub initial_balances: Option\u003cVec\u003cSnip20InitialBalance\u003e\u003e,\n        pub prng_seed: Binary,\n        pub config: Option\u003cSnip20InitConfig\u003e,\n        pub callback: Option\u003cCallback\u003cHumanAddr\u003e\u003e\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\n    pub struct Snip20InitialBalance {\n        pub address: HumanAddr,\n        pub amount: Uint128,\n    }\n    \n    /// This type represents optional configuration values which can be overridden.\n    /// All values are optional and have defaults which are more private by default,\n    /// but can be overridden if necessary\n    #[derive(Serialize, Deserialize, JsonSchema, Clone, Default, Debug)]\n    pub struct Snip20InitConfig {\n        /// Indicates whether the total supply is public or should be kept secret.\n        /// default: False\n        pub public_total_supply: Option\u003cbool\u003e,\n    }\n    \n    impl Snip20InitMsg {\n        pub fn config(\u0026self) -\u003e Snip20InitConfig {\n            self.config.clone().unwrap_or_default()\n        }\n    }\n    \n    impl Snip20InitConfig {\n        pub fn public_total_supply(\u0026self) -\u003e bool {\n            self.public_total_supply.unwrap_or(false)\n        }\n    }\n}\n","traces":[{"line":339,"address":[2833504],"length":1,"stats":{"Line":0},"fn_name":"config"},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":4},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_pair.rs"],"content":"use cosmwasm_std::{Api, StdResult, Querier, HumanAddr, Uint128, CanonicalAddr};\nuse crate::token_type::TokenType;\nuse fadroma_scrt_addr::{Canonize, Humanize};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize, Deserializer, Serializer};\n\n#[derive(Clone, Debug, JsonSchema)]\npub struct TokenPair\u003cA\u003e(\n    pub TokenType\u003cA\u003e,\n    pub TokenType\u003cA\u003e\n);\nimpl Canonize\u003cTokenPair\u003cCanonicalAddr\u003e\u003e for TokenPair\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenPair\u003cCanonicalAddr\u003e\u003e {\n        Ok(TokenPair(self.0.canonize(api)?, self.1.canonize(api)?))\n    }\n}\nimpl Humanize\u003cTokenPair\u003cHumanAddr\u003e\u003e for TokenPair\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenPair\u003cHumanAddr\u003e\u003e {\n        Ok(TokenPair(self.0.humanize(api)?, self.1.humanize(api)?))\n    }\n}\n\n#[deprecated(note=\"please use TokenPair\u003cCanonicalAddr\u003e instead\")]\npub type TokenPairStored = TokenPair\u003cCanonicalAddr\u003e;\n\npub struct TokenPairIterator\u003c'a, A\u003e {\n    pair: \u0026'a TokenPair\u003cA\u003e,\n    index: u8\n}\n\nimpl\u003cA: Clone + PartialEq\u003e TokenPair\u003cA\u003e {\n    /// Returns `true` if one of the token types in the pair is the same as the argument.\n    pub fn contains(\u0026self, token: \u0026TokenType\u003cA\u003e) -\u003e bool {\n        self.0 == *token || self.1 == *token\n    }\n\n    /// Returns the index of the stored token type (0 or 1) that matches the argument.\n    /// Returns `None` if there are no matches.\n    pub fn get_token_index(\u0026self, token: \u0026TokenType\u003cA\u003e) -\u003e Option\u003cusize\u003e {\n        if self.0 == *token {\n            return Some(0);\n        } else if self.1 == *token {\n            return Some(1);\n        }\n\n        None\n    }\n\n    pub fn get_token(\u0026self, index: usize) -\u003e Option\u003c\u0026TokenType\u003cA\u003e\u003e {\n        match index {\n            0 =\u003e Some(\u0026self.0),\n            1 =\u003e Some(\u0026self.1),\n            _ =\u003e None\n        }\n    }\n}\n\nimpl TokenPair\u003cHumanAddr\u003e {\n    /// Returns the balance for each token in the pair. The order of the balances in returned array\n    /// correspond to the token order in the pair i.e `[ self.0 balance, self.1 balance ]`.\n    pub fn query_balances(\n        \u0026self,\n        querier: \u0026impl Querier,\n        exchange_addr: HumanAddr,\n        viewing_key: String\n    ) -\u003e StdResult\u003c[Uint128; 2]\u003e {\n        let amount_0 = self.0.query_balance(querier, exchange_addr.clone(), viewing_key.clone())?;\n        let amount_1 = self.1.query_balance(querier, exchange_addr, viewing_key)?;\n\n        // order is important\n        Ok([amount_0, amount_1])\n    }\n}\n\nimpl\u003cA: PartialEq\u003e PartialEq for TokenPair\u003cA\u003e {\n    fn eq(\u0026self, other: \u0026TokenPair\u003cA\u003e) -\u003e bool {\n        (self.0 == other.0 || self.0 == other.1) \u0026\u0026 (self.1 == other.0 || self.1 == other.1)\n    }\n}\n\nimpl\u003c'a, A: Clone\u003e IntoIterator for \u0026'a TokenPair\u003cA\u003e {\n    type Item = \u0026'a TokenType\u003cA\u003e;\n    type IntoIter = TokenPairIterator\u003c'a, A\u003e;\n    fn into_iter(self) -\u003e Self::IntoIter {\n        TokenPairIterator { pair: self, index: 0 }\n    }\n}\n\nimpl\u003c'a, A: Clone\u003e Iterator for TokenPairIterator\u003c'a, A\u003e {\n    type Item = \u0026'a TokenType\u003cA\u003e;\n\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        let result = match self.index {\n            0 =\u003e Some(\u0026self.pair.0),\n            1 =\u003e Some(\u0026self.pair.1),\n            _ =\u003e None\n        };\n\n        self.index += 1;\n\n        result\n    }\n}\n\n// These are only used for serde, because it doesn't work with struct tuples.\n#[derive(Serialize, Deserialize)]\npub struct TokenPairSerde\u003cA: Clone\u003e {\n    token_0: TokenType\u003cA\u003e,\n    token_1: TokenType\u003cA\u003e,\n}\n\n#[deprecated(note=\"please use TokenPairStoredSerde\u003cCanonicalAddr\u003e instead\")]\npub type TokenPairStoredSerde = TokenPairSerde\u003cCanonicalAddr\u003e;\n\nimpl\u003cA: Clone + Serialize\u003e Serialize for TokenPair\u003cA\u003e {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        TokenPairSerde { token_0: self.0.clone(), token_1: self.1.clone() }.serialize(serializer)\n    }\n}\n\nimpl\u003c'de, A: Deserialize\u003c'de\u003e + Clone\u003e Deserialize\u003c'de\u003e for TokenPair\u003cA\u003e {\n    fn deserialize\u003cD\u003e(deserializer: D) -\u003e Result\u003cSelf, D::Error\u003e\n    where\n        D: Deserializer\u003c'de\u003e,\n    {\n        Deserialize::deserialize(deserializer)\n            .map(|TokenPairSerde { token_0, token_1 }| TokenPair(token_0, token_1))\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn token_pair_equality() {\n        let pair: TokenPair\u003cHumanAddr\u003e = TokenPair(\n            TokenType::CustomToken {\n                contract_addr: \"address\".into(),\n                token_code_hash: \"hash\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"denom\".into()\n            }\n        );\n\n        let pair2 = TokenPair(pair.1.clone(), pair.0.clone());\n\n        assert_eq!(pair, pair.clone());\n        assert_eq!(pair2, pair2.clone());\n        assert_eq!(pair, pair2);\n    }\n}\n","traces":[{"line":13,"address":[604448,604861],"length":1,"stats":{"Line":2},"fn_name":"canonize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":14,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":77,"address":[792056],"length":1,"stats":{"Line":3},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[605915,605536],"length":1,"stats":{"Line":2},"fn_name":"serialize\u003ccosmwasm_std::addresses::CanonicalAddr,\u0026mut serde_json_wasm::ser::Serializer\u003e"},{"line":120,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":125,"address":[605936,606016],"length":1,"stats":{"Line":2},"fn_name":"deserialize\u003ccosmwasm_std::addresses::CanonicalAddr,serde::__private::de::missing_field::MissingFieldDeserializer\u003cserde_json_wasm::de::errors::Error\u003e\u003e"},{"line":129,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":139,"address":[636848,637056],"length":1,"stats":{"Line":3},"fn_name":"token_pair_equality"},{"line":141,"address":[636911],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[636855],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[636880],"length":1,"stats":{"Line":1},"fn_name":null},{"line":145,"address":[637071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":146,"address":[636987],"length":1,"stats":{"Line":1},"fn_name":null},{"line":150,"address":[637354,637250,637310,637502],"length":1,"stats":{"Line":3},"fn_name":null},{"line":152,"address":[637495,637547,637670],"length":1,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[637802],"length":1,"stats":{"Line":1},"fn_name":null},{"line":154,"address":[638139,638025],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":21,"coverable":46},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_pair_amount.rs"],"content":"use cosmwasm_std::{Uint128, Env, StdResult};\nuse crate::{token_type::TokenType, token_pair::TokenPair};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct TokenPairAmount\u003cA: Clone\u003e {\n    pub pair:     TokenPair\u003cA\u003e,\n    pub amount_0: Uint128,\n    pub amount_1: Uint128\n}\n\nimpl\u003cA: Clone\u003e TokenPairAmount\u003cA\u003e {\n    pub fn assert_sent_native_token_balance(\u0026self, env: \u0026Env) -\u003e StdResult\u003c()\u003e {\n        self.pair.0.assert_sent_native_token_balance(env, self.amount_0)?;\n        self.pair.1.assert_sent_native_token_balance(env, self.amount_1)?;\n\n        Ok(())\n    }\n}\n\nimpl\u003c'a, A: Clone\u003e IntoIterator for \u0026'a TokenPairAmount\u003cA\u003e {\n    type Item = (Uint128, \u0026'a TokenType\u003cA\u003e);\n    type IntoIter = TokenPairAmountIterator\u003c'a, A\u003e;\n    fn into_iter(self) -\u003e Self::IntoIter {\n        TokenPairAmountIterator {\n            pair: self,\n            index: 0\n        }\n    }\n}\n\npub struct TokenPairAmountIterator\u003c'a, A: Clone\u003e {\n    pair: \u0026'a TokenPairAmount\u003cA\u003e,\n    index: u8\n}\n\nimpl\u003c'a, A: Clone\u003e Iterator for TokenPairAmountIterator\u003c'a, A\u003e {\n    type Item = (Uint128, \u0026'a TokenType\u003cA\u003e);\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        let result = match self.index {\n            0 =\u003e Some((self.pair.amount_0, \u0026self.pair.pair.0)),\n            1 =\u003e Some((self.pair.amount_1, \u0026self.pair.pair.1)),\n            _ =\u003e None\n        };\n        self.index += 1;\n        result\n    }\n}\n","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":12},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_type.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, Api, StdResult, Querier, Uint128, StdError, Env};\nuse fadroma_scrt_addr::{Canonize, Humanize};\nuse schemars::JsonSchema;\nuse secret_toolkit::snip20;\nuse serde::{Deserialize, Serialize};\n\nconst BLOCK_SIZE: usize = 256;\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum TokenType\u003cA\u003e {\n    CustomToken {\n        contract_addr: A,\n        token_code_hash: String,\n        //viewing_key: String,\n    },\n    NativeToken {\n        denom: String,\n    },\n}\nimpl Canonize\u003cTokenType\u003cCanonicalAddr\u003e\u003e for TokenType\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenType\u003cCanonicalAddr\u003e\u003e {\n        Ok(match self {\n            Self::CustomToken { contract_addr, token_code_hash } =\u003e TokenType::CustomToken {\n                contract_addr: contract_addr.canonize(api)?,\n                token_code_hash: token_code_hash.clone()\n            },\n            Self::NativeToken { denom } =\u003e TokenType::NativeToken {\n                denom: denom.clone()\n            }\n        })\n    }\n}\nimpl Humanize\u003cTokenType\u003cHumanAddr\u003e\u003e for TokenType\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenType\u003cHumanAddr\u003e\u003e {\n        Ok(match self {\n            Self::CustomToken { contract_addr, token_code_hash } =\u003e TokenType::CustomToken {\n                contract_addr: contract_addr.humanize(api)?,\n                token_code_hash: token_code_hash.clone()\n            },\n            Self::NativeToken { denom } =\u003e TokenType::NativeToken {\n                denom: denom.clone()\n            }\n        })\n    }\n}\n\n#[deprecated(note=\"please use TokenType\u003cCanonicalAddr\u003e instead\")]\npub type TokenTypeStored = TokenType\u003cCanonicalAddr\u003e;\n\nimpl\u003cA: Clone\u003e TokenType\u003cA\u003e {\n    pub fn is_native_token(\u0026self) -\u003e bool {\n        match self {\n            TokenType::NativeToken { .. } =\u003e true,\n            TokenType::CustomToken { .. } =\u003e false,\n        }\n    }\n    pub fn is_custom_token(\u0026self) -\u003e bool {\n        match self {\n            TokenType::NativeToken { .. } =\u003e false,\n            TokenType::CustomToken { .. } =\u003e true,\n        }\n    }\n    pub fn assert_sent_native_token_balance(\u0026self, env: \u0026Env, amount: Uint128) -\u003e StdResult\u003c()\u003e {\n        if let TokenType::NativeToken { denom } = \u0026self {\n            return match env.message.sent_funds.iter().find(|x| x.denom == *denom) {\n                Some(coin) =\u003e {\n                    if amount == coin.amount {\n                        Ok(())\n                    } else {\n                        Err(StdError::generic_err(\"Native token balance missmatch between the argument and the transferred\"))\n                    }\n                }\n                None =\u003e {\n                    if amount.is_zero() {\n                        Ok(())\n                    } else {\n                        Err(StdError::generic_err(\"Native token balance missmatch between the argument and the transferred\"))\n                    }\n                }\n            }\n        }\n\n        Ok(())\n    }\n}\n\nimpl TokenType\u003cHumanAddr\u003e {\n    pub fn query_balance(\n        \u0026self,\n        querier: \u0026impl Querier,\n        exchange_addr: HumanAddr,\n        viewing_key: String\n    ) -\u003e StdResult\u003cUint128\u003e {\n        match self {\n            TokenType::NativeToken { denom } =\u003e {\n                let result = querier.query_balance(exchange_addr, denom)?;\n                Ok(result.amount)\n            },\n            TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n                let result = snip20::balance_query(\n                    querier,\n                    exchange_addr.clone(),\n                    viewing_key,\n                    BLOCK_SIZE,\n                    token_code_hash.clone(),\n                    contract_addr.clone()\n                )?;\n                Ok(result.amount)\n            }\n        }\n    }\n}\n","traces":[{"line":22,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":14,"coverable":47},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_type_amount.rs"],"content":"use cosmwasm_std::{Uint128, Env, StdResult};\nuse crate::token_type::TokenType;\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct TokenTypeAmount\u003cA\u003e {\n    pub token: TokenType\u003cA\u003e,\n    pub amount: Uint128\n}\n\nimpl\u003cA: Clone\u003e TokenTypeAmount\u003cA\u003e {\n    pub fn assert_sent_native_token_balance(\u0026self, env: \u0026Env) -\u003e StdResult\u003c()\u003e {\n        self.token.assert_sent_native_token_balance(env, self.amount)\n    }\n}\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-addr","lib.rs"],"content":"//! `HumanAddr`\u003c-\u003e`CanonicalAddr` conversion\n\nuse cosmwasm_std::{Api, CanonicalAddr, HumanAddr, StdResult};\n\npub trait Humanize\u003cT\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cT\u003e;\n}\nimpl Humanize\u003cHumanAddr\u003e for CanonicalAddr {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cHumanAddr\u003e {\n        api.human_address(self)\n    }\n}\nimpl\u003cT: Humanize\u003cU\u003e, U\u003e Humanize\u003cVec\u003cU\u003e\u003e for Vec\u003cT\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cVec\u003cU\u003e\u003e {\n        self.iter().map(|x|x.humanize(api)).collect()\n    }\n}\n\npub trait Canonize\u003cT\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cT\u003e;\n}\nimpl Canonize\u003cCanonicalAddr\u003e for HumanAddr {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCanonicalAddr\u003e {\n        api.canonical_address(self)\n    }\n}\nimpl\u003cT: Canonize\u003cU\u003e, U\u003e Canonize\u003cVec\u003cU\u003e\u003e for Vec\u003cT\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cVec\u003cU\u003e\u003e {\n        self.iter().map(|x|x.canonize(api)).collect()\n    }\n}\n","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":8},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","composable-admin","src","admin.rs"],"content":"use cosmwasm_std::{\n    HumanAddr, CanonicalAddr, StdResult, Extern, Env,\n    Api, Querier, Storage, StdError, HandleResponse,\n    Binary, to_binary\n};\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\n\nconst ADMIN_KEY: \u0026[u8] = b\"ltp5P6sFZT\";\n\npub fn admin_handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: AdminHandleMsg,\n    handle: impl AdminHandle,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        AdminHandleMsg::ChangeAdmin { address } =\u003e handle.change_admin(deps, env, address)\n    }\n}\n\npub fn admin_query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: AdminQueryMsg,\n    query: impl AdminQuery,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        AdminQueryMsg::Admin =\u003e query.query_admin(deps)\n    }\n}\n\npub trait AdminHandle {\n    fn change_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        address: HumanAddr,\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        assert_admin(deps, \u0026env)?;\n        save_admin(deps, \u0026address)?;\n    \n        Ok(HandleResponse::default())\n    }\n}\n\npub trait AdminQuery {\n    fn query_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026Extern\u003cS, A, Q\u003e\n    )-\u003e StdResult\u003cBinary\u003e {\n        let address = load_admin(deps)?;\n    \n        to_binary(\u0026AdminQueryResponse { \n            address\n        })\n    }\n}\n\npub struct DefaultHandleImpl;\n\nimpl AdminHandle for DefaultHandleImpl { }\n\npub struct DefaultQueryImpl;\n\nimpl AdminQuery for DefaultQueryImpl { }\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum AdminHandleMsg {\n    ChangeAdmin {\n        address: HumanAddr\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum AdminQueryMsg {\n    Admin\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub struct AdminQueryResponse {\n    pub address: HumanAddr\n}\n\npub fn load_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cHumanAddr\u003e {\n    let result = deps.storage.get(ADMIN_KEY);\n\n    if let Some(bytes) = result {\n        let admin = CanonicalAddr::from(bytes);\n\n        deps.api.human_address(\u0026admin)\n    } else {\n        Ok(HumanAddr::default())\n    }\n}\n\npub fn save_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003c()\u003e {\n    let admin = deps.api.canonical_address(address)?;\n    deps.storage.set(ADMIN_KEY, \u0026admin.as_slice());\n\n    Ok(())\n}\n\npub fn assert_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    env: \u0026Env\n) -\u003e StdResult\u003c()\u003e {\n    let admin = load_admin(deps)?;\n\n    if admin == env.message.sender {\n        return Ok(());\n    }\n\n    Err(StdError::unauthorized())\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::from_binary;\n    use cosmwasm_std::testing::{mock_dependencies, mock_env};\n\n    #[test]\n    fn test_handle() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let admin = HumanAddr::from(\"admin\");\n        save_admin(deps, \u0026admin).unwrap();\n\n        let msg = AdminHandleMsg::ChangeAdmin { \n            address: HumanAddr::from(\"will fail\")\n        };\n\n        let result = admin_handle(\n            deps,\n            mock_env(\"unauthorized\", \u0026[]),\n            msg,\n            DefaultHandleImpl\n        ).unwrap_err();\n        \n        match result {\n            StdError::Unauthorized { .. } =\u003e { },\n            _ =\u003e panic!(\"Expected \\\"StdError::Unauthorized\\\"\")\n        };\n\n        let new_admin = HumanAddr::from(\"new_admin\");\n\n        let msg = AdminHandleMsg::ChangeAdmin { \n            address: new_admin.clone()\n        };\n\n        admin_handle(\n            deps,\n            mock_env(admin, \u0026[]),\n            msg,\n            DefaultHandleImpl\n        ).unwrap();\n\n        assert!(load_admin(deps).unwrap() == new_admin);\n    }\n\n    #[test]\n    fn test_query() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let result = admin_query(deps, AdminQueryMsg::Admin, DefaultQueryImpl).unwrap();\n\n        let response: AdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.address == HumanAddr::default());\n\n        let admin = HumanAddr::from(\"admin\");\n        save_admin(deps, \u0026admin).unwrap();\n\n        let result = admin_query(deps, AdminQueryMsg::Admin, DefaultQueryImpl).unwrap();\n\n        let response: AdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.address == admin);\n    }\n}\n","traces":[{"line":11,"address":[609520,609689],"length":1,"stats":{"Line":1},"fn_name":"admin_handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::admin::DefaultHandleImpl\u003e"},{"line":18,"address":[609561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":22,"address":[609780,609728],"length":1,"stats":{"Line":1},"fn_name":"admin_query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::admin::DefaultQueryImpl\u003e"},{"line":28,"address":[609753],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":87,"address":[611523,611120],"length":1,"stats":{"Line":2},"fn_name":"load_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":90,"address":[611149],"length":1,"stats":{"Line":2},"fn_name":null},{"line":92,"address":[611188,611346],"length":1,"stats":{"Line":3},"fn_name":null},{"line":93,"address":[611239],"length":1,"stats":{"Line":3},"fn_name":null},{"line":95,"address":[611439],"length":1,"stats":{"Line":3},"fn_name":null},{"line":97,"address":[611291],"length":1,"stats":{"Line":1},"fn_name":null},{"line":101,"address":[612002,611600,612017],"length":1,"stats":{"Line":2},"fn_name":"save_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":105,"address":[611638,611783],"length":1,"stats":{"Line":2},"fn_name":null},{"line":106,"address":[611883,611751],"length":1,"stats":{"Line":4},"fn_name":null},{"line":108,"address":[611979],"length":1,"stats":{"Line":3},"fn_name":null},{"line":111,"address":[612410,612032,612425],"length":1,"stats":{"Line":2},"fn_name":"assert_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":115,"address":[612196,612070],"length":1,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[612286,612174],"length":1,"stats":{"Line":4},"fn_name":null},{"line":118,"address":[612351],"length":1,"stats":{"Line":2},"fn_name":null},{"line":121,"address":[612327,612376],"length":1,"stats":{"Line":2},"fn_name":null},{"line":131,"address":[558464,559731],"length":1,"stats":{"Line":3},"fn_name":"test_handle"},{"line":132,"address":[558471],"length":1,"stats":{"Line":1},"fn_name":null},{"line":134,"address":[558535],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[558639,558566],"length":1,"stats":{"Line":2},"fn_name":null},{"line":138,"address":[558699],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[558770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[558809],"length":1,"stats":{"Line":1},"fn_name":null},{"line":149,"address":[558956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":150,"address":[558998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[558967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":156,"address":[559087],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[559134],"length":1,"stats":{"Line":1},"fn_name":null},{"line":162,"address":[559247],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[559596,559422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":170,"address":[559760,560657],"length":1,"stats":{"Line":3},"fn_name":"test_query"},{"line":171,"address":[559767],"length":1,"stats":{"Line":1},"fn_name":null},{"line":173,"address":[559815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[559905],"length":1,"stats":{"Line":1},"fn_name":null},{"line":176,"address":[560180,560001,560075],"length":1,"stats":{"Line":2},"fn_name":null},{"line":178,"address":[560149],"length":1,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[560233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[560316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[560369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[560540,560463],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":50,"coverable":51},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","composable-admin","src","lib.rs"],"content":"pub use require_admin::require_admin;\n\npub mod multi_admin;\npub mod admin;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","composable-admin","src","multi_admin.rs"],"content":"use cosmwasm_std::{\n    HumanAddr, CanonicalAddr, StdResult, Extern, Env,\n    Api, Querier, Storage, to_vec, StdError, HandleResponse,\n    Binary, to_binary, from_slice, ReadonlyStorage\n};\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\nuse serde::de::DeserializeOwned;\n\nconst ADMINS_KEY: \u0026[u8] = b\"i801onL3kf\";\n\npub fn multi_admin_handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: MultiAdminHandleMsg,\n    handle: impl MultiAdminHandle,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        MultiAdminHandleMsg::AddAdmins { addresses } =\u003e handle.add_admins(deps, env, addresses)\n    }\n}\n\npub fn multi_admin_query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: MultiAdminQueryMsg,\n    query: impl MultiAdminQuery,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        MultiAdminQueryMsg::Admins =\u003e query.query_admins(deps)\n    }\n}\n\npub trait MultiAdminHandle {\n    fn add_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        addresses: Vec\u003cHumanAddr\u003e,\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        assert_admin(deps, \u0026env)?;\n        save_admins(deps, \u0026addresses)?;\n    \n        Ok(HandleResponse::default())\n    }\n}\n\npub trait MultiAdminQuery {\n    fn query_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026Extern\u003cS, A, Q\u003e\n    )-\u003e StdResult\u003cBinary\u003e {\n        let addresses = load_admins(deps)?;\n    \n        to_binary(\u0026MultiAdminQueryResponse { \n            addresses\n        })\n    }\n}\n\npub struct DefaultHandleImpl;\n\nimpl MultiAdminHandle for DefaultHandleImpl { }\n\npub struct DefaultQueryImpl;\n\nimpl MultiAdminQuery for DefaultQueryImpl { }\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum MultiAdminHandleMsg {\n    AddAdmins {\n        addresses: Vec\u003cHumanAddr\u003e,\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum MultiAdminQueryMsg {\n    Admins\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub struct MultiAdminQueryResponse {\n    pub addresses: Vec\u003cHumanAddr\u003e\n}\n\npub fn save_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    addresses: \u0026Vec\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let mut admins: Vec\u003cCanonicalAddr\u003e = \n        load(\u0026deps.storage, ADMINS_KEY).unwrap_or(vec![]);\n    \n    for address in addresses {\n        let canonical = deps.api.canonical_address(address)?;\n        admins.push(canonical);\n    }\n\n    deps.storage.set(ADMINS_KEY, \u0026to_vec(\u0026admins)?);\n\n    Ok(())\n}\n\npub fn load_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cVec\u003cHumanAddr\u003e\u003e {\n    let admins: Vec\u003cCanonicalAddr\u003e =\n        load(\u0026deps.storage, ADMINS_KEY).unwrap_or(vec![]);\n    \n    let mut result = Vec::with_capacity(admins.len());\n\n    for admin in admins {\n        result.push(deps.api.human_address(\u0026admin)?)\n    }\n\n    Ok(result)\n}\n\npub fn assert_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    env: \u0026Env,\n) -\u003e StdResult\u003c()\u003e {\n    let admins = load_admins(deps)?;\n\n    if admins.contains(\u0026env.message.sender) {\n        return Ok(());\n    }\n\n    Err(StdError::unauthorized())\n}\n\nfn load\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cT\u003e {\n    let result = storage.get(key).ok_or_else(||\n        StdError::SerializeErr { \n            source: \"load\".into(),\n            msg: \"key not found\".into(),\n            backtrace: None\n        }\n    )?;\n    \n    from_slice(\u0026result)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::from_binary;\n    use cosmwasm_std::testing::{mock_dependencies, mock_env};\n\n    #[test]\n    fn test_handle() {\n        const ADMIN: \u0026str = \"goshu\";\n\n        fn run_msg\u003cS: Storage, A: Api, Q: Querier\u003e(\n            deps: \u0026mut Extern\u003cS, A, Q\u003e,\n            addresses: Vec\u003cHumanAddr\u003e,\n            assert_len: usize\n        ) {\n            let msg = MultiAdminHandleMsg::AddAdmins {\n                addresses\n            };\n    \n            let result = multi_admin_handle(\n                deps,\n                mock_env(HumanAddr::from(ADMIN), \u0026[]),\n                msg,\n                DefaultHandleImpl\n            );\n    \n            assert!(result.is_ok());\n    \n            let admins = load_admins(deps).unwrap();\n            assert!(\n                admins.len() == assert_len,\n                \"Assert admins.len() failed: Expected: {}, Got: {}\", admins.len(), assert_len\n            );\n        }\n\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let admin = HumanAddr::from(\"goshu\");\n        save_admins(deps, \u0026vec![ admin.clone() ]).unwrap();\n\n        let msg = MultiAdminHandleMsg::AddAdmins {\n            addresses: vec![ HumanAddr::from(\"will fail\") ]\n        };\n\n        let result = multi_admin_handle(\n            deps,\n            mock_env(HumanAddr::from(\"unauthorized\"), \u0026[]),\n            msg,\n            DefaultHandleImpl\n        )\n        .unwrap_err();\n\n        match result {\n            StdError::Unauthorized { .. } =\u003e { },\n            _ =\u003e panic!(\"Expected \\\"StdError::Unauthorized\\\"\")\n        };\n\n        run_msg(deps, vec![], 1);\n\n        run_msg(\n            deps,\n            vec![\n                HumanAddr::from(\"archer\"),\n                HumanAddr::from(\"lana\")\n            ],\n            3\n        );\n\n        run_msg(\n            deps,\n            vec![\n                HumanAddr::from(\"pam\"),\n            ],\n            4\n        );\n    }\n\n    #[test]\n    fn test_query() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let result = multi_admin_query(deps, MultiAdminQueryMsg::Admins, DefaultQueryImpl).unwrap();\n\n        let response: MultiAdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.addresses.len() == 0);\n\n        let admins = vec![\n            HumanAddr::from(\"archer\"),\n            HumanAddr::from(\"lana\")\n        ];\n\n        save_admins(deps, \u0026admins).unwrap();\n\n        let result = multi_admin_query(deps, MultiAdminQueryMsg::Admins, DefaultQueryImpl).unwrap();\n\n        let response: MultiAdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.addresses == admins);\n    }\n}\n","traces":[{"line":12,"address":[525120,525289],"length":1,"stats":{"Line":2},"fn_name":"multi_admin_handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::multi_admin::DefaultHandleImpl\u003e"},{"line":19,"address":[525161],"length":1,"stats":{"Line":2},"fn_name":null},{"line":23,"address":[525380,525328],"length":1,"stats":{"Line":2},"fn_name":"multi_admin_query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::multi_admin::DefaultQueryImpl\u003e"},{"line":29,"address":[525353],"length":1,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[526927,526720],"length":1,"stats":{"Line":8},"fn_name":"save_admins\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":92,"address":[526763],"length":1,"stats":{"Line":8},"fn_name":null},{"line":95,"address":[526964,527115,526904,527024,527622],"length":1,"stats":{"Line":40},"fn_name":null},{"line":96,"address":[527355,527572,527147],"length":1,"stats":{"Line":8},"fn_name":null},{"line":97,"address":[527287],"length":1,"stats":{"Line":8},"fn_name":null},{"line":100,"address":[527100,528103,527683,528048],"length":1,"stats":{"Line":24},"fn_name":null},{"line":102,"address":[528189],"length":1,"stats":{"Line":8},"fn_name":null},{"line":105,"address":[528224,528426],"length":1,"stats":{"Line":6},"fn_name":"load_admins\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":108,"address":[528254],"length":1,"stats":{"Line":6},"fn_name":null},{"line":111,"address":[528466,528411],"length":1,"stats":{"Line":12},"fn_name":null},{"line":113,"address":[528761,528690,528511,528794,529486],"length":1,"stats":{"Line":26},"fn_name":null},{"line":114,"address":[528938,529033],"length":1,"stats":{"Line":14},"fn_name":null},{"line":117,"address":[529530],"length":1,"stats":{"Line":6},"fn_name":null},{"line":120,"address":[530075,529664,530090],"length":1,"stats":{"Line":5},"fn_name":"assert_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":124,"address":[529829,529702],"length":1,"stats":{"Line":5},"fn_name":null},{"line":126,"address":[529985,529930,529806],"length":1,"stats":{"Line":18},"fn_name":null},{"line":127,"address":[530015],"length":1,"stats":{"Line":2},"fn_name":null},{"line":130,"address":[530042,529991],"length":1,"stats":{"Line":11},"fn_name":null},{"line":133,"address":[530445,530096,530460],"length":1,"stats":{"Line":8},"fn_name":"load\u003calloc::vec::Vec\u003ccosmwasm_std::addresses::CanonicalAddr, alloc::alloc::Global\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":134,"address":[530677,530689,530348,530205,530137,530464],"length":1,"stats":{"Line":27},"fn_name":"{{closure}}\u003calloc::vec::Vec\u003ccosmwasm_std::addresses::CanonicalAddr, alloc::alloc::Global\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":135,"address":[530546],"length":1,"stats":{"Line":9},"fn_name":null},{"line":136,"address":[530477],"length":1,"stats":{"Line":9},"fn_name":null},{"line":137,"address":[530500],"length":1,"stats":{"Line":9},"fn_name":null},{"line":138,"address":[530537],"length":1,"stats":{"Line":9},"fn_name":null},{"line":142,"address":[530259,530390],"length":1,"stats":{"Line":14},"fn_name":null},{"line":152,"address":[570576,572033],"length":1,"stats":{"Line":3},"fn_name":"test_handle"},{"line":155,"address":[573152,574017],"length":1,"stats":{"Line":1},"fn_name":"run_msg\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":166,"address":[573242],"length":1,"stats":{"Line":1},"fn_name":null},{"line":167,"address":[573351],"length":1,"stats":{"Line":1},"fn_name":null},{"line":171,"address":[573509,573424],"length":1,"stats":{"Line":1},"fn_name":null},{"line":173,"address":[573541,573502],"length":1,"stats":{"Line":2},"fn_name":null},{"line":174,"address":[573717,573607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[573579],"length":1,"stats":{"Line":1},"fn_name":null},{"line":176,"address":[573681],"length":1,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[570583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[570627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[570876,570668,570742],"length":1,"stats":{"Line":3},"fn_name":null},{"line":186,"address":[570989],"length":1,"stats":{"Line":1},"fn_name":null},{"line":191,"address":[571175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[571279],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[571383],"length":1,"stats":{"Line":1},"fn_name":null},{"line":199,"address":[571409],"length":1,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[571402,571498],"length":1,"stats":{"Line":2},"fn_name":null},{"line":206,"address":[571515,571593],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[571531],"length":1,"stats":{"Line":1},"fn_name":null},{"line":208,"address":[571562],"length":1,"stats":{"Line":1},"fn_name":null},{"line":215,"address":[571790,571837],"length":1,"stats":{"Line":2},"fn_name":null},{"line":216,"address":[571806],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[572064,573088],"length":1,"stats":{"Line":3},"fn_name":"test_query"},{"line":224,"address":[572071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":226,"address":[572119],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[572209],"length":1,"stats":{"Line":1},"fn_name":null},{"line":229,"address":[572292,572421],"length":1,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[572484,572374],"length":1,"stats":{"Line":1},"fn_name":null},{"line":232,"address":[572390],"length":1,"stats":{"Line":1},"fn_name":null},{"line":233,"address":[572453],"length":1,"stats":{"Line":1},"fn_name":null},{"line":236,"address":[572669],"length":1,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[572751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":240,"address":[572804],"length":1,"stats":{"Line":1},"fn_name":null},{"line":241,"address":[572975,572898],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":70,"coverable":72},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","require-admin","src","lib.rs"],"content":"use proc_macro::TokenStream;\nuse syn::{FnArg, ItemFn, PathArguments, Stmt, Type, parse_macro_input, parse_quote, Pat, PatIdent};\nuse syn::punctuated::Punctuated;\nuse syn::token::Comma;\nuse quote::quote;\n\n#[proc_macro_attribute]\npub fn require_admin(_attr: TokenStream, func: TokenStream) -\u003e TokenStream {\n    let mut ast = parse_macro_input!(func as ItemFn);\n\n    let (deps, env) = find_extern_arg(\u0026ast.sig.inputs);\n\n    let stmt = create_require_admin_stmt(deps, env);\n    ast.block.stmts.insert(0, stmt);\n\n    let result = quote! {\n        #ast\n    };\n\n    TokenStream::from(result)\n}\n\nfn find_extern_arg(args: \u0026Punctuated\u003cFnArg, Comma\u003e) -\u003e (PatIdent, PatIdent) {\n    let mut deps: Option\u003cPatIdent\u003e = None;\n    let mut env: Option\u003cPatIdent\u003e = None;\n\n    for arg in args {\n        match arg {\n            FnArg::Typed(item) =\u003e {\n                match item.ty.as_ref() {\n                    Type::Reference(reference) =\u003e {\n                        match reference.elem.as_ref() {\n                            Type::Path(type_path) =\u003e {\n                                let result = type_path.path.segments.iter()\n                                    .find(|i| {\n                                        if let PathArguments::AngleBracketed(_) = i.arguments {\n                                            if i.ident.to_string() == \"Extern\" {\n                                                return true\n                                            }\n                                        }\n\n                                        false\n                                    });\n\n                                if let Some(_) = result {\n                                    if let Pat::Ident(ident) = item.pat.as_ref() {\n                                        deps = Some(ident.clone())\n                                    }\n                                }\n                            },\n                            _ =\u003e continue\n                        }\n                    },\n                    Type::Path(type_path) =\u003e {\n                        let result = type_path.path.segments.iter()\n                            .find(|i| {\n                                if i.ident.to_string() == \"Env\" {\n                                    return true\n                                }\n                    \n                                false\n                            });\n                \n                        if let Some(_) = result {\n                            if let Pat::Ident(ident) = item.pat.as_ref() {\n                                env = Some(ident.clone())\n                            }\n                        }\n                    }\n                    _ =\u003e continue\n                }\n            },\n            _ =\u003e continue\n        }\n    }\n    \n    return (\n        deps.unwrap_or_else(|| panic!(\"Couldn't find argument of type \\\"Extern\u003cStorage, Api, Querier\u003e\\\"\")),\n        env.unwrap_or_else(|| panic!(\"Couldn't find arguments of type \\\"Env\\\"\"))\n    );\n}\n\nfn create_require_admin_stmt(deps: PatIdent, env: PatIdent) -\u003e Stmt {\n    let code = quote! {\n        assert_admin(#deps, \u0026#env)?;\n    };\n\n    parse_quote!(#code)\n}\n","traces":[{"line":8,"address":[267392,268760,268775],"length":1,"stats":{"Line":0},"fn_name":"require_admin"},{"line":9,"address":[267530,267423,267625],"length":1,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[267599,267840],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[268048],"length":1,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[268325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[268435,268599],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[268644,268526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[270704,268784],"length":1,"stats":{"Line":0},"fn_name":"find_extern_arg"},{"line":24,"address":[268828],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[268863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[269111,268882,269585,268986,269087],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[269148],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[269183],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[269211,269301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[269316],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[269344],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[269376],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[276110,275984],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":36,"address":[276003,276132,276034],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[276126,276043,276018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[276134],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[276036],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[269583,269529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[269560,269637,269784,269595],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[269789,269639,269618],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[269247],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[269860,269262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[276255,276160],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":57,"address":[276271,276174],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[276284],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[276277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[270026,269972],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[270078,270003,270036,270228],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[270083,270059,270233],"length":1,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[270556],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[270294],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[270421],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[270736,271456],"length":1,"stats":{"Line":0},"fn_name":"create_require_admin_stmt"},{"line":84,"address":[270846,270765],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[271248,271167],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":40},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-auth","composable-auth","src","lib.rs"],"content":"pub use cosmwasm_utils::viewing_key::{ViewingKey, VIEWING_KEY_SIZE};\n\nuse cosmwasm_std::{\n    StdResult, Extern, Env, Api, Querier, Storage,\n    StdError, HandleResponse, to_binary\n};\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\nuse cosmwasm_utils::storage::{ns_save, ns_load};\n\nconst VIEWING_KEYS: \u0026[u8] = b\"XXzo7ZXRJ2\";\n\npub fn auth_handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: AuthHandleMsg,\n    handle: impl AuthHandle,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        AuthHandleMsg::CreateViewingKey { entropy, .. } =\u003e\n            handle.create_viewing_key(deps, env, entropy),\n        AuthHandleMsg::SetViewingKey { key, .. } =\u003e \n            handle.set_viewing_key(deps, env, key)\n    }\n}\n\npub trait AuthHandle {\n    fn create_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        entropy: String\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        let prng_seed = [ \n            env.block.time.to_be_bytes(),\n            env.block.height.to_be_bytes() \n        ].concat();\n\n        let key = ViewingKey::new(\u0026env, \u0026prng_seed, \u0026(entropy).as_ref());\n        let address = deps.api.canonical_address(\u0026env.message.sender)?;\n        save_viewing_key(deps, address.as_slice(), \u0026key)?;\n\n        Ok(HandleResponse {\n            messages: vec![],\n            log: vec![],\n            data: Some(to_binary(\u0026CreateViewingKeyData {\n                key: key.0\n            })?)\n        })\n    }\n\n    fn set_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        key: String\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        let key = ViewingKey(key);\n        let address = deps.api.canonical_address(\u0026env.message.sender)?;\n        save_viewing_key(deps, address.as_slice(), \u0026key)?;\n\n        Ok(HandleResponse::default())\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum AuthHandleMsg {\n    CreateViewingKey {\n        entropy: String,\n        padding: Option\u003cString\u003e,\n    },\n    SetViewingKey {\n        key: String,\n        padding: Option\u003cString\u003e,\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub struct CreateViewingKeyData {\n    pub key: String\n}\n\npub struct DefaultHandleImpl;\n\nimpl AuthHandle for DefaultHandleImpl { }\n\n#[inline]\npub fn save_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    key: \u0026[u8],\n    viewing_key: \u0026ViewingKey\n) -\u003e StdResult\u003c()\u003e {\n    ns_save(\u0026mut deps.storage, VIEWING_KEYS, key, \u0026viewing_key)\n}\n\n#[inline]\npub fn load_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    key: \u0026[u8],\n) -\u003e StdResult\u003cOption\u003cViewingKey\u003e\u003e {\n    ns_load(\u0026deps.storage, VIEWING_KEYS, key)\n}\n\npub fn authenticate(\n    storage: \u0026impl Storage,\n    provided_key: \u0026ViewingKey,\n    storage_key: \u0026[u8]\n) -\u003e StdResult\u003c()\u003e {\n    let stored_vk: Option\u003cViewingKey\u003e = ns_load(storage, VIEWING_KEYS, storage_key)?;\n\n    if let Some(key) = stored_vk {\n        if provided_key.check_viewing_key(\u0026key.to_hashed()) {\n            return Ok(());\n        }\n    }\n\n    provided_key.check_viewing_key(\u0026[0u8; VIEWING_KEY_SIZE]);\n\n    return Err(StdError::unauthorized());\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::{from_binary, HumanAddr};\n    use cosmwasm_std::testing::{mock_dependencies, mock_env};\n\n    #[test]\n    fn test_handle() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let sender = HumanAddr(\"sender\".into());\n        let sender_canonical = deps.api.canonical_address(\u0026sender).unwrap();\n        let env = mock_env(sender, \u0026[]);\n\n        let result = auth_handle(\n            deps,\n            env.clone(),\n            AuthHandleMsg::CreateViewingKey { entropy: \"123\".into(), padding: None },\n            DefaultHandleImpl\n        ).unwrap();\n\n        let created_vk: CreateViewingKeyData = from_binary(\u0026result.data.unwrap()).unwrap();\n        let created_vk = ViewingKey(created_vk.key);\n        \n        assert_eq!(created_vk, load_viewing_key(deps, sender_canonical.as_slice()).unwrap().unwrap());\n\n        let auth_result = authenticate(\u0026deps.storage, \u0026ViewingKey(\"invalid\".into()), sender_canonical.as_slice());\n        assert_eq!(auth_result.unwrap_err(), StdError::unauthorized());\n\n        let auth_result = authenticate(\u0026deps.storage, \u0026created_vk, sender_canonical.as_slice());\n        assert!(auth_result.is_ok());\n\n        let new_key = String::from(\"new_key\");\n\n        auth_handle(\n            deps,\n            env.clone(),\n            AuthHandleMsg::SetViewingKey { key: new_key.clone(), padding: None },\n            DefaultHandleImpl\n        ).unwrap();\n\n        assert_eq!(ViewingKey(new_key.clone()), load_viewing_key(deps, sender_canonical.as_slice()).unwrap().unwrap());\n\n        let auth_result = authenticate(\u0026deps.storage, \u0026ViewingKey(new_key), sender_canonical.as_slice());\n        assert!(auth_result.is_ok());\n    }\n}\n","traces":[{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-callback","lib.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, StdResult, Api, Binary};\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n/// Info needed to instantiate a contract.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInstantiationInfo {\n    pub code_hash: String,\n    pub id: u64\n}\n\n/// Info needed to talk to a contract instance.\n#[derive(Default, Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInstance\u003cA\u003e {\n    pub address: A,\n    pub code_hash: String\n}\nimpl Canonize\u003cContractInstance\u003cCanonicalAddr\u003e\u003e for ContractInstance\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractInstance\u003cCanonicalAddr\u003e\u003e {\n        Ok(ContractInstance {\n            address:   self.address.canonize(api)?,\n            code_hash: self.code_hash.clone()\n        })\n    }\n}\nimpl Humanize\u003cContractInstance\u003cHumanAddr\u003e\u003e for ContractInstance\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractInstance\u003cHumanAddr\u003e\u003e {\n        Ok(ContractInstance {\n            address:   self.address.humanize(api)?,\n            code_hash: self.code_hash.clone()\n        })\n    }\n}\n\n#[deprecated(note=\"Please use ContractInstance\u003cHumanAddr\u003e instead.\")]\npub type ContractInfo = ContractInstance\u003cHumanAddr\u003e;\n\n#[deprecated(note=\"Please use ContractInstance\u003cCanonicalAddr\u003e instead.\")]\npub type ContractInfoStored = ContractInstance\u003cCanonicalAddr\u003e;\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n/// Info needed to have the other contract respond.\npub struct Callback\u003cA\u003e {\n    /// The message to call.\n    pub msg: Binary,\n    /// Info about the contract requesting the callback.\n    pub contract: ContractInstance\u003cA\u003e\n}\nimpl Canonize\u003cCallback\u003cCanonicalAddr\u003e\u003e for Callback\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCallback\u003cCanonicalAddr\u003e\u003e {\n        Ok(Callback { msg: self.msg.clone(), contract: self.contract.canonize(api)? })\n    }\n}\nimpl Humanize\u003cCallback\u003cHumanAddr\u003e\u003e for Callback\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCallback\u003cHumanAddr\u003e\u003e {\n        Ok(Callback { msg: self.msg.clone(), contract: self.contract.humanize(api)? })\n    }\n}\n\n#[deprecated(note=\"Please use Callback\u003cCanonicalAddr\u003e instead.\")]\npub type CallbackStored = Callback\u003cCanonicalAddr\u003e;\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":22,"address":[786744,786614],"length":1,"stats":{"Line":8},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":28,"address":[569216,569612,569627],"length":1,"stats":{"Line":3},"fn_name":"humanize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":29,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":8,"coverable":12},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-contract","lib.rs"],"content":"//! # Fadroma\n\n/// Import commonly used definitions that need to be available everywhere in the contract\n#[macro_export] macro_rules! prelude {\n    () =\u003e { use cosmwasm_std::{\n        Storage, Api, Querier, Extern, Env,\n        HumanAddr, CanonicalAddr, Coin, Uint128,\n        StdResult, StdError,\n        InitResponse, HandleResponse, LogAttribute, Binary,\n        CosmosMsg, BankMsg, WasmMsg, to_binary,\n        log\n    }; };\n}\n\n/// Define an enum that implements the necessary traits\n/// (de/serialization, schema generation, cloning, debug printing, equality comparison)\n#[macro_export] macro_rules! message {\n    ( $Msg:ident { $( $(#[$meta:meta])* $field:ident : $type:ty ),* } ) =\u003e {\n        #[derive(serde::Serialize,serde::Deserialize,Clone,Debug,PartialEq,schemars::JsonSchema)]\n        #[serde(rename_all = \"snake_case\")]\n        pub struct $Msg { $( $(#[$meta])* pub $field: $type ),* } } }\n\n/// Define an enum with variants that implement the necessary traits\n#[macro_export] macro_rules! messages {\n    ( $( $Enum:ident { $( $(#[$meta:meta])* $Msg:ident { $( $field:ident : $type:ty ),* } )* } )*\n    ) =\u003e { $(\n        #[derive(serde::Serialize,serde::Deserialize,Clone,Debug,PartialEq,schemars::JsonSchema)]\n        #[serde(rename_all = \"snake_case\")]\n        pub enum $Enum { $( $(#[$meta])* $Msg { $($field : $type),* } ),* } )* } }\n\n/// Define the state singleton.\n// TODO: Support other shapes of state\n#[macro_export] macro_rules! define_state_singleton {\n    (\n        $State:ident\n        { $( $(#[$meta:meta])* $state_field:ident : $state_field_type:ty ),* }\n    ) =\u003e {\n        /// State singleton\n        message!($State { $($(#[$meta])* $state_field:$state_field_type),* });\n        use cosmwasm_storage::{Singleton, singleton, ReadonlySingleton, singleton_read};\n        pub static CONFIG_KEY: \u0026[u8] = b\"fadroma_root_state\";\n        pub fn get_store_rw\u003cS: Storage\u003e(storage: \u0026mut S) -\u003e Singleton\u003cS, $State\u003e {\n            singleton(storage, CONFIG_KEY)\n        }\n        pub fn get_store_ro\u003cS: Storage\u003e(storage: \u0026S) -\u003e ReadonlySingleton\u003cS, $State\u003e {\n            singleton_read(storage, CONFIG_KEY)\n        }\n    }\n}\n\n/// Instantiation interface.\n#[macro_export] macro_rules! define_init_message {\n    // if imported:\n    ($_:ident, $Import:ident) =\u003e { pub use super::$Import; };\n    // if defined in place:\n    ($Name:ident, { $(\n        $(#[$meta:meta])* $arg:ident : $type:ty\n    ),* }) =\u003e {\n        message!($Name { $($arg: $type),* });\n    }\n}\n\n/// Query interface.\n#[macro_export] macro_rules! define_q_messages {\n    // if imported:\n    ($_1:tt, $Import:ident, { $($_2:tt)* }) =\u003e { pub use super::$Import; };\n    // if defined in place:\n    ($Name:ident, { $(\n        $(#[$meta:meta])* $Variant:ident ( $($arg:ident : $type:ty),* )\n    )* }) =\u003e {\n        messages!($Name { $( $(#[$meta])* $Variant {$($arg: $type),*} )* });\n    };\n}\n\n/// Transaction interface.\n#[macro_export] macro_rules! define_tx_messages {\n    // if imported:\n    ($_1:tt, $Import:ident, { $($_2:tt)* }) =\u003e { pub use super::$Import; };\n    // if defined in place:\n    ($Name:ident, { $(\n        $(#[$meta:meta])* $Variant:ident ( $($arg:ident : $type:ty),* )\n    )* }) =\u003e {\n        messages!($Name { $( $(#[$meta])* $Variant {$($arg: $type),*} )* });\n    };\n}\n\n/// Instatiation. Either defines or imports an `InitMsg`, and hooks up your init logic to it.\n/// Function body must return the initial value of `State`.\n#[macro_export] macro_rules! implement_init {\n    // define the InitMsg in place:\n    (\n        $(#[$InitMeta:meta])* [$Init:ident]\n        ($deps:ident, $env:ident, $msg:ident :{ $($field:ident : $type:ty),* }) $body:block\n    ) =\u003e {\n        use msg::$Init;\n        $(#[$InitMeta])*\n        pub fn init \u003cS: Storage, A: Api, Q: Querier\u003e(\n            $deps: \u0026mut Extern\u003cS, A, Q\u003e, $env: Env, $msg: $Init\n        ) -\u003e StdResult\u003cInitResponse\u003e {\n            $(let $field : $type = $msg.$field;)*\n            get_store_rw(\u0026mut $deps.storage).save(\u0026$body)?;\n            Ok(InitResponse::default())\n        }\n    };\n    // or import it from an external module:\n    (\n        $(#[$InitMeta:meta])* [$_:ident]\n        ($deps:ident, $env:ident, $msg:ident : $InitExt:ty ) $body:block\n    ) =\u003e {\n        $(#[$InitMeta])*\n        pub fn init \u003cS: Storage, A: Api, Q: Querier\u003e(\n            $deps: \u0026mut Extern\u003cS, A, Q\u003e, $env: Env, $msg: $InitExt\n        ) -\u003e StdResult\u003cInitResponse\u003e {\n            // no auto-destructuring\n            get_store_rw(\u0026mut $deps.storage).save(\u0026$body)?;\n            Ok(InitResponse::default())\n        }\n    };\n}\n\n/// Query implementations.\n#[macro_export] macro_rules! implement_queries {\n    // for external query message type, ignore the name in the brackets\n    // and pass through to the next macro variantb\n    (\n        $State:ident, $EnumExt:ident, $_:ident\n        ( $deps:ident, $state:ident, $msg:ident ) -\u003e $Response:ident { $($bodies:tt)* }\n    ) =\u003e {\n        implement_queries!($State, $EnumExt ( $deps, $state, $msg ) -\u003e $Response { $($bodies)* });\n    };\n\n    // implement queries defined in $body\n    (\n        $State:ident, $Enum:ident\n        ( $deps:ident, $state:ident, $msg:ident ) -\u003e $Response:ident { $(\n            $(#[$meta:meta])* $Variant:ident ( $($field:ident : $type:ty),*)\n            $body:tt\n        )* }\n    ) =\u003e {\n        /// Query dispatcher.\n        pub fn query \u003cS: Storage, A: Api, Q: Querier\u003e (\n            $deps: \u0026Extern\u003cS, A, Q\u003e, $msg: msg::$Enum\n        ) -\u003e StdResult\u003cBinary\u003e {\n            let state = get_store_ro(\u0026$deps.storage).load()?; // get snapshot of contract state\n            let result = match $msg { $( // find the matching handler\n                msg::$Enum::$Variant {..} =\u003e self::queries::$Variant($deps, state, $msg),\n            )* };\n            Ok(cosmwasm_std::to_binary(\u0026result?)?) // return handler result\n        }\n        /// Query handlers.\n        mod queries {\n            prelude!();\n            use super::{*, msg::Response};\n            // for every query message variant, define a handler \n            $(\n                $(#[$meta])*\n                #[allow(non_snake_case)]\n                pub fn $Variant \u003cS: Storage, A: Api, Q: Querier\u003e(\n                    $deps: \u0026Extern\u003cS, A, Q\u003e, $state: $State, $msg: msg::$Enum,\n                ) -\u003e StdResult\u003c$Response\u003e {\n                    if let super::msg::$Enum::$Variant {$($field),*} = $msg { // destructure the message\n                        $body // perform user-specified actions\n                    } else { unreachable!() }\n                }\n            )*\n        }\n\n    }\n}\n\n/// Transaction implementations\n#[macro_export] macro_rules! implement_transactions {\n    (   $State:ident, $Enum:ident, $_:ident\n        ($deps:ident, $env:ident, $state:ident, $msg:ident) -\u003e $Response:ident { $($bodies:tt)* }\n    ) =\u003e {\n        implement_transactions!($State, $Enum ($deps, $env, $state, $msg) -\u003e $Response { $($bodies)* });\n    };\n    (   $State:ident, $Enum:ident\n        ($deps:ident, $env:ident, $state:ident, $msg:ident) -\u003e $Response:ident {\n            $($(#[$meta:meta])* $Variant:ident ( $($arg:ident $(: $type:ty)?),* ) $body:block)*\n        }\n    ) =\u003e {\n        /// Transaction dispatcher\n        pub fn handle \u003cS: Storage, A: Api, Q: Querier\u003e (\n            $deps: \u0026mut Extern\u003cS, A, Q\u003e, $env: Env, $msg: msg::$Enum,\n        ) -\u003e StdResult\u003cHandleResponse\u003e {\n            // pick the handler that matches the message and call it:\n            match $msg { $(\n                msg::$Enum::$Variant {..} =\u003e self::handle::$Variant($deps, $env, $msg),\n            )* }\n        }\n        /// Transaction handlers\n        mod handle {\n            prelude!();\n            use super::*;\n            // shorthand for saving state\n            // define a handler for every tx message variant\n            $(#[allow(non_snake_case)] pub fn $Variant \u003cS: Storage, A: Api, Q: Querier\u003e(\n                $deps: \u0026mut Extern\u003cS, A, Q\u003e,\n                $env:  Env,\n                $msg:  msg::$Enum,\n            ) -\u003e StdResult\u003cHandleResponse\u003e {\n                // get mutable snapshot of current state:\n                let mut $state = get_store_rw(\u0026mut $deps.storage).load()?;\n                macro_rules! save_state {\n                    () =\u003e { get_store_rw(\u0026mut $deps.storage).save(\u0026$state)?; }\n                };\n                if let super::msg::$Enum::$Variant {$($arg),*} = $msg {\n                    // perform user-specified actions\n                    $body\n                } else {\n                    unreachable!()\n                }\n            })*\n        }\n    };\n}\n\n/// Define a smart contract\n#[macro_export] macro_rules! contract {\n\n    // This pattern matching is ugly!\n    (\n        // passed to `define_state_singleton!`\n        [$State:ident]\n        { $( $(#[$meta:meta])* $state_field:ident : $state_field_type:ty ),* }\n\n        // Define the signature of the init message, how it's handled.\n        //\n        $(#[$InitMeta:meta])*\n        [$Init:ident]\n        ( $init_deps:ident, $init_env:ident, $init_msg:ident : $($init_msg_definition:tt)+\n        ) $init_body:block\n\n        // Define query messages and how they're handled:\n        [$Q:ident]\n        ( $q_deps:ident, $q_state:ident, $q_msg:ident $( : $ExtQ:ident)? )\n        -\u003e $QResponse:ident { $(\n            $(#[$QVariantMeta:meta])* $QVariant:ident\n            ($($q_arg:ident $(: $q_arg_type:ty)?),*) $q_body:tt\n        )* }\n\n        // Define possible responses:\n        [$Response:ident] {\n        $( $(#[$response_meta:meta])* $ResponseMsg:ident { $($resp_field:ident : $resp_field_type:ty),* } )* }\n\n        // Define transaction messages and how they're handled:\n        [$TX:ident]\n        ( $tx_deps:ident, $tx_env:ident, $tx_state:ident, $tx_msg:ident $( : $ExtTX:ident)? )\n        -\u003e $TXResponse:ident { $(\n            $(#[$TXVariantMeta:meta])* $TXVariant:ident\n            ($($tx_arg:ident $(: $tx_arg_type:ty)?),*) $tx_body:tt\n        )* }\n\n    ) =\u003e {\n\n        prelude!();\n\n        /// WASM entry points.\n        // Similar in spirit to [`create_entry_points`](https://docs.rs/cosmwasm-std/0.10.1/src/cosmwasm_std/entry_points.rs.html#49),\n        // but doesn't need the implementation to be in a sibling module (the `super::contract` on L65)\n        // TODO custom `migrate` for SecretNetwork\n        #[cfg(target_arch = \"wasm32\")]\n        mod wasm {\n            //use super::contract;\n            use cosmwasm_std::{\n                ExternalStorage as Storage, ExternalApi as Api, ExternalQuerier as Querier,\n                do_init, do_handle, do_query\n            };\n            #[no_mangle] extern \"C\" fn init (env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n                do_init(\u0026super::init::\u003cStorage, Api, Querier\u003e, env_ptr, msg_ptr)\n            }\n            #[no_mangle] extern \"C\" fn handle (env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n                do_handle(\u0026super::handle::\u003cStorage, Api, Querier\u003e, env_ptr, msg_ptr)\n            }\n            #[no_mangle] extern \"C\" fn query (msg_ptr: u32) -\u003e u32 {\n                do_query(\u0026super::query::\u003cStorage, Api, Querier\u003e, msg_ptr,)\n            }\n            // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n            // automatically because we `use cosmwasm_std`.\n        }\n\n        /// This contract's on-chain API.\n        pub mod msg {\n            // The argument sets of the {Init,Query,Handle}Msg handlers\n            // are used to automatically generate the corresponding\n            // protocol messages.\n            // * This is why the @Q/@TX/@Response sub-sections are not just passed in as opaque `tt`s\n            // * Only responses can't be inferred and need to be pre-defined.\n            // * Although, with some more macro trickery, they could be defined in place\n            //   (e.g. the return types of $Q handlers could be defined as\n            //   `-\u003e Foo { field: type }` and then populated with `return Self { field: value }`\n            // * Let's revisit this once some we have some more examples of custom responses\n            //\n            prelude!();\n\n            use super::*;\n\n            define_init_message!($Init, $($init_msg_definition)+);\n\n            define_q_messages!($Q, $($ExtQ,)? {\n                $( $(#[$QVariantMeta])* $QVariant ($($q_arg $(: $q_arg_type)?),*))*\n            });\n\n            define_tx_messages!($TX, $($ExtTX,)? {\n                $( $(#[$TXVariantMeta])* $TXVariant ($( $tx_arg $(: $tx_arg_type)?),*))*\n            });\n\n            messages!($Response { $(\n                $(#[$response_meta])* $ResponseMsg {$($resp_field: $resp_field_type),*}\n            )* });\n        }\n\n        /// Implementations\n        //use msg::{$Init,$Q,$TX,$Response};\n\n        define_state_singleton! {\n            $State { $( $(#[$meta])* $state_field : $state_field_type ),* }\n        }\n\n        implement_init! {\n            $(#[$InitMeta])* [$Init]\n            ($init_deps, $init_env, $init_msg : $($init_msg_definition)+) $init_body\n        }\n\n        implement_queries! {\n            $State, $($ExtQ,)? $Q ($q_deps, $q_state, $q_msg) -\u003e $QResponse { $(\n                $(#[$QVariantMeta])* $QVariant\n                ($($q_arg $(: $q_arg_type)?),*) $q_body\n            )* }\n        }\n\n        implement_transactions! {\n            $State, $($ExtTX,)? $TX ($tx_deps, $tx_env, $tx_state, $tx_msg) -\u003e $TXResponse { $(\n                $(#[$TXVariantMeta])* $TXVariant\n                ($( $tx_arg $(: $tx_arg_type)?),*) $tx_body\n            )* }\n        }\n\n    };\n\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","checks.rs"],"content":"use cosmwasm_std::{StdResult, StdError, HumanAddr};\nuse crate::types::{ContractStatus, ContractStatusLevel};\n\nmacro_rules! migration_message {\n    (paused: $reason:expr) =\u003e { format!(\n         \"This contract has been paused. Reason: {}\",\n         \u0026$reason\n    ) };\n    (migration: $reason:expr, $new_address:expr) =\u003e { format!(\n         \"This contract is being migrated to {}, please use that address instead. Reason: {}\",\n         \u0026$new_address.unwrap_or(HumanAddr::default()),\n         \u0026$reason\n    ) };\n}\n\npub fn is_operational (status: \u0026ContractStatus\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n    let ContractStatus { level, reason, new_address } = status;\n    match level {\n        ContractStatusLevel::Operational =\u003e Ok(()),\n        ContractStatusLevel::Paused =\u003e Err(StdError::GenericErr {\n            backtrace: None,\n            msg: migration_message!(paused: reason)\n        }),\n        ContractStatusLevel::Migrating =\u003e Err(StdError::GenericErr {\n            backtrace: None,\n            msg: migration_message!(migration: reason, new_address.clone())\n        }),\n    }\n}\n\npub fn can_set_status (\n    status:           \u0026ContractStatus\u003cHumanAddr\u003e,\n    new_status_level: \u0026ContractStatusLevel\n) -\u003e StdResult\u003c()\u003e {\n    let ContractStatus { level, reason, new_address } = status;\n    match level {\n        ContractStatusLevel::Operational =\u003e Ok(()),\n        ContractStatusLevel::Paused =\u003e Ok(()),\n        ContractStatusLevel::Migrating =\u003e match new_status_level {\n            // if already migrating, allow message and new_address to be updated\n            ContractStatusLevel::Migrating =\u003e Ok(()),\n            // but prevent reverting from migration status\n            _ =\u003e Err(StdError::GenericErr {\n                backtrace: None,\n                msg: migration_message!(migration: reason, new_address.clone())\n            })\n        }\n    }\n}\n","traces":[{"line":16,"address":[496740,495712],"length":1,"stats":{"Line":8},"fn_name":"is_operational"},{"line":17,"address":[2858793],"length":1,"stats":{"Line":8},"fn_name":null},{"line":18,"address":[2858872,2858886,2859757,2860152,2860147],"length":1,"stats":{"Line":8},"fn_name":null},{"line":19,"address":[2858879,2858841],"length":1,"stats":{"Line":16},"fn_name":null},{"line":20,"address":[2054299],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[2858891],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[2053196,2054219,2054126],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[496555],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[495934],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[2859759,2859085,2859002],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[498090,497104],"length":1,"stats":{"Line":0},"fn_name":"can_set_status"},{"line":35,"address":[497142],"length":1,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[497252,497221,497235],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[497190,497228],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[2860301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[497283,498047],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[497262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[497914],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[497293],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[498049,497388,497305],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","lib.rs"],"content":"pub mod types;\nmod storage;\nmod checks;\n\nuse cosmwasm_std::{Extern, Storage, Api, Querier, Env, HumanAddr, StdResult};\nuse composable_admin::{require_admin, admin::assert_admin};\nuse fadroma_scrt_addr::{Humanize, Canonize};\n\n/// Return the current contract status. Defaults to operational if nothing was stored.\npub fn get_status \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003ctypes::ContractStatus\u003cHumanAddr\u003e\u003e {\n    storage::load(\u0026deps.storage)?.humanize(\u0026deps.api)\n}\n\n/// Fail if the current contract status level is other than `Operational`.\npub fn is_operational \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003c()\u003e {\n    checks::is_operational(\u0026get_status(deps)?)\n}\n\n/// Fail if trying to return from `Migrating` status.\npub fn can_set_status \u003cS: Storage, A: Api, Q: Querier\u003e  (\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    to_level: \u0026types::ContractStatusLevel\n) -\u003e StdResult\u003c()\u003e {\n    checks::can_set_status(\u0026get_status(deps)?, to_level)\n}\n\n/// Store a new contract status.\n#[require_admin]\npub fn set_status \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    level: types::ContractStatusLevel,\n    reason: String,\n    new_address: Option\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    storage::save(\u0026mut deps.storage, \u0026types::ContractStatus { level, reason, new_address: match new_address {\n        Some(new_address) =\u003e Some(new_address.canonize(\u0026deps.api)?),\n        None =\u003e None\n    } })\n}\n\n/// Wrap status levels around the `match` statement that does your handle dispatch.\n#[macro_export] macro_rules! with_status {\n    // by default, assumes the handle msg enum is called `HandleMsg` and imported\n    ($deps:ident, $env:ident, match $msg:ident { $($rest:tt)* }) =\u003e {\n        with_status!(HandleMsg, $deps, $env, match $msg { $($rest)* })\n    };\n    // but an alternative name can be passed\n    ($HandleMsg:ty, $deps:ident, $env:ident, match $msg:ident { $($rest:tt)* }) =\u003e {\n        if let HandleMsg::SetStatus { level, reason, new_address } = $msg {\n            fadroma_scrt_migrate::can_set_status(\u0026$deps, \u0026level)?;\n            fadroma_scrt_migrate::set_status($deps, $env, level, reason, new_address)?;\n            Ok(HandleResponse::default())\n        } else {\n            fadroma_scrt_migrate::is_operational(\u0026$deps)?;\n            match $msg {\n                HandleMsg::SetStatus { .. } =\u003e unreachable!(),\n                $($rest)*\n            }\n        }\n    }\n}\n","traces":[{"line":10,"address":[1027264,1027612],"length":1,"stats":{"Line":4},"fn_name":"get_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":13,"address":[1027294],"length":1,"stats":{"Line":4},"fn_name":null},{"line":17,"address":[1029900,1029568],"length":1,"stats":{"Line":3},"fn_name":"is_operational\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":20,"address":[1029592],"length":1,"stats":{"Line":4},"fn_name":null},{"line":24,"address":[1029184,1029540],"length":1,"stats":{"Line":0},"fn_name":"can_set_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":28,"address":[1029222],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[1027688,1027915,1027812,1028112],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[1027632,1029155,1029170],"length":1,"stats":{"Line":0},"fn_name":"set_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":40,"address":[1028952,1028188,1028174,1027854],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[1028203,1027885],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[1028176],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":11},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","storage.rs"],"content":"use cosmwasm_std::{StdResult, CanonicalAddr, Storage};\nuse crate::types::ContractStatus;\n\npub const PREFIX: \u0026[u8] = b\"fadroma_migration_state\";\n\npub fn load (storage: \u0026impl Storage) -\u003e StdResult\u003cContractStatus\u003cCanonicalAddr\u003e\u003e {\n    match cosmwasm_utils::storage::load(storage, PREFIX)? {\n        Some(status) =\u003e status,\n        None =\u003e Ok(ContractStatus::default())\n    }\n}\npub fn save (storage: \u0026mut impl Storage, status: \u0026ContractStatus\u003cCanonicalAddr\u003e) -\u003e StdResult\u003c()\u003e {\n    cosmwasm_utils::storage::save(storage, PREFIX, status)\n}\n","traces":[{"line":6,"address":[1016192],"length":1,"stats":{"Line":6},"fn_name":"load\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":7,"address":[1016470,1016555,1016658,1016216,1016656],"length":1,"stats":{"Line":14},"fn_name":null},{"line":8,"address":[1016572,1016449],"length":1,"stats":{"Line":6},"fn_name":null},{"line":9,"address":[1016557,1016623],"length":1,"stats":{"Line":15},"fn_name":null},{"line":12,"address":[1016672],"length":1,"stats":{"Line":0},"fn_name":"save\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":13,"address":[1016696],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":6},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","test.rs"],"content":"// TODO\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","types.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, StdResult, Api};\nuse serde::{Serialize, Deserialize};\nuse schemars::JsonSchema;\nuse fadroma_scrt_addr::{Humanize, Canonize};\n\n/// Possible states of a contract.\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Debug, Clone)]\npub enum ContractStatusLevel {\n    /// Live\n    Operational,\n    /// Temporarily disabled\n    Paused,\n    /// Permanently disabled\n    Migrating,\n}\n\n// TODO once serde-json-wasm finally supports serializing Rusty enums,\n// this structure can be merged with `ContractStatusLevel`, with\n// `reason` and `new_address` becoming propeties of `Migrating`\n/// Current state of a contract w/ optional description and pointer to new version\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Debug, Clone)]\npub struct ContractStatus\u003cA\u003e {\n    pub level:       ContractStatusLevel,\n    pub reason:      String,\n    pub new_address: Option\u003cA\u003e\n}\nimpl\u003cA\u003e Default for ContractStatus\u003cA\u003e {\n    fn default () -\u003e Self { Self {\n        level:       ContractStatusLevel::Operational,\n        reason:      String::new(),\n        new_address: None\n    } }\n}\nimpl Humanize\u003cContractStatus\u003cHumanAddr\u003e\u003e for ContractStatus\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractStatus\u003cHumanAddr\u003e\u003e {\n        Ok(ContractStatus {\n            level: self.level.clone(),\n            reason: self.reason.clone(),\n            new_address: match \u0026self.new_address {\n                Some(canon_addr) =\u003e Some(api.human_address(\u0026canon_addr)?),\n                None =\u003e None\n            }\n        })\n    }\n}\nimpl Canonize\u003cContractStatus\u003cCanonicalAddr\u003e\u003e for ContractStatus\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractStatus\u003cCanonicalAddr\u003e\u003e {\n        Ok(ContractStatus {\n            level: self.level.clone(),\n            reason: self.reason.clone(),\n            new_address: match \u0026self.new_address {\n                Some(human_addr) =\u003e Some(api.canonical_address(\u0026human_addr)?),\n                None =\u003e None\n            }\n        })\n    }\n}\n","traces":[{"line":28,"address":[999856,999902],"length":1,"stats":{"Line":16},"fn_name":"default\u003ccosmwasm_std::addresses::CanonicalAddr\u003e"},{"line":30,"address":[749522],"length":1,"stats":{"Line":8},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":36,"address":[748941],"length":1,"stats":{"Line":8},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":38,"address":[998661],"length":1,"stats":{"Line":8},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":16},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":9,"coverable":16},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-storage","lib.rs"],"content":"use serde::Serialize;\nuse serde::de::DeserializeOwned;\nuse cosmwasm_std::{ReadonlyStorage, StdResult, Storage, from_slice, to_vec};\n\npub fn save\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, key: \u0026[u8], value: \u0026T) -\u003e StdResult\u003c()\u003e {\n    storage.set(key, \u0026to_vec(value)?);\n    Ok(())\n}\n\npub fn remove\u003cS: Storage\u003e(storage: \u0026mut S, key: \u0026[u8]) {\n    storage.remove(key);\n}\n\npub fn load\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cOption\u003cT\u003e\u003e {\n    let result = storage.get(key);\n\n    if let Some(data) = result {\n        from_slice(\u0026data)\n    } else {\n        Ok(None)\n    }\n}\n\npub fn ns_save\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, namespace: \u0026[u8], key: \u0026[u8], value: \u0026T) -\u003e StdResult\u003c()\u003e {\n    let key = concat(namespace, key);\n    storage.set(\u0026key, \u0026to_vec(value)?);\n\n    Ok(())\n}\n\npub fn ns_remove\u003cS: Storage\u003e(storage: \u0026mut S, namespace: \u0026[u8], key: \u0026[u8]) {\n    let key = concat(namespace, key);\n    storage.remove(\u0026key);\n}\n\npub fn ns_load\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, namespace: \u0026[u8], key: \u0026[u8]) -\u003e StdResult\u003cOption\u003cT\u003e\u003e {\n    let key = concat(namespace, key);\n\n    load(storage, \u0026key)\n}\n\n#[inline]\nfn concat(namespace: \u0026[u8], key: \u0026[u8]) -\u003e Vec\u003cu8\u003e {\n    let mut k = namespace.to_vec();\n    k.extend_from_slice(key);\n\n    k\n}\n\n","traces":[{"line":5,"address":[666992,667370],"length":1,"stats":{"Line":20},"fn_name":"save\u003cexchange::state::Config\u003ccosmwasm_std::addresses::CanonicalAddr\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":6,"address":[667310,667069],"length":1,"stats":{"Line":39},"fn_name":null},{"line":7,"address":[648590,649006,649422],"length":1,"stats":{"Line":20},"fn_name":null},{"line":10,"address":[816720],"length":1,"stats":{"Line":1},"fn_name":"remove\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":11,"address":[816738],"length":1,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[814573,813165,813584,812880,813936,813523,813232,813869,814288,814227],"length":1,"stats":{"Line":14},"fn_name":"load\u003calloc::vec::Vec\u003csienna_amm_shared::exchange::Exchange\u003ccosmwasm_std::addresses::CanonicalAddr\u003e, alloc::alloc::Global\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":15,"address":[666665],"length":1,"stats":{"Line":14},"fn_name":null},{"line":17,"address":[666692],"length":1,"stats":{"Line":14},"fn_name":null},{"line":18,"address":[666743,666863],"length":1,"stats":{"Line":14},"fn_name":null},{"line":20,"address":[666780],"length":1,"stats":{"Line":9},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":10,"coverable":14},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","convert.rs"],"content":"use cosmwasm_std::{StdResult, StdError};\nuse crate::u256_math;\nuse crate::u256_math::U256;\n\n/// Convert between tokens with different decimals.\n///\n/// # Arguments\n///\n/// * `amount` - the amount of the input token to convert\n/// * `rate` - corresponds to the output token decimals. E.g: If we want 1:1 rate and the output token has 6 decimals, then rate = 1_000_000\n/// * `input_decimals` - the number of decimals of the input token\n/// * `output_decimals` - the number of decimals of the output token\npub fn convert_token(\n    amount: u128,\n    rate: u128,\n    input_decimals: u8,\n    output_decimals: u8\n) -\u003e StdResult\u003cu128\u003e {\n    let err_msg = \"u128 overflow detected.\";\n\n    // result = amount * rate / one whole output token\n \n    let amount = Some(U256::from(amount));\n    let rate = Some(U256::from(rate));\n\n    let mut result = u256_math::mul(amount, rate).ok_or_else(|| \n        StdError::generic_err(err_msg)\n    )?;\n\n    // But, if tokens have different number of decimals, we need to compensate either by \n    // dividing or multiplying (depending on which token has more decimals) the difference\n    if input_decimals \u003c output_decimals {\n        let compensation = get_whole_token_representation(\n            output_decimals - input_decimals\n        );\n        let compensation = Some(U256::from(compensation));\n\n        result = u256_math::mul(Some(result), compensation).ok_or_else(|| \n            StdError::generic_err(err_msg) \n        )?;\n    } else if output_decimals \u003c input_decimals {\n        let compensation = get_whole_token_representation(\n            input_decimals - output_decimals\n        );\n        let compensation = Some(U256::from(compensation));\n\n        result = u256_math::div(Some(result), compensation).ok_or_else(|| \n            StdError::generic_err(err_msg) \n        )?;\n    }\n\n    let whole_token = Some(U256::from(\n        get_whole_token_representation(output_decimals)\n    ));\n\n    let result = u256_math::div(Some(result), whole_token).ok_or_else(||\n        StdError::generic_err(err_msg)\n    )?;\n\n    // Check if resulting u128 would overflow\n    if result.0[3] \u003e 0 {\n        return Err(StdError::generic_err(err_msg));\n    }\n\n    Ok(result.low_u128())\n}\n\n/// Get the amount needed to represent 1 whole token given its decimals.\n/// Ex. Given token A that has 3 decimals, 1 A == 1000\npub fn get_whole_token_representation(decimals: u8) -\u003e u128 {\n    let mut whole_token = 1u128;\n\n    for _ in 0..decimals {\n        whole_token *= 10;\n    };\n\n    whole_token\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_convert_token() {\n        // Assuming the user friendly (in the UI) exchange rate has been set to\n        // 1 swapped_token (9 decimals) == 1.5 input_token (9 decimals):\n        // the rate would be 1 / 1.5 = 0.(6) or 666666666 (0.(6) ** 10 * 9)\n        // meaning the price for 1 whole swapped_token is\n        // 1500000000 (1.5 * 10 ** 9 decimals) of input_token.\n\n        // If we want to get 2 of swapped_token, we need to send 3 input_token\n        // i.e. amount = 3000000000 (3 * 10 ** 9 decimals)\n\n        let rate = 666_666_666;\n        let amount = 3_000_000_000;\n\n        let result = convert_token(amount, rate, 9, 9).unwrap();\n        assert_eq!(result, 1_999_999_998);\n\n        // Should work the same even if input_token has less decimals (ex. 6)\n        // Here amount has 3 zeroes less because input_token now has 6 decimals, so\n        // 1 input_token = 3000000 (3 * 10 ** 6)\n\n        let rate = 666_666_666;\n        let amount = 3_000_000;\n\n        let result = convert_token(amount, rate, 6, 9).unwrap();\n        assert_eq!(result, 1_999_999_998);\n\n        // And the other way around - when swap_token has 6 decimals.\n        // Here the rate and result have 3 less digits - to account for the less decimals\n\n        let rate = 666_666;\n        let amount = 3_000_000_000;\n\n        let result = convert_token(amount, rate, 9, 6).unwrap();\n        assert_eq!(result, 1_999_998);\n    }\n}\n","traces":[{"line":13,"address":[554592],"length":1,"stats":{"Line":1},"fn_name":"convert_token"},{"line":19,"address":[554678],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[554705],"length":1,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[554808],"length":1,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[1910256],"length":1,"stats":{"Line":1},"fn_name":"{{closure}}"},{"line":27,"address":[540452],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[555206,555997],"length":1,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[555389,555330],"length":1,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[555429],"length":1,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[556060,555522,555803],"length":1,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[540500],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[556782,556105,555309],"length":1,"stats":{"Line":3},"fn_name":null},{"line":43,"address":[556115,556174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":45,"address":[556214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[540528],"length":1,"stats":{"Line":1},"fn_name":"{{closure}}"},{"line":48,"address":[540548],"length":1,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[556876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[556082],"length":1,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[557250,557454,556969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[540596],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[557380],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[557496],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[557472,557584],"length":1,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[557616],"length":1,"stats":{"Line":1},"fn_name":"get_whole_token_representation"},{"line":71,"address":[557627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[557645,557852,557748],"length":1,"stats":{"Line":3},"fn_name":null},{"line":74,"address":[557760,557857,557887],"length":1,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[559136,559141],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":95,"address":[557927],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[557956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[557976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[558051,558254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[558148],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[558172],"length":1,"stats":{"Line":1},"fn_name":null},{"line":108,"address":[558298,558196],"length":1,"stats":{"Line":2},"fn_name":null},{"line":109,"address":[558342,558546],"length":1,"stats":{"Line":1},"fn_name":null},{"line":114,"address":[558439],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[558468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":117,"address":[558488,558590],"length":1,"stats":{"Line":2},"fn_name":null},{"line":118,"address":[558634,558749],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":35,"coverable":40},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","crypto.rs"],"content":"use rand_chacha::ChaChaRng;\nuse rand_core::{RngCore, SeedableRng};\nuse subtle::ConstantTimeEq;\nuse sha2::{Digest, Sha256};\n\npub struct Prng {\n    rng: ChaChaRng,\n}\n\npub fn sha_256(data: \u0026[u8]) -\u003e [u8; 32] {\n    let mut hasher = Sha256::new();\n    hasher.update(data);\n    let hash = hasher.finalize();\n\n    let mut result = [0u8; 32];\n    result.copy_from_slice(hash.as_slice());\n    \n    result\n}\n\npub fn compare_slice_ct_time(s1: \u0026[u8], s2: \u0026[u8]) -\u003e bool {\n    bool::from(s1.ct_eq(s2))\n}\n\nimpl Prng {\n    pub fn new(seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        let mut hasher = Sha256::new();\n\n        // write input message\n        hasher.update(\u0026seed);\n        hasher.update(\u0026entropy);\n        let hash = hasher.finalize();\n\n        let mut hash_bytes = [0u8; 32];\n        hash_bytes.copy_from_slice(hash.as_slice());\n\n        let rng: ChaChaRng = ChaChaRng::from_seed(hash_bytes);\n\n        Self { rng }\n    }\n\n    pub fn rand_bytes(\u0026mut self) -\u003e [u8; 32] {\n        let mut bytes = [0u8; 32];\n        self.rng.fill_bytes(\u0026mut bytes);\n\n        bytes\n    }\n}","traces":[{"line":10,"address":[536528],"length":1,"stats":{"Line":0},"fn_name":"sha_256"},{"line":11,"address":[536571],"length":1,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[1913184],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[536601],"length":1,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[1913245],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[536671],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[1913328],"length":1,"stats":{"Line":0},"fn_name":"compare_slice_ct_time"},{"line":22,"address":[536760],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[536800],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":27,"address":[1913429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[1913440],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[536862],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[536941],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","data.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, StdResult, Api, Binary};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\nuse crate::{humanize_maybe_empty, canonicalize_maybe_empty};\n\n/// Code hash and address of a contract.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInfo {\n    pub code_hash: String,\n    pub address: HumanAddr,\n}\n/// Code hash and address of a contract.\n#[derive(Serialize, Deserialize, Clone, PartialEq, Debug)]\npub struct ContractInfoStored {\n    pub code_hash: String,\n    pub address: CanonicalAddr,\n}\n\n/// Info used to instantiate a contract\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInstantiationInfo {\n    pub code_hash: String,\n    pub id: u64\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n/// Used to ask a contract to send back a message.\npub struct Callback {\n    /// The message to call.\n    pub msg: Binary,\n    /// Info about the contract requesting the callback.\n    pub contract: ContractInfo\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, Debug)]\n/// Used to ask a contract to send back a message.\npub struct CallbackStored {\n    /// The message to call.\n    pub msg: Binary,\n    /// Info about the contract requesting the callback.\n    pub contract: ContractInfoStored\n}\n\nimpl Default for ContractInfo {\n    fn default() -\u003e Self {\n        ContractInfo {\n            code_hash: \"\".into(),\n            address: HumanAddr::default()\n        }\n    }\n}\n\nimpl ContractInfo {\n    pub fn to_stored(\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractInfoStored\u003e {\n        Ok(ContractInfoStored {\n            code_hash: self.code_hash.clone(),\n            address: canonicalize_maybe_empty(api, \u0026self.address)?\n        })\n    }\n}\n\nimpl ContractInfoStored {\n    pub fn to_normal(self, api: \u0026impl Api) -\u003e StdResult\u003cContractInfo\u003e {\n        Ok(ContractInfo {\n            code_hash: self.code_hash,\n            address: humanize_maybe_empty(api, \u0026self.address)?\n        })\n    }\n}\n\nimpl Callback {\n    pub fn to_stored(\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCallbackStored\u003e {\n        Ok(CallbackStored{\n            msg: self.msg.clone(),\n            contract: self.contract.to_stored(api)?\n        })\n    }\n}\n\nimpl CallbackStored {\n    pub fn to_normal(self, api: \u0026impl Api) -\u003e StdResult\u003cCallback\u003e {\n        Ok(Callback{\n            msg: self.msg.clone(),\n            contract: self.contract.to_normal(api)?\n        })\n    }\n}\n","traces":[{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[527502],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[527529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":19},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","lib.rs"],"content":"use cosmwasm_std::{CanonicalAddr, HumanAddr, Api, StdResult};\n\npub mod viewing_key;\npub mod storage;\npub mod crypto;\npub mod convert;\npub mod u256_math;\n\nmod data;\n\npub use data::*;\n\n/// Attempting to canonicalize an empty address will fail. \n/// This function skips calling `canonical_address` if the input is empty\n/// and returns `CanonicalAddr::default()` instead.\npub fn canonicalize_maybe_empty(api: \u0026impl Api, addr: \u0026HumanAddr) -\u003e StdResult\u003cCanonicalAddr\u003e {\n    Ok(\n        if *addr == HumanAddr::default() {\n            CanonicalAddr::default()\n        } else {\n            api.canonical_address(addr)?\n        }\n    )\n}\n\n/// Attempting to humanize an empty address will fail. \n/// This function skips calling `human_address` if the input is empty\n/// and returns `HumanAddr::default()` instead.\npub fn humanize_maybe_empty(api: \u0026impl Api, addr: \u0026CanonicalAddr) -\u003e StdResult\u003cHumanAddr\u003e {\n    Ok(\n        if *addr == CanonicalAddr::default() {\n            HumanAddr::default()\n        } else {\n            api.human_address(addr)?\n        }\n    )\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","storage.rs"],"content":"#![deprecated(note=\"Please use fadroma_scrt_storage instead\")]\npub use fadroma_scrt_storage::*;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","u256_math.rs"],"content":"// Copied from https://github.com/enigmampc/SecretSwap/blob/master/contracts/secretswap_pair/src/u256_math.rs\n\npub use primitive_types::U256;\n\n/// U256 sqrt ported from here: https://ethereum.stackexchange.com/a/87713/12112\n///\n/// function sqrt(uint y) internal pure returns (uint z) {\n///     if (y \u003e 3) {\n///         z = y;\n///         uint x = y / 2 + 1;\n///         while (x \u003c z) {\n///             z = x;\n///             x = (y / x + x) / 2;\n///         }\n///     } else if (y != 0) {\n///         z = 1;\n///     }\n/// }\n///\n/// Tested it here: https://github.com/enigmampc/u256-sqrt-test/blob/aa7693/src/main.rs\npub fn sqrt(y: U256) -\u003e Option\u003cU256\u003e {\n    let mut z = U256::from(0);\n    if y.gt(\u0026U256::from(3)) {\n        z = y.clone();\n        let mut x = y.checked_div(U256::from(2))?.checked_add(U256::from(1))?;\n        while x.lt(\u0026z) {\n            z = x.clone();\n            x = y\n                .checked_div(x)?\n                .checked_add(x)?\n                .checked_div(U256::from(2))?;\n        }\n    } else if !y.is_zero() {\n        z = U256::from(1);\n    }\n\n    return Some(z);\n}\n\npub fn sub(a: Option\u003cU256\u003e, b: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match b {\n        Some(b) =\u003e a.and_then(checked_sub(b)),\n        None =\u003e None,\n    }\n}\n\npub fn div(nom: Option\u003cU256\u003e, denom: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match denom {\n        Some(denom) =\u003e nom.and_then(checked_div(denom)),\n        None =\u003e None,\n    }\n}\n\npub fn add(a: Option\u003cU256\u003e, b: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match b {\n        Some(b) =\u003e a.and_then(checked_add(b)),\n        None =\u003e None,\n    }\n}\n\npub fn mul(a: Option\u003cU256\u003e, b: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match b {\n        Some(b) =\u003e a.and_then(checked_mul(b)),\n        None =\u003e None,\n    }\n}\n\nfn checked_sub(b: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |a: U256| a.checked_sub(b)\n}\n\nfn checked_div(denom: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |nom: U256| nom.checked_div(denom)\n}\n\nfn checked_add(b: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |a: U256| a.checked_add(b)\n}\n\nfn checked_mul(b: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |a: U256| a.checked_mul(b)\n}\n","traces":[{"line":21,"address":[537408],"length":1,"stats":{"Line":0},"fn_name":"sqrt"},{"line":22,"address":[537430],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[537443,538130],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[537513],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[538087,537568,537879],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[539108,538080,538097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[538135],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[538589,538677,538395,538833,538213,539118,538324,538914],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[538260,538375],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[538525,538657],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[538894,538807],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[539331,539336,539249,537494],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[539260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[539133],"length":1,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[539344],"length":1,"stats":{"Line":0},"fn_name":"sub"},{"line":41,"address":[539396,539382],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[539370,539410],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[539389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[539568],"length":1,"stats":{"Line":1},"fn_name":"div"},{"line":48,"address":[539606,539620],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[539594,539634],"length":1,"stats":{"Line":2},"fn_name":null},{"line":50,"address":[539613],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[539792],"length":1,"stats":{"Line":0},"fn_name":"add"},{"line":55,"address":[539830,539844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[539818,539858],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[539837],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[540016],"length":1,"stats":{"Line":1},"fn_name":"mul"},{"line":62,"address":[540054,540068],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[540042,540082],"length":1,"stats":{"Line":2},"fn_name":null},{"line":64,"address":[540061],"length":1,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[540240],"length":1,"stats":{"Line":0},"fn_name":"checked_sub"},{"line":69,"address":[540243],"length":1,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[540288],"length":1,"stats":{"Line":1},"fn_name":"checked_div"},{"line":73,"address":[540291],"length":1,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[540336],"length":1,"stats":{"Line":0},"fn_name":"checked_add"},{"line":77,"address":[540339],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[540384],"length":1,"stats":{"Line":1},"fn_name":"checked_mul"},{"line":81,"address":[540387],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":8,"coverable":38},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","viewing_key.rs"],"content":"//Copied from https://github.com/enigmampc/snip20-reference-impl/blob/master/src/viewing_key.rs\n\nuse std::fmt;\n\nuse cosmwasm_std::{Env, Binary};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse crate::crypto::{sha_256, Prng, compare_slice_ct_time};\n\npub const VIEWING_KEY_SIZE: usize = 32;\nconst VIEWING_KEY_PREFIX: \u0026str = \"api_key_\";\n\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug, PartialEq)]\npub struct ViewingKey(pub String);\n\npub fn create_hashed_password(s1: \u0026str) -\u003e [u8; VIEWING_KEY_SIZE] {\n    sha_256(s1.as_bytes())\n}\n\nimpl ViewingKey {\n    ///A good source for the `seed` and `entropy` values is https://www.random.org/strings/\n    pub fn new(env: \u0026Env, seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        // 16 here represents the lengths in bytes of the block height and time.\n        let entropy_len = 16 + env.message.sender.len() + entropy.len();\n        let mut rng_entropy = Vec::with_capacity(entropy_len);\n        rng_entropy.extend_from_slice(\u0026env.block.height.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.block.time.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.message.sender.0.as_bytes());\n        rng_entropy.extend_from_slice(entropy);\n\n        let mut rng = Prng::new(seed, \u0026rng_entropy);\n\n        let rand_slice = rng.rand_bytes();\n\n        let key = sha_256(\u0026rand_slice);\n\n        Self(VIEWING_KEY_PREFIX.to_string() + \u0026Binary::from(\u0026key).to_base64())\n    }\n\n    pub fn to_hashed(\u0026self) -\u003e [u8; VIEWING_KEY_SIZE] {\n        create_hashed_password(\u0026self.0)\n    }\n\n    pub fn as_bytes(\u0026self) -\u003e \u0026[u8] {\n        self.0.as_bytes()\n    }\n\n    pub fn check_viewing_key(\u0026self, hashed_pw: \u0026[u8]) -\u003e bool {\n        let mine_hashed = create_hashed_password(\u0026self.0);\n\n        compare_slice_ct_time(\u0026mine_hashed, hashed_pw)\n    }\n}\n\nimpl fmt::Display for ViewingKey {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n","traces":[{"line":17,"address":[547664],"length":1,"stats":{"Line":0},"fn_name":"create_hashed_password"},{"line":18,"address":[547743],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[547760,548626],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":25,"address":[547856,548013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[1905645],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[548258],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[548489],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[548887,548496,548649,548748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":22}]};
        var previousData = {"files":[{"path":["/","home","hack_lenovo_03","sienna","amm","api","schema.rs"],"content":"use std::{env::current_dir,fs::create_dir_all};\nuse cosmwasm_schema::{export_schema, remove_schemas, schema_for};\n\nuse sienna_amm_shared::msg::exchange as exchange;\nuse sienna_amm_shared::msg::factory as factory;\nuse sienna_amm_shared::msg::sienna_burner as burner;\nuse lp_token::msg as lp_token;\nuse snip20_reference_impl::msg as snip20;\n\nfn main() {\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"amm\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(exchange::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(exchange::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(exchange::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(exchange::QueryMsgResponse), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"factory\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(factory::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(factory::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(factory::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(factory::QueryResponse), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"burner\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(burner::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(burner::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(burner::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(burner::QueryAnswer), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"lp_token\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(sienna_amm_shared::msg::snip20::Snip20InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::HandleAnswer), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(lp_token::QueryAnswer), \u0026out_dir);\n\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"api\");\n    out_dir.push(\"snip20\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n    export_schema(\u0026schema_for!(snip20::InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::HandleAnswer), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(snip20::QueryAnswer), \u0026out_dir);\n\n}\n","traces":[{"line":10,"address":[697457,692544],"length":1,"stats":{"Line":0},"fn_name":"main"},{"line":11,"address":[692557],"length":1,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[692599],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[692626],"length":1,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[692702],"length":1,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[692821],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[692989],"length":1,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[693114],"length":1,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[693239],"length":1,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[693364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[693481],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[693530],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[693557],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[693633],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[693752],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[693920],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[694045],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[694170],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[694295],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[694412],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[694461],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[694488],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[694564],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[694683],"length":1,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[694833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[694958],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[695083],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[695208],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[695325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[695374],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[695401],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[695477],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[695584],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[695728],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[695853],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[695978],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[696103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[696228],"length":1,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[696345],"length":1,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[696394],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[696421],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[696497],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[696604],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[696748],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[696873],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[696998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[697123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[697248],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":48},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","contract.rs"],"content":"use std::ops::Add;\nuse cosmwasm_std::{\n    to_binary, Api, Env, Extern, HandleResponse, InitResponse, Querier,\n    StdError, Binary, StdResult, Storage, QueryResult, CosmosMsg, WasmMsg,\n    Uint128, log, HumanAddr, Decimal, QueryRequest, WasmQuery\n};\nuse secret_toolkit::snip20;\nuse sienna_amm_shared::{\n    TokenPairAmount, TokenType,\n    TokenTypeAmount, create_send_msg, Fee, ExchangeSettings,\n    msg::{\n        exchange::{InitMsg, HandleMsg, QueryMsg, QueryMsgResponse, SwapSimulationResponse},\n        snip20::{Snip20InitConfig, Snip20InitMsg},\n        factory::{QueryMsg as FactoryQueryMsg, QueryResponse as FactoryResponse},\n        sienna_burner::HandleMsg as BurnerHandleMsg,\n    },\n    u256_math, u256_math::U256, viewing_key::ViewingKey, crypto::Prng\n};\n\nuse crate::{state::{Config, store_config, load_config}, decimal_math};\nuse fadroma_scrt_migrate::get_status;\nuse fadroma_scrt_callback::{Callback, ContractInstance};\n\ntype SwapResult = StdResult\u003c(Uint128, Uint128, Uint128)\u003e;\n\n/// Pad handle responses and log attributes to blocks\n/// of 256 bytes to prevent leaking info based on response size\nconst BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n\n    if msg.pair.0 == msg.pair.1 {\n        return Err(StdError::generic_err(\"Trying to create an exchange with the same token.\"));\n    }\n\n    let mut messages = vec![];\n\n    let mut rng = Prng::new(\u0026env.message.sender.0.as_bytes(), \u0026env.block.time.to_be_bytes());\n\n    let viewing_key = ViewingKey::new(\u0026env, \u0026rng.rand_bytes(), \u0026rng.rand_bytes());\n\n    try_register_custom_token(\u0026env, \u0026mut messages, \u0026msg.pair.0, \u0026viewing_key)?;\n    try_register_custom_token(\u0026env, \u0026mut messages, \u0026msg.pair.1, \u0026viewing_key)?;\n\n    // Create LP token\n    messages.push(CosmosMsg::Wasm(WasmMsg::Instantiate {\n        code_id: msg.lp_token_contract.id,\n        msg: to_binary(\u0026Snip20InitMsg {\n            name: format!(\n                \"SiennaSwap Liquidity Provider (LP) token for {}-{}\",\n                \u0026msg.pair.0, \u0026msg.pair.1\n            ),\n            admin: Some(env.contract.address.clone()),\n            symbol: \"SWAP-LP\".to_string(),\n            decimals: 6,\n            callback: Some(Callback {\n                msg: to_binary(\u0026HandleMsg::OnLpTokenInit)?,\n                contract: ContractInstance {\n                    address: env.contract.address.clone(),\n                    code_hash: env.contract_code_hash\n                }\n            }),\n            initial_balances: None,\n            prng_seed: Binary::from(rng.rand_bytes()),\n            config: Some(Snip20InitConfig {\n                public_total_supply: Some(true)\n            })\n        })?,\n        send: vec![],\n        label: format!(\n            \"{}-{}-SiennaSwap-LP-Token-{}\",\n            \u0026msg.pair.0,\n            \u0026msg.pair.1,\n            \u0026env.contract.address\n        ),\n        callback_code_hash: msg.lp_token_contract.code_hash.clone(),\n    }));\n    \n    // Execute the HandleMsg::RegisterExchange method of\n    // the factory contract in order to register this address\n    messages.push(\n        CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr: msg.callback.contract.address,\n            callback_code_hash: msg.callback.contract.code_hash,\n            msg: msg.callback.msg,\n            send: vec![],\n        })\n    );\n\n    let config = Config {\n        factory_info: msg.factory_info,\n        lp_token_info: ContractInstance {\n            code_hash: msg.lp_token_contract.code_hash,\n            // We get the address when the instantiated LP token calls OnLpTokenInit\n            address: HumanAddr::default()\n        },\n        pair: msg.pair,\n        contract_addr: env.contract.address.clone(),\n        viewing_key,\n        pool_cache: [ Uint128::zero(), Uint128::zero() ]\n    };\n\n    store_config(deps, \u0026config)?;\n\n    Ok(InitResponse {\n        messages,\n        log: vec![\n            log(\"created_exchange_address\", env.contract.address.as_str())\n        ]\n    })\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    with_status!(deps, env, match msg {\n        HandleMsg::AddLiquidity { deposit, slippage_tolerance } =\u003e add_liquidity(deps, env, deposit, slippage_tolerance),\n        HandleMsg::RemoveLiquidity { amount, recipient } =\u003e remove_liquidity(deps, env, amount, recipient),\n        HandleMsg::OnLpTokenInit =\u003e register_lp_token(deps, env),\n        HandleMsg::Swap { offer, expected_return } =\u003e swap(deps, env, offer, expected_return)\n    })\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e QueryResult {\n    match msg {\n        QueryMsg::Status =\u003e to_binary(\u0026get_status(deps)?),\n        QueryMsg::PairInfo =\u003e {\n            let config = load_config(deps)?;\n            let result = config.pair.query_balances(\u0026deps.querier, config.contract_addr, config.viewing_key.0)?;\n            to_binary(\u0026QueryMsgResponse::PairInfo {\n                liquidity_token: config.lp_token_info,\n                factory: config.factory_info,\n                pair: config.pair,\n                amount_0: result[0],\n                amount_1: result[1]\n            })\n        },\n        QueryMsg::SwapSimulation { offer } =\u003e {\n            let config = load_config(deps)?;\n            to_binary(\u0026swap_simulation(deps, config, offer)?)\n        }\n    }\n}\n\nfn add_liquidity\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    deposit: TokenPairAmount\u003cHumanAddr\u003e,\n    slippage: Option\u003cDecimal\u003e\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    deposit.assert_sent_native_token_balance(\u0026env)?;\n\n    let config = load_config(\u0026deps)?;\n\n    let Config {\n        pair,\n        contract_addr,\n        viewing_key,\n        lp_token_info,\n        ..\n    } = config;\n    \n    if pair != deposit.pair {\n        return Err(StdError::generic_err(\"The provided tokens dont match those managed by the contract.\"));\n    }\n\n    // Because we asserted that the provided pair and the one that is managed by the contract\n    // are identical, from here on, we must only work with the one provided (deposit.pair).\n    // This is because even though pairs with orders (A,B) and (B,A) are identical, the `amount_0` and `amount_1`\n    // variables correspond directly to the pair provided and not necessarily to the one stored. So in this case, order is important.\n\n    let mut messages: Vec\u003cCosmosMsg\u003e = vec![];\n\n    let mut pool_balances = deposit.pair.query_balances(\u0026deps.querier, contract_addr, viewing_key.0)?;\n\n    for (i, (amount, token)) in deposit.into_iter().enumerate() {\n        match \u0026token {\n            TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n                messages.push(snip20::transfer_from_msg(\n                    env.message.sender.clone(),\n                    env.contract.address.clone(),\n                    amount,\n                    None,\n                    BLOCK_SIZE,\n                    token_code_hash.clone(),\n                    contract_addr.clone())?\n                );\n            },\n            TokenType::NativeToken { .. } =\u003e {\n                // If the asset is native token, balance is already increased.\n                // To calculate properly we should subtract user deposit from the pool.\n                pool_balances[i] = (pool_balances[i] - amount)?;\n            }\n        }\n    }\n\n    assert_slippage_tolerance(\n        slippage,\n        \u0026[ deposit.amount_0, deposit.amount_1 ],\n        \u0026pool_balances\n    )?;\n\n    let liquidity_supply = query_liquidity(\u0026deps.querier, \u0026lp_token_info)?;\n\n    let lp_tokens = if liquidity_supply == Uint128::zero() {\n        // If the provider is minting a new pool, the number of liquidity tokens they will\n        // receive will equal sqrt(x * y), where x and y represent the amount of each token provided.\n\n        let amount_0 = U256::from(deposit.amount_0.u128());\n        let amount_1 = U256::from(deposit.amount_1.u128());\n\n        let initial_liquidity = u256_math::mul(Some(amount_0), Some(amount_1))\n            .and_then(u256_math::sqrt)\n            .ok_or(StdError::generic_err(format!(\n                \"Cannot calculate sqrt(deposit_0 {} * deposit_1 {})\",\n                amount_0, amount_1\n            )))?;\n\n        clamp(initial_liquidity)?\n    } else {\n        // When adding to an existing pool, an equal amount of each token, proportional to the\n        // current price, must be deposited. So, determine how many LP tokens are minted.\n\n        let total_share = Some(U256::from(liquidity_supply.u128()));\n\n        let amount_0 = Some(U256::from(deposit.amount_0.u128()));\n        let pool_0 = Some(U256::from(pool_balances[0].u128()));\n\n        let share_0 = u256_math::div(u256_math::mul(amount_0, total_share), pool_0)\n            .ok_or(StdError::generic_err(format!(\n                \"Cannot calculate deposits[0] {} * total_share {} / pools[0].amount {}\",\n                amount_0.unwrap(),\n                total_share.unwrap(),\n                pool_0.unwrap()\n            )))?;\n\n        let amount_1 = Some(U256::from(deposit.amount_1.u128()));\n        let pool_1 = Some(U256::from(pool_balances[1].u128()));\n\n        let share_1 = u256_math::div(u256_math::mul(amount_1, total_share), pool_1)\n            .ok_or(StdError::generic_err(format!(\n                \"Cannot calculate deposits[1] {} * total_share {} / pools[1].amount {}\",\n                amount_1.unwrap(),\n                total_share.unwrap(),\n                pool_1.unwrap()\n            )))?;\n\n        clamp(std::cmp::min(share_0, share_1))?\n    };\n\n    messages.push(snip20::mint_msg(\n        env.message.sender,\n        lp_tokens,\n        None,\n        BLOCK_SIZE,\n        lp_token_info.code_hash,\n        lp_token_info.address,\n    )?);\n\n    Ok(HandleResponse {\n        messages,\n        log: vec![\n            log(\"action\", \"provide_liquidity\"),\n            log(\"assets\", format!(\"{}, {}\", deposit.pair.0, deposit.pair.1)),\n            log(\"share\", lp_tokens),\n        ],\n        data: None,\n    })\n}\n\nfn remove_liquidity\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n    recipient: HumanAddr\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let config = load_config(\u0026deps)?;\n\n    let Config {\n        pair,\n        lp_token_info,\n        contract_addr,\n        viewing_key,\n        ..\n    } = config;\n\n    let liquidity_supply = query_liquidity(\u0026deps.querier, \u0026lp_token_info)?;\n    let pool_balances = pair.query_balances(\u0026deps.querier, contract_addr, viewing_key.0)?;\n\n    // Calculate the withdrawn amount for each token in the pair - for each token X\n    // amount of X withdrawn = amount in pool for X * amount of LP tokens being burned / total liquidity pool amount\n\n    let withdraw_amount = Some(U256::from(amount.u128()));\n    let total_liquidity = Some(U256::from(liquidity_supply.u128()));\n\n    let mut pool_withdrawn: [Uint128; 2] = [ Uint128::zero(), Uint128::zero() ];\n\n    for (i, pool_amount) in pool_balances.iter().enumerate() {\n        let pool_amount = Some(U256::from(pool_amount.u128()));\n\n        let withdrawn_token_amount = u256_math::div(\n            u256_math::mul(pool_amount, withdraw_amount),\n            total_liquidity,\n        ).ok_or(StdError::generic_err(format!(\n            \"Cannot calculate current_pool_amount {} * withdrawn_share_amount {} / total_share {}\",\n            pool_amount.unwrap(),\n            withdraw_amount.unwrap(),\n            total_liquidity.unwrap()\n        )))?;\n\n        pool_withdrawn[i] = clamp(withdrawn_token_amount)?;\n    }\n\n    let mut messages: Vec\u003cCosmosMsg\u003e = Vec::with_capacity(2);\n\n    for (i, token) in pair.into_iter().enumerate() {\n        messages.push(\n            create_send_msg(\u0026token, env.contract.address.clone(), recipient.clone(), pool_withdrawn[i])?\n        );\n    }\n\n    messages.push(snip20::burn_from_msg(\n        env.message.sender,\n        amount,\n        None,\n        BLOCK_SIZE,\n        lp_token_info.code_hash,\n        lp_token_info.address\n    )?);\n\n    Ok(HandleResponse {\n        messages,\n        log: vec![\n            log(\"action\", \"remove_liquidity\"),\n            log(\"withdrawn_share\", amount.to_string()),\n            log(\"refund_assets\", format!(\"{}, {}\", \u0026pair.0, \u0026pair.1)),\n        ],\n        data: None\n    })\n}\n\nfn swap\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    offer: TokenTypeAmount\u003cHumanAddr\u003e,\n    expected_return: Option\u003cUint128\u003e\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut messages = vec![];\n\n    match \u0026offer.token {\n        TokenType::NativeToken { .. } =\u003e {\n            offer.assert_sent_native_token_balance(\u0026env)?;\n        },\n        TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n            messages.push(snip20::transfer_from_msg(\n                env.message.sender.clone(),\n                env.contract.address.clone(),\n                offer.amount,\n                None,\n                BLOCK_SIZE,\n                token_code_hash.clone(),\n                contract_addr.clone()\n            )?);\n        }\n    }\n\n    let mut config = load_config(deps)?;\n\n    let settings = query_exchange_settings(\u0026deps.querier, config.factory_info.clone())?;\n\n    let (mut return_amount, spread_amount, mut commission_amount) = do_swap(deps, \u0026mut config, \u0026offer, settings.swap_fee, false)?;\n    store_config(deps, \u0026config)?; // Save in order to update the pool_cache\n\n    if let Some(expected_return) = expected_return {\n        if return_amount.lt(\u0026expected_return) {\n            return Err(StdError::generic_err(\n                \"Operation fell short of expected_return\",\n            ));\n        }\n    }\n\n    // SIENNA needs to be burned on each swap in order to decrease the total supply\n    if let Some(info) = settings.sienna_burner {\n        let (result, decrease_amount) = percentage_decrease(U256::from(return_amount.u128()), settings.sienna_fee)?;\n        let decrease_amount = clamp(decrease_amount)?;\n\n        commission_amount = commission_amount + decrease_amount;\n        return_amount = clamp(result)?;\n\n        messages.push(CosmosMsg::Wasm(WasmMsg::Execute {\n            callback_code_hash: info.code_hash,\n            contract_addr: info.address,\n            msg: to_binary(\u0026BurnerHandleMsg::Burn {\n                amount: decrease_amount\n            })?,\n            send: vec![]\n        }))\n    }\n\n    let index = config.pair.get_token_index(\u0026offer.token).unwrap(); // Safe, checked in do_swap\n    let token = config.pair.get_token(index ^ 1).unwrap();\n\n    messages.push(create_send_msg(\u0026token, env.contract.address, env.message.sender, return_amount)?);\n\n    Ok(HandleResponse{\n        messages,\n        log: vec![\n            log(\"action\", \"swap\"),\n            log(\"offer_token\", offer.token.to_string()),\n            log(\"offer_amount\", offer.amount.to_string()),\n            log(\"return_amount\", return_amount.to_string()),\n            log(\"spread_amount\", spread_amount.to_string()),\n            log(\"commission_amount\", commission_amount.to_string())\n        ],\n        data: None\n    })\n}\n\n\n\nfn query_liquidity(\n    querier: \u0026impl Querier,\n    lp_token_info: \u0026ContractInstance\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cUint128\u003e {\n    let result = snip20::token_info_query(\n        querier,\n        BLOCK_SIZE,\n        lp_token_info.code_hash.clone(),\n        lp_token_info.address.clone()\n    )?;\n\n    //If this happens, the LP token has been incorrectly configured\n    if result.total_supply.is_none() {\n        unreachable!(\"LP token has no available supply.\");\n    }\n\n    Ok(result.total_supply.unwrap())\n}\n\nfn swap_simulation\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    mut config: Config\u003cHumanAddr\u003e,\n    offer: TokenTypeAmount\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cSwapSimulationResponse\u003e {\n    let settings = query_exchange_settings(\u0026deps.querier, config.factory_info.clone())?;\n\n    let (mut return_amount, spread_amount, mut commission_amount) = do_swap(deps, \u0026mut config, \u0026offer, settings.swap_fee, true)?;\n\n    if let Some(_) = settings.sienna_burner {\n        let (result, decrease_amount) = percentage_decrease(U256::from(return_amount.u128()), settings.sienna_fee)?;\n        let decrease_amount = clamp(decrease_amount)?;\n\n        commission_amount += decrease_amount;\n        return_amount = clamp(result)?;\n    }\n\n    Ok(SwapSimulationResponse { return_amount, spread_amount, commission_amount })\n}\n\nfn register_lp_token\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = load_config(\u0026deps)?;\n\n    //This should only be set once when the LP token is instantiated.\n    if config.lp_token_info.address != HumanAddr::default() {\n        return Err(StdError::unauthorized());\n    }\n\n    config.lp_token_info.address = env.message.sender.clone();\n\n    store_config(deps, \u0026config)?;\n\n    Ok(HandleResponse {\n        messages: vec![snip20::register_receive_msg(\n            env.contract_code_hash,\n            None,\n            BLOCK_SIZE,\n            config.lp_token_info.code_hash,\n            env.message.sender.clone(),\n        )?],\n        log: vec![log(\"liquidity_token_addr\", env.message.sender.as_str())],\n        data: None,\n    })\n}\n\nfn try_register_custom_token(\n    env: \u0026Env,\n    messages: \u0026mut Vec\u003cCosmosMsg\u003e,\n    token: \u0026TokenType\u003cHumanAddr\u003e,\n    viewing_key: \u0026ViewingKey\n) -\u003e StdResult\u003c()\u003e {\n    if let TokenType::CustomToken { \n        contract_addr, token_code_hash, ..\n    } = token {\n        messages.push(snip20::set_viewing_key_msg(\n            viewing_key.0.clone(),\n            None,\n            BLOCK_SIZE,\n            token_code_hash.clone(),\n            contract_addr.clone(),\n        )?);\n        messages.push(snip20::register_receive_msg(\n            env.contract_code_hash.clone(),\n            None,\n            BLOCK_SIZE,\n            token_code_hash.clone(),\n            contract_addr.clone(),\n        )?);\n    }\n\n    Ok(())\n}\n\nfn do_swap\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    config: \u0026mut Config\u003cHumanAddr\u003e,\n    offer: \u0026TokenTypeAmount\u003cHumanAddr\u003e,\n    fee: Fee,\n    is_simulation: bool\n) -\u003e SwapResult {\n    if !config.pair.contains(\u0026offer.token) {\n        return Err(StdError::generic_err(format!(\"The supplied token {}, is not managed by this contract.\", offer.token)));\n    }\n\n    let balances = config.pair.query_balances(\u0026deps.querier, config.contract_addr.clone(), config.viewing_key.0.clone())?;\n    let token_index = config.pair.get_token_index(\u0026offer.token).unwrap(); //Safe because we checked above for existence\n    \n    let mut offer_pool = balances[token_index];\n\n    if !is_simulation {\n        config.pool_cache[token_index] = config.pool_cache[token_index].add(offer.amount);\n\n        // If offer.token is not native, the balance hasn't been increased yet\n        if let TokenType::NativeToken { .. } = offer.token {\n            let result = U256::from(offer_pool.u128()).checked_sub(U256::from(offer.amount.u128()))\n                .ok_or(StdError::generic_err(\"This can't really happen.\"))?;\n\n            offer_pool = clamp(result)?\n        }\n    }\n\n    compute_swap(\n        offer_pool,\n        balances[token_index ^ 1],\n        offer.amount,\n        fee\n    )\n}\n\n// Copied from https://github.com/enigmampc/SecretSwap/blob/ffd72d1c94096ac3a78aaf8e576f22584f49fe7a/contracts/secretswap_pair/src/contract.rs#L768\nfn compute_swap(\n    offer_pool: Uint128,\n    ask_pool: Uint128,\n    offer_amount: Uint128,\n    fee: Fee\n) -\u003e SwapResult {\n    // offer =\u003e ask\n    let offer_pool = Some(U256::from(offer_pool.u128()));\n    let ask_pool = Some(U256::from(ask_pool.u128()));\n    let offer_amount = Some(U256::from(offer_amount.u128()));\n\n    // cp = offer_pool * ask_pool\n    let cp = u256_math::mul(offer_pool, ask_pool).ok_or(StdError::generic_err(format!(\n        \"Cannot calculate cp = offer_pool {} * ask_pool {}\",\n        offer_pool.unwrap(),\n        ask_pool.unwrap()\n    )))?;\n\n    // return_amount = (ask_pool - cp / (offer_pool + offer_amount))\n    // ask_amount = return_amount * (1 - commission_rate)\n    let return_amount = u256_math::sub(ask_pool, u256_math::div(Some(cp), u256_math::add(offer_pool, offer_amount)))\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate return_amount = (ask_pool {} - cp {} / (offer_pool {} + offer_amount {}))\",\n            ask_pool.unwrap(),\n            cp,\n            offer_pool.unwrap(),\n            offer_amount.unwrap(),\n        )))?;\n\n    // calculate spread \u0026 commission\n    // spread = offer_amount * ask_pool / offer_pool - return_amount\n    let spread_amount = u256_math::div(u256_math::mul(offer_amount, ask_pool), offer_pool)\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate offer_amount {} * ask_pool {} / offer_pool {}\",\n            offer_amount.unwrap(),\n            ask_pool.unwrap(),\n            offer_pool.unwrap()\n        )))?\n        .saturating_sub(return_amount);\n\n    // commission_amount = return_amount * fee.nom / fee.denom\n    let (return_amount, commission_amount) = percentage_decrease(return_amount, fee)?;\n\n    Ok((clamp(return_amount)?, clamp(spread_amount)?, clamp(commission_amount)?))\n}\n\nfn percentage_decrease(amount: U256, fee: Fee) -\u003e StdResult\u003c(U256, U256)\u003e {\n    let amount = Some(amount);\n    let nom = Some(U256::from(fee.nom));\n    let denom = Some(U256::from(fee.denom));\n\n    let decrease_amount = u256_math::div(u256_math::mul(amount, nom), denom,)\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate return_amount {} * commission_rate_nom {} / commission_rate_denom {}\",\n            amount.unwrap(),\n            nom.unwrap(),\n            denom.unwrap()\n        )))?;\n\n    let result = u256_math::sub(amount, Some(decrease_amount))\n        .ok_or(StdError::generic_err(format!(\n            \"Cannot calculate return_amount {} - commission_amount {}\",\n            amount.unwrap(),\n            decrease_amount\n        )))?;\n\n    Ok((result, decrease_amount))\n}\n\n/// The amount the price moves in a trading pair between when a transaction is submitted and when it is executed.\n/// Returns an `StdError` if the range of the expected tokens to be received is exceeded.\nfn assert_slippage_tolerance(\n    slippage: Option\u003cDecimal\u003e,\n    deposits: \u0026[Uint128; 2],\n    pools: \u0026[Uint128; 2]\n) -\u003e StdResult\u003c()\u003e {\n    if slippage.is_none() {\n        return Ok(());\n    }\n\n    let one_minus_slippage_tolerance = decimal_math::decimal_subtraction(Decimal::one(), slippage.unwrap())?;\n\n    // Ensure each prices are not dropped as much as slippage tolerance rate\n    if decimal_math::decimal_multiplication(\n        Decimal::from_ratio(deposits[0], deposits[1]),\n        one_minus_slippage_tolerance,\n    ) \u003e Decimal::from_ratio(pools[0], pools[1]) || \n    decimal_math::decimal_multiplication(\n        Decimal::from_ratio(deposits[1], deposits[0]),\n        one_minus_slippage_tolerance,\n    ) \u003e Decimal::from_ratio(pools[1], pools[0])\n    {\n        return Err(StdError::generic_err(\n            \"Operation exceeds max slippage tolerance\",\n        ));\n    }\n\n    Ok(())\n}\n\nfn query_exchange_settings (\n    querier: \u0026impl Querier,\n    factory: ContractInstance\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cExchangeSettings\u003cHumanAddr\u003e\u003e {\n    let result: FactoryResponse = querier.query(\u0026QueryRequest::Wasm(WasmQuery::Smart {\n        callback_code_hash: factory.code_hash,\n        contract_addr: factory.address,\n        msg: to_binary(\u0026FactoryQueryMsg::GetExchangeSettings)?\n    }))?;\n\n    match result {\n        FactoryResponse::GetExchangeSettings { settings } =\u003e Ok(settings),\n        _ =\u003e Err(StdError::generic_err(\"An error occurred while trying to retrieve exchange settings.\"))\n    }\n}\n\n/*\n#[cfg(test)]\nmod tests {\n    use super::*;\n*/\n\nfn clamp(val: U256) -\u003e StdResult\u003cUint128\u003e {\n    if val \u003e u128::MAX.into() {\n        Err(StdError::generic_err(format!(\"cannot represent {} in 128 bits\", \u0026val)))\n    } else {\n        Ok(Uint128(val.low_u128()))\n    }\n}\n","traces":[{"line":497,"address":[632768,633304],"length":1,"stats":{"Line":0},"fn_name":"try_register_custom_token"},{"line":503,"address":[632961,634072,632837,634067],"length":1,"stats":{"Line":0},"fn_name":null},{"line":504,"address":[632901],"length":1,"stats":{"Line":0},"fn_name":null},{"line":506,"address":[633234,633485,633092,633352],"length":1,"stats":{"Line":0},"fn_name":null},{"line":507,"address":[632937],"length":1,"stats":{"Line":0},"fn_name":null},{"line":508,"address":[632985],"length":1,"stats":{"Line":0},"fn_name":null},{"line":510,"address":[633005],"length":1,"stats":{"Line":0},"fn_name":null},{"line":511,"address":[633044],"length":1,"stats":{"Line":0},"fn_name":null},{"line":513,"address":[633659,633801,633910,634049],"length":1,"stats":{"Line":0},"fn_name":null},{"line":514,"address":[633518],"length":1,"stats":{"Line":0},"fn_name":null},{"line":515,"address":[633552],"length":1,"stats":{"Line":0},"fn_name":null},{"line":517,"address":[633572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":518,"address":[633611],"length":1,"stats":{"Line":0},"fn_name":null},{"line":522,"address":[632968],"length":1,"stats":{"Line":0},"fn_name":null},{"line":562,"address":[634080],"length":1,"stats":{"Line":0},"fn_name":"compute_swap"},{"line":569,"address":[634248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":570,"address":[634387],"length":1,"stats":{"Line":0},"fn_name":null},{"line":571,"address":[634526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":574,"address":[635699,634855,634665,635255],"length":1,"stats":{"Line":0},"fn_name":null},{"line":576,"address":[634747],"length":1,"stats":{"Line":0},"fn_name":null},{"line":577,"address":[634801],"length":1,"stats":{"Line":0},"fn_name":null},{"line":582,"address":[635385,636824,636546,635730,636475],"length":1,"stats":{"Line":0},"fn_name":null},{"line":583,"address":[635952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":585,"address":[635790],"length":1,"stats":{"Line":0},"fn_name":null},{"line":587,"address":[635844],"length":1,"stats":{"Line":0},"fn_name":null},{"line":588,"address":[635898],"length":1,"stats":{"Line":0},"fn_name":null},{"line":593,"address":[637810,637520,636842,637714,637449,636676],"length":1,"stats":{"Line":0},"fn_name":null},{"line":594,"address":[637060],"length":1,"stats":{"Line":0},"fn_name":null},{"line":596,"address":[636898],"length":1,"stats":{"Line":0},"fn_name":null},{"line":597,"address":[636952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":598,"address":[637006],"length":1,"stats":{"Line":0},"fn_name":null},{"line":600,"address":[637650],"length":1,"stats":{"Line":0},"fn_name":null},{"line":603,"address":[637843,638248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":605,"address":[639029,638584,638837,638161,638330],"length":1,"stats":{"Line":0},"fn_name":null},{"line":608,"address":[639120],"length":1,"stats":{"Line":0},"fn_name":"percentage_decrease"},{"line":609,"address":[639165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":610,"address":[639288],"length":1,"stats":{"Line":0},"fn_name":null},{"line":611,"address":[639386],"length":1,"stats":{"Line":0},"fn_name":null},{"line":613,"address":[640628,639479,640168,640239],"length":1,"stats":{"Line":0},"fn_name":null},{"line":614,"address":[639779],"length":1,"stats":{"Line":0},"fn_name":null},{"line":616,"address":[639617],"length":1,"stats":{"Line":0},"fn_name":null},{"line":617,"address":[639671],"length":1,"stats":{"Line":0},"fn_name":null},{"line":618,"address":[639725],"length":1,"stats":{"Line":0},"fn_name":null},{"line":621,"address":[640369,641574,641012,641083],"length":1,"stats":{"Line":0},"fn_name":null},{"line":622,"address":[640713],"length":1,"stats":{"Line":0},"fn_name":null},{"line":624,"address":[640659],"length":1,"stats":{"Line":0},"fn_name":null},{"line":628,"address":[641218],"length":1,"stats":{"Line":0},"fn_name":null},{"line":633,"address":[641600],"length":1,"stats":{"Line":0},"fn_name":"assert_slippage_tolerance"},{"line":638,"address":[641670],"length":1,"stats":{"Line":0},"fn_name":null},{"line":639,"address":[641726],"length":1,"stats":{"Line":0},"fn_name":null},{"line":642,"address":[641963,641703,641749],"length":1,"stats":{"Line":0},"fn_name":null},{"line":645,"address":[642197,642333,642124,642062],"length":1,"stats":{"Line":0},"fn_name":null},{"line":646,"address":[641931],"length":1,"stats":{"Line":0},"fn_name":null},{"line":648,"address":[642088],"length":1,"stats":{"Line":0},"fn_name":null},{"line":649,"address":[642303,642241],"length":1,"stats":{"Line":0},"fn_name":null},{"line":650,"address":[642165],"length":1,"stats":{"Line":0},"fn_name":null},{"line":652,"address":[642267],"length":1,"stats":{"Line":0},"fn_name":null},{"line":654,"address":[642364],"length":1,"stats":{"Line":0},"fn_name":null},{"line":659,"address":[642352],"length":1,"stats":{"Line":0},"fn_name":null},{"line":684,"address":[642432],"length":1,"stats":{"Line":0},"fn_name":"clamp"},{"line":685,"address":[642466,642861,642863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":686,"address":[642534],"length":1,"stats":{"Line":0},"fn_name":null},{"line":688,"address":[642509,642814],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":63},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","decimal_math.rs"],"content":"// Copied from https://github.com/enigmampc/SecretSwap/blob/master/contracts/secretswap_pair/src/math.rs\n\nuse cosmwasm_std::{Decimal, StdResult, Uint128};\n\nconst DECIMAL_FRACTIONAL: Uint128 = Uint128(1_000_000_000u128);\n/*\npub fn reverse_decimal(decimal: Decimal) -\u003e Decimal {\n    if decimal.is_zero() {\n        return Decimal::zero();\n    }\n\n    Decimal::from_ratio(DECIMAL_FRACTIONAL, decimal * DECIMAL_FRACTIONAL)\n}\n*/\npub fn decimal_subtraction(a: Decimal, b: Decimal) -\u003e StdResult\u003cDecimal\u003e {\n    Ok(Decimal::from_ratio(\n        (a * DECIMAL_FRACTIONAL - b * DECIMAL_FRACTIONAL)?,\n        DECIMAL_FRACTIONAL,\n    ))\n}\n\npub fn decimal_multiplication(a: Decimal, b: Decimal) -\u003e Decimal {\n    Decimal::from_ratio(a * DECIMAL_FRACTIONAL * b, DECIMAL_FRACTIONAL)\n}\n","traces":[{"line":15,"address":[611328],"length":1,"stats":{"Line":0},"fn_name":"decimal_subtraction"},{"line":16,"address":[611700,611581],"length":1,"stats":{"Line":0},"fn_name":null},{"line":17,"address":[611598,611413],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[611728],"length":1,"stats":{"Line":0},"fn_name":"decimal_multiplication"},{"line":23,"address":[611762],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":5},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","lib.rs"],"content":"#[macro_use] extern crate fadroma_scrt_migrate;\npub mod contract;\npub mod state;\nmod decimal_math;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","src","state.rs"],"content":"use cosmwasm_std::{\n    Api, CanonicalAddr, Extern, HumanAddr, Querier,\n    StdResult, Storage, Uint128, StdError\n};\nuse serde::{Serialize,Deserialize};\n\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstance;\nuse fadroma_scrt_storage::{load, save};\nuse cosmwasm_utils::viewing_key::ViewingKey;\nuse sienna_amm_shared::TokenPair;\n\nconst CONFIG_KEY: \u0026[u8] = b\"config\";\n\n#[derive(Serialize, Deserialize, PartialEq, Debug)]\npub(crate) struct Config\u003cA: Clone\u003e {\n    pub factory_info:  ContractInstance\u003cA\u003e,\n    pub lp_token_info: ContractInstance\u003cA\u003e,\n    pub pair:          TokenPair\u003cA\u003e,\n    /// The address of the current contract.\n    pub contract_addr: A,\n    /// Viewing key used for custom SNIP20 tokens.\n    pub viewing_key:   ViewingKey,\n    /// Typically, smart contracts which need tokens to perform some functionality\n    /// require callers to first make an approval on the token contract,\n    /// then call a function that in turn calls transferFrom on the token contract.\n    ///\n    /// This is not how Uniswap pairs accept tokens.\n    /// Instead, pairs check their token balances at the end of every interaction.\n    ///\n    /// Then, at the beginning of the next interaction, current balances are differenced\n    /// against the stored values to determine the amount of tokens that were sent by the\n    /// current interactor.\n    pub pool_cache: [Uint128; 2]\n}\nimpl Canonize\u003cConfig\u003cCanonicalAddr\u003e\u003e for Config\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cCanonicalAddr\u003e\u003e {\n        Ok(Config {\n            factory_info:  self.factory_info.canonize(api)?,\n            lp_token_info: self.lp_token_info.canonize(api)?,\n            pair:          self.pair.canonize(api)?,\n            contract_addr: self.contract_addr.canonize(api)?,\n            viewing_key:   self.viewing_key.clone(),\n            pool_cache:    self.pool_cache\n        })\n    }\n}\nimpl Humanize\u003cConfig\u003cHumanAddr\u003e\u003e for Config\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n        Ok(Config {\n            factory_info:  self.factory_info.humanize(api)?,\n            lp_token_info: self.lp_token_info.humanize(api)?,\n            pair:          self.pair.humanize(api)?,\n            contract_addr: self.contract_addr.humanize(api)?,\n            viewing_key:   self.viewing_key.clone(),\n            pool_cache:    self.pool_cache\n        })\n    }\n}\n\npub(crate) fn store_config \u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:   \u0026mut Extern\u003cS, A, Q\u003e,\n    config: \u0026Config\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, CONFIG_KEY, \u0026config.canonize(\u0026deps.api)?)\n}\n\npub(crate) fn load_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n    let result: Config\u003cCanonicalAddr\u003e = load(\u0026deps.storage, CONFIG_KEY)?.ok_or(\n        StdError::generic_err(\"Config doesn't exist in storage.\")\n    )?;\n    result.humanize(\u0026deps.api)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::testing::mock_dependencies;\n    use sienna_amm_shared::TokenType;\n\n    #[test]\n    fn properly_stores_config() -\u003e StdResult\u003c()\u003e {\n        let mut deps = mock_dependencies(10, \u0026[]);\n\n        let config = Config {\n            factory_info: ContractInstance {\n                code_hash: \"factory_hash\".into(),\n                address: HumanAddr(\"factory\".into())\n            },\n            lp_token_info: ContractInstance {\n                code_hash: \"token_hash\".into(),\n                address: HumanAddr(\"lp_token\".into())\n            },\n            pair: TokenPair(\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"first_addr\".into()),\n                    token_code_hash: \"13123adasd\".into()\n                },\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"scnd_addr\".into()),\n                    token_code_hash: \"4534qwerqqw\".into()\n                }\n            ),\n            contract_addr: HumanAddr(\"this\".into()),\n            viewing_key: ViewingKey(\"vk\".into()),\n            pool_cache: [ Uint128::zero(), Uint128(123) ]\n        };\n\n        store_config(\u0026mut deps, \u0026config)?;\n\n        let result = load_config(\u0026deps)?;\n\n        assert_eq!(config, result);\n\n        Ok(())\n    }\n}\n","traces":[{"line":37,"address":[571456,571834],"length":1,"stats":{"Line":1},"fn_name":"canonize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":38,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":41,"address":[572266,572310,572595,571956],"length":1,"stats":{"Line":3},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[576304,576656],"length":1,"stats":{"Line":1},"fn_name":"store_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":65,"address":[576350],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[576688,577091],"length":1,"stats":{"Line":1},"fn_name":"load_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":71,"address":[577138,576900,576718,577297,576987,577068],"length":1,"stats":{"Line":3},"fn_name":null},{"line":72,"address":[576869],"length":1,"stats":{"Line":1},"fn_name":null},{"line":74,"address":[577225],"length":1,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[596361,596352],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":85,"address":[643617],"length":1,"stats":{"Line":1},"fn_name":null},{"line":88,"address":[643775],"length":1,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[644015],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[644583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[644711,644783],"length":1,"stats":{"Line":2},"fn_name":null},{"line":107,"address":[644887,644815],"length":1,"stats":{"Line":2},"fn_name":null},{"line":108,"address":[644919,644994],"length":1,"stats":{"Line":2},"fn_name":null},{"line":111,"address":[645502,645391,645765,645556,645455],"length":1,"stats":{"Line":3},"fn_name":null},{"line":113,"address":[645826,645541,646020,646232],"length":1,"stats":{"Line":2},"fn_name":null},{"line":115,"address":[645941,646371,646286],"length":1,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[646339],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":34,"coverable":34},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","exchange","tests","integration.rs"],"content":"//! This integration test tries to run and call the generated wasm.\n//! It depends on a Wasm build being available, which you can create with `cargo wasm`.\n//! Then running `cargo integration-test` will validate we can properly call into that generated Wasm.\n//!\n//! You can easily convert unit tests to integration tests.\n//! 1. First copy them over verbatum,\n//! 2. Then change\n//!      let mut deps = mock_dependencies(20, \u0026[]);\n//!    to\n//!      let mut deps = mock_instance(WASM, \u0026[]);\n//! 3. If you access raw storage, where ever you see something like:\n//!      deps.storage.get(CONFIG_KEY).expect(\"no data stored\");\n//!    replace it with:\n//!      deps.with_storage(|store| {\n//!          let data = store.get(CONFIG_KEY).expect(\"no data stored\");\n//!          //...\n//!      });\n//! 4. Anywhere you see query(\u0026deps, ...) you must replace it with query(\u0026mut deps, ...)\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","contract.rs"],"content":"use cosmwasm_std::{\n    Api, Binary, CosmosMsg, Env, Extern, HandleResponse, InitResponse,\n    Querier, StdError, StdResult, Storage, WasmMsg, log, to_binary, HumanAddr\n};\nuse sienna_amm_shared::{\n    TokenPair,\n    Pagination,\n    msg::{\n        exchange::InitMsg as ExchangeInitMsg,\n        ido::{IdoInitMsg, IdoInitConfig},\n        factory::{InitMsg, HandleMsg, QueryMsg, QueryResponse},\n        sienna_burner::HandleMsg as BurnerHandleMsg\n    },\n    admin::{\n        require_admin,\n        admin::{\n            DefaultHandleImpl as AdminHandle, DefaultQueryImpl as AdminQuery,\n            save_admin, admin_handle, admin_query, assert_admin\n        }\n    }\n};\nuse fadroma_scrt_callback::{ContractInstance, Callback};\nuse fadroma_scrt_storage::{load, save, remove};\nuse crate::state::{\n    save_config, load_config, Config, pair_exists, store_exchange,\n    get_address_for_pair, get_idos, store_ido_address, get_exchanges\n};\nuse fadroma_scrt_migrate::{is_operational, can_set_status, set_status, get_status};\n\npub const EPHEMERAL_STORAGE_KEY: \u0026[u8] = b\"ephemeral_storage\";\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    save_config(deps, \u0026Config::from_init_msg(msg))?;\n    save_admin(deps, \u0026env.message.sender)?;\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    with_status!(deps, env, match msg {\n        HandleMsg::SetConfig { .. }          =\u003e set_config(deps, env, msg),\n        HandleMsg::CreateExchange { pair }   =\u003e create_exchange(deps, env, pair),\n        HandleMsg::CreateIdo { info }        =\u003e create_ido(deps, env, info),\n        HandleMsg::RegisterIdo { signature } =\u003e register_ido(deps, env, signature),\n        HandleMsg::RegisterExchange { pair, signature } =\u003e\n            register_exchange(deps, env, pair, signature),\n\n        HandleMsg::Admin(msg) =\u003e admin_handle(deps, env, msg, AdminHandle),\n    })\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::Status                       =\u003e to_binary(\u0026get_status(deps)?),\n        QueryMsg::GetConfig {}                 =\u003e get_config(deps),\n        QueryMsg::GetExchangeAddress { pair }  =\u003e query_exchange_address(deps, pair),\n        QueryMsg::ListExchanges { pagination } =\u003e list_exchanges(deps, pagination),\n        QueryMsg::ListIdos { pagination }      =\u003e list_idos(deps, pagination),\n        QueryMsg::GetExchangeSettings          =\u003e query_exchange_settings(deps),\n\n        QueryMsg::Admin(msg) =\u003e admin_query(deps, msg, AdminQuery),\n    }\n}\n\n#[require_admin]\npub fn set_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env:  Env,\n    msg:  HandleMsg\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    if let HandleMsg::SetConfig {\n        snip20_contract, lp_token_contract, pair_contract, ido_contract,\n        exchange_settings\n    } = msg {\n        let mut config = load_config(deps)?;\n        if let Some(new_value) = snip20_contract   { config.snip20_contract   = new_value; }\n        if let Some(new_value) = lp_token_contract { config.lp_token_contract = new_value; }\n        if let Some(new_value) = pair_contract     { config.pair_contract     = new_value; }\n        if let Some(new_value) = ido_contract      { config.ido_contract      = new_value; }\n        if let Some(new_value) = exchange_settings { config.exchange_settings = new_value; }\n        save_config(deps, \u0026config)?;\n        Ok(HandleResponse::default())\n    } else {\n        unreachable!()\n    }\n}\n\npub fn get_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n) -\u003e StdResult\u003cBinary\u003e {\n    let Config::\u003cHumanAddr\u003e {\n        snip20_contract, lp_token_contract, pair_contract, ido_contract,\n        exchange_settings, ..\n    } = load_config(deps)?;\n    to_binary(\u0026QueryResponse::Config {\n        snip20_contract, lp_token_contract, pair_contract, ido_contract,\n        exchange_settings\n    })\n}\n\npub fn create_exchange\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pair: TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cHandleResponse\u003e {\n\n    if pair.0 == pair.1 {\n        return Err(StdError::generic_err(\"Cannot create an exchange with the same token.\"));\n    }\n\n    if pair_exists(deps, \u0026pair)? {\n        return Err(StdError::generic_err(\"Pair already exists\"));\n    }\n\n    let config = load_config(deps)?;\n\n    // We take advantage of the serialized execution model to create a signature\n    // and remove it at the end of the transaction. This signature is passed to\n    // the created pair which it then returns to HandleMsg::RegisterExchange so that\n    // it can be compared to the one we stored. This way, we ensure that exchanges \n    // can only be created through this method.\n    let signature = create_signature(\u0026env)?;\n    save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n    // Actually creating the exchange happens when the instantiated contract calls\n    // us back via the HandleMsg::RegisterExchange so that we can get its address.\n\n    Ok(HandleResponse{\n        messages: vec![\n            CosmosMsg::Wasm(\n                WasmMsg::Instantiate {\n                    code_id: config.pair_contract.id,\n                    callback_code_hash: config.pair_contract.code_hash,\n                    send: vec![],\n                    label: format!(\n                        \"{}-{}-pair-{}-{}\",\n                        pair.0,\n                        pair.1,\n                        env.contract.address,\n                        config.pair_contract.id\n                    ),\n                    msg: to_binary(\n                        \u0026ExchangeInitMsg {\n                            pair: pair.clone(),\n                            lp_token_contract: config.lp_token_contract.clone(),\n                            factory_info: ContractInstance {\n                                code_hash: env.contract_code_hash.clone(),\n                                address:   env.contract.address.clone()\n                            },\n                            callback: Callback {\n                                contract: ContractInstance {\n                                    address:   env.contract.address,\n                                    code_hash: env.contract_code_hash,\n                                },\n                                msg: to_binary(\u0026HandleMsg::RegisterExchange {\n                                    pair: pair.clone(),\n                                    signature\n                                })?,\n                            }\n                        }\n                    )?\n                }\n            )\n        ],\n        log: vec![\n            log(\"action\", \"create_exchange\"),\n            log(\"pair\", pair),\n        ],\n        data: None\n    })\n}\n\nfn register_exchange\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pair: TokenPair\u003cHumanAddr\u003e,\n    signature: Binary\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    ensure_correct_signature(\u0026mut deps.storage, signature)?;\n\n    store_exchange(deps, \u0026pair, \u0026env.message.sender)?;\n\n    let config = load_config(\u0026deps)?;\n    let mut messages = vec![];\n\n    if let Some(info) = config.exchange_settings.sienna_burner {\n        let pairs = vec![ env.message.sender.clone() ];\n        messages.push(CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr:      info.address,\n            callback_code_hash: info.code_hash,\n            msg: to_binary(\u0026BurnerHandleMsg::AddPairs { pairs })?,\n            send: vec![]\n        }))\n    }\n\n    Ok(HandleResponse {\n        messages,\n        log: vec![\n            log(\"action\", \"register_exchange\"),\n            log(\"address\", env.message.sender),\n            log(\"pair\", pair)\n        ],\n        data: None\n    })\n}\n\nfn query_exchange_address\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pair: TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = get_address_for_pair(deps, \u0026pair)?;\n    \n    to_binary(\u0026QueryResponse::GetExchangeAddress {\n        address\n    })\n}\n\nfn create_ido\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    info: IdoInitConfig\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let signature = create_signature(\u0026env)?;\n    save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n    \n    // Again, creating the IDO happens when the instantiated contract calls\n    // us back via the HandleMsg::RegisterIdo so that we can get its address.\n    \n    let config = load_config(deps)?;\n\n    Ok(HandleResponse {\n        messages: vec![\n            CosmosMsg::Wasm(WasmMsg::Instantiate {\n                code_id: config.ido_contract.id,\n                callback_code_hash: config.ido_contract.code_hash.clone(),\n                send: vec![],\n                label: format!(\n                    \"IDO for {}({}), id: {}\",\n                    info.snip20_init_info.name,\n                    info.snip20_init_info.symbol,\n                    config.ido_contract.id\n                ),\n                msg: to_binary(\u0026IdoInitMsg {\n                    info,\n                    snip20_contract: config.snip20_contract,\n                    callback: Callback {\n                        contract: ContractInstance {\n                            address:   env.contract.address,\n                            code_hash: env.contract_code_hash,\n                        },\n                        msg: to_binary(\u0026HandleMsg::RegisterIdo {\n                            signature\n                        })?\n                    }\n                })?\n            })\n        ],\n        log: vec![\n            log(\"action\", \"create_exchange\")\n        ],\n        data: None\n    })\n}\n\nfn register_ido\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    signature: Binary\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    ensure_correct_signature(\u0026mut deps.storage, signature)?;\n\n    let mut config = load_config(deps)?;\n\n    store_ido_address(deps, \u0026env.message.sender, \u0026mut config)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![\n            log(\"created IDO\", env.message.sender)\n        ],\n        data: None\n    })\n}\n\nfn list_idos\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cBinary\u003e {\n    let config = load_config(deps)?;\n    let idos = get_idos(deps, \u0026config, pagination)?;\n\n    to_binary(\u0026QueryResponse::ListIdos { idos })\n}\n\nfn list_exchanges\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cBinary\u003e {\n    let exchanges = get_exchanges(deps, pagination)?;\n\n    to_binary(\u0026QueryResponse::ListExchanges { exchanges })\n}\n\nfn query_exchange_settings\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cBinary\u003e {\n    let config = load_config(deps)?;\n\n    Ok(to_binary(\u0026QueryResponse::GetExchangeSettings {\n        settings: config.exchange_settings\n    })?)\n}\n\npub fn create_signature(env: \u0026Env) -\u003e StdResult\u003cBinary\u003e {\n    to_binary(\u0026[\n        env.message.sender.0.as_bytes(),\n        \u0026env.block.height.to_be_bytes(),\n        \u0026env.block.time.to_be_bytes()\n    ].concat())\n}\n\nfn ensure_correct_signature(storage: \u0026mut impl Storage, signature: Binary) -\u003e StdResult\u003c()\u003e {\n    let stored_signature: Binary =\n        load(storage, EPHEMERAL_STORAGE_KEY)?.unwrap_or_default();\n\n    if stored_signature != signature {\n        return  Err(StdError::unauthorized());\n    }\n\n    remove(storage, EPHEMERAL_STORAGE_KEY);\n\n    Ok(())\n}\n","traces":[{"line":32,"address":[775073,774144,775058],"length":1,"stats":{"Line":1},"fn_name":"init\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":37,"address":[774316,774216],"length":1,"stats":{"Line":3},"fn_name":null},{"line":38,"address":[774664,774755,774967],"length":1,"stats":{"Line":2},"fn_name":null},{"line":39,"address":[774740,775012],"length":1,"stats":{"Line":4},"fn_name":null},{"line":42,"address":[779460,775088],"length":1,"stats":{"Line":1},"fn_name":"handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":47,"address":[775829,778926,778345,777892,778225,777410,775543,775909,775135],"length":1,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[775952,777390],"length":1,"stats":{"Line":2},"fn_name":null},{"line":49,"address":[776183,777388],"length":1,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[777386,776491],"length":1,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[777052,777382],"length":1,"stats":{"Line":2},"fn_name":null},{"line":52,"address":[776673],"length":1,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[776800,777384],"length":1,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[777216],"length":1,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[780122,779504],"length":1,"stats":{"Line":1},"fn_name":"query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":63,"address":[780142,780137,779568],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[779575,780076,779822,779539],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[779603],"length":1,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[779618],"length":1,"stats":{"Line":1},"fn_name":null},{"line":67,"address":[779753],"length":1,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[779706],"length":1,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[779795],"length":1,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[779812],"length":1,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[807669,807424,807224,807475],"length":1,"stats":{"Line":2},"fn_name":null},{"line":76,"address":[807184,812009,811994],"length":1,"stats":{"Line":1},"fn_name":"set_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":81,"address":[807452],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[807729],"length":1,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[807889],"length":1,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[808028,808077,808401,807973,808192],"length":1,"stats":{"Line":3},"fn_name":null},{"line":86,"address":[808576,808448,808152],"length":1,"stats":{"Line":3},"fn_name":null},{"line":87,"address":[808748,808876,808541],"length":1,"stats":{"Line":3},"fn_name":null},{"line":88,"address":[809161,808841,809033],"length":1,"stats":{"Line":3},"fn_name":null},{"line":89,"address":[809318,809126,809431],"length":1,"stats":{"Line":3},"fn_name":null},{"line":90,"address":[809773,809588,809411],"length":1,"stats":{"Line":3},"fn_name":null},{"line":91,"address":[809965,809766,810190,809884],"length":1,"stats":{"Line":2},"fn_name":null},{"line":92,"address":[811208,809950],"length":1,"stats":{"Line":2},"fn_name":null},{"line":98,"address":[780144,781017,781032],"length":1,"stats":{"Line":1},"fn_name":"get_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":101,"address":[780873,780169],"length":1,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[780300],"length":1,"stats":{"Line":1},"fn_name":null},{"line":103,"address":[780413],"length":1,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[780654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[780477],"length":1,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[780590],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[781040,788157],"length":1,"stats":{"Line":1},"fn_name":"create_exchange\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":117,"address":[781115],"length":1,"stats":{"Line":1},"fn_name":null},{"line":118,"address":[781283],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[781674,781276,781397],"length":1,"stats":{"Line":0},"fn_name":null},{"line":122,"address":[781724],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[781977,782186,781821,781717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[781959,782294,782640,782226,782431],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[783116,782887,782701,782385,782749],"length":1,"stats":{"Line":0},"fn_name":null},{"line":138,"address":[788685],"length":1,"stats":{"Line":0},"fn_name":null},{"line":139,"address":[786520,782785,784564,784849,786969,787494,786010],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[786845],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[786697],"length":1,"stats":{"Line":0},"fn_name":null},{"line":142,"address":[782801],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[782817],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[782857],"length":1,"stats":{"Line":0},"fn_name":null},{"line":145,"address":[783178,783404,783501],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[783159],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[783166],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[783170],"length":1,"stats":{"Line":0},"fn_name":null},{"line":152,"address":[786403,786623,787316,785386],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[785098],"length":1,"stats":{"Line":0},"fn_name":null},{"line":154,"address":[783803],"length":1,"stats":{"Line":0},"fn_name":null},{"line":155,"address":[783822],"length":1,"stats":{"Line":0},"fn_name":null},{"line":156,"address":[784039],"length":1,"stats":{"Line":0},"fn_name":null},{"line":157,"address":[783894],"length":1,"stats":{"Line":0},"fn_name":null},{"line":158,"address":[783966],"length":1,"stats":{"Line":0},"fn_name":null},{"line":160,"address":[785018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":161,"address":[784173],"length":1,"stats":{"Line":0},"fn_name":null},{"line":162,"address":[784103],"length":1,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[784135],"length":1,"stats":{"Line":0},"fn_name":null},{"line":165,"address":[784676,784329,785604,784952],"length":1,"stats":{"Line":0},"fn_name":null},{"line":166,"address":[784237],"length":1,"stats":{"Line":0},"fn_name":null},{"line":167,"address":[784297],"length":1,"stats":{"Line":0},"fn_name":null},{"line":175,"address":[788244,788459],"length":1,"stats":{"Line":0},"fn_name":null},{"line":176,"address":[788260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[788333],"length":1,"stats":{"Line":0},"fn_name":null},{"line":179,"address":[788673],"length":1,"stats":{"Line":0},"fn_name":null},{"line":183,"address":[789472,794018],"length":1,"stats":{"Line":1},"fn_name":"register_exchange\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":189,"address":[789746,789504,789946,789681],"length":1,"stats":{"Line":3},"fn_name":null},{"line":191,"address":[789714,790008,790069,790281],"length":1,"stats":{"Line":2},"fn_name":null},{"line":193,"address":[790451,790041,790660,790324],"length":1,"stats":{"Line":2},"fn_name":null},{"line":194,"address":[790436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":196,"address":[790780,790902,792603,790700],"length":1,"stats":{"Line":2},"fn_name":null},{"line":197,"address":[791013,790862],"length":1,"stats":{"Line":0},"fn_name":null},{"line":198,"address":[792240],"length":1,"stats":{"Line":0},"fn_name":null},{"line":199,"address":[791128],"length":1,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[791168],"length":1,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[791208,791536,791443,791393],"length":1,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[791509],"length":1,"stats":{"Line":0},"fn_name":null},{"line":206,"address":[793186],"length":1,"stats":{"Line":2},"fn_name":null},{"line":207,"address":[790904],"length":1,"stats":{"Line":2},"fn_name":null},{"line":208,"address":[792747,792918,790954],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[790970],"length":1,"stats":{"Line":2},"fn_name":null},{"line":210,"address":[792680],"length":1,"stats":{"Line":2},"fn_name":null},{"line":211,"address":[792792],"length":1,"stats":{"Line":2},"fn_name":null},{"line":213,"address":[793174],"length":1,"stats":{"Line":2},"fn_name":null},{"line":217,"address":[794900,794288,794885],"length":1,"stats":{"Line":1},"fn_name":"query_exchange_address\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":221,"address":[794560,794391,794772,794326],"length":1,"stats":{"Line":2},"fn_name":null},{"line":223,"address":[794493],"length":1,"stats":{"Line":1},"fn_name":null},{"line":224,"address":[794467],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[800522,794912],"length":1,"stats":{"Line":0},"fn_name":"create_ido\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":233,"address":[794987,795118,795464,795255],"length":1,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[795574,795209,795634,795526,795843],"length":1,"stats":{"Line":0},"fn_name":null},{"line":239,"address":[795908,796087,796299,795616],"length":1,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[800836],"length":1,"stats":{"Line":0},"fn_name":null},{"line":242,"address":[798363,797385,799320,796345,798867,799844,796017],"length":1,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[799048],"length":1,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[796033],"length":1,"stats":{"Line":0},"fn_name":null},{"line":245,"address":[796057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":246,"address":[796326],"length":1,"stats":{"Line":0},"fn_name":null},{"line":247,"address":[796691,796594,796412],"length":1,"stats":{"Line":0},"fn_name":null},{"line":249,"address":[796393],"length":1,"stats":{"Line":0},"fn_name":null},{"line":250,"address":[796400],"length":1,"stats":{"Line":0},"fn_name":null},{"line":251,"address":[796404],"length":1,"stats":{"Line":0},"fn_name":null},{"line":253,"address":[799666,798750,798974,797638],"length":1,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[796909],"length":1,"stats":{"Line":0},"fn_name":null},{"line":255,"address":[796947],"length":1,"stats":{"Line":0},"fn_name":null},{"line":256,"address":[797558],"length":1,"stats":{"Line":0},"fn_name":null},{"line":257,"address":[797049],"length":1,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[796979],"length":1,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[797011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[798014,797145,797226,797492],"length":1,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[797113],"length":1,"stats":{"Line":0},"fn_name":null},{"line":268,"address":[800690,800609],"length":1,"stats":{"Line":0},"fn_name":null},{"line":269,"address":[800625],"length":1,"stats":{"Line":0},"fn_name":null},{"line":271,"address":[800824],"length":1,"stats":{"Line":0},"fn_name":null},{"line":275,"address":[803391,801616],"length":1,"stats":{"Line":1},"fn_name":"register_ido\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":280,"address":[802019,801651,801822,801771],"length":1,"stats":{"Line":3},"fn_name":null},{"line":282,"address":[802219,802078,801807,802431],"length":1,"stats":{"Line":2},"fn_name":null},{"line":284,"address":[802521,802570,802474,802192,802795],"length":1,"stats":{"Line":3},"fn_name":null},{"line":286,"address":[803076],"length":1,"stats":{"Line":1},"fn_name":null},{"line":287,"address":[802555],"length":1,"stats":{"Line":1},"fn_name":null},{"line":288,"address":[802845,802933],"length":1,"stats":{"Line":2},"fn_name":null},{"line":289,"address":[802866],"length":1,"stats":{"Line":1},"fn_name":null},{"line":291,"address":[803064],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[804477,803664],"length":1,"stats":{"Line":0},"fn_name":"list_idos\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":299,"address":[803884,803720],"length":1,"stats":{"Line":0},"fn_name":null},{"line":300,"address":[804450,803990,804034,803865,804224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":302,"address":[804125],"length":1,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[804608,804983,804998],"length":1,"stats":{"Line":0},"fn_name":"list_exchanges\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":309,"address":[804843,804649],"length":1,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[804758],"length":1,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[806397,805008],"length":1,"stats":{"Line":0},"fn_name":"query_exchange_settings\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":317,"address":[805033,805319],"length":1,"stats":{"Line":0},"fn_name":null},{"line":319,"address":[805409,805555,805873,805220],"length":1,"stats":{"Line":0},"fn_name":null},{"line":320,"address":[805156],"length":1,"stats":{"Line":0},"fn_name":null},{"line":324,"address":[1015872,1016163],"length":1,"stats":{"Line":1},"fn_name":"create_signature"},{"line":325,"address":[1016040],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[1015910],"length":1,"stats":{"Line":1},"fn_name":null},{"line":327,"address":[1015934],"length":1,"stats":{"Line":1},"fn_name":null},{"line":328,"address":[1015984],"length":1,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[807154,807169,806432],"length":1,"stats":{"Line":1},"fn_name":"ensure_correct_signature\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":333,"address":[806552,806848,806467],"length":1,"stats":{"Line":2},"fn_name":null},{"line":336,"address":[806901],"length":1,"stats":{"Line":1},"fn_name":null},{"line":337,"address":[806986],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[806967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":342,"address":[807118],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":74,"coverable":159},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","lib.rs"],"content":"#[macro_use] extern crate fadroma_scrt_migrate;\npub mod contract;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n\n#[cfg(test)] mod test;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","state.rs"],"content":"use cosmwasm_std::{Api, CanonicalAddr, Extern, HumanAddr, Querier, StdError, StdResult, Storage};\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstantiationInfo;\nuse serde::{Deserialize, Serialize};\nuse sienna_amm_shared::{\n    Exchange, ExchangeSettings, TokenPair, TokenType, Pagination,\n    msg::factory::{InitMsg, HandleMsg, QueryResponse},\n    storage::{save, load},\n};\nuse std::usize;\n\nconst CONFIG_KEY: \u0026[u8] = b\"config\";\nconst IDO_PREFIX: \u0026[u8; 1] = b\"I\";\nconst EXCHANGES_KEY: \u0026[u8] = b\"exchanges\";\n\npub const PAGINATION_LIMIT: u8 = 30;\n\n#[derive(Serialize, Deserialize, PartialEq, Debug, Clone)]\npub(crate) struct Config\u003cA\u003e {\n    pub snip20_contract:   ContractInstantiationInfo,\n    pub lp_token_contract: ContractInstantiationInfo,\n    pub pair_contract:     ContractInstantiationInfo,\n    pub ido_contract:      ContractInstantiationInfo,\n    pub exchange_settings: ExchangeSettings\u003cA\u003e,\n    pub pair_count:        u64,\n    pub ido_count:         u64\n}\nimpl Config\u003cHumanAddr\u003e {\n    pub fn from_init_msg(msg: InitMsg) -\u003e Self {\n        Self {\n            snip20_contract:   msg.snip20_contract,\n            lp_token_contract: msg.lp_token_contract,\n            pair_contract:     msg.pair_contract,\n            ido_contract:      msg.ido_contract,\n            exchange_settings: msg.exchange_settings,\n            pair_count:        0,\n            ido_count:         0\n        }\n    }\n}\nimpl Canonize\u003cConfig\u003cCanonicalAddr\u003e\u003e for Config\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cCanonicalAddr\u003e\u003e {\n        Ok(Config {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.canonize(api)?,\n            pair_count:        self.pair_count,\n            ido_count:         self.ido_count\n        })\n    }\n}\nimpl Humanize\u003cConfig\u003cHumanAddr\u003e\u003e for Config\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n        Ok(Config {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.clone().humanize(api)?,\n            pair_count:        self.pair_count,\n            ido_count:         self.ido_count\n        })\n    }\n}\nimpl Into\u003cInitMsg\u003e for \u0026Config\u003cHumanAddr\u003e {\n    fn into (self) -\u003e InitMsg {\n        InitMsg {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.clone()\n        }\n    }\n}\nimpl Into\u003cHandleMsg\u003e for \u0026Config\u003cHumanAddr\u003e {\n    fn into (self) -\u003e HandleMsg {\n        HandleMsg::SetConfig {\n            snip20_contract:   Some(self.snip20_contract.clone()),\n            lp_token_contract: Some(self.lp_token_contract.clone()),\n            pair_contract:     Some(self.pair_contract.clone()),\n            ido_contract:      Some(self.ido_contract.clone()),\n            exchange_settings: Some(self.exchange_settings.clone())\n        }\n    }\n}\nimpl Into\u003cQueryResponse\u003e for \u0026Config\u003cHumanAddr\u003e {\n    fn into (self) -\u003e QueryResponse {\n        QueryResponse::Config {\n            snip20_contract:   self.snip20_contract.clone(),\n            lp_token_contract: self.lp_token_contract.clone(),\n            pair_contract:     self.pair_contract.clone(),\n            ido_contract:      self.ido_contract.clone(),\n            exchange_settings: self.exchange_settings.clone()\n        }\n    }\n}\n\n/// Returns StdResult\u003c()\u003e resulting from saving the config to storage\npub(crate) fn save_config\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:   \u0026mut Extern\u003cS, A, Q\u003e,\n    config: \u0026Config\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, CONFIG_KEY, \u0026config.canonize(\u0026deps.api)?)\n}\n\n/// Returns StdResult\u003cConfig\u003e resulting from retrieving the config from storage\npub(crate) fn load_config \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cConfig\u003cHumanAddr\u003e\u003e {\n    let config: Option\u003cConfig\u003cCanonicalAddr\u003e\u003e = load(\u0026deps.storage, CONFIG_KEY)?;\n    config.ok_or(StdError::generic_err(\"Config doesn't exist in storage.\"))?.humanize(\u0026deps.api)\n}\n\n/// Returns StdResult\u003cbool\u003e indicating whether a pair has been created before or not.\n/// Note that TokenPair(A, B) and TokenPair(B, A) is considered to be same.\npub(crate) fn pair_exists\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    pair: \u0026TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cbool\u003e {\n    let key = generate_pair_key(\u0026pair.canonize(\u0026deps.api)?);\n    Ok(deps.storage.get(\u0026key).is_some())\n}\n\n/// Stores information about an exchange contract. Returns an `StdError` if the exchange\n/// already exists or if something else goes wrong.\npub(crate) fn store_exchange\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:    \u0026mut Extern\u003cS, A, Q\u003e,\n    pair:    \u0026TokenPair\u003cHumanAddr\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003c()\u003e {\n    let pair = pair.canonize(\u0026deps.api)?;\n    let key = generate_pair_key(\u0026pair);\n    if deps.storage.get(\u0026key).is_some() {\n        return Err(StdError::generic_err(\"Exchange already exists\"));\n    }\n\n    let address = address.canonize(\u0026deps.api)?;\n    save(\u0026mut deps.storage, \u0026key, \u0026address)?;\n\n    let mut exchanges = load_exchanges(\u0026deps.storage)?;\n    if exchanges.iter().any(|e| e.address == address) {\n        return Err(StdError::generic_err(\"Exchange address already exists\"));\n    }\n\n    exchanges.push(Exchange { pair, address });\n    save_exchanges(\u0026mut deps.storage, \u0026exchanges)\n}\n\n/// Get the address of an exchange contract which manages the given pair.\npub(crate) fn get_address_for_pair\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pair: \u0026TokenPair\u003cHumanAddr\u003e\n) -\u003e StdResult\u003cHumanAddr\u003e {\n    let key = generate_pair_key(\u0026pair.canonize(\u0026deps.api)?);\n\n    let canonical = load(\u0026deps.storage, \u0026key)?.ok_or_else(||\n        StdError::generic_err(\"Address doesn't exist in storage.\")\n    )?;\n\n    deps.api.human_address(\u0026canonical)\n}\n\npub(crate) fn store_ido_address\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:    \u0026mut Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr,\n    config:  \u0026mut Config\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let address = deps.api.canonical_address(\u0026address)?;\n    let index = generate_ido_index(\u0026config.ido_count);\n\n    save(\u0026mut deps.storage, index.as_slice(), \u0026address)?;\n\n    config.ido_count += 1;\n    save_config(deps, \u0026config)\n}\n\npub(crate) fn get_idos\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps:       \u0026Extern\u003cS, A, Q\u003e,\n    config:     \u0026Config\u003cHumanAddr\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cVec\u003cHumanAddr\u003e\u003e {\n    if pagination.start \u003e= config.ido_count {\n        return Ok(vec![]);\n    }\n\n    let limit = pagination.limit.min(PAGINATION_LIMIT);\n    let end = (pagination.start + limit as u64).min(config.ido_count);\n\n    let mut result = Vec::with_capacity((end - pagination.start) as usize);\n\n    for i in pagination.start..end {\n        let index = generate_ido_index(\u0026i);\n        let addr: CanonicalAddr = load(\u0026deps.storage, index.as_slice())?.ok_or_else(||\n            StdError::generic_err(\"IDO address doesn't exist in storage.\")\n        )?;\n\n        let human_addr = deps.api.human_address(\u0026addr)?;\n        result.push(human_addr);\n    }\n\n    Ok(result)\n}\n\npub(crate) fn get_exchanges\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    pagination: Pagination\n) -\u003e StdResult\u003cVec\u003cExchange\u003cHumanAddr\u003e\u003e\u003e {\n    let mut exchanges = load_exchanges(\u0026deps.storage)?;\n\n    if pagination.start as usize \u003e= exchanges.len() {\n        return Ok(vec![]);\n    }\n\n    let limit = pagination.limit.min(PAGINATION_LIMIT);\n    let end = (pagination.start + limit as u64).min(exchanges.len() as u64);\n\n    let mut result = Vec::with_capacity((end - pagination.start) as usize);\n\n    let exchanges = exchanges\n        .drain((pagination.start as usize)..(end as usize))\n        .collect::\u003cVec\u003cExchange\u003cCanonicalAddr\u003e\u003e\u003e();\n    for exchange in exchanges {\n        result.push(exchange.humanize(\u0026deps.api)?)\n    }\n\n    Ok(result)\n}\n\nfn load_exchanges(storage: \u0026impl Storage) -\u003e StdResult\u003cVec\u003cExchange\u003cCanonicalAddr\u003e\u003e\u003e {\n    let result: Option\u003cVec\u003cExchange\u003cCanonicalAddr\u003e\u003e\u003e = load(storage, EXCHANGES_KEY)?;\n    Ok(result.unwrap_or(vec![]))\n}\n\nfn save_exchanges(\n    storage: \u0026mut impl Storage,\n    exchanges: \u0026Vec\u003cExchange\u003cCanonicalAddr\u003e\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(storage, EXCHANGES_KEY, exchanges)\n}\n\nfn generate_ido_index(index: \u0026u64) -\u003e Vec\u003cu8\u003e {\n    [ IDO_PREFIX, index.to_string().as_bytes() ].concat()\n}\n\npub fn generate_pair_key(\n    pair: \u0026TokenPair\u003cCanonicalAddr\u003e\n) -\u003e Vec\u003cu8\u003e {\n    let mut bytes: Vec\u003c\u0026[u8]\u003e = Vec::new();\n\n    match \u0026pair.0 {\n        TokenType::NativeToken { denom } =\u003e bytes.push(denom.as_bytes()),\n        TokenType::CustomToken { contract_addr, .. } =\u003e bytes.push(contract_addr.as_slice())\n    }\n\n    match \u0026pair.1 {\n        TokenType::NativeToken { denom } =\u003e bytes.push(denom.as_bytes()),\n        TokenType::CustomToken { contract_addr, .. } =\u003e bytes.push(contract_addr.as_slice())\n    }\n\n    bytes.sort();\n\n    bytes.concat()\n}\n","traces":[{"line":29,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[678896,679248],"length":1,"stats":{"Line":1},"fn_name":"save_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":106,"address":[678942],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[679814,679280],"length":1,"stats":{"Line":1},"fn_name":"load_config\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":113,"address":[679546,679310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":114,"address":[679489,679641,679757,679841],"length":1,"stats":{"Line":6},"fn_name":null},{"line":119,"address":[680112,680590],"length":1,"stats":{"Line":1},"fn_name":"pair_exists\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":123,"address":[680650,680549,680163],"length":1,"stats":{"Line":2},"fn_name":null},{"line":124,"address":[680697,680610],"length":1,"stats":{"Line":2},"fn_name":null},{"line":129,"address":[680944,683764],"length":1,"stats":{"Line":1},"fn_name":"store_exchange\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":134,"address":[681345,681014],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[681338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":136,"address":[681447,681604,681538],"length":1,"stats":{"Line":3},"fn_name":null},{"line":137,"address":[681713],"length":1,"stats":{"Line":1},"fn_name":null},{"line":140,"address":[681694,682171,681962,681808],"length":1,"stats":{"Line":2},"fn_name":null},{"line":141,"address":[682579,681916,682306,682370,682242],"length":1,"stats":{"Line":3},"fn_name":null},{"line":143,"address":[682644,682776,682988,682352],"length":1,"stats":{"Line":2},"fn_name":null},{"line":144,"address":[683835,683808,683098,683025,682742],"length":1,"stats":{"Line":5},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":145,"address":[683503],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[683173],"length":1,"stats":{"Line":1},"fn_name":null},{"line":149,"address":[683686],"length":1,"stats":{"Line":1},"fn_name":null},{"line":153,"address":[684351,683872],"length":1,"stats":{"Line":1},"fn_name":"get_address_for_pair\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":157,"address":[684411,683923,684310],"length":1,"stats":{"Line":2},"fn_name":null},{"line":159,"address":[685408,684371,684968,685267,684458,684944],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":160,"address":[685420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":163,"address":[685044],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[686343,685456,686358],"length":1,"stats":{"Line":1},"fn_name":"store_ido_address\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":171,"address":[685635,685496],"length":1,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[685608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":174,"address":[686194,685731,685893,685832,685968],"length":1,"stats":{"Line":3},"fn_name":null},{"line":176,"address":[686276,686252,685926],"length":1,"stats":{"Line":2},"fn_name":null},{"line":177,"address":[686264],"length":1,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[688653,686368,688638],"length":1,"stats":{"Line":1},"fn_name":"get_idos\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":185,"address":[686444],"length":1,"stats":{"Line":1},"fn_name":null},{"line":186,"address":[686494],"length":1,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[686468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":190,"address":[686580],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[686675],"length":1,"stats":{"Line":1},"fn_name":null},{"line":194,"address":[686750,688633,687059,686878],"length":1,"stats":{"Line":4},"fn_name":null},{"line":195,"address":[687107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":196,"address":[687624,687648,687958,687124,687246,688656],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":197,"address":[688668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":200,"address":[688035,688083,688248,688485,687719],"length":1,"stats":{"Line":3},"fn_name":null},{"line":201,"address":[688177],"length":1,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[686963],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[690609,690624,688704],"length":1,"stats":{"Line":2},"fn_name":"get_exchanges\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":211,"address":[688926,688775],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[689037,688908],"length":1,"stats":{"Line":2},"fn_name":null},{"line":214,"address":[689120],"length":1,"stats":{"Line":1},"fn_name":null},{"line":217,"address":[689208,689091],"length":1,"stats":{"Line":2},"fn_name":null},{"line":218,"address":[689215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[689334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":222,"address":[689428],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[689412],"length":1,"stats":{"Line":1},"fn_name":null},{"line":225,"address":[689738,689809,689531,690454],"length":1,"stats":{"Line":3},"fn_name":null},{"line":226,"address":[689930,690012],"length":1,"stats":{"Line":2},"fn_name":null},{"line":229,"address":[690500],"length":1,"stats":{"Line":1},"fn_name":null},{"line":232,"address":[691099,690624],"length":1,"stats":{"Line":1},"fn_name":"load_exchanges\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":233,"address":[690840,690648],"length":1,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[691084,690783,690931],"length":1,"stats":{"Line":2},"fn_name":null},{"line":237,"address":[691136],"length":1,"stats":{"Line":1},"fn_name":"save_exchanges\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":241,"address":[691160],"length":1,"stats":{"Line":1},"fn_name":null},{"line":244,"address":[1037024,1037187],"length":1,"stats":{"Line":1},"fn_name":"generate_ido_index"},{"line":245,"address":[1037043],"length":1,"stats":{"Line":1},"fn_name":null},{"line":248,"address":[1037777,1037216],"length":1,"stats":{"Line":1},"fn_name":"generate_pair_key"},{"line":251,"address":[1037249],"length":1,"stats":{"Line":2},"fn_name":null},{"line":253,"address":[1037268,1037288],"length":1,"stats":{"Line":2},"fn_name":null},{"line":254,"address":[1037342,1037447,1037276],"length":1,"stats":{"Line":4},"fn_name":null},{"line":255,"address":[1037489,1037295],"length":1,"stats":{"Line":4},"fn_name":null},{"line":258,"address":[1037510,1037454],"length":1,"stats":{"Line":2},"fn_name":null},{"line":259,"address":[1037466,1037561],"length":1,"stats":{"Line":3},"fn_name":null},{"line":260,"address":[1037517,1037668],"length":1,"stats":{"Line":4},"fn_name":null},{"line":263,"address":[1037635,1037699],"length":1,"stats":{"Line":4},"fn_name":null},{"line":265,"address":[1037706],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":112,"coverable":115},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","src","test.rs"],"content":"pub use cosmwasm_std::{\n    StdResult, StdError, Extern, Storage, Api, Querier, Env, Binary, to_binary,\n    HandleResponse, from_binary, HumanAddr,\n    testing::{mock_dependencies, mock_env, MockApi, MockQuerier, MockStorage}\n};\npub use sienna_amm_shared::{\n    Exchange, ExchangeSettings, Fee,\n    TokenPair, TokenType,\n    Pagination,\n    msg::factory::{InitMsg, HandleMsg, QueryMsg, QueryResponse},\n};\npub use fadroma_scrt_addr::{Humanize, Canonize};\npub use fadroma_scrt_callback::ContractInstantiationInfo;\npub use fadroma_scrt_storage::{load, save, remove};\npub use crate::{contract::*, state::*};\n\nfn mkenv (sender: impl Into\u003cHumanAddr\u003e) -\u003e Env {\n    mock_env(sender, \u0026[])\n}\n\nfn mkdeps () -\u003e Extern\u003cimpl Storage, impl Api, impl Querier\u003e {\n    mock_dependencies(10, \u0026[])\n}\n\nfn mkconfig (id: u64) -\u003e Config\u003cHumanAddr\u003e {\n    Config::from_init_msg(InitMsg {\n        snip20_contract:   ContractInstantiationInfo { id, code_hash: \"snip20\".into() },\n        lp_token_contract: ContractInstantiationInfo { id, code_hash: \"lptoken\".into(), },\n        pair_contract:     ContractInstantiationInfo { id, code_hash: \"2341586789\".into(), },\n        ido_contract:      ContractInstantiationInfo { id,  code_hash: \"348534835\".into(), },\n        exchange_settings: ExchangeSettings {\n            swap_fee: Fee::new(28, 10000),\n            sienna_fee: Fee::new(2, 10000),\n            sienna_burner: None\n        }\n    })\n}\n\nfn assert_unauthorized(response: StdResult\u003cHandleResponse\u003e) {\n    assert!(response.is_err());\n    let err = response.unwrap_err();\n    assert_eq!(err, StdError::unauthorized())\n}\n\nmod test_contract {\n    use super::*;\n\n    #[test] fn ok_init () -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let env = mkenv(\"sender1111\");\n        let config = mkconfig(0);\n        assert!(init(deps, env, (\u0026config).into()).is_ok());\n        assert_eq!(config, load_config(deps)?);\n        Ok(())\n    }\n\n    #[test] fn ok_get_set_config () -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let config1 = mkconfig(1);\n        let env = mkenv(\"sender1111\");\n        // init with some config\n        assert!(init(deps, env.clone(), (\u0026config1).into()).is_ok());\n        // get current config\n        let response: QueryResponse = from_binary(\u0026query(deps, QueryMsg::GetConfig {})?)?;\n        assert_eq!(response, (\u0026config1).into());\n        // set config to something else\n        let config2 = mkconfig(2);\n        assert!(handle(deps, env, (\u0026config2).into()).is_ok());\n        // updated config is returned\n        let response: QueryResponse = from_binary(\u0026query(deps, QueryMsg::GetConfig {})?)?;\n        assert_eq!(response, (\u0026config2).into());\n        Ok(())\n    }\n\n    #[test] fn create_exchange_for_the_same_tokens_returns_error() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n        );\n\n        let result = create_exchange(deps, mkenv(\"sender\"), pair);\n\n        let error: StdError = result.unwrap_err();\n\n        let result = match error {\n            StdError::GenericErr { msg, .. } =\u003e {\n                if msg.as_str() == \"Cannot create an exchange with the same token.\" {\n                    true\n                } else {\n                    false\n                }\n            }\n            _ =\u003e false\n        };\n\n        assert!(result);\n\n        let pair = TokenPair (\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n        );\n\n        let result = create_exchange(deps, mkenv(\"sender\"), pair);\n\n        let error: StdError = result.unwrap_err();\n\n        let result = match error {\n            StdError::GenericErr { msg, .. } =\u003e {\n                if msg.as_str() == \"Cannot create an exchange with the same token.\" {\n                    true\n                } else {\n                    false\n                }\n            }\n            _ =\u003e false\n        };\n\n        assert!(result);\n\n        Ok(())\n    }\n\n    #[test] fn test_register_exchange() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n        );\n\n        let sender_addr = HumanAddr(\"sender1111\".into());\n\n        let result = handle(\n            deps,\n            mkenv(sender_addr.clone()),\n            HandleMsg::RegisterExchange {\n                pair: pair.clone(),\n                signature: to_binary(\"whatever\")?\n            }\n        );\n\n        assert_unauthorized(result);\n\n        let config = mkconfig(0);\n        save_config(deps, \u0026config)?;\n\n        let env = mkenv(sender_addr.clone());\n\n        let signature = create_signature(\u0026env)?;\n        save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n        handle(\n            deps,\n            env,\n            HandleMsg::RegisterExchange {\n                pair: pair.clone(),\n                signature\n            }\n        )?;\n\n        //Ensure that the ephemeral storage is empty after the message\n        let result: Option\u003cBinary\u003e = load(\u0026deps.storage, EPHEMERAL_STORAGE_KEY)?;\n        \n        match result {\n            None =\u003e { },\n            _ =\u003e panic!(\"Ephemeral storage should be empty!\")\n        }\n\n        Ok(())\n    }\n\n    #[test] fn test_register_ido() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let sender_addr = HumanAddr(\"sender1111\".into());\n\n        let result = handle(\n            deps,\n            mkenv(sender_addr.clone()),\n            HandleMsg::RegisterIdo {\n                signature: to_binary(\"whatever\")?\n            }\n        );\n\n        assert_unauthorized(result);\n\n        let config = mkconfig(0);\n        save_config(deps, \u0026config)?;\n\n        let env = mkenv(sender_addr.clone());\n\n        let signature = create_signature(\u0026env)?;\n        save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n        handle(\n            deps,\n            env,\n            HandleMsg::RegisterIdo {\n                signature\n            }\n        )?;\n        //Ensure that the ephemeral storage is empty after the message\n        let result: Option\u003cBinary\u003e = load(\u0026deps.storage, EPHEMERAL_STORAGE_KEY)?;\n        \n        match result {\n            None =\u003e { },\n            _ =\u003e panic!(\"Ephemeral storage should be empty!\")\n        }\n\n        Ok(())\n    }\n\n    #[test] fn query_exchange() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"token_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"test1\".into()\n            },\n        );\n\n        let config = mkconfig(0);\n        save_config(deps, \u0026config)?;\n\n        let sender_addr = HumanAddr(\"sender1111\".into());\n        let env = mkenv(sender_addr.clone());\n\n        let signature = create_signature(\u0026env)?;\n        save(\u0026mut deps.storage, EPHEMERAL_STORAGE_KEY, \u0026signature)?;\n\n        handle(\n            deps,\n            env,\n            HandleMsg::RegisterExchange {\n                pair: pair.clone(),\n                signature\n            }\n        ).unwrap();\n        \n        let result = query(\n            deps,\n            QueryMsg::GetExchangeAddress {\n                pair: pair.clone()\n            }\n        )?;\n\n        let response: QueryResponse = from_binary(\u0026result)?;\n\n        match response {\n            QueryResponse::GetExchangeAddress { address } =\u003e assert_eq!(sender_addr, address),\n            _ =\u003e return Err(StdError::generic_err(\"Wrong response. Expected: QueryResponse::GetExchangeAddress.\"))\n        };\n        \n        Ok(())\n    }\n}\n\nmod test_state {\n    use super::*;\n\n    fn swap_pair\u003cA: Clone\u003e (pair: \u0026TokenPair\u003cA\u003e) -\u003e TokenPair\u003cA\u003e {\n        TokenPair(pair.1.clone(), pair.0.clone())\n    }\n\n    fn pagination(start: u64, limit: u8) -\u003e Pagination {\n        Pagination { start, limit }\n    }\n\n    fn mock_config() -\u003e Config\u003cHumanAddr\u003e {\n        Config::from_init_msg(InitMsg {\n            snip20_contract: ContractInstantiationInfo {\n                id: 1,\n                code_hash: \"snip20_contract\".into()\n            },\n            lp_token_contract: ContractInstantiationInfo {\n                id: 2,\n                code_hash: \"lp_token_contract\".into()\n            },\n            ido_contract: ContractInstantiationInfo {\n                id: 3,\n                code_hash: \"ido_contract\".into()\n            },\n            pair_contract: ContractInstantiationInfo {\n                id: 4,\n                code_hash: \"pair_contract\".into()\n            },\n            exchange_settings: ExchangeSettings {\n                swap_fee: Fee::new(28, 10000),\n                sienna_fee: Fee::new(2, 10000),\n                sienna_burner: None\n            }\n        })\n    }\n\n    #[test]\n    fn generates_the_same_key_for_swapped_pairs() -\u003e StdResult\u003c()\u003e {\n        fn cmp_pair\u003cS: Storage, A: Api, Q: Querier\u003e(\n            deps: \u0026Extern\u003cS, A, Q\u003e,\n            pair: TokenPair\u003cHumanAddr\u003e\n        ) -\u003e StdResult\u003c()\u003e {\n            let stored_pair = pair.canonize(\u0026deps.api)?;\n            let key = generate_pair_key(\u0026stored_pair);\n\n            let pair = swap_pair(\u0026pair);\n\n            let stored_pair = pair.canonize(\u0026deps.api)?;\n            let swapped_key = generate_pair_key(\u0026stored_pair);\n\n            assert_eq!(key, swapped_key);\n\n            Ok(())\n        }\n\n        let ref deps = mkdeps();\n\n        cmp_pair(\n            deps,\n            TokenPair(\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"first_addr\".into()),\n                    token_code_hash: \"13123adasd\".into()\n                },\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"scnd_addr\".into()),\n                    token_code_hash: \"4534qwerqqw\".into()\n                }\n            )\n        )?;\n\n        cmp_pair(\n            deps,\n            TokenPair(\n                TokenType::NativeToken {\n                    denom: \"test1\".into()\n                },\n                TokenType::NativeToken {\n                    denom: \"test2\".into()\n                },\n            )\n        )?;\n\n        cmp_pair(\n            deps,\n            TokenPair(\n                TokenType::NativeToken {\n                    denom: \"test3\".into()\n                },\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(\"third_addr\".into()),\n                    token_code_hash: \"asd21312asd\".into()\n                }\n            )\n        )?;\n\n        Ok(())\n    }\n\n    #[test]\n    fn query_correct_exchange_info() -\u003e StdResult\u003c()\u003e {\n        let mut deps = mkdeps();\n\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"first_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"scnd_addr\".into()),\n                token_code_hash: \"4534qwerqqw\".into()\n            }\n        );\n\n        let address = HumanAddr(\"ctrct_addr\".into());\n\n        store_exchange(\u0026mut deps, \u0026pair, \u0026address)?;\n\n        let retrieved_address = get_address_for_pair(\u0026deps, \u0026pair)?;\n\n        assert!(pair_exists(\u0026mut deps, \u0026pair)?);\n        assert_eq!(address, retrieved_address);\n\n        Ok(())\n    }\n\n    #[test]\n    fn only_one_exchange_per_factory() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let pair = TokenPair (\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"first_addr\".into()),\n                token_code_hash: \"13123adasd\".into()\n            },\n            TokenType::CustomToken {\n                contract_addr: HumanAddr(\"scnd_addr\".into()),\n                token_code_hash: \"4534qwerqqw\".into()\n            }\n        );\n\n        store_exchange(deps, \u0026pair, \u0026\"first_addr\".into())?;\n\n        let swapped = swap_pair(\u0026pair);\n\n        match store_exchange(deps, \u0026swapped, \u0026\"other_addr\".into()) {\n            Ok(_) =\u003e Err(StdError::generic_err(\"Exchange already exists\")),\n            Err(_) =\u003e Ok(())\n        }\n    }\n\n    #[test]\n    fn test_get_idos() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n        let mut config = mock_config();\n\n        save_config(deps, \u0026config)?;\n\n        let mut addresses = vec![];\n\n        for i in 0..33 {\n            let addr = HumanAddr::from(format!(\"addr_{}\", i));\n\n            store_ido_address(deps, \u0026addr, \u0026mut config)?;\n            addresses.push(addr);\n        }\n\n        let mut config = load_config(deps)?;\n\n        let result = get_idos(deps, \u0026mut config, pagination(addresses.len() as u64, 20))?;\n        assert_eq!(result.len(), 0);\n\n        let result = get_idos(deps, \u0026mut config, pagination((addresses.len() - 1) as u64, 20))?;\n        assert_eq!(result.len(), 1);\n\n        let result = get_idos(deps, \u0026mut config, pagination(0, PAGINATION_LIMIT + 10))?;\n        assert_eq!(result.len(), PAGINATION_LIMIT as usize);\n\n        let result = get_idos(deps, \u0026mut config, pagination(3, PAGINATION_LIMIT))?;\n        assert_eq!(result, addresses[3..]);\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_get_exchanges() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = mkdeps();\n\n        let mut exchanges = vec![];\n\n        for i in 0..33 {\n            let pair = TokenPair (\n                TokenType::CustomToken {\n                    contract_addr: HumanAddr(format!(\"addr_{}\", i)),\n                    token_code_hash: format!(\"code_hash_{}\", i)\n                },\n                TokenType::NativeToken {\n                    denom: format!(\"denom_{}\", i)\n                },\n            );\n            let address = HumanAddr(format!(\"address_{}\", i));\n\n            store_exchange(deps, \u0026pair, \u0026address)?;\n\n            exchanges.push(Exchange { pair, address });\n        }\n\n        let result = get_exchanges(deps, pagination(exchanges.len() as u64, 20))?;\n        assert_eq!(result.len(), 0);\n\n        let result = get_exchanges(deps, pagination((exchanges.len() - 1) as u64, 20))?;\n        assert_eq!(result.len(), 1);\n\n        let result = get_exchanges(deps, pagination(0, PAGINATION_LIMIT + 10))?;\n        assert_eq!(result.len(), PAGINATION_LIMIT as usize);\n\n        let result = get_exchanges(deps, pagination(3, PAGINATION_LIMIT))?;\n        assert_eq!(result, exchanges[3..]);\n\n        Ok(())\n    }\n}\n","traces":[{"line":17,"address":[819200,819248],"length":1,"stats":{"Line":2},"fn_name":"mkenv\u003c\u0026str\u003e"},{"line":18,"address":[819221,819260],"length":1,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[1037872],"length":1,"stats":{"Line":6},"fn_name":"mkdeps"},{"line":22,"address":[1037880],"length":1,"stats":{"Line":6},"fn_name":null},{"line":25,"address":[1038858,1037920],"length":1,"stats":{"Line":1},"fn_name":"mkconfig"},{"line":26,"address":[1038588],"length":1,"stats":{"Line":3},"fn_name":null},{"line":27,"address":[1037950],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[1038021],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[1038174,1038097],"length":1,"stats":{"Line":4},"fn_name":null},{"line":30,"address":[1038291,1038214],"length":1,"stats":{"Line":6},"fn_name":null},{"line":31,"address":[1038532],"length":1,"stats":{"Line":3},"fn_name":null},{"line":32,"address":[1038331],"length":1,"stats":{"Line":3},"fn_name":null},{"line":33,"address":[1038427],"length":1,"stats":{"Line":3},"fn_name":null},{"line":34,"address":[1038520],"length":1,"stats":{"Line":3},"fn_name":null},{"line":39,"address":[1038896,1039468],"length":1,"stats":{"Line":1},"fn_name":"assert_unauthorized"},{"line":40,"address":[1039105,1038908],"length":1,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[1038999],"length":1,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[1039137,1039353,1039285],"length":1,"stats":{"Line":4},"fn_name":null},{"line":48,"address":[916203,916218,914976],"length":1,"stats":{"Line":3},"fn_name":"ok_init"},{"line":49,"address":[914993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[915032],"length":1,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[915059],"length":1,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[915355,915230,915123,915489],"length":1,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[915482,915537,915955,916017],"length":1,"stats":{"Line":3},"fn_name":null},{"line":54,"address":[916139],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[916224,919734,919749],"length":1,"stats":{"Line":3},"fn_name":"ok_get_set_config"},{"line":58,"address":[916250],"length":1,"stats":{"Line":1},"fn_name":null},{"line":59,"address":[916316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":60,"address":[916323],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[916390,916775,916458,916527],"length":1,"stats":{"Line":3},"fn_name":null},{"line":64,"address":[916732,917205,917680,916807],"length":1,"stats":{"Line":3},"fn_name":null},{"line":65,"address":[917649,917723],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[917974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[918335,918178,917981],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[919328,918779,918368,918292],"length":1,"stats":{"Line":3},"fn_name":null},{"line":71,"address":[919371,919297],"length":1,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[919614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[919760,922675],"length":1,"stats":{"Line":3},"fn_name":"create_exchange_for_the_same_tokens_returns_error"},{"line":76,"address":[919777],"length":1,"stats":{"Line":1},"fn_name":null},{"line":79,"address":[919963],"length":1,"stats":{"Line":1},"fn_name":null},{"line":80,"address":[919832],"length":1,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[919895],"length":1,"stats":{"Line":1},"fn_name":null},{"line":83,"address":[920215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":84,"address":[920039,920111],"length":1,"stats":{"Line":2},"fn_name":null},{"line":85,"address":[920143],"length":1,"stats":{"Line":1},"fn_name":null},{"line":89,"address":[920495,920427],"length":1,"stats":{"Line":2},"fn_name":null},{"line":91,"address":[920692],"length":1,"stats":{"Line":1},"fn_name":null},{"line":94,"address":[920826],"length":1,"stats":{"Line":1},"fn_name":null},{"line":95,"address":[920948,921038,920885,921072],"length":1,"stats":{"Line":3},"fn_name":null},{"line":96,"address":[921074],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[921064],"length":1,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[920908],"length":1,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[920916,921157],"length":1,"stats":{"Line":1},"fn_name":null},{"line":107,"address":[921189],"length":1,"stats":{"Line":1},"fn_name":null},{"line":108,"address":[921126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[921264],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[921233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[921512,921444],"length":1,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[921709],"length":1,"stats":{"Line":1},"fn_name":null},{"line":120,"address":[921843],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[921965,922055,922085,921902],"length":1,"stats":{"Line":3},"fn_name":null},{"line":122,"address":[922087],"length":1,"stats":{"Line":1},"fn_name":null},{"line":124,"address":[922077],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[921925],"length":1,"stats":{"Line":0},"fn_name":null},{"line":130,"address":[922164,921933],"length":1,"stats":{"Line":1},"fn_name":null},{"line":132,"address":[922144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[927443,927458,922704],"length":1,"stats":{"Line":3},"fn_name":"test_register_exchange"},{"line":136,"address":[922727],"length":1,"stats":{"Line":1},"fn_name":null},{"line":139,"address":[922921],"length":1,"stats":{"Line":1},"fn_name":null},{"line":140,"address":[922790],"length":1,"stats":{"Line":1},"fn_name":null},{"line":141,"address":[922853],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[923069],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[922997],"length":1,"stats":{"Line":1},"fn_name":null},{"line":148,"address":[923313,923241],"length":1,"stats":{"Line":2},"fn_name":null},{"line":152,"address":[923425,923361,923470],"length":1,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[923721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":154,"address":[923478],"length":1,"stats":{"Line":1},"fn_name":null},{"line":155,"address":[923925,923570,923635,923505],"length":1,"stats":{"Line":3},"fn_name":null},{"line":159,"address":[924329],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[924479],"length":1,"stats":{"Line":1},"fn_name":null},{"line":162,"address":[924881,924615,924548,924672],"length":1,"stats":{"Line":2},"fn_name":null},{"line":164,"address":[924942,924657],"length":1,"stats":{"Line":2},"fn_name":null},{"line":166,"address":[924973,925187,925048,925396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":167,"address":[925466,925621,925514,925139,925830],"length":1,"stats":{"Line":3},"fn_name":null},{"line":171,"address":[925540],"length":1,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[925916],"length":1,"stats":{"Line":1},"fn_name":null},{"line":173,"address":[925586],"length":1,"stats":{"Line":1},"fn_name":null},{"line":174,"address":[925876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[926856,926643,927068],"length":1,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[926816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[927222],"length":1,"stats":{"Line":0},"fn_name":null},{"line":186,"address":[927196],"length":1,"stats":{"Line":1},"fn_name":null},{"line":189,"address":[931219,927472,931234],"length":1,"stats":{"Line":3},"fn_name":"test_register_ido"},{"line":190,"address":[927495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[927550],"length":1,"stats":{"Line":1},"fn_name":null},{"line":196,"address":[927689,927734,927629],"length":1,"stats":{"Line":3},"fn_name":null},{"line":197,"address":[927920],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[928012,927742,927834],"length":1,"stats":{"Line":2},"fn_name":null},{"line":202,"address":[928359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":204,"address":[928509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":205,"address":[928911,928645,928702,928578],"length":1,"stats":{"Line":2},"fn_name":null},{"line":207,"address":[928687,928972],"length":1,"stats":{"Line":2},"fn_name":null},{"line":209,"address":[929003,929078,929426,929217],"length":1,"stats":{"Line":2},"fn_name":null},{"line":210,"address":[929944,929496,929544,929169,929735],"length":1,"stats":{"Line":3},"fn_name":null},{"line":214,"address":[929573],"length":1,"stats":{"Line":1},"fn_name":null},{"line":215,"address":[929659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":216,"address":[929619],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[930670,930882,930457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[930630],"length":1,"stats":{"Line":1},"fn_name":null},{"line":224,"address":[931017],"length":1,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[930991],"length":1,"stats":{"Line":1},"fn_name":null},{"line":230,"address":[935475,935460,931248],"length":1,"stats":{"Line":3},"fn_name":"query_exchange"},{"line":231,"address":[931271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":234,"address":[931457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":235,"address":[931326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":236,"address":[931389],"length":1,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[931605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":239,"address":[931533],"length":1,"stats":{"Line":1},"fn_name":null},{"line":243,"address":[931789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":244,"address":[931858,931966,931922,932031,932240],"length":1,"stats":{"Line":3},"fn_name":null},{"line":246,"address":[931992,932285],"length":1,"stats":{"Line":2},"fn_name":null},{"line":247,"address":[932404,932333],"length":1,"stats":{"Line":2},"fn_name":null},{"line":249,"address":[932848,932639,932428,932500],"length":1,"stats":{"Line":2},"fn_name":null},{"line":250,"address":[932591,932918,933282,932966,933073],"length":1,"stats":{"Line":3},"fn_name":null},{"line":254,"address":[932992],"length":1,"stats":{"Line":1},"fn_name":null},{"line":255,"address":[933368],"length":1,"stats":{"Line":1},"fn_name":null},{"line":256,"address":[933038],"length":1,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[933328],"length":1,"stats":{"Line":1},"fn_name":null},{"line":263,"address":[933700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":264,"address":[933673],"length":1,"stats":{"Line":1},"fn_name":null},{"line":268,"address":[934613,934248,934404,933978,934296],"length":1,"stats":{"Line":3},"fn_name":null},{"line":271,"address":[935087,934670,934379],"length":1,"stats":{"Line":3},"fn_name":null},{"line":272,"address":[934799],"length":1,"stats":{"Line":0},"fn_name":null},{"line":275,"address":[935215],"length":1,"stats":{"Line":1},"fn_name":null},{"line":282,"address":[1205677,1205504,1205662],"length":1,"stats":{"Line":1},"fn_name":"swap_pair\u003ccosmwasm_std::addresses::HumanAddr\u003e"},{"line":283,"address":[1205534,1205627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[1097488],"length":1,"stats":{"Line":1},"fn_name":"pagination"},{"line":290,"address":[1098457,1097536],"length":1,"stats":{"Line":1},"fn_name":"mock_config"},{"line":291,"address":[1098187],"length":1,"stats":{"Line":1},"fn_name":null},{"line":292,"address":[1097579],"length":1,"stats":{"Line":1},"fn_name":null},{"line":294,"address":[1097553],"length":1,"stats":{"Line":1},"fn_name":null},{"line":296,"address":[1097654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":298,"address":[1097623],"length":1,"stats":{"Line":1},"fn_name":null},{"line":300,"address":[1097770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[1097698],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[1097886],"length":1,"stats":{"Line":1},"fn_name":null},{"line":306,"address":[1097814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":308,"address":[1098131],"length":1,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[1097930],"length":1,"stats":{"Line":1},"fn_name":null},{"line":310,"address":[1098026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":311,"address":[1098119],"length":1,"stats":{"Line":1},"fn_name":null},{"line":317,"address":[1098496,1100946],"length":1,"stats":{"Line":3},"fn_name":"generates_the_same_key_for_swapped_pairs"},{"line":318,"address":[1207479,1205728,1207494],"length":1,"stats":{"Line":1},"fn_name":"cmp_pair\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":322,"address":[1206113,1205771,1206322,1205851],"length":1,"stats":{"Line":2},"fn_name":null},{"line":323,"address":[1206098],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[1206378],"length":1,"stats":{"Line":1},"fn_name":null},{"line":327,"address":[1206427,1206830,1207056,1206553,1206508],"length":1,"stats":{"Line":3},"fn_name":null},{"line":328,"address":[1206815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":330,"address":[1207138,1207352,1207265],"length":1,"stats":{"Line":2},"fn_name":null},{"line":332,"address":[1207316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[1098513],"length":1,"stats":{"Line":1},"fn_name":null},{"line":339,"address":[1098995],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[1098667],"length":1,"stats":{"Line":1},"fn_name":null},{"line":341,"address":[1098536],"length":1,"stats":{"Line":1},"fn_name":null},{"line":342,"address":[1098599],"length":1,"stats":{"Line":1},"fn_name":null},{"line":344,"address":[1098919],"length":1,"stats":{"Line":1},"fn_name":null},{"line":345,"address":[1098743,1098815],"length":1,"stats":{"Line":2},"fn_name":null},{"line":346,"address":[1098847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":353,"address":[1099650],"length":1,"stats":{"Line":1},"fn_name":null},{"line":354,"address":[1099531],"length":1,"stats":{"Line":1},"fn_name":null},{"line":355,"address":[1099241],"length":1,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[1099606],"length":1,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[1099575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":365,"address":[1100429],"length":1,"stats":{"Line":1},"fn_name":null},{"line":366,"address":[1100174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[1099896],"length":1,"stats":{"Line":1},"fn_name":null},{"line":369,"address":[1100353],"length":1,"stats":{"Line":1},"fn_name":null},{"line":370,"address":[1100218],"length":1,"stats":{"Line":1},"fn_name":null},{"line":371,"address":[1100281],"length":1,"stats":{"Line":1},"fn_name":null},{"line":376,"address":[1100680],"length":1,"stats":{"Line":1},"fn_name":null},{"line":380,"address":[1100976,1103217,1103232],"length":1,"stats":{"Line":4},"fn_name":"query_correct_exchange_info"},{"line":381,"address":[1100993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":384,"address":[1101134],"length":1,"stats":{"Line":1},"fn_name":null},{"line":385,"address":[1101003],"length":1,"stats":{"Line":1},"fn_name":null},{"line":386,"address":[1101066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":388,"address":[1101386],"length":1,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[1101210,1101282],"length":1,"stats":{"Line":2},"fn_name":null},{"line":390,"address":[1101314],"length":1,"stats":{"Line":1},"fn_name":null},{"line":394,"address":[1101662,1101590],"length":1,"stats":{"Line":2},"fn_name":null},{"line":396,"address":[1102103,1101894,1101787,1101832,1101723],"length":1,"stats":{"Line":3},"fn_name":null},{"line":398,"address":[1101879,1102506,1102168,1102294],"length":1,"stats":{"Line":2},"fn_name":null},{"line":400,"address":[1103038,1102279,1102549,1102883,1102597],"length":1,"stats":{"Line":3},"fn_name":null},{"line":401,"address":[1103074,1103120,1102960],"length":1,"stats":{"Line":2},"fn_name":null},{"line":403,"address":[1103085],"length":1,"stats":{"Line":1},"fn_name":null},{"line":407,"address":[1103232,1104540],"length":1,"stats":{"Line":3},"fn_name":"only_one_exchange_per_factory"},{"line":408,"address":[1103249],"length":1,"stats":{"Line":1},"fn_name":null},{"line":410,"address":[1103403],"length":1,"stats":{"Line":1},"fn_name":null},{"line":411,"address":[1103272],"length":1,"stats":{"Line":1},"fn_name":null},{"line":412,"address":[1103335],"length":1,"stats":{"Line":1},"fn_name":null},{"line":414,"address":[1103655],"length":1,"stats":{"Line":1},"fn_name":null},{"line":415,"address":[1103479,1103551],"length":1,"stats":{"Line":2},"fn_name":null},{"line":416,"address":[1103583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[1104020,1103859,1103956],"length":1,"stats":{"Line":3},"fn_name":null},{"line":422,"address":[1104429],"length":1,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[1104657,1104744,1104436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":425,"address":[1104555,1104726,1104659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[1104695],"length":1,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[1104992,1110089,1110074],"length":1,"stats":{"Line":3},"fn_name":"test_get_idos"},{"line":432,"address":[1105021],"length":1,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[1105066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":435,"address":[1105465,1105160,1105097,1105256,1105204],"length":1,"stats":{"Line":3},"fn_name":null},{"line":437,"address":[1105238],"length":1,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[1105510,1105646,1105755,1106510],"length":1,"stats":{"Line":4},"fn_name":null},{"line":440,"address":[1105791],"length":1,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[1106119,1106445,1106219,1106048],"length":1,"stats":{"Line":2},"fn_name":null},{"line":443,"address":[1106145],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[1106550,1105745,1106913,1106701],"length":1,"stats":{"Line":2},"fn_name":null},{"line":448,"address":[1107215,1106953,1107424,1107037,1106672],"length":1,"stats":{"Line":3},"fn_name":null},{"line":449,"address":[1107186,1107662,1107477],"length":1,"stats":{"Line":2},"fn_name":null},{"line":451,"address":[1108005,1108214,1107628,1107721],"length":1,"stats":{"Line":2},"fn_name":null},{"line":452,"address":[1107976,1108450,1108271],"length":1,"stats":{"Line":2},"fn_name":null},{"line":454,"address":[1108511,1108417,1108895,1108686],"length":1,"stats":{"Line":2},"fn_name":null},{"line":455,"address":[1108660,1108949,1109129],"length":1,"stats":{"Line":2},"fn_name":null},{"line":457,"address":[1109629,1109190,1109400,1109096],"length":1,"stats":{"Line":2},"fn_name":null},{"line":458,"address":[1109848,1109903,1109703,1109331],"length":1,"stats":{"Line":3},"fn_name":null},{"line":460,"address":[1109862],"length":1,"stats":{"Line":1},"fn_name":null},{"line":464,"address":[1110096,1115585,1115600],"length":1,"stats":{"Line":3},"fn_name":"test_get_exchanges"},{"line":465,"address":[1110125],"length":1,"stats":{"Line":1},"fn_name":null},{"line":467,"address":[1110178],"length":1,"stats":{"Line":1},"fn_name":null},{"line":469,"address":[1110304,1112537,1110470,1110358,1110185],"length":1,"stats":{"Line":5},"fn_name":null},{"line":471,"address":[1110967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":472,"address":[1110506],"length":1,"stats":{"Line":1},"fn_name":null},{"line":473,"address":[1110736,1110908],"length":1,"stats":{"Line":2},"fn_name":null},{"line":475,"address":[1111282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[1111223,1111051],"length":1,"stats":{"Line":2},"fn_name":null},{"line":479,"address":[1111642,1111470],"length":1,"stats":{"Line":2},"fn_name":null},{"line":481,"address":[1112211,1111773,1112437,1111844],"length":1,"stats":{"Line":2},"fn_name":null},{"line":483,"address":[1111873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":486,"address":[1112593,1112806,1113018,1110449],"length":1,"stats":{"Line":2},"fn_name":null},{"line":487,"address":[1112777,1113053,1113238],"length":1,"stats":{"Line":2},"fn_name":null},{"line":489,"address":[1113569,1113204,1113778,1113297],"length":1,"stats":{"Line":2},"fn_name":null},{"line":490,"address":[1113543,1114011,1113832],"length":1,"stats":{"Line":2},"fn_name":null},{"line":492,"address":[1114238,1113978,1114072,1114447],"length":1,"stats":{"Line":2},"fn_name":null},{"line":493,"address":[1114212,1114501,1114681],"length":1,"stats":{"Line":2},"fn_name":null},{"line":495,"address":[1114943,1114742,1115172,1114648],"length":1,"stats":{"Line":2},"fn_name":null},{"line":496,"address":[1115246,1114874,1115390,1115444],"length":1,"stats":{"Line":3},"fn_name":null},{"line":498,"address":[1115404],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":240,"coverable":247},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","factory","tests","integration.rs"],"content":"//! This integration test tries to run and call the generated wasm.\n//! It depends on a Wasm build being available, which you can create with `cargo wasm`.\n//! Then running `cargo integration-test` will validate we can properly call into that generated Wasm.\n//!\n//! You can easily convert unit tests to integration tests.\n//! 1. First copy them over verbatum,\n//! 2. Then change\n//!      let mut deps = mock_dependencies(20, \u0026[]);\n//!    to\n//!      let mut deps = mock_instance(WASM, \u0026[]);\n//! 3. If you access raw storage, where ever you see something like:\n//!      deps.storage.get(CONFIG_KEY).expect(\"no data stored\");\n//!    replace it with:\n//!      deps.with_storage(|store| {\n//!          let data = store.get(CONFIG_KEY).expect(\"no data stored\");\n//!          //...\n//!      });\n//! 4. Anywhere you see query(\u0026deps, ...) you must replace it with query(\u0026mut deps, ...)\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","contract.rs"],"content":"/// This contract implements SNIP-20 standard:\n/// https://github.com/SecretFoundation/SNIPs/blob/master/SNIP-20.md\nuse cosmwasm_std::{\n    log, to_binary, Api, BankMsg, Binary, CanonicalAddr, Coin, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, QueryResult, ReadonlyStorage, StdError,\n    StdResult, Storage, Uint128, WasmMsg\n};\n\nuse sienna_amm_shared::msg::snip20::Snip20InitMsg;\n\nuse crate::msg::{\n    space_pad, ContractStatusLevel, HandleAnswer, HandleMsg, QueryAnswer, QueryMsg,\n    ResponseStatus::Success,\n};\nuse crate::rand::sha_256;\nuse crate::receiver::Snip20ReceiveMsg;\nuse crate::state::{\n    get_receiver_hash, get_transfers, read_allowance, read_viewing_key, set_receiver_hash,\n    store_transfer, write_allowance, write_viewing_key, Balances, Config, Constants,\n    ReadonlyBalances, ReadonlyConfig,\n};\nuse crate::viewing_key::{ViewingKey, VIEWING_KEY_SIZE};\n\n/// We make sure that responses from `handle` are padded to a multiple of this size.\npub const RESPONSE_BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: Snip20InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let init_config = msg.config();\n    let mut total_supply: u128 = 0;\n    {\n        let mut balances = Balances::from_storage(\u0026mut deps.storage);\n        let initial_balances = msg.initial_balances.unwrap_or_default();\n        for balance in initial_balances {\n            let balance_address = deps.api.canonical_address(\u0026balance.address)?;\n            let amount = balance.amount.u128();\n            balances.set_account_balance(\u0026balance_address, amount);\n            if let Some(new_total_supply) = total_supply.checked_add(amount) {\n                total_supply = new_total_supply;\n            } else {\n                return Err(StdError::generic_err(\n                    \"The sum of all initial balances exceeds the maximum possible total supply\",\n                ));\n            }\n        }\n    }\n\n    // Check name, symbol, decimals\n    if !is_valid_name(\u0026msg.name) {\n        return Err(StdError::generic_err(\n            \"Name is not in the expected format (3-200 UTF-8 bytes)\",\n        ));\n    }\n    if !is_valid_symbol(\u0026msg.symbol) {\n        return Err(StdError::generic_err(\n            \"Ticker symbol is not in expected format [A-Za-z-]{3,12}\",\n        ));\n    }\n    if msg.decimals \u003e 18 {\n        return Err(StdError::generic_err(\"Decimals must not exceed 18\"));\n    }\n\n    let admin = msg.admin.unwrap_or_else(|| env.message.sender.clone());\n\n    let prng_seed_hashed = sha_256(\u0026msg.prng_seed.0);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    config.set_constants(\u0026Constants {\n        name: msg.name,\n        symbol: msg.symbol,\n        decimals: msg.decimals,\n        admin: admin.clone(),\n        prng_seed: prng_seed_hashed.to_vec(),\n        total_supply_is_public: init_config.public_total_supply(),\n    })?;\n    config.set_total_supply(total_supply);\n    config.set_contract_status(ContractStatusLevel::NormalRun);\n    config.set_minters(Vec::from([admin]))?;\n\n    let mut messages = vec![];\n\n    if let Some(callback) = msg.callback {\n        messages.push(\n            CosmosMsg::Wasm(WasmMsg::Execute {\n                contract_addr: callback.contract.address,\n                callback_code_hash: callback.contract.code_hash,\n                msg: callback.msg,\n                send: vec![],\n            })\n        )\n    }\n    \n    Ok(InitResponse {\n        messages,\n        log: vec![\n            log(\"token_address\", env.contract.address),\n            log(\"token_code_hash\", env.contract_code_hash)\n        ]\n    })\n}\n\nfn pad_response(response: StdResult\u003cHandleResponse\u003e) -\u003e StdResult\u003cHandleResponse\u003e {\n    response.map(|mut response| {\n        response.data = response.data.map(|mut data| {\n            space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n            data\n        });\n        response\n    })\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n\n    match contract_status {\n        ContractStatusLevel::StopAll | ContractStatusLevel::StopAllButRedeems =\u003e {\n            let response = match msg {\n                HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n                HandleMsg::Redeem { .. }\n                    if contract_status == ContractStatusLevel::StopAllButRedeems =\u003e\n                {\n                    return cmd_unavailable();\n                    //try_redeem(deps, env, amount)\n                }\n                _ =\u003e Err(StdError::generic_err(\n                    \"This contract is stopped and this action is not allowed\",\n                )),\n            };\n            return pad_response(response);\n        }\n        ContractStatusLevel::NormalRun =\u003e {} // If it's a normal run just continue\n    }\n\n    let response = match msg {\n        // Native\n        HandleMsg::Deposit { .. } =\u003e /* try_deposit(deps, env) */ cmd_unavailable(),\n        HandleMsg::Redeem { .. } =\u003e /* try_redeem(deps, env, amount) */ cmd_unavailable(),\n\n        // Base\n        HandleMsg::Transfer { .. } =\u003e /*try_transfer(deps, env, \u0026recipient, amount)*/ cmd_unavailable(),\n        HandleMsg::Send { .. } =\u003e /* try_send(deps, env, \u0026recipient, amount, msg)*/ cmd_unavailable(),\n        HandleMsg::Burn { .. } =\u003e /* try_burn(deps, env, amount)*/ cmd_unavailable(),\n        HandleMsg::RegisterReceive { code_hash, .. } =\u003e try_register_receive(deps, env, code_hash),\n        HandleMsg::CreateViewingKey { entropy, .. } =\u003e try_create_key(deps, env, entropy),\n        HandleMsg::SetViewingKey { key, .. } =\u003e try_set_key(deps, env, key),\n\n        // Allowance\n        HandleMsg::IncreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_increase_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::DecreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_decrease_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::TransferFrom {\n            owner,\n            recipient,\n            amount,\n            ..\n        } =\u003e try_transfer_from(deps, env, \u0026owner, \u0026recipient, amount),\n        HandleMsg::SendFrom { .. } =\u003e /*try_send_from(deps, env, \u0026owner, \u0026recipient, amount, msg)*/ cmd_unavailable(),\n        HandleMsg::BurnFrom { owner, amount, .. } =\u003e try_burn_from(deps, env, \u0026owner, amount),\n\n        // Mint\n        HandleMsg::Mint {\n            recipient, amount, ..\n        } =\u003e try_mint(deps, env, recipient, amount),\n\n        // Other\n        HandleMsg::ChangeAdmin { address, .. } =\u003e change_admin(deps, env, address),\n        HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n        HandleMsg::AddMinters { minters, .. } =\u003e add_minters(deps, env, minters),\n        HandleMsg::RemoveMinters { minters, .. } =\u003e remove_minters(deps, env, minters),\n        HandleMsg::SetMinters { minters, .. } =\u003e set_minters(deps, env, minters),\n    };\n\n    pad_response(response)\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e, msg: QueryMsg) -\u003e QueryResult {\n    match msg {\n        QueryMsg::TokenInfo {} =\u003e query_token_info(\u0026deps.storage),\n        QueryMsg::ExchangeRate {} =\u003e query_exchange_rate(),\n        QueryMsg::Minters { .. } =\u003e query_minters(deps),\n        _ =\u003e authenticated_queries(deps, msg),\n    }\n}\n\npub fn authenticated_queries\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e QueryResult {\n    let (addresses, key) = msg.get_validation_params();\n\n    for address in addresses {\n        let canonical_addr = deps.api.canonical_address(address)?;\n\n        let expected_key = read_viewing_key(\u0026deps.storage, \u0026canonical_addr);\n\n        if expected_key.is_none() {\n            // Checking the key will take significant time. We don't want to exit immediately if it isn't set\n            // in a way which will allow to time the command and determine if a viewing key doesn't exist\n            key.check_viewing_key(\u0026[0u8; VIEWING_KEY_SIZE]);\n        } else if key.check_viewing_key(expected_key.unwrap().as_slice()) {\n            return match msg {\n                // Base\n                QueryMsg::Balance { address, .. } =\u003e query_balance(\u0026deps, \u0026address),\n                QueryMsg::TransferHistory {\n                    address,\n                    page,\n                    page_size,\n                    ..\n                } =\u003e query_transactions(\u0026deps, \u0026address, page.unwrap_or(0), page_size),\n                QueryMsg::Allowance { owner, spender, .. } =\u003e {\n                    try_check_allowance(deps, owner, spender)\n                }\n                _ =\u003e panic!(\"This query type does not require authentication\"),\n            };\n        }\n    }\n\n    Ok(to_binary(\u0026QueryAnswer::ViewingKeyError {\n        msg: \"Wrong viewing key for this address or viewing key not set\".to_string(),\n    })?)\n}\n\n/// This function just returns a constant 1:1 rate to uscrt, since that's the purpose of this\n/// contract.\nfn query_exchange_rate() -\u003e QueryResult {\n    to_binary(\u0026QueryAnswer::ExchangeRate {\n        rate: Uint128(1),\n        denom: \"uscrt\".to_string(),\n    })\n}\n\nfn query_token_info\u003cS: ReadonlyStorage\u003e(storage: \u0026S) -\u003e QueryResult {\n    let config = ReadonlyConfig::from_storage(storage);\n    let constants = config.constants()?;\n\n    let total_supply = if constants.total_supply_is_public {\n        Some(Uint128(config.total_supply()))\n    } else {\n        None\n    };\n\n    to_binary(\u0026QueryAnswer::TokenInfo {\n        name: constants.name,\n        symbol: constants.symbol,\n        decimals: constants.decimals,\n        total_supply,\n    })\n}\n\npub fn query_transactions\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account).unwrap();\n    let txs = get_transfers(\u0026deps.api, \u0026deps.storage, \u0026address, page, page_size)?;\n\n    let result = QueryAnswer::TransferHistory { txs };\n    to_binary(\u0026result)\n}\n\npub fn query_balance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account)?;\n\n    let amount = Uint128(ReadonlyBalances::from_storage(\u0026deps.storage).account_amount(\u0026address));\n    let response = QueryAnswer::Balance { amount };\n    to_binary(\u0026response)\n}\n\nfn query_minters\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let minters = ReadonlyConfig::from_storage(\u0026deps.storage).minters();\n\n    let response = QueryAnswer::Minters { minters };\n    to_binary(\u0026response)\n}\n\nfn change_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    let mut consts = config.constants()?;\n    consts.admin = address;\n    config.set_constants(\u0026consts)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::ChangeAdmin { status: Success })?),\n    })\n}\n\nfn try_mint\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    let minters = config.minters();\n    if !minters.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(\n            \"Minting is allowed to minter accounts only\",\n        ));\n    }\n\n    let amount = amount.u128();\n\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_add(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the total supply above the supported maximum\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let receipient_account = \u0026deps.api.canonical_address(\u0026address)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n\n    let mut account_balance = balances.balance(receipient_account);\n\n    if let Some(new_balance) = account_balance.checked_add(amount) {\n        account_balance = new_balance;\n    } else {\n        // This error literally can not happen, since the account's funds are a subset\n        // of the total supply, both are stored as u128, and we check for overflow of\n        // the total supply just a couple lines before.\n        // Still, writing this to cover all overflows.\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the account's balance above the supported maximum\",\n        ));\n    }\n\n    balances.set_account_balance(receipient_account, account_balance);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Mint { status: Success })?),\n    };\n\n    Ok(res)\n}\n\npub fn try_set_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    key: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let vk = ViewingKey(key);\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026vk);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetViewingKey { status: Success })?),\n    })\n}\n\npub fn try_create_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    entropy: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let constants = ReadonlyConfig::from_storage(\u0026deps.storage).constants()?;\n    let prng_seed = constants.prng_seed;\n\n    let key = ViewingKey::new(\u0026env, \u0026prng_seed, (\u0026entropy).as_ref());\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026key);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::CreateViewingKey { key })?),\n    })\n}\n\nfn set_contract_status\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    status_level: ContractStatusLevel,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_contract_status(status_level);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetContractStatus {\n            status: Success,\n        })?),\n    })\n}\n\npub fn try_check_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    owner: HumanAddr,\n    spender: HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let owner_address = deps.api.canonical_address(\u0026owner)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    let response = QueryAnswer::Allowance {\n        owner,\n        spender,\n        allowance: Uint128(allowance.amount),\n        expiration: allowance.expiration,\n    };\n    to_binary(\u0026response)\n}\n\n#[allow(dead_code)]\nfn try_deposit\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut amount = Uint128::zero();\n\n    for coin in \u0026env.message.sent_funds {\n        if coin.denom == \"uscrt\" {\n            amount = coin.amount\n        }\n    }\n\n    if amount.is_zero() {\n        return Err(StdError::generic_err(\"No funds were sent to be deposited\"));\n    }\n\n    let amount = amount.u128();\n\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n    if let Some(account_balance) = account_balance.checked_add(amount) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow your balance\",\n        ));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_add(amount) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow the currency's total supply\",\n        ));\n    }\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Deposit { status: Success })?),\n    };\n\n    Ok(res)\n}\n\n#[allow(dead_code)]\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount_raw = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(account_balance) = account_balance.checked_sub(amount_raw) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to redeem: balance={}, required={}\",\n            account_balance, amount_raw\n        )));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_sub(amount_raw) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"You are tyring to redeem more tokens than what is available in the total supply\",\n        ));\n    }\n\n    let withdrawl_coins: Vec\u003cCoin\u003e = vec![Coin {\n        denom: \"uscrt\".to_string(),\n        amount,\n    }];\n\n    let res = HandleResponse {\n        messages: vec![CosmosMsg::Bank(BankMsg::Send {\n            from_address: env.contract.address,\n            to_address: env.message.sender,\n            amount: withdrawl_coins,\n        })],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Redeem { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_transfer_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount.u128(),\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\n#[allow(dead_code)]\nfn try_transfer\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Transfer { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_add_receiver_api_callback\u003cS: ReadonlyStorage\u003e(\n    messages: \u0026mut Vec\u003cCosmosMsg\u003e,\n    storage: \u0026S,\n    recipient: \u0026HumanAddr,\n    msg: Option\u003cBinary\u003e,\n    sender: HumanAddr,\n    from: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let receiver_hash = get_receiver_hash(storage, recipient);\n    if let Some(receiver_hash) = receiver_hash {\n        let receiver_hash = receiver_hash?;\n        let receiver_msg = Snip20ReceiveMsg::new(sender, from, amount, msg);\n        let callback_msg = receiver_msg.into_cosmos_msg(receiver_hash, recipient.clone())?;\n\n        messages.push(callback_msg);\n    }\n    Ok(())\n}\n\n#[allow(dead_code)]\nfn try_send\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender.clone(),\n        sender,\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Send { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_register_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    code_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    set_receiver_hash(\u0026mut deps.storage, \u0026env.message.sender, code_hash);\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![log(\"register_status\", \"success\")],\n        data: Some(to_binary(\u0026HandleAnswer::RegisterReceive {\n            status: Success,\n        })?),\n    };\n    Ok(res)\n}\n\nfn insufficient_allowance(allowance: u128, required: u128) -\u003e StdError {\n    StdError::generic_err(format!(\n        \"insufficient allowance: allowance={}, required={}\",\n        allowance, required\n    ))\n}\n\nfn try_transfer_from_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let spender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let owner_address = deps.api.canonical_address(owner)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n    let amount_raw = amount.u128();\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    if allowance.expiration.map(|ex| ex \u003c env.block.time) == Some(true) {\n        allowance.amount = 0;\n        write_allowance(\n            \u0026mut deps.storage,\n            \u0026owner_address,\n            \u0026spender_address,\n            allowance,\n        )?;\n        return Err(insufficient_allowance(0, amount_raw));\n    }\n\n    if let Some(new_allowance) = allowance.amount.checked_sub(amount_raw) {\n        allowance.amount = new_allowance;\n    } else {\n        return Err(insufficient_allowance(allowance.amount, amount_raw));\n    }\n\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026recipient_address,\n        amount_raw,\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\nfn try_transfer_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::TransferFrom { status: Success })?),\n    };\n    Ok(res)\n}\n#[allow(dead_code)]\nfn try_send_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender,\n        owner.clone(),\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SendFrom { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_burn_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    \n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    let amount = amount.u128();\n\n    // remove from supply\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    // subtract from owner account\n    let owner_address = deps.api.canonical_address(owner)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026owner_address);\n\n    if let Some(new_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n    balances.set_account_balance(\u0026owner_address, account_balance);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::BurnFrom { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_increase_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_add(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::IncreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn try_decrease_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_sub(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::DecreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn add_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_add: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.add_minters(minters_to_add)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::AddMinters { status: Success })?),\n    })\n}\n\nfn remove_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_remove: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.remove_minters(minters_to_remove)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::RemoveMinters { status: Success })?),\n    })\n}\n\nfn set_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_set: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_minters(minters_to_set)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetMinters { status: Success })?),\n    })\n}\n\n/// Burn tokens\n///\n/// Remove `amount` tokens from the system irreversibly, from signer account\n///\n/// @param amount the amount of money to burn\n#[allow(dead_code)]\nfn try_burn\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(new_account_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_account_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n\n    balances.set_account_balance(\u0026sender_address, account_balance);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Burn { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn perform_transfer\u003cT: Storage\u003e(\n    store: \u0026mut T,\n    from: \u0026CanonicalAddr,\n    to: \u0026CanonicalAddr,\n    amount: u128,\n) -\u003e StdResult\u003c()\u003e {\n    let mut balances = Balances::from_storage(store);\n\n    let mut from_balance = balances.balance(from);\n    if let Some(new_from_balance) = from_balance.checked_sub(amount) {\n        from_balance = new_from_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds: balance={}, required={}\",\n            from_balance, amount\n        )));\n    }\n    balances.set_account_balance(from, from_balance);\n\n    let mut to_balance = balances.balance(to);\n    to_balance = to_balance.checked_add(amount).ok_or_else(|| {\n        StdError::generic_err(\"This tx will literally make them too rich. Try transferring less\")\n    })?;\n    balances.set_account_balance(to, to_balance);\n\n    Ok(())\n}\n\nfn is_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003cbool\u003e {\n    let consts = config.constants()?;\n    if \u0026consts.admin != account {\n        return Ok(false);\n    }\n\n    Ok(true)\n}\n\nfn check_if_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003c()\u003e {\n    if !is_admin(config, account)? {\n        return Err(StdError::generic_err(\n            \"This is an admin command. Admin commands can only be run from admin address\",\n        ));\n    }\n\n    Ok(())\n}\n\nfn is_valid_name(name: \u0026str) -\u003e bool {\n    let len = name.len();\n    3 \u003c= len \u0026\u0026 len \u003c= 200\n}\n\nfn is_valid_symbol(symbol: \u0026str) -\u003e bool {\n    let len = symbol.len();\n    let len_is_valid = 3 \u003c= len \u0026\u0026 len \u003c= 12;\n\n    len_is_valid \u0026\u0026 symbol.bytes().all(|byte| {\n        (b'A' \u003c= byte \u0026\u0026 byte \u003c= b'Z') || (b'a' \u003c= byte \u0026\u0026 byte \u003c= b'z') || byte == b'-'\n    })\n}\n\nfn cmd_unavailable() -\u003e StdResult\u003cHandleResponse\u003e {\n    Err(StdError::unauthorized())\n}\n\n// pub fn migrate\u003cS: Storage, A: Api, Q: Querier\u003e(\n//     _deps: \u0026mut Extern\u003cS, A, Q\u003e,\n//     _env: Env,\n//     _msg: MigrateMsg,\n// ) -\u003e StdResult\u003cMigrateResponse\u003e {\n//     Ok(MigrateResponse::default())\n// }\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::testing::*;\n    use cosmwasm_std::{from_binary, BlockInfo, ContractInfo, MessageInfo, QueryResponse};\n    use std::any::Any;\n\n    use sienna_amm_shared::msg::snip20::{Snip20InitConfig as InitConfig, Snip20InitialBalance as InitialBalance};\n\n    use crate::msg::ResponseStatus;\n\n    // Helper functions\n\n    fn init_helper(\n        initial_balances: Vec\u003cInitialBalance\u003e,\n    ) -\u003e (\n        StdResult\u003cInitResponse\u003e,\n        Extern\u003cMockStorage, MockApi, MockQuerier\u003e,\n    ) {\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n\n        let init_msg = Snip20InitMsg {\n            name: \"sec-sec\".to_string(),\n            admin: Some(HumanAddr(\"admin\".to_string())),\n            symbol: \"SECSEC\".to_string(),\n            decimals: 8,\n            initial_balances: Some(initial_balances),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: None,\n            callback: None\n        };\n\n        (init(\u0026mut deps, env, init_msg), deps)\n    }\n    /*\n    /// Will return a ViewingKey only for the first account in `initial_balances`\n    fn auth_query_helper(\n        initial_balances: Vec\u003cInitialBalance\u003e,\n    ) -\u003e (ViewingKey, Extern\u003cMockStorage, MockApi, MockQuerier\u003e) {\n        let (init_result, mut deps) = init_helper(initial_balances.clone());\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let account = initial_balances[0].address.clone();\n        let create_vk_msg = HandleMsg::CreateViewingKey {\n            entropy: \"42\".to_string(),\n            padding: None,\n        };\n        let handle_response = handle(\u0026mut deps, mock_env(account.0, \u0026[]), create_vk_msg).unwrap();\n        let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"Unexpected result from handle\"),\n        };\n\n        (vk, deps)\n    }\n    */\n    fn extract_error_msg\u003cT: Any\u003e(error: StdResult\u003cT\u003e) -\u003e String {\n        match error {\n            Ok(response) =\u003e {\n                let bin_err = (\u0026response as \u0026dyn Any)\n                    .downcast_ref::\u003cQueryResponse\u003e()\n                    .expect(\"An error was expected, but no error could be extracted\");\n                match from_binary(bin_err).unwrap() {\n                    QueryAnswer::ViewingKeyError { msg } =\u003e msg,\n                    _ =\u003e panic!(\"Unexpected query answer\"),\n                }\n            }\n            Err(err) =\u003e match err {\n                StdError::GenericErr { msg, .. } =\u003e msg,\n                _ =\u003e panic!(\"Unexpected result from init\"),\n            },\n        }\n    }\n\n    fn ensure_success(handle_result: HandleResponse) -\u003e bool {\n        let handle_result: HandleAnswer = from_binary(\u0026handle_result.data.unwrap()).unwrap();\n\n        match handle_result {\n            HandleAnswer::Deposit { status }\n            | HandleAnswer::Redeem { status }\n            | HandleAnswer::Transfer { status }\n            | HandleAnswer::Send { status }\n            | HandleAnswer::Burn { status }\n            | HandleAnswer::RegisterReceive { status }\n            | HandleAnswer::SetViewingKey { status }\n            | HandleAnswer::TransferFrom { status }\n            | HandleAnswer::SendFrom { status }\n            | HandleAnswer::BurnFrom { status }\n            | HandleAnswer::Mint { status }\n            | HandleAnswer::ChangeAdmin { status }\n            | HandleAnswer::SetContractStatus { status }\n            | HandleAnswer::SetMinters { status }\n            | HandleAnswer::AddMinters { status }\n            | HandleAnswer::RemoveMinters { status } =\u003e {\n                matches!(status, ResponseStatus::Success {..})\n            }\n            _ =\u003e panic!(\"HandleAnswer not supported for success extraction\"),\n        }\n    }\n\n    // Init tests\n\n    #[test]\n    fn test_init_sanity() {\n        let (init_result, deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert_ne!(init_result.unwrap(), InitResponse::default());\n        \n        let config = ReadonlyConfig::from_storage(\u0026deps.storage);\n        let constants = config.constants().unwrap();\n        assert_eq!(config.total_supply(), 5000);\n        assert_eq!(config.contract_status(), ContractStatusLevel::NormalRun);\n        assert_eq!(constants.name, \"sec-sec\".to_string());\n        assert_eq!(constants.admin, HumanAddr(\"admin\".to_string()));\n        assert_eq!(constants.symbol, \"SECSEC\".to_string());\n        assert_eq!(constants.decimals, 8);\n        assert_eq!(\n            constants.prng_seed,\n            sha_256(\"lolz fun yay\".to_owned().as_bytes())\n        );\n        assert_eq!(constants.total_supply_is_public, false);\n    }\n\n    #[test]\n    fn test_total_supply_overflow() {\n        let (init_result, _deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(u128::max_value()),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let (init_result, _deps) = init_helper(vec![\n            InitialBalance {\n                address: HumanAddr(\"lebron\".to_string()),\n                amount: Uint128(u128::max_value()),\n            },\n            InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: Uint128(1),\n            },\n        ]);\n        let error = extract_error_msg(init_result);\n        assert_eq!(\n            error,\n            \"The sum of all initial balances exceeds the maximum possible total supply\"\n        );\n    }\n\n    // Handle tests\n    /*\n    #[test]\n    fn test_handle_transfer() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        assert_eq!(5000 - 1000, balances.account_amount(\u0026bob_canonical));\n        assert_eq!(1000, balances.account_amount(\u0026alice_canonical));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(10000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient funds\"));\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_send() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let handle_msg = HandleMsg::Send {\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n            msg: Some(to_binary(\"hey hey you you\").unwrap()),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result.clone()));\n        assert!(result.messages.contains(\u0026CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr: HumanAddr(\"contract\".to_string()),\n            callback_code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            msg: Snip20ReceiveMsg::new(\n                HumanAddr(\"bob\".to_string()),\n                HumanAddr(\"bob\".to_string()),\n                Uint128(100),\n                Some(to_binary(\"hey hey you you\").unwrap())\n            )\n            .into_binary()\n            .unwrap(),\n            send: vec![]\n        })));\n    }\n    */\n    #[test]\n    fn test_handle_register_receive() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let hash = get_receiver_hash(\u0026deps.storage, \u0026HumanAddr(\"contract\".to_string()))\n            .unwrap()\n            .unwrap();\n        assert_eq!(hash, \"this_is_a_hash_of_a_code\".to_string());\n    }\n    \n    #[test]\n    fn test_handle_create_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::CreateViewingKey {\n            entropy: \"\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let answer: HandleAnswer = from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n\n        let key = match answer {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"NOPE\"),\n        };\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(key.check_viewing_key(saved_vk.as_slice()));\n    }\n    \n    #[test]\n    fn test_handle_set_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Set VK\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"hi lol\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        // Set valid VK\n        let actual_vk = ViewingKey(\"x\".to_string().repeat(VIEWING_KEY_SIZE));\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: actual_vk.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey { status: Success }).unwrap(),\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(actual_vk.check_viewing_key(\u0026saved_vk));\n    }\n    \n    #[test]\n    fn test_handle_transfer_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Transfer before allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: Some(1_571_797_420),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer after allowance expired\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\n            \u0026mut deps,\n            Env {\n                block: BlockInfo {\n                    height: 12_345,\n                    time: 1_571_797_420,\n                    chain_id: \"cosmos-testnet-14002\".to_string(),\n                },\n                message: MessageInfo {\n                    sender: HumanAddr(\"bob\".to_string()),\n                    sent_funds: vec![],\n                },\n                contract: ContractInfo {\n                    address: HumanAddr::from(MOCK_CONTRACT_ADDR),\n                },\n                contract_key: Some(\"\".to_string()),\n                contract_code_hash: \"\".to_string(),\n            },\n            handle_msg,\n        );\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let alice_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026alice_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(alice_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n    /*\n    #[test]\n    fn test_handle_send_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Send before allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Send more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"lolz\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let send_msg = Binary::from(r#\"{ \"some_msg\": { \"some_key\": \"some_val\" } }\"#.as_bytes());\n        let snip20_msg = Snip20ReceiveMsg::new(\n            HumanAddr(\"alice\".to_string()),\n            HumanAddr(\"bob\".to_string()),\n            Uint128(2000),\n            Some(send_msg.clone()),\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(2000),\n            msg: Some(send_msg),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        assert!(handle_result.unwrap().messages.contains(\n            \u0026snip20_msg\n                .into_cosmos_msg(\"lolz\".to_string(), HumanAddr(\"contract\".to_string()))\n                .unwrap()\n        ));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let contract_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"contract\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let contract_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026contract_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(contract_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_burn_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Burn before allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Burn more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000 - 2000);\n\n        // Second burn more than allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n    */\n    #[test]\n    fn test_handle_decrease_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 0,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(50),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 1950,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_increase_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 2000,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 4000,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_change_admin() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"bob\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let admin = ReadonlyConfig::from_storage(\u0026deps.storage)\n            .constants()\n            .unwrap()\n            .admin;\n        assert_eq!(admin, HumanAddr(\"bob\".to_string()));\n    }\n\n    #[test]\n    fn test_handle_set_contract_status() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"admin\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n        assert!(matches!(contract_status, ContractStatusLevel::StopAll{..}));\n    }\n    /*\n    #[test]\n    fn test_handle_redeem() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"butler\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Redeem {\n            amount: Uint128(1000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"butler\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"butler\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 4000)\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_deposit() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Deposit { padding: None };\n        let handle_result = handle(\n            \u0026mut deps,\n            mock_env(\n                \"lebron\",\n                \u0026[Coin {\n                    denom: \"uscrt\".to_string(),\n                    amount: Uint128(1000),\n                }],\n            ),\n            handle_msg,\n        );\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"lebron\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 6000)\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_burn() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let burn_amount: u128 = 100;\n        let handle_msg = HandleMsg::Burn {\n            amount: Uint128(burn_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply - burn_amount);\n    }\n    */\n    #[test]\n    fn test_handle_mint() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let mint_amount: u128 = 100;\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(mint_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply + mint_amount);\n    }\n\n    #[test]\n    fn test_handle_admin_commands() {\n        let admin_err = \"Admin commands can only be run from admin address\".to_string();\n\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), pause_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let change_admin_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"not_admin\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), change_admin_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n    }\n    /*\n    #[test]\n    fn test_handle_pause_with_withdrawals() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Withdraw failed: {}\",\n            handle_result.err().unwrap()\n        );\n    }\n    */\n    /*\n    #[test]\n    fn test_handle_pause_all() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n    }\n    */\n    #[test]\n    fn test_handle_set_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    #[test]\n    fn test_handle_add_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n    }\n\n    #[test]\n    fn test_handle_remove_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        // Removing another extra time to ensure nothing funky happens\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    // Query tests\n    /* \n    #[test]\n    fn test_authenticated_queries() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let no_vk_yet_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"no_vk_yet\".to_string(),\n        };\n        let query_result = query(\u0026deps, no_vk_yet_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n\n        let create_vk_msg = HandleMsg::CreateViewingKey {\n            entropy: \"34\".to_string(),\n            padding: None,\n        };\n        let handle_response = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), create_vk_msg).unwrap();\n        let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"Unexpected result from handle\"),\n        };\n\n        let query_balance_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: vk.0,\n        };\n\n        let query_response = query(\u0026deps, query_balance_msg).unwrap();\n        let balance = match from_binary(\u0026query_response).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected result from query\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n\n        let wrong_vk_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"wrong_vk\".to_string(),\n        };\n        let query_result = query(\u0026deps, wrong_vk_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n    }\n    */\n    #[test]\n    fn test_query_token_info() {\n        let init_name = \"sec-sec\".to_string();\n        let init_admin = HumanAddr(\"admin\".to_string());\n        let init_symbol = \"SECSEC\".to_string();\n        let init_decimals = 8;\n        let init_config: InitConfig = from_binary(\u0026Binary::from(\n            r#\"{ \"public_total_supply\": true }\"#.as_bytes(),\n        ))\n        .unwrap();\n        let init_supply = Uint128(5000);\n\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n        let init_msg = Snip20InitMsg {\n            name: init_name.clone(),\n            admin: Some(init_admin.clone()),\n            symbol: init_symbol.clone(),\n            decimals: init_decimals.clone(),\n            initial_balances: Some(vec![InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: init_supply,\n            }]),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: Some(init_config),\n            callback: None\n        };\n        let init_result = init(\u0026mut deps, env, init_msg);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let query_msg = QueryMsg::TokenInfo {};\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Init failed: {}\",\n            query_result.err().unwrap()\n        );\n        let query_answer: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        match query_answer {\n            QueryAnswer::TokenInfo {\n                name,\n                symbol,\n                decimals,\n                total_supply,\n            } =\u003e {\n                assert_eq!(name, init_name);\n                assert_eq!(symbol, init_symbol);\n                assert_eq!(decimals, init_decimals);\n                assert_eq!(total_supply, Some(Uint128(5000)));\n            }\n            _ =\u003e panic!(\"unexpected\"),\n        }\n    }\n    /*\n    #[test]\n    fn test_query_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let vk1 = ViewingKey(\"key1\".to_string());\n        let vk2 = ViewingKey(\"key2\".to_string());\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Query failed: {}\",\n            query_result.err().unwrap()\n        );\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk1.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk2.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"lebron\".to_string()),\n            spender: HumanAddr(\"giannis\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(0));\n    }\n    */\n    /*\n    #[test]\n    fn test_query_balance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"wrong_key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let balance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n    }\n    */\n    /*\n    #[test]\n    fn test_query_transfer_history() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"banana\".to_string()),\n            amount: Uint128(500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"mango\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 0,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        // let a: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        // println!(\"{:?}\", a);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert!(transfers.is_empty());\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 10,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 3);\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 2,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 2);\n    }\n    */\n}\n","traces":[{"line":27,"address":[5301206,5295072],"length":1,"stats":{"Line":7},"fn_name":"init\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":32,"address":[5295138],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[5295316],"length":1,"stats":{"Line":7},"fn_name":null},{"line":35,"address":[5295348],"length":1,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[5295404],"length":1,"stats":{"Line":7},"fn_name":null},{"line":37,"address":[5295705,5295741,5295554,5295459,5296932],"length":1,"stats":{"Line":10},"fn_name":null},{"line":38,"address":[5295949,5296173,5296382,5296044],"length":1,"stats":{"Line":8},"fn_name":null},{"line":39,"address":[5296441,5296127],"length":1,"stats":{"Line":8},"fn_name":null},{"line":40,"address":[5296473],"length":1,"stats":{"Line":7},"fn_name":null},{"line":41,"address":[5296531],"length":1,"stats":{"Line":1},"fn_name":null},{"line":42,"address":[5296670],"length":1,"stats":{"Line":7},"fn_name":null},{"line":44,"address":[5296708],"length":1,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[5296994],"length":1,"stats":{"Line":7},"fn_name":null},{"line":53,"address":[5297085],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[5297176,5297058],"length":1,"stats":{"Line":8},"fn_name":null},{"line":58,"address":[5297222],"length":1,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[5297207],"length":1,"stats":{"Line":7},"fn_name":null},{"line":63,"address":[5297387],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[5301360,5297476,5301377,5297316],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":68,"address":[5297484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[5297597],"length":1,"stats":{"Line":7},"fn_name":null},{"line":71,"address":[5298417,5297852,5298101,5298189],"length":1,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[5297612],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[5297643],"length":1,"stats":{"Line":7},"fn_name":null},{"line":74,"address":[5297675],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[5297701],"length":1,"stats":{"Line":7},"fn_name":null},{"line":76,"address":[5297708],"length":1,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[5297781],"length":1,"stats":{"Line":7},"fn_name":null},{"line":79,"address":[5298509],"length":1,"stats":{"Line":7},"fn_name":null},{"line":80,"address":[5298540],"length":1,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[5298988,5298776,5298571],"length":1,"stats":{"Line":7},"fn_name":null},{"line":83,"address":[5298758],"length":1,"stats":{"Line":7},"fn_name":null},{"line":85,"address":[5299699,5299459],"length":1,"stats":{"Line":8},"fn_name":null},{"line":86,"address":[5300122,5300214],"length":1,"stats":{"Line":0},"fn_name":null},{"line":87,"address":[5299842],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[5299581],"length":1,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[5299613],"length":1,"stats":{"Line":0},"fn_name":null},{"line":90,"address":[5299645],"length":1,"stats":{"Line":0},"fn_name":null},{"line":91,"address":[5299677],"length":1,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[5300533],"length":1,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[5299701],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[5299751,5300319],"length":1,"stats":{"Line":7},"fn_name":null},{"line":99,"address":[5299772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":100,"address":[5300246],"length":1,"stats":{"Line":7},"fn_name":null},{"line":105,"address":[661168],"length":1,"stats":{"Line":1},"fn_name":"pad_response"},{"line":106,"address":[2196427,2196272,2196439],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":107,"address":[2196144,2196290,2196250,2196262],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":108,"address":[2196163],"length":1,"stats":{"Line":1},"fn_name":null},{"line":109,"address":[2196194],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[2196365],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[5308335,5301712],"length":1,"stats":{"Line":3},"fn_name":"handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":120,"address":[5302119,5301770],"length":1,"stats":{"Line":7},"fn_name":null},{"line":122,"address":[5302195],"length":1,"stats":{"Line":0},"fn_name":null},{"line":123,"address":[5302178],"length":1,"stats":{"Line":1},"fn_name":null},{"line":124,"address":[5302712],"length":1,"stats":{"Line":0},"fn_name":null},{"line":125,"address":[5302248,5302366],"length":1,"stats":{"Line":0},"fn_name":null},{"line":127,"address":[5302316,5302591],"length":1,"stats":{"Line":0},"fn_name":null},{"line":129,"address":[5302608],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[5302670,5302282],"length":1,"stats":{"Line":0},"fn_name":null},{"line":136,"address":[5302470,5302717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":141,"address":[5304288],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[5302205,5304316,5307118],"length":1,"stats":{"Line":6},"fn_name":null},{"line":144,"address":[5304298,5307123],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[5304334,5307113],"length":1,"stats":{"Line":0},"fn_name":null},{"line":148,"address":[5307108,5304352],"length":1,"stats":{"Line":0},"fn_name":null},{"line":149,"address":[5307103,5304370],"length":1,"stats":{"Line":0},"fn_name":null},{"line":150,"address":[5307098,5304396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":151,"address":[5304556,5307093],"length":1,"stats":{"Line":2},"fn_name":null},{"line":152,"address":[5304716,5307088],"length":1,"stats":{"Line":2},"fn_name":null},{"line":155,"address":[5304876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[5305158],"length":1,"stats":{"Line":1},"fn_name":null},{"line":167,"address":[5305544,5306958],"length":1,"stats":{"Line":2},"fn_name":null},{"line":173,"address":[5305662,5306953],"length":1,"stats":{"Line":0},"fn_name":null},{"line":174,"address":[5305688,5306890],"length":1,"stats":{"Line":0},"fn_name":null},{"line":177,"address":[5305854],"length":1,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[5306874,5306514],"length":1,"stats":{"Line":2},"fn_name":null},{"line":183,"address":[5306668],"length":1,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[5306052,5306880],"length":1,"stats":{"Line":2},"fn_name":null},{"line":185,"address":[5306878,5306206],"length":1,"stats":{"Line":2},"fn_name":null},{"line":186,"address":[5306876,5306360],"length":1,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[5306760],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[5308400,5308670],"length":1,"stats":{"Line":1},"fn_name":"query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":194,"address":[5308668,5308435,5308580],"length":1,"stats":{"Line":3},"fn_name":null},{"line":195,"address":[5308666,5308592],"length":1,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[5308609,5308664],"length":1,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[5308616,5308506],"length":1,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[5308736,5311731],"length":1,"stats":{"Line":0},"fn_name":"authenticated_queries\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":205,"address":[5308774],"length":1,"stats":{"Line":0},"fn_name":null},{"line":207,"address":[5309087,5309201,5308941,5309289,5309309,5310943],"length":1,"stats":{"Line":0},"fn_name":null},{"line":208,"address":[5309511,5309341,5309724],"length":1,"stats":{"Line":0},"fn_name":null},{"line":210,"address":[5309475,5309769],"length":1,"stats":{"Line":0},"fn_name":null},{"line":212,"address":[5310141,5309843,5309984,5309785],"length":1,"stats":{"Line":0},"fn_name":null},{"line":215,"address":[5309957],"length":1,"stats":{"Line":0},"fn_name":null},{"line":216,"address":[5310005,5309887],"length":1,"stats":{"Line":0},"fn_name":null},{"line":219,"address":[5310412,5310689,5310151],"length":1,"stats":{"Line":0},"fn_name":null},{"line":221,"address":[5310472],"length":1,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[5310504],"length":1,"stats":{"Line":0},"fn_name":null},{"line":223,"address":[5310524],"length":1,"stats":{"Line":0},"fn_name":null},{"line":225,"address":[5310538],"length":1,"stats":{"Line":0},"fn_name":null},{"line":226,"address":[5310243],"length":1,"stats":{"Line":0},"fn_name":null},{"line":227,"address":[5310307,5310749],"length":1,"stats":{"Line":0},"fn_name":null},{"line":229,"address":[5310200],"length":1,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[5311475,5310975,5311056,5311158],"length":1,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[5310948],"length":1,"stats":{"Line":0},"fn_name":null},{"line":241,"address":[661406,661232],"length":1,"stats":{"Line":0},"fn_name":"query_exchange_rate"},{"line":242,"address":[661297],"length":1,"stats":{"Line":0},"fn_name":null},{"line":243,"address":[661249],"length":1,"stats":{"Line":0},"fn_name":null},{"line":244,"address":[661267],"length":1,"stats":{"Line":0},"fn_name":null},{"line":248,"address":[5312208,5312836],"length":1,"stats":{"Line":1},"fn_name":"query_token_info\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":249,"address":[5312233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[5312419,5312256,5312642,5312323],"length":1,"stats":{"Line":2},"fn_name":null},{"line":252,"address":[5312797,5312395,5312694],"length":1,"stats":{"Line":2},"fn_name":null},{"line":253,"address":[5312704],"length":1,"stats":{"Line":1},"fn_name":null},{"line":255,"address":[5312682],"length":1,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[5312943],"length":1,"stats":{"Line":1},"fn_name":null},{"line":259,"address":[5312856],"length":1,"stats":{"Line":1},"fn_name":null},{"line":260,"address":[5312882],"length":1,"stats":{"Line":1},"fn_name":null},{"line":261,"address":[5312911],"length":1,"stats":{"Line":1},"fn_name":null},{"line":262,"address":[5312919],"length":1,"stats":{"Line":1},"fn_name":null},{"line":266,"address":[5313296,5314108,5314123],"length":1,"stats":{"Line":0},"fn_name":"query_transactions\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":272,"address":[5313358],"length":1,"stats":{"Line":0},"fn_name":null},{"line":273,"address":[5313708,5313506,5313940,5313418],"length":1,"stats":{"Line":0},"fn_name":null},{"line":275,"address":[5313605],"length":1,"stats":{"Line":0},"fn_name":null},{"line":276,"address":[5313693],"length":1,"stats":{"Line":0},"fn_name":null},{"line":279,"address":[5314675,5314128,5314660],"length":1,"stats":{"Line":0},"fn_name":"query_balance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":283,"address":[5314166,5314290],"length":1,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[5314461,5314390,5314283],"length":1,"stats":{"Line":0},"fn_name":null},{"line":286,"address":[5314534],"length":1,"stats":{"Line":0},"fn_name":null},{"line":287,"address":[5314582],"length":1,"stats":{"Line":0},"fn_name":null},{"line":290,"address":[5314688,5314801],"length":1,"stats":{"Line":0},"fn_name":"query_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":291,"address":[5314712],"length":1,"stats":{"Line":0},"fn_name":null},{"line":293,"address":[5314820],"length":1,"stats":{"Line":0},"fn_name":null},{"line":294,"address":[5314890],"length":1,"stats":{"Line":0},"fn_name":null},{"line":297,"address":[5317641,5317656,5315024],"length":1,"stats":{"Line":1},"fn_name":"change_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":302,"address":[5315061],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[5315268,5315159,5315217,5315094,5315465],"length":1,"stats":{"Line":4},"fn_name":null},{"line":306,"address":[5316050,5315838,5315253,5315523],"length":1,"stats":{"Line":2},"fn_name":null},{"line":307,"address":[5316077,5316137,5315780],"length":1,"stats":{"Line":2},"fn_name":null},{"line":308,"address":[5316325,5316227,5316130,5316550],"length":1,"stats":{"Line":2},"fn_name":null},{"line":310,"address":[5316901],"length":1,"stats":{"Line":1},"fn_name":null},{"line":311,"address":[5316310],"length":1,"stats":{"Line":1},"fn_name":null},{"line":312,"address":[5316604],"length":1,"stats":{"Line":1},"fn_name":null},{"line":313,"address":[5316611,5316673,5316798,5316737,5317087],"length":1,"stats":{"Line":3},"fn_name":null},{"line":317,"address":[5317664,5320488,5320473],"length":1,"stats":{"Line":1},"fn_name":"try_mint\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":323,"address":[5317746],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[5317769],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[5317972,5317817,5317913],"length":1,"stats":{"Line":3},"fn_name":null},{"line":327,"address":[5318013],"length":1,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[5318121,5317978],"length":1,"stats":{"Line":2},"fn_name":null},{"line":334,"address":[5318145],"length":1,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[5318204],"length":1,"stats":{"Line":1},"fn_name":null},{"line":336,"address":[5318343],"length":1,"stats":{"Line":1},"fn_name":null},{"line":338,"address":[5318390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":342,"address":[5318359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":344,"address":[5318487,5318666,5318878],"length":1,"stats":{"Line":1},"fn_name":null},{"line":346,"address":[5318648],"length":1,"stats":{"Line":1},"fn_name":null},{"line":348,"address":[5318921,5319005],"length":1,"stats":{"Line":2},"fn_name":null},{"line":350,"address":[5319021,5319131],"length":1,"stats":{"Line":2},"fn_name":null},{"line":351,"address":[5319198],"length":1,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[5319253],"length":1,"stats":{"Line":0},"fn_name":null},{"line":362,"address":[5319214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":365,"address":[5319355],"length":1,"stats":{"Line":1},"fn_name":null},{"line":366,"address":[5319370],"length":1,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[5319503,5319439,5319916,5319377,5319541],"length":1,"stats":{"Line":3},"fn_name":null},{"line":370,"address":[5319743],"length":1,"stats":{"Line":1},"fn_name":null},{"line":373,"address":[5322076,5320496,5322091],"length":1,"stats":{"Line":1},"fn_name":"try_set_key\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":378,"address":[5320530],"length":1,"stats":{"Line":1},"fn_name":null},{"line":380,"address":[5320761,5320654,5320567,5320980],"length":1,"stats":{"Line":2},"fn_name":null},{"line":381,"address":[5320746],"length":1,"stats":{"Line":1},"fn_name":null},{"line":383,"address":[5321412],"length":1,"stats":{"Line":1},"fn_name":null},{"line":384,"address":[5321067],"length":1,"stats":{"Line":1},"fn_name":null},{"line":385,"address":[5321120],"length":1,"stats":{"Line":1},"fn_name":null},{"line":386,"address":[5321127,5321250,5321599,5321309,5321186],"length":1,"stats":{"Line":3},"fn_name":null},{"line":390,"address":[5322096,5325410,5325395],"length":1,"stats":{"Line":1},"fn_name":"try_create_key\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":395,"address":[5322139,5322239],"length":1,"stats":{"Line":2},"fn_name":null},{"line":396,"address":[5322816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":398,"address":[5322954,5323048,5322856],"length":1,"stats":{"Line":3},"fn_name":null},{"line":400,"address":[5323155,5323274,5323065,5323496],"length":1,"stats":{"Line":2},"fn_name":null},{"line":401,"address":[5323259],"length":1,"stats":{"Line":1},"fn_name":null},{"line":403,"address":[5324253],"length":1,"stats":{"Line":1},"fn_name":null},{"line":404,"address":[5323704],"length":1,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[5323760],"length":1,"stats":{"Line":1},"fn_name":null},{"line":406,"address":[5324150,5323767,5323966,5324443,5324030],"length":1,"stats":{"Line":3},"fn_name":null},{"line":410,"address":[5326805,5326820,5325424],"length":1,"stats":{"Line":1},"fn_name":"set_contract_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":415,"address":[5325472],"length":1,"stats":{"Line":1},"fn_name":null},{"line":417,"address":[5325483,5325602,5325859,5325652,5325544],"length":1,"stats":{"Line":4},"fn_name":null},{"line":419,"address":[5325629],"length":1,"stats":{"Line":1},"fn_name":null},{"line":421,"address":[5326208],"length":1,"stats":{"Line":1},"fn_name":null},{"line":422,"address":[5325909],"length":1,"stats":{"Line":1},"fn_name":null},{"line":423,"address":[5325924],"length":1,"stats":{"Line":1},"fn_name":null},{"line":424,"address":[5325993,5325931,5326591,5326105],"length":1,"stats":{"Line":2},"fn_name":null},{"line":430,"address":[5328642,5326832],"length":1,"stats":{"Line":0},"fn_name":"try_check_allowance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":435,"address":[5327301,5326872,5326988,5327097],"length":1,"stats":{"Line":0},"fn_name":null},{"line":436,"address":[5327745,5327066,5327532,5327363,5327408],"length":1,"stats":{"Line":0},"fn_name":null},{"line":438,"address":[5328442,5328209,5327517,5327807,5327855],"length":1,"stats":{"Line":0},"fn_name":null},{"line":443,"address":[5328018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":444,"address":[5328050],"length":1,"stats":{"Line":0},"fn_name":null},{"line":446,"address":[5328194],"length":1,"stats":{"Line":0},"fn_name":null},{"line":646,"address":[5328672,5329842],"length":1,"stats":{"Line":1},"fn_name":"try_register_receive\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":651,"address":[5328721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":653,"address":[5328762],"length":1,"stats":{"Line":1},"fn_name":null},{"line":654,"address":[5328816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":655,"address":[5329144,5329692,5328998],"length":1,"stats":{"Line":1},"fn_name":null},{"line":659,"address":[5329410],"length":1,"stats":{"Line":1},"fn_name":null},{"line":662,"address":[661440],"length":1,"stats":{"Line":1},"fn_name":"insufficient_allowance"},{"line":663,"address":[661477],"length":1,"stats":{"Line":1},"fn_name":null},{"line":669,"address":[5329872,5334802,5334817],"length":1,"stats":{"Line":1},"fn_name":"try_transfer_from_impl\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":676,"address":[5330399,5329966,5330062,5330186],"length":1,"stats":{"Line":2},"fn_name":null},{"line":677,"address":[5330843,5330155,5330458,5330630,5330506],"length":1,"stats":{"Line":3},"fn_name":null},{"line":678,"address":[5330599,5331082,5330956,5331295,5330908],"length":1,"stats":{"Line":3},"fn_name":null},{"line":679,"address":[5331359,5331039],"length":1,"stats":{"Line":2},"fn_name":null},{"line":681,"address":[5331611,5331463,5331824,5331399],"length":1,"stats":{"Line":2},"fn_name":null},{"line":683,"address":[5334845,5334832,5331558,5331877],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":684,"address":[5332001],"length":1,"stats":{"Line":0},"fn_name":null},{"line":689,"address":[5332025],"length":1,"stats":{"Line":0},"fn_name":null},{"line":691,"address":[5332169,5332435],"length":1,"stats":{"Line":0},"fn_name":null},{"line":694,"address":[5332473,5331936],"length":1,"stats":{"Line":2},"fn_name":null},{"line":695,"address":[5332545],"length":1,"stats":{"Line":1},"fn_name":null},{"line":697,"address":[5332642],"length":1,"stats":{"Line":1},"fn_name":null},{"line":704,"address":[5332561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":713,"address":[5334040,5333117,5333391],"length":1,"stats":{"Line":3},"fn_name":null},{"line":720,"address":[5334238],"length":1,"stats":{"Line":1},"fn_name":null},{"line":721,"address":[5334254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":724,"address":[5334434],"length":1,"stats":{"Line":1},"fn_name":null},{"line":727,"address":[5334864,5335250],"length":1,"stats":{"Line":1},"fn_name":"try_transfer_from\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":734,"address":[5334967,5335094],"length":1,"stats":{"Line":2},"fn_name":null},{"line":737,"address":[5335079],"length":1,"stats":{"Line":1},"fn_name":null},{"line":738,"address":[5335184],"length":1,"stats":{"Line":1},"fn_name":null},{"line":739,"address":[5335364,5335191,5335729,5335329,5335265],"length":1,"stats":{"Line":3},"fn_name":null},{"line":741,"address":[5335654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":775,"address":[5339198,5339213,5336048],"length":1,"stats":{"Line":0},"fn_name":"try_burn_from\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":781,"address":[5336138],"length":1,"stats":{"Line":0},"fn_name":null},{"line":783,"address":[5336153,5336221,5336285,5336363,5336572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":785,"address":[5336633,5336311],"length":1,"stats":{"Line":0},"fn_name":null},{"line":788,"address":[5336657],"length":1,"stats":{"Line":0},"fn_name":null},{"line":789,"address":[5336718],"length":1,"stats":{"Line":0},"fn_name":null},{"line":790,"address":[5336879],"length":1,"stats":{"Line":0},"fn_name":null},{"line":792,"address":[5336926],"length":1,"stats":{"Line":0},"fn_name":null},{"line":796,"address":[5336895],"length":1,"stats":{"Line":0},"fn_name":null},{"line":799,"address":[5337186,5337023,5337398],"length":1,"stats":{"Line":0},"fn_name":null},{"line":801,"address":[5337168],"length":1,"stats":{"Line":0},"fn_name":null},{"line":802,"address":[5337441,5337515],"length":1,"stats":{"Line":0},"fn_name":null},{"line":804,"address":[5337659,5337531],"length":1,"stats":{"Line":0},"fn_name":null},{"line":805,"address":[5337726],"length":1,"stats":{"Line":0},"fn_name":null},{"line":807,"address":[5337792],"length":1,"stats":{"Line":0},"fn_name":null},{"line":812,"address":[5337742],"length":1,"stats":{"Line":0},"fn_name":null},{"line":815,"address":[5338192],"length":1,"stats":{"Line":0},"fn_name":null},{"line":816,"address":[5338207],"length":1,"stats":{"Line":0},"fn_name":null},{"line":817,"address":[5338214,5338276,5338340,5338753,5338378],"length":1,"stats":{"Line":0},"fn_name":null},{"line":820,"address":[5338580],"length":1,"stats":{"Line":0},"fn_name":null},{"line":823,"address":[5339216,5342750],"length":1,"stats":{"Line":1},"fn_name":"try_increase_allowance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":830,"address":[5339545,5339754,5339298,5339421],"length":1,"stats":{"Line":2},"fn_name":null},{"line":831,"address":[5339991,5339816,5340200,5339514,5339864],"length":1,"stats":{"Line":3},"fn_name":null},{"line":833,"address":[5339976,5340313,5340462,5340671,5340265],"length":1,"stats":{"Line":3},"fn_name":null},{"line":834,"address":[5340845,5340396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":835,"address":[5340869],"length":1,"stats":{"Line":1},"fn_name":null},{"line":836,"address":[5340894],"length":1,"stats":{"Line":1},"fn_name":null},{"line":838,"address":[5340931],"length":1,"stats":{"Line":1},"fn_name":null},{"line":843,"address":[5340972],"length":1,"stats":{"Line":1},"fn_name":null},{"line":847,"address":[5341104],"length":1,"stats":{"Line":1},"fn_name":null},{"line":848,"address":[5341366],"length":1,"stats":{"Line":1},"fn_name":null},{"line":849,"address":[5341754,5341639,5342171,5341472],"length":1,"stats":{"Line":2},"fn_name":null},{"line":855,"address":[5342783],"length":1,"stats":{"Line":1},"fn_name":null},{"line":858,"address":[5346921,5343392],"length":1,"stats":{"Line":1},"fn_name":"try_decrease_allowance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":865,"address":[5343930,5343721,5343474,5343597],"length":1,"stats":{"Line":2},"fn_name":null},{"line":866,"address":[5344167,5343690,5343992,5344376,5344040],"length":1,"stats":{"Line":3},"fn_name":null},{"line":868,"address":[5344638,5344441,5344152,5344847,5344489],"length":1,"stats":{"Line":3},"fn_name":null},{"line":869,"address":[5345016,5344572],"length":1,"stats":{"Line":2},"fn_name":null},{"line":870,"address":[5345040],"length":1,"stats":{"Line":1},"fn_name":null},{"line":871,"address":[5345065],"length":1,"stats":{"Line":0},"fn_name":null},{"line":873,"address":[5345102],"length":1,"stats":{"Line":1},"fn_name":null},{"line":878,"address":[5345143],"length":1,"stats":{"Line":1},"fn_name":null},{"line":882,"address":[5345275],"length":1,"stats":{"Line":1},"fn_name":null},{"line":883,"address":[5345537],"length":1,"stats":{"Line":1},"fn_name":null},{"line":884,"address":[5345925,5346342,5345643,5345810],"length":1,"stats":{"Line":2},"fn_name":null},{"line":890,"address":[5346954],"length":1,"stats":{"Line":1},"fn_name":null},{"line":893,"address":[5349408,5349393,5347568],"length":1,"stats":{"Line":2},"fn_name":"add_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":898,"address":[5347605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":900,"address":[5347638,5347703,5347855,5347761,5348052],"length":1,"stats":{"Line":4},"fn_name":null},{"line":902,"address":[5348094,5348170,5348382,5347788],"length":1,"stats":{"Line":2},"fn_name":null},{"line":904,"address":[5348720],"length":1,"stats":{"Line":1},"fn_name":null},{"line":905,"address":[5348155],"length":1,"stats":{"Line":1},"fn_name":null},{"line":906,"address":[5348436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":907,"address":[5348443,5348505,5348569,5348617,5348903],"length":1,"stats":{"Line":3},"fn_name":null},{"line":911,"address":[5351248,5349408,5351233],"length":1,"stats":{"Line":2},"fn_name":"remove_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":916,"address":[5349445],"length":1,"stats":{"Line":1},"fn_name":null},{"line":918,"address":[5349892,5349478,5349601,5349695,5349543],"length":1,"stats":{"Line":4},"fn_name":null},{"line":920,"address":[5349934,5350010,5350222,5349628],"length":1,"stats":{"Line":2},"fn_name":null},{"line":922,"address":[5350560],"length":1,"stats":{"Line":1},"fn_name":null},{"line":923,"address":[5349995],"length":1,"stats":{"Line":1},"fn_name":null},{"line":924,"address":[5350276],"length":1,"stats":{"Line":1},"fn_name":null},{"line":925,"address":[5350457,5350345,5350283,5350743,5350409],"length":1,"stats":{"Line":3},"fn_name":null},{"line":929,"address":[5353073,5351248,5353088],"length":1,"stats":{"Line":2},"fn_name":"set_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":934,"address":[5351285],"length":1,"stats":{"Line":1},"fn_name":null},{"line":936,"address":[5351318,5351535,5351732,5351441,5351383],"length":1,"stats":{"Line":4},"fn_name":null},{"line":938,"address":[5352062,5351850,5351468,5351774],"length":1,"stats":{"Line":2},"fn_name":null},{"line":940,"address":[5352400],"length":1,"stats":{"Line":1},"fn_name":null},{"line":941,"address":[5351835],"length":1,"stats":{"Line":1},"fn_name":null},{"line":942,"address":[5352116],"length":1,"stats":{"Line":1},"fn_name":null},{"line":943,"address":[5352249,5352123,5352185,5352583,5352297],"length":1,"stats":{"Line":3},"fn_name":null},{"line":995,"address":[5354506,5354521,5353088],"length":1,"stats":{"Line":1},"fn_name":"perform_transfer\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1001,"address":[5353167],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1003,"address":[5353196],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[5353257,5353397],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1005,"address":[5353472],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1007,"address":[5353530],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1012,"address":[5353488],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1014,"address":[5353921],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1015,"address":[5354117,5354528,5353970,5354409],"length":1,"stats":{"Line":1},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1016,"address":[5354540],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1018,"address":[5354175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1020,"address":[5354484],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1023,"address":[5354576,5355040],"length":1,"stats":{"Line":1},"fn_name":"is_admin\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1024,"address":[5354907,5354606],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1025,"address":[5355000,5354868],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1026,"address":[5355084],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1032,"address":[5355104],"length":1,"stats":{"Line":1},"fn_name":"check_if_admin\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1033,"address":[5355137],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1034,"address":[5355302],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1039,"address":[5355293],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1042,"address":[661760],"length":1,"stats":{"Line":1},"fn_name":"is_valid_name"},{"line":1043,"address":[661774],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1044,"address":[661792],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1047,"address":[661856],"length":1,"stats":{"Line":7},"fn_name":"is_valid_symbol"},{"line":1048,"address":[661880],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1049,"address":[661900],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1051,"address":[2196448],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}"},{"line":1052,"address":[2196468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1056,"address":[662016],"length":1,"stats":{"Line":0},"fn_name":"cmd_unavailable"},{"line":1057,"address":[662029],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1081,"address":[3932592,3933780],"length":1,"stats":{"Line":5},"fn_name":"init_helper"},{"line":1087,"address":[3932614],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1088,"address":[3932749,3932669],"length":1,"stats":{"Line":14},"fn_name":null},{"line":1091,"address":[3932757],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1092,"address":[3932883,3932818],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1093,"address":[3932947],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1095,"address":[3933020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1096,"address":[3933209],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1101,"address":[3933667,3933537],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1129,"address":[5476435,5476832,5477157,5476128],"length":1,"stats":{"Line":2},"fn_name":"extract_error_msg\u003ccosmwasm_std::init_handle::InitResponse\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":1130,"address":[5476866,5476162],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1131,"address":[5476854,5476150,5476873,5476169],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1132,"address":[5476196,5476502,5476918,5477297,5476575,5477224],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1135,"address":[5477313,5476591],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1136,"address":[5476625,5477350],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1137,"address":[5476728,5477468],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1140,"address":[5476953,5476231],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1141,"address":[5476975,5476253],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1142,"address":[5477087,5476365],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1147,"address":[3933808,3934495],"length":1,"stats":{"Line":1},"fn_name":"ensure_success"},{"line":1148,"address":[3933931,3933820],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1150,"address":[3934150,3934318,3934168,3934240,3934222,3934378,3934333,3934273,3934363,3934258,3934132,3934204,3934186,3934348,3934288,3934303],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1151,"address":[3934155],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1167,"address":[3934382],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1169,"address":[3934086],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1176,"address":[3934839,3934592],"length":1,"stats":{"Line":3},"fn_name":"test_init_sanity"},{"line":1177,"address":[3934599,3934854,3934692],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1178,"address":[3934633],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1181,"address":[3935206,3935009],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1183,"address":[3935495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1184,"address":[3935518],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1185,"address":[3935857,3935603],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1186,"address":[3935911,3936085,3935825],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1187,"address":[3936042,3936140],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1188,"address":[3936366],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1189,"address":[3936663],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1190,"address":[3937055,3936916],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1191,"address":[3937158,3937005],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1193,"address":[3937110,3937018],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1195,"address":[3937475,3937369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1199,"address":[3937632,3937940],"length":1,"stats":{"Line":3},"fn_name":"test_total_supply_overflow"},{"line":1200,"address":[3937822,3937639,3937758,3937955],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1201,"address":[3937681],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1202,"address":[3937798],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1204,"address":[3938371,3938117],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1205,"address":[3938100],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1207,"address":[3938221],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1210,"address":[3938175,3938609,3938852],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1211,"address":[3938673],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1212,"address":[3938191,3938559],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1213,"address":[3938649],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1215,"address":[3938796],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1216,"address":[3938737],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1220,"address":[3939157],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1221,"address":[3939292,3939413,3939487],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1317,"address":[3939967,3939712],"length":1,"stats":{"Line":3},"fn_name":"test_handle_register_receive"},{"line":1318,"address":[3939719,3939820,3939982],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1319,"address":[3939761],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1322,"address":[3940147,3940378],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1323,"address":[3940130],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1325,"address":[3940225],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1329,"address":[3940195],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1332,"address":[3940658],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1333,"address":[3940913],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1334,"address":[3941039,3941190],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1336,"address":[3941228,3941163,3941354],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1339,"address":[3941403,3941479],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1343,"address":[3942111,3941840],"length":1,"stats":{"Line":3},"fn_name":"test_handle_create_viewing_key"},{"line":1344,"address":[3942126,3941964,3941847],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1345,"address":[3941905],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1348,"address":[3942527,3942294],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1349,"address":[3942277],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1351,"address":[3942371],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1355,"address":[3942342],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1358,"address":[3943062,3942807],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1359,"address":[3943447,3943095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1360,"address":[3943078],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1362,"address":[3943282],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1364,"address":[3943636,3943967,3943145],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1367,"address":[3944023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1368,"address":[3944176],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1370,"address":[3944136,3944246,3944313],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1372,"address":[3944149,3944214],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1374,"address":[3944424,3944472],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1375,"address":[3944502,3944613,3944638],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1379,"address":[3945223,3944960],"length":1,"stats":{"Line":3},"fn_name":"test_handle_set_viewing_key"},{"line":1380,"address":[3944967,3945238,3945076],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1381,"address":[3945017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1384,"address":[3945661,3945418],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1385,"address":[3945401],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1387,"address":[3945496],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1392,"address":[3945466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1395,"address":[3945941],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1396,"address":[3946196,3946640],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1398,"address":[3946823],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1399,"address":[3946712],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1400,"address":[3946771],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1407,"address":[3947099],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1409,"address":[3947284],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1412,"address":[3947443],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1413,"address":[3948142,3947698],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1415,"address":[3948325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1416,"address":[3948214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1417,"address":[3948273],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1419,"address":[3948678,3948601],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1421,"address":[3948614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1423,"address":[3948867,3948819],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1424,"address":[3948897,3949033,3949008],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1428,"address":[3949613,3949296],"length":1,"stats":{"Line":3},"fn_name":"test_handle_transfer_from"},{"line":1429,"address":[3949466,3949309,3949628],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1430,"address":[3949407],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1433,"address":[3950057,3949814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1434,"address":[3949791],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1436,"address":[3949892],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1441,"address":[3949862,3950257],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1442,"address":[3950289],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1443,"address":[3950348],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1446,"address":[3950528,3950608],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1447,"address":[3950824],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1448,"address":[3950951,3951105,3951072],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1452,"address":[3951138,3951078],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1453,"address":[3951170],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1455,"address":[3951206],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1457,"address":[3951374,3951629],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1458,"address":[3951909,3951668],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1459,"address":[3951645],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1461,"address":[3951744],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1464,"address":[3951714,3952110],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1465,"address":[3952142],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1466,"address":[3952201],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1469,"address":[3952461,3952381],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1470,"address":[3952677],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1471,"address":[3952925,3952804,3952958],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1475,"address":[3952931,3952991],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1476,"address":[3953023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1477,"address":[3953082],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1482,"address":[3953874],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1483,"address":[3953330],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1486,"address":[3953262],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1488,"address":[3953543],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1489,"address":[3953386,3953454],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1490,"address":[3953486],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1492,"address":[3953679],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1493,"address":[3953607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1495,"address":[3953711,3953778],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1496,"address":[3953810],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1498,"address":[3954066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1500,"address":[3954282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1501,"address":[3954563,3954530,3954409],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1505,"address":[3954596,3954536],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1506,"address":[3954628],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1507,"address":[3954687],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1510,"address":[3955163,3954867,3954947],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1511,"address":[3955459,3955202],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1512,"address":[3955179],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1514,"address":[3955294],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1516,"address":[3955248,3955700],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1518,"address":[3955668,3955264],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1520,"address":[3955941,3955817],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1522,"address":[3955833,3955909],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1524,"address":[3956074,3956138],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1525,"address":[3956195],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1526,"address":[3956258],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1527,"address":[3956338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1528,"address":[3956607,3956393],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1529,"address":[3956498,3956687],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1530,"address":[3956742,3956670],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1531,"address":[3956854,3956988],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1535,"address":[3957035,3956951],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1536,"address":[3957067],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1537,"address":[3957126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1540,"address":[3957306,3957386],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1541,"address":[3957602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1542,"address":[3957857,3957832,3957729],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1738,"address":[3958637,3958336],"length":1,"stats":{"Line":3},"fn_name":"test_handle_decrease_allowance"},{"line":1739,"address":[3958652,3958349,3958490],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1740,"address":[3958431],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1743,"address":[3959081,3958838],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1744,"address":[3958815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1746,"address":[3958916],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1750,"address":[3959281,3958886],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1751,"address":[3959313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1755,"address":[3959505,3959760],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1756,"address":[3960053,3959799],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1757,"address":[3959776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1759,"address":[3959888],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1762,"address":[3960279,3959845],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1764,"address":[3960247,3959858],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1766,"address":[3960514,3960396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1768,"address":[3960482,3960409],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1771,"address":[3960711,3960663],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1772,"address":[3960874,3960749],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1781,"address":[3960837,3960921],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1782,"address":[3960953],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1786,"address":[3961145,3961400],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1787,"address":[3961674,3961433],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1788,"address":[3961416],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1790,"address":[3961509],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1794,"address":[3961479,3961863],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1795,"address":[3961895],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1799,"address":[3962342,3962087],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1800,"address":[3962628,3962375],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1801,"address":[3962358],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1803,"address":[3962463],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1806,"address":[3962453,3962817],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1807,"address":[3962966,3962855],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1817,"address":[3963344,3963623],"length":1,"stats":{"Line":3},"fn_name":"test_handle_increase_allowance"},{"line":1818,"address":[3963638,3963476,3963351],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1819,"address":[3963417],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1822,"address":[3964067,3963824],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1823,"address":[3963801],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1825,"address":[3963902],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1829,"address":[3963872,3964261],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1830,"address":[3964293],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1834,"address":[3964485,3964740],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1835,"address":[3965027,3964773],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1836,"address":[3964756],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1838,"address":[3964862],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1841,"address":[3965253,3964819],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1843,"address":[3964832,3965221],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1845,"address":[3965488,3965370],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1847,"address":[3965456,3965383],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1850,"address":[3965685,3965637],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1851,"address":[3965723,3965848],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1860,"address":[3965811,3965895],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1861,"address":[3965927],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1865,"address":[3966119,3966374],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1866,"address":[3966660,3966407],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1867,"address":[3966390],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1869,"address":[3966495],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1872,"address":[3966485,3966849],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1873,"address":[3966887,3967000],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1883,"address":[3967312,3967575],"length":1,"stats":{"Line":3},"fn_name":"test_handle_change_admin"},{"line":1884,"address":[3967590,3967319,3967428],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1885,"address":[3967369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1888,"address":[3967992,3967758],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1889,"address":[3967741],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1891,"address":[3967836],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1895,"address":[3968180,3967806],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1898,"address":[3968559,3968304],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1899,"address":[3968829,3968592],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1900,"address":[3968575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1902,"address":[3968664],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1905,"address":[3968654,3969111,3969034],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1908,"address":[3969143,3969071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1909,"address":[3969355],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1913,"address":[3970103,3969840],"length":1,"stats":{"Line":3},"fn_name":"test_handle_set_contract_status"},{"line":1914,"address":[3970118,3969956,3969847],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1915,"address":[3969897],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1918,"address":[3970612,3970283],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1919,"address":[3970266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1921,"address":[3970459],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1928,"address":[3970800,3971016,3970417],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1929,"address":[3971049,3971286],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1930,"address":[3971032],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1932,"address":[3971121],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1935,"address":[3971111,3971483],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1936,"address":[3971562,3971622],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2042,"address":[3972127,3971808],"length":1,"stats":{"Line":3},"fn_name":"test_handle_mint"},{"line":2043,"address":[3971815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2044,"address":[3972142,3971873,3971972],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2045,"address":[3971889],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2046,"address":[3971948],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2048,"address":[3972552,3972316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2049,"address":[3972299],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2051,"address":[3972390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2054,"address":[3972380,3972748],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2055,"address":[3972852],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2057,"address":[3972876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2058,"address":[3972935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2061,"address":[3973083,3973338],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2062,"address":[3973371,3973608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2063,"address":[3973354],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2065,"address":[3973443],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2068,"address":[3973433,3973805],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2069,"address":[3974134,3973919],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2073,"address":[3979968,3974336],"length":1,"stats":{"Line":3},"fn_name":"test_handle_admin_commands"},{"line":2074,"address":[3974349],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2076,"address":[3974706,3974432,3974507],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2077,"address":[3974448],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2080,"address":[3974900,3975241],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2081,"address":[3974877],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2083,"address":[3975076],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2090,"address":[3975034,3975441],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2091,"address":[3975657],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2092,"address":[3976096,3975784,3975937],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2095,"address":[3976053,3976129],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2098,"address":[3976352],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2099,"address":[3976607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2100,"address":[3976734,3977046,3976887],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2103,"address":[3977003,3977079],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2106,"address":[3977302],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2107,"address":[3977557],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2108,"address":[3977684,3977813,3977957],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2111,"address":[3977914,3977990],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2114,"address":[3978213],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2115,"address":[3978468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2116,"address":[3978842,3978595,3978724],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2119,"address":[3978815,3978875],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2122,"address":[3978999],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2123,"address":[3979254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2124,"address":[3979381,3979620,3979510],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2227,"address":[3980285,3980000],"length":1,"stats":{"Line":3},"fn_name":"test_handle_set_minters"},{"line":2228,"address":[3980138,3980013,3980300],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2229,"address":[3980079],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2232,"address":[3980728,3980468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2233,"address":[3980451],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2235,"address":[3980572],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2239,"address":[3980526,3980916],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2242,"address":[3981139],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2243,"address":[3981394],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2244,"address":[3981683,3981521,3981624],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2247,"address":[3981640,3981716],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2250,"address":[3981939],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2251,"address":[3982194,3982378],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2254,"address":[3982411,3982351],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2255,"address":[3982443],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2258,"address":[3982591],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2259,"address":[3982846,3983030],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2262,"address":[3983063,3983003],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2263,"address":[3983095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2266,"address":[3983243],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2267,"address":[3983498],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2268,"address":[3983753,3983625,3983728],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2272,"address":[3984301,3984016],"length":1,"stats":{"Line":3},"fn_name":"test_handle_add_minters"},{"line":2273,"address":[3984029,3984154,3984316],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2274,"address":[3984095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2277,"address":[3984478,3984732],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2278,"address":[3984461],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2280,"address":[3984582],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2284,"address":[3984920,3984536],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2287,"address":[3985143],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2288,"address":[3985398],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2289,"address":[3985525,3985687,3985628],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2292,"address":[3985644,3985720],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2295,"address":[3985943],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2296,"address":[3986198,3986382],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2299,"address":[3986415,3986355],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2300,"address":[3986447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2303,"address":[3986595],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2304,"address":[3986850,3987034],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2307,"address":[3987067,3987007],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2308,"address":[3987099],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2311,"address":[3987247],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2312,"address":[3987702,3987502],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2316,"address":[3987920,3988229],"length":1,"stats":{"Line":3},"fn_name":"test_handle_remove_minters"},{"line":2317,"address":[3988082,3987933,3988244],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2318,"address":[3988023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2321,"address":[3988430,3988699],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2322,"address":[3988407],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2324,"address":[3988534],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2328,"address":[3988893,3988488],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2331,"address":[3989116],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2332,"address":[3989371],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2333,"address":[3989498,3989601,3989660],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2336,"address":[3989693,3989617],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2339,"address":[3989916],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2340,"address":[3990355,3990171],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2343,"address":[3990388,3990328],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2344,"address":[3990420],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2347,"address":[3990568],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2348,"address":[3990823],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2349,"address":[3991053,3991086,3990950],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2352,"address":[3991119,3991059],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2353,"address":[3991151],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2356,"address":[3991299],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2357,"address":[3991554],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2358,"address":[3991681,3991784,3991843],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2362,"address":[3991876,3991800],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2365,"address":[3992099],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2366,"address":[3992538,3992354],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2369,"address":[3992511,3992571],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2370,"address":[3992603],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2373,"address":[3992751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2374,"address":[3993006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2375,"address":[3993236,3993133,3993269],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2378,"address":[3993242,3993302],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2379,"address":[3993334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2382,"address":[3993482],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2383,"address":[3993737],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2384,"address":[3993967,3993992,3993864],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2447,"address":[3994384,3998766],"length":1,"stats":{"Line":3},"fn_name":"test_query_token_info"},{"line":2448,"address":[3994391],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2449,"address":[3994456],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2450,"address":[3994515],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2451,"address":[3994583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2452,"address":[3994729,3994802,3994885],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2456,"address":[3994911],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2458,"address":[3994935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2459,"address":[3994969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2461,"address":[3995016],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2462,"address":[3995144,3995099],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2463,"address":[3995176],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2464,"address":[3995249],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2465,"address":[3995442,3995313],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2469,"address":[3995728],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2470,"address":[3995802],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2473,"address":[3996082],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2474,"address":[3996596,3996253],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2475,"address":[3996230],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2477,"address":[3996431],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2480,"address":[3996306],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2481,"address":[3996317,3996784],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2482,"address":[3996817,3997172],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2483,"address":[3996800],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2485,"address":[3997007],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2487,"address":[3996870,3997377],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2489,"address":[3997554],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2495,"address":[3997970,3997820,3997704],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2496,"address":[3998130,3997881,3998021],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2497,"address":[3998276,3998027],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2498,"address":[3998327,3998185,3998361],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2500,"address":[3997783],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":604,"coverable":743},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\nmod rand;\npub mod receiver;\npub mod state;\nmod utils;\nmod viewing_key;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","msg.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{Binary, HumanAddr, StdError, StdResult, Uint128};\n\nuse crate::state::Tx;\nuse crate::viewing_key::ViewingKey;\n\n#[derive(Serialize, Deserialize, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    // Native coin interactions\n    Redeem {\n        amount: Uint128,\n        denom: Option\u003cString\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Deposit {\n        padding: Option\u003cString\u003e,\n    },\n\n    // Base ERC-20 stuff\n    Transfer {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    Send {\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Burn {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    CreateViewingKey {\n        entropy: String,\n        padding: Option\u003cString\u003e,\n    },\n    SetViewingKey {\n        key: String,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    TransferFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    SendFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    BurnFrom {\n        owner: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Mint\n    Mint {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    AddMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    RemoveMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    SetMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Admin\n    ChangeAdmin {\n        address: HumanAddr,\n        padding: Option\u003cString\u003e,\n    },\n    SetContractStatus {\n        level: ContractStatusLevel,\n        padding: Option\u003cString\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleAnswer {\n    // Native\n    Deposit {\n        status: ResponseStatus,\n    },\n    Redeem {\n        status: ResponseStatus,\n    },\n\n    // Base\n    Transfer {\n        status: ResponseStatus,\n    },\n    Send {\n        status: ResponseStatus,\n    },\n    Burn {\n        status: ResponseStatus,\n    },\n    RegisterReceive {\n        status: ResponseStatus,\n    },\n    CreateViewingKey {\n        key: ViewingKey,\n    },\n    SetViewingKey {\n        status: ResponseStatus,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    TransferFrom {\n        status: ResponseStatus,\n    },\n    SendFrom {\n        status: ResponseStatus,\n    },\n    BurnFrom {\n        status: ResponseStatus,\n    },\n\n    // Mint\n    Mint {\n        status: ResponseStatus,\n    },\n    AddMinters {\n        status: ResponseStatus,\n    },\n    RemoveMinters {\n        status: ResponseStatus,\n    },\n    SetMinters {\n        status: ResponseStatus,\n    },\n\n    // Other\n    ChangeAdmin {\n        status: ResponseStatus,\n    },\n    SetContractStatus {\n        status: ResponseStatus,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    TokenInfo {},\n    ExchangeRate {},\n    Allowance {\n        owner: HumanAddr,\n        spender: HumanAddr,\n        key: String,\n    },\n    Balance {\n        address: HumanAddr,\n        key: String,\n    },\n    TransferHistory {\n        address: HumanAddr,\n        key: String,\n        page: Option\u003cu32\u003e,\n        page_size: u32,\n    },\n    Minters {},\n}\n\nimpl QueryMsg {\n    pub fn get_validation_params(\u0026self) -\u003e (Vec\u003c\u0026HumanAddr\u003e, ViewingKey) {\n        match self {\n            Self::Balance { address, key } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::TransferHistory { address, key, .. } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::Allowance {\n                owner,\n                spender,\n                key,\n                ..\n            } =\u003e (vec![owner, spender], ViewingKey(key.clone())),\n            _ =\u003e panic!(\"This query type does not require authentication\"),\n        }\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryAnswer {\n    TokenInfo {\n        name: String,\n        symbol: String,\n        decimals: u8,\n        total_supply: Option\u003cUint128\u003e,\n    },\n    ExchangeRate {\n        rate: Uint128,\n        denom: String,\n    },\n    Allowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n        expiration: Option\u003cu64\u003e,\n    },\n    Balance {\n        amount: Uint128,\n    },\n    TransferHistory {\n        txs: Vec\u003cTx\u003e,\n    },\n\n    ViewingKeyError {\n        msg: String,\n    },\n    Minters {\n        minters: Vec\u003cHumanAddr\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct CreateViewingKeyResponse {\n    pub key: String,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ResponseStatus {\n    Success,\n    Failure,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ContractStatusLevel {\n    NormalRun,\n    StopAllButRedeems,\n    StopAll,\n}\n\npub fn status_level_to_u8(status_level: ContractStatusLevel) -\u003e u8 {\n    match status_level {\n        ContractStatusLevel::NormalRun =\u003e 0,\n        ContractStatusLevel::StopAllButRedeems =\u003e 1,\n        ContractStatusLevel::StopAll =\u003e 2,\n    }\n}\n\npub fn u8_to_status_level(status_level: u8) -\u003e StdResult\u003cContractStatusLevel\u003e {\n    match status_level {\n        0 =\u003e Ok(ContractStatusLevel::NormalRun),\n        1 =\u003e Ok(ContractStatusLevel::StopAllButRedeems),\n        2 =\u003e Ok(ContractStatusLevel::StopAll),\n        _ =\u003e Err(StdError::generic_err(\"Invalid state level\")),\n    }\n}\n\n// Take a Vec\u003cu8\u003e and pad it up to a multiple of `block_size`, using spaces at the end.\npub fn space_pad(block_size: usize, message: \u0026mut Vec\u003cu8\u003e) -\u003e \u0026mut Vec\u003cu8\u003e {\n    let len = message.len();\n    let surplus = len % block_size;\n    if surplus == 0 {\n        return message;\n    }\n\n    let missing = block_size - surplus;\n    message.reserve(missing);\n    message.extend(std::iter::repeat(b' ').take(missing));\n    message\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::{from_slice, StdResult};\n\n    #[derive(Serialize, Deserialize, JsonSchema, Debug, PartialEq)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum Something {\n        Var { padding: Option\u003cString\u003e },\n    }\n\n    #[test]\n    fn test_deserialization_of_missing_option_fields() -\u003e StdResult\u003c()\u003e {\n        let input = b\"{ \\\"var\\\": {} }\";\n        let obj: Something = from_slice(input)?;\n        assert_eq!(\n            obj,\n            Something::Var { padding: None },\n            \"unexpected value: {:?}\",\n            obj\n        );\n        Ok(())\n    }\n}\n","traces":[{"line":212,"address":[1976286,1975696],"length":1,"stats":{"Line":0},"fn_name":"get_validation_params"},{"line":213,"address":[5534771,5535161,5534971],"length":1,"stats":{"Line":0},"fn_name":null},{"line":214,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":215,"address":[1976018,1976248],"length":1,"stats":{"Line":0},"fn_name":null},{"line":216,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":217,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":218,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":219,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":220,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":221,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":222,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":281,"address":[5535216],"length":1,"stats":{"Line":7},"fn_name":"status_level_to_u8"},{"line":282,"address":[5535257,5535271,5535264],"length":1,"stats":{"Line":1},"fn_name":null},{"line":283,"address":[5535227,5535259],"length":1,"stats":{"Line":8},"fn_name":null},{"line":284,"address":[5535266],"length":1,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[5535273],"length":1,"stats":{"Line":1},"fn_name":null},{"line":289,"address":[5535296],"length":1,"stats":{"Line":6},"fn_name":"u8_to_status_level"},{"line":290,"address":[1976854,1976880,1976867],"length":1,"stats":{"Line":2},"fn_name":null},{"line":291,"address":[1976792,1976847],"length":1,"stats":{"Line":7},"fn_name":null},{"line":292,"address":[1976860],"length":1,"stats":{"Line":0},"fn_name":null},{"line":293,"address":[1976873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":294,"address":[1976886,1976818],"length":1,"stats":{"Line":0},"fn_name":null},{"line":299,"address":[1976928],"length":1,"stats":{"Line":1},"fn_name":"space_pad"},{"line":300,"address":[1976965],"length":1,"stats":{"Line":1},"fn_name":null},{"line":301,"address":[1977030,1976986],"length":1,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[1977022],"length":1,"stats":{"Line":1},"fn_name":null},{"line":303,"address":[1977065],"length":1,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[1977085,1977123],"length":1,"stats":{"Line":1},"fn_name":null},{"line":307,"address":[1977115],"length":1,"stats":{"Line":1},"fn_name":null},{"line":308,"address":[1977153],"length":1,"stats":{"Line":1},"fn_name":null},{"line":309,"address":[1977223],"length":1,"stats":{"Line":1},"fn_name":null},{"line":324,"address":[660861,660876,660256],"length":1,"stats":{"Line":3},"fn_name":"test_deserialization_of_missing_option_fields"},{"line":325,"address":[660273],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[660288,660485],"length":1,"stats":{"Line":1},"fn_name":null},{"line":327,"address":[660407,660576,660645],"length":1,"stats":{"Line":2},"fn_name":null},{"line":333,"address":[660626],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":21,"coverable":36},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","rand.rs"],"content":"use rand_chacha::ChaChaRng;\nuse rand_core::{RngCore, SeedableRng};\n\nuse sha2::{Digest, Sha256};\n\npub fn sha_256(data: \u0026[u8]) -\u003e [u8; 32] {\n    let mut hasher = Sha256::new();\n    hasher.update(data);\n    let hash = hasher.finalize();\n\n    let mut result = [0u8; 32];\n    result.copy_from_slice(hash.as_slice());\n    result\n}\n\npub struct Prng {\n    rng: ChaChaRng,\n}\n\nimpl Prng {\n    pub fn new(seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        let mut hasher = Sha256::new();\n\n        // write input message\n        hasher.update(\u0026seed);\n        hasher.update(\u0026entropy);\n        let hash = hasher.finalize();\n\n        let mut hash_bytes = [0u8; 32];\n        hash_bytes.copy_from_slice(hash.as_slice());\n\n        let rng: ChaChaRng = ChaChaRng::from_seed(hash_bytes);\n\n        Self { rng }\n    }\n\n    pub fn rand_bytes(\u0026mut self) -\u003e [u8; 32] {\n        let mut bytes = [0u8; 32];\n        self.rng.fill_bytes(\u0026mut bytes);\n\n        bytes\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    /// This test checks that the rng is stateful and generates\n    /// different random bytes every time it is called.\n    #[test]\n    fn test_rng() {\n        let mut rng = Prng::new(b\"foo\", b\"bar!\");\n        let r1: [u8; 32] = [\n            155, 11, 21, 97, 252, 65, 160, 190, 100, 126, 85, 251, 47, 73, 160, 49, 216, 182, 93,\n            30, 185, 67, 166, 22, 34, 10, 213, 112, 21, 136, 49, 214,\n        ];\n        let r2: [u8; 32] = [\n            46, 135, 19, 242, 111, 125, 59, 215, 114, 130, 122, 155, 202, 23, 36, 118, 83, 11, 6,\n            180, 97, 165, 218, 136, 134, 243, 191, 191, 149, 178, 7, 149,\n        ];\n        let r3: [u8; 32] = [\n            9, 2, 131, 50, 199, 170, 6, 68, 168, 28, 242, 182, 35, 114, 15, 163, 65, 139, 101, 221,\n            207, 147, 119, 110, 81, 195, 6, 134, 14, 253, 245, 244,\n        ];\n        let r4: [u8; 32] = [\n            68, 196, 114, 205, 225, 64, 201, 179, 18, 77, 216, 197, 211, 13, 21, 196, 11, 102, 106,\n            195, 138, 250, 29, 185, 51, 38, 183, 0, 5, 169, 65, 190,\n        ];\n        assert_eq!(r1, rng.rand_bytes());\n        assert_eq!(r2, rng.rand_bytes());\n        assert_eq!(r3, rng.rand_bytes());\n        assert_eq!(r4, rng.rand_bytes());\n    }\n}\n","traces":[{"line":6,"address":[2195184],"length":1,"stats":{"Line":7},"fn_name":"sha_256"},{"line":7,"address":[2195227],"length":1,"stats":{"Line":1},"fn_name":null},{"line":8,"address":[2663680],"length":1,"stats":{"Line":7},"fn_name":null},{"line":9,"address":[2195259],"length":1,"stats":{"Line":1},"fn_name":null},{"line":11,"address":[2663741],"length":1,"stats":{"Line":7},"fn_name":null},{"line":12,"address":[2195330],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[2663824],"length":1,"stats":{"Line":1},"fn_name":"new"},{"line":22,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[2195456],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[2195517],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[2195600],"length":1,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[2791344],"length":1,"stats":{"Line":3},"fn_name":"test_rng"},{"line":53,"address":[2791351],"length":1,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[2791386],"length":1,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[2791642],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[2791898],"length":1,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[2792154],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[2792410,2792551],"length":1,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[2792595,2792521,2792718],"length":1,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[2792885,2792762,2792688],"length":1,"stats":{"Line":2},"fn_name":null},{"line":73,"address":[2792929,2792855,2793038],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":27,"coverable":28},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","receiver.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{to_binary, Binary, CosmosMsg, HumanAddr, StdResult, Uint128, WasmMsg};\n\nuse crate::{contract::RESPONSE_BLOCK_SIZE, msg::space_pad};\n\n/// Snip20ReceiveMsg should be de/serialized under `Receive()` variant in a HandleMsg\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub struct Snip20ReceiveMsg {\n    pub sender: HumanAddr,\n    pub from: HumanAddr,\n    pub amount: Uint128,\n    pub msg: Option\u003cBinary\u003e,\n}\n\nimpl Snip20ReceiveMsg {\n    pub fn new(sender: HumanAddr, from: HumanAddr, amount: Uint128, msg: Option\u003cBinary\u003e) -\u003e Self {\n        Self {\n            sender,\n            from,\n            amount,\n            msg,\n        }\n    }\n\n    /// serializes the message, and pads it to 256 bytes\n    pub fn into_binary(self) -\u003e StdResult\u003cBinary\u003e {\n        let msg = ReceiverHandleMsg::Receive(self);\n        let mut data = to_binary(\u0026msg)?;\n        space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n        Ok(data)\n    }\n\n    /// creates a cosmos_msg sending this struct to the named contract\n    pub fn into_cosmos_msg(\n        self,\n        callback_code_hash: String,\n        contract_addr: HumanAddr,\n    ) -\u003e StdResult\u003cCosmosMsg\u003e {\n        let msg = self.into_binary()?;\n        let execute = WasmMsg::Execute {\n            msg,\n            callback_code_hash,\n            contract_addr,\n            send: vec![],\n        };\n        Ok(execute.into())\n    }\n}\n\n// This is just a helper to properly serialize the above message\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\nenum ReceiverHandleMsg {\n    Receive(Snip20ReceiveMsg),\n}\n","traces":[{"line":19,"address":[2220144],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[4358288],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":10},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","state.rs"],"content":"use std::any::type_name;\nuse std::convert::TryFrom;\n\nuse cosmwasm_std::{\n    Api, CanonicalAddr, Coin, HumanAddr, ReadonlyStorage, StdError, StdResult, Storage, Uint128,\n};\nuse cosmwasm_storage::{PrefixedStorage, ReadonlyPrefixedStorage};\n\nuse secret_toolkit::storage::{AppendStore, AppendStoreMut, TypedStore, TypedStoreMut};\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse crate::msg::{status_level_to_u8, u8_to_status_level, ContractStatusLevel};\nuse crate::viewing_key::ViewingKey;\nuse serde::de::DeserializeOwned;\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\npub const PREFIX_TXS: \u0026[u8] = b\"transfers\";\n\npub const KEY_CONSTANTS: \u0026[u8] = b\"constants\";\npub const KEY_TOTAL_SUPPLY: \u0026[u8] = b\"total_supply\";\npub const KEY_CONTRACT_STATUS: \u0026[u8] = b\"contract_status\";\npub const KEY_MINTERS: \u0026[u8] = b\"minters\";\npub const KEY_TX_COUNT: \u0026[u8] = b\"tx-count\";\n\npub const PREFIX_CONFIG: \u0026[u8] = b\"config\";\npub const PREFIX_BALANCES: \u0026[u8] = b\"balances\";\npub const PREFIX_ALLOWANCES: \u0026[u8] = b\"allowances\";\npub const PREFIX_VIEW_KEY: \u0026[u8] = b\"viewingkey\";\npub const PREFIX_RECEIVERS: \u0026[u8] = b\"receivers\";\n\n// Note that id is a globally incrementing counter.\n// Since it's 64 bits long, even at 50 tx/s it would take\n// over 11 billion years for it to rollback. I'm pretty sure\n// we'll have bigger issues by then.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct Tx {\n    pub id: u64,\n    pub from: HumanAddr,\n    pub sender: HumanAddr,\n    pub receiver: HumanAddr,\n    pub coins: Coin,\n}\n\nimpl Tx {\n    pub fn into_stored\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cStoredTx\u003e {\n        let tx = StoredTx {\n            id: self.id,\n            from: api.canonical_address(\u0026self.from)?,\n            sender: api.canonical_address(\u0026self.sender)?,\n            receiver: api.canonical_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug)]\npub struct StoredTx {\n    pub id: u64,\n    pub from: CanonicalAddr,\n    pub sender: CanonicalAddr,\n    pub receiver: CanonicalAddr,\n    pub coins: Coin,\n}\n\nimpl StoredTx {\n    pub fn into_humanized\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cTx\u003e {\n        let tx = Tx {\n            id: self.id,\n            from: api.human_address(\u0026self.from)?,\n            sender: api.human_address(\u0026self.sender)?,\n            receiver: api.human_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\npub fn store_transfer\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    sender: \u0026CanonicalAddr,\n    receiver: \u0026CanonicalAddr,\n    amount: Uint128,\n    denom: String,\n) -\u003e StdResult\u003c()\u003e {\n    let mut config = Config::from_storage(store);\n    let id = config.tx_count() + 1;\n    config.set_tx_count(id)?;\n\n    let coins = Coin { denom, amount };\n    let tx = StoredTx {\n        id,\n        from: owner.clone(),\n        sender: sender.clone(),\n        receiver: receiver.clone(),\n        coins,\n    };\n\n    if owner != sender {\n        append_tx(store, tx.clone(), \u0026owner)?;\n    }\n    append_tx(store, tx.clone(), \u0026sender)?;\n    append_tx(store, tx, \u0026receiver)?;\n\n    Ok(())\n}\n\nfn append_tx\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    tx: StoredTx,\n    for_address: \u0026CanonicalAddr,\n) -\u003e StdResult\u003c()\u003e {\n    let mut store = PrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], store);\n    let mut store = AppendStoreMut::attach_or_create(\u0026mut store)?;\n    store.push(\u0026tx)\n}\n\npub fn get_transfers\u003cA: Api, S: ReadonlyStorage\u003e(\n    api: \u0026A,\n    storage: \u0026S,\n    for_address: \u0026CanonicalAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cVec\u003cTx\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], storage);\n\n    // Try to access the storage of txs for the account.\n    // If it doesn't exist yet, return an empty list of transfers.\n    let store = if let Some(result) = AppendStore::\u003cStoredTx, _\u003e::attach(\u0026store) {\n        result?\n    } else {\n        return Ok(vec![]);\n    };\n\n    // Take `page_size` txs starting from the latest tx, potentially skipping `page * page_size`\n    // txs from the start.\n    let tx_iter = store\n        .iter()\n        .rev()\n        .skip((page * page_size) as _)\n        .take(page_size as _);\n    // The `and_then` here flattens the `StdResult\u003cStdResult\u003cTx\u003e\u003e` to an `StdResult\u003cTx\u003e`\n    let txs: StdResult\u003cVec\u003cTx\u003e\u003e = tx_iter\n        .map(|tx| tx.map(|tx| tx.into_humanized(api)).and_then(|x| x))\n        .collect();\n    txs\n}\n\n// Config\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct Constants {\n    pub name: String,\n    pub admin: HumanAddr,\n    pub symbol: String,\n    pub decimals: u8,\n    pub prng_seed: Vec\u003cu8\u003e,\n    // privacy configuration\n    pub total_supply_is_public: bool,\n}\n\npub struct ReadonlyConfig\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfig\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n}\n\nfn set_bin_data\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, key: \u0026[u8], data: \u0026T) -\u003e StdResult\u003c()\u003e {\n    let bin_data =\n        bincode2::serialize(\u0026data).map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?;\n\n    storage.set(key, \u0026bin_data);\n    Ok(())\n}\n\nfn get_bin_data\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cT\u003e {\n    let bin_data = storage.get(key);\n\n    match bin_data {\n        None =\u003e Err(StdError::not_found(\"Key not found in storage\")),\n        Some(bin_data) =\u003e Ok(bincode2::deserialize::\u003cT\u003e(\u0026bin_data)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?),\n    }\n}\n\npub struct Config\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Config\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn set_constants(\u0026mut self, constants: \u0026Constants) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_CONSTANTS, constants)\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn set_total_supply(\u0026mut self, supply: u128) {\n        self.storage.set(KEY_TOTAL_SUPPLY, \u0026supply.to_be_bytes());\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn set_contract_status(\u0026mut self, status: ContractStatusLevel) {\n        let status_u8 = status_level_to_u8(status);\n        self.storage\n            .set(KEY_CONTRACT_STATUS, \u0026status_u8.to_be_bytes());\n    }\n\n    pub fn set_minters(\u0026mut self, minters_to_set: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_MINTERS, \u0026minters_to_set)\n    }\n\n    pub fn add_minters(\u0026mut self, minters_to_add: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n        minters.extend(minters_to_add);\n\n        self.set_minters(minters)\n    }\n\n    pub fn remove_minters(\u0026mut self, minters_to_remove: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n\n        for minter in minters_to_remove {\n            minters.retain(|x| x != \u0026minter);\n        }\n\n        self.set_minters(minters)\n    }\n\n    pub fn minters(\u0026mut self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n\n    pub fn set_tx_count(\u0026mut self, count: u64) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_TX_COUNT, \u0026count)\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Config` and `ReadonlyConfig`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyConfigImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfigImpl\u003c'a, S\u003e {\n    fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        let consts_bytes = self\n            .0\n            .get(KEY_CONSTANTS)\n            .ok_or_else(|| StdError::generic_err(\"no constants stored in configuration\"))?;\n        bincode2::deserialize::\u003cConstants\u003e(\u0026consts_bytes)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cConstants\u003e(), e))\n    }\n\n    fn total_supply(\u0026self) -\u003e u128 {\n        let supply_bytes = self\n            .0\n            .get(KEY_TOTAL_SUPPLY)\n            .expect(\"no total supply stored in config\");\n        // This unwrap is ok because we know we stored things correctly\n        slice_to_u128(\u0026supply_bytes).unwrap()\n    }\n\n    fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        let supply_bytes = self\n            .0\n            .get(KEY_CONTRACT_STATUS)\n            .expect(\"no contract status stored in config\");\n\n        // These unwraps are ok because we know we stored things correctly\n        let status = slice_to_u8(\u0026supply_bytes).unwrap();\n        u8_to_status_level(status).unwrap()\n    }\n\n    fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        get_bin_data(self.0, KEY_MINTERS).unwrap()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        get_bin_data(self.0, KEY_TX_COUNT).unwrap_or_default()\n    }\n}\n\n// Balances\n\npub struct ReadonlyBalances\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n}\n\npub struct Balances\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Balances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn balance(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n\n    pub fn set_account_balance(\u0026mut self, account: \u0026CanonicalAddr, amount: u128) {\n        self.storage.set(account.as_slice(), \u0026amount.to_be_bytes())\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Balances` and `ReadonlyBalances`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyBalancesImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalancesImpl\u003c'a, S\u003e {\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        let account_bytes = account.as_slice();\n        let result = self.0.get(account_bytes);\n        match result {\n            // This unwrap is ok because we know we stored things correctly\n            Some(balance_bytes) =\u003e slice_to_u128(\u0026balance_bytes).unwrap(),\n            None =\u003e 0,\n        }\n    }\n}\n\n// Allowances\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, Default, JsonSchema)]\npub struct Allowance {\n    pub amount: u128,\n    pub expiration: Option\u003cu64\u003e,\n}\n\npub fn read_allowance\u003cS: Storage\u003e(\n    store: \u0026S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n) -\u003e StdResult\u003cAllowance\u003e {\n    let owner_store =\n        ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let owner_store = TypedStore::attach(\u0026owner_store);\n    let allowance = owner_store.may_load(spender.as_slice());\n    allowance.map(Option::unwrap_or_default)\n}\n\npub fn write_allowance\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n    allowance: Allowance,\n) -\u003e StdResult\u003c()\u003e {\n    let mut owner_store =\n        PrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let mut owner_store = TypedStoreMut::attach(\u0026mut owner_store);\n\n    owner_store.store(spender.as_slice(), \u0026allowance)\n}\n\n// Viewing Keys\n\npub fn write_viewing_key\u003cS: Storage\u003e(store: \u0026mut S, owner: \u0026CanonicalAddr, key: \u0026ViewingKey) {\n    let mut balance_store = PrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.set(owner.as_slice(), \u0026key.to_hashed());\n}\n\npub fn read_viewing_key\u003cS: Storage\u003e(store: \u0026S, owner: \u0026CanonicalAddr) -\u003e Option\u003cVec\u003cu8\u003e\u003e {\n    let balance_store = ReadonlyPrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.get(owner.as_slice())\n}\n\n// Receiver Interface\n\npub fn get_receiver_hash\u003cS: ReadonlyStorage\u003e(\n    store: \u0026S,\n    account: \u0026HumanAddr,\n) -\u003e Option\u003cStdResult\u003cString\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.get(account.as_str().as_bytes()).map(|data| {\n        String::from_utf8(data)\n            .map_err(|_err| StdError::invalid_utf8(\"stored code hash was not a valid String\"))\n    })\n}\n\npub fn set_receiver_hash\u003cS: Storage\u003e(store: \u0026mut S, account: \u0026HumanAddr, code_hash: String) {\n    let mut store = PrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.set(account.as_str().as_bytes(), code_hash.as_bytes());\n}\n\n// Helpers\n\n/// Converts 16 bytes value into u128\n/// Errors if data found that is not 16 bytes\nfn slice_to_u128(data: \u0026[u8]) -\u003e StdResult\u003cu128\u003e {\n    match \u003c[u8; 16]\u003e::try_from(data) {\n        Ok(bytes) =\u003e Ok(u128::from_be_bytes(bytes)),\n        Err(_) =\u003e Err(StdError::generic_err(\n            \"Corrupted data found. 16 byte expected.\",\n        )),\n    }\n}\n\n/// Converts 1 byte value into u8\n/// Errors if data found that is not 1 byte\nfn slice_to_u8(data: \u0026[u8]) -\u003e StdResult\u003cu8\u003e {\n    if data.len() == 1 {\n        Ok(data[0])\n    } else {\n        Err(StdError::generic_err(\n            \"Corrupted data found. 1 byte expected.\",\n        ))\n    }\n}\n","traces":[{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[5724768,5727364],"length":1,"stats":{"Line":1},"fn_name":"store_transfer\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":89,"address":[5724876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[5725043,5724986,5725071,5724925],"length":1,"stats":{"Line":3},"fn_name":null},{"line":91,"address":[5725286,5725064,5725499,5725103],"length":1,"stats":{"Line":2},"fn_name":null},{"line":93,"address":[5725171],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[5725258],"length":1,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[5725541],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[5725602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[5725996,5726110,5725949,5725891],"length":1,"stats":{"Line":3},"fn_name":null},{"line":103,"address":[5726333,5726120,5726017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[5726395,5726884,5726668],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[5726496,5727012,5726911,5727228],"length":1,"stats":{"Line":2},"fn_name":null},{"line":108,"address":[5726969],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[5728051,5727392,5728066],"length":1,"stats":{"Line":1},"fn_name":"append_tx\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":116,"address":[5727448],"length":1,"stats":{"Line":1},"fn_name":null},{"line":117,"address":[5727657,5727754,5727977,5727593],"length":1,"stats":{"Line":2},"fn_name":null},{"line":118,"address":[5727739],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[5729496,5729481,5728080],"length":1,"stats":{"Line":0},"fn_name":"get_transfers\u003ccosmwasm_std::mock::MockApi,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":128,"address":[5728162],"length":1,"stats":{"Line":0},"fn_name":null},{"line":132,"address":[5728271,5728361],"length":1,"stats":{"Line":0},"fn_name":null},{"line":133,"address":[5728861,5728465,5728758],"length":1,"stats":{"Line":0},"fn_name":null},{"line":135,"address":[5728595],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[5729321,5728846,5729206,5729258],"length":1,"stats":{"Line":0},"fn_name":null},{"line":143,"address":[5729265,5729221],"length":1,"stats":{"Line":0},"fn_name":null},{"line":144,"address":[5729301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":146,"address":[5729389,5729328],"length":1,"stats":{"Line":0},"fn_name":null},{"line":147,"address":[5729612,5729600,5729547,5729673,5729381,5729632,5729504],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003ccosmwasm_std::mock::MockApi,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":149,"address":[5729448],"length":1,"stats":{"Line":0},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[5731404,5730587,5731008,5731003,5730988,5730176,5731419,5730572,5730592],"length":1,"stats":{"Line":9},"fn_name":"set_bin_data\u003clp_token::state::Constants,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":202,"address":[5730653,5730237,5731424,5731586,5731712,5731226,5730394,5731069,5731568,5731442,5731730,5730810],"length":1,"stats":{"Line":9},"fn_name":"{{closure}}\u003clp_token::state::Constants,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":205,"address":[5730505,5731195,5730921,5730779,5731337,5730363],"length":1,"stats":{"Line":18},"fn_name":null},{"line":206,"address":[5731384,5730968,5730552],"length":1,"stats":{"Line":9},"fn_name":null},{"line":209,"address":[5733376,5732592,5731856,5732510,5733303,5734087],"length":1,"stats":{"Line":2},"fn_name":"get_bin_data\u003cu64,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":210,"address":[5731897,5733417,5732633],"length":1,"stats":{"Line":2},"fn_name":null},{"line":212,"address":[5734157,5731927,5732580,5733447,5733371,5734155,5732578,5732663,5733373],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[5732547,5732643,5734124,5733340,5732665,5731929,5731907,5733449,5733427],"length":1,"stats":{"Line":4},"fn_name":null},{"line":214,"address":[5732099,5732460,5733617,5733667,5732202,5731956,5734037,5733253,5732883,5732692,5732833,5733476],"length":1,"stats":{"Line":2},"fn_name":null},{"line":215,"address":[5734178,5732236,5732185,5734304,5733260,5733560,5734322,5732863,5733029,5732049,5734160,5734466,5732776,5733813,5733647,5732467,5734448,5734044],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}\u003cu64,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":224,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":290,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":303,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":12},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":354,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":373,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":413,"address":[5740160,5740578],"length":1,"stats":{"Line":2},"fn_name":"read_allowance\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":418,"address":[5740224],"length":1,"stats":{"Line":2},"fn_name":null},{"line":420,"address":[5740320],"length":1,"stats":{"Line":2},"fn_name":null},{"line":421,"address":[5740353,5740443],"length":1,"stats":{"Line":4},"fn_name":null},{"line":422,"address":[5740455],"length":1,"stats":{"Line":2},"fn_name":null},{"line":425,"address":[5740608,5740912],"length":1,"stats":{"Line":2},"fn_name":"write_allowance\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":431,"address":[5740677],"length":1,"stats":{"Line":2},"fn_name":null},{"line":433,"address":[5740773],"length":1,"stats":{"Line":2},"fn_name":null},{"line":435,"address":[5740806,5740893],"length":1,"stats":{"Line":4},"fn_name":null},{"line":440,"address":[5740944,5741150],"length":1,"stats":{"Line":1},"fn_name":"write_viewing_key\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":441,"address":[5740982],"length":1,"stats":{"Line":1},"fn_name":null},{"line":442,"address":[5741009,5741131],"length":1,"stats":{"Line":2},"fn_name":null},{"line":445,"address":[5741184,5741335],"length":1,"stats":{"Line":1},"fn_name":"read_viewing_key\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":446,"address":[5741216],"length":1,"stats":{"Line":1},"fn_name":null},{"line":447,"address":[5741243],"length":1,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[5741612,5741360],"length":1,"stats":{"Line":1},"fn_name":"get_receiver_hash\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":456,"address":[5741398],"length":1,"stats":{"Line":1},"fn_name":null},{"line":457,"address":[5741576,5741760,5741425],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":458,"address":[5741774],"length":1,"stats":{"Line":1},"fn_name":null},{"line":459,"address":[5741664,5741648],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":463,"address":[5742176,5741840],"length":1,"stats":{"Line":1},"fn_name":"set_receiver_hash\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":464,"address":[5741873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":465,"address":[5742096,5741902],"length":1,"stats":{"Line":2},"fn_name":null},{"line":472,"address":[2203760],"length":1,"stats":{"Line":1},"fn_name":"slice_to_u128"},{"line":473,"address":[2203817,2203970,2203793,2203968],"length":1,"stats":{"Line":2},"fn_name":null},{"line":474,"address":[2203804,2203953,2203819],"length":1,"stats":{"Line":3},"fn_name":null},{"line":475,"address":[2203866],"length":1,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[2203984],"length":1,"stats":{"Line":1},"fn_name":"slice_to_u8"},{"line":484,"address":[2204170,2204043],"length":1,"stats":{"Line":7},"fn_name":null},{"line":485,"address":[2204162,2204199,2204070,2204177],"length":1,"stats":{"Line":7},"fn_name":null},{"line":487,"address":[2204084],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":133,"coverable":174},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","utils.rs"],"content":"use crate::viewing_key::VIEWING_KEY_SIZE;\nuse sha2::{Digest, Sha256};\nuse std::convert::TryInto;\nuse subtle::ConstantTimeEq;\n\npub fn ct_slice_compare(s1: \u0026[u8], s2: \u0026[u8]) -\u003e bool {\n    bool::from(s1.ct_eq(s2))\n}\n\npub fn create_hashed_password(s1: \u0026str) -\u003e [u8; VIEWING_KEY_SIZE] {\n    Sha256::digest(s1.as_bytes())\n        .as_slice()\n        .try_into()\n        .expect(\"Wrong password length\")\n}\n","traces":[{"line":6,"address":[2145568],"length":1,"stats":{"Line":1},"fn_name":"ct_slice_compare"},{"line":7,"address":[2145592],"length":1,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[2145632],"length":1,"stats":{"Line":1},"fn_name":"create_hashed_password"},{"line":11,"address":[2145730],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":4,"coverable":4},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","src","viewing_key.rs"],"content":"use std::fmt;\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::Env;\n\nuse crate::rand::{sha_256, Prng};\nuse crate::utils::{create_hashed_password, ct_slice_compare};\n\npub const VIEWING_KEY_SIZE: usize = 32;\npub const VIEWING_KEY_PREFIX: \u0026str = \"api_key_\";\n\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct ViewingKey(pub String);\n\nimpl ViewingKey {\n    pub fn check_viewing_key(\u0026self, hashed_pw: \u0026[u8]) -\u003e bool {\n        let mine_hashed = create_hashed_password(\u0026self.0);\n\n        ct_slice_compare(\u0026mine_hashed, hashed_pw)\n    }\n\n    pub fn new(env: \u0026Env, seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        // 16 here represents the lengths in bytes of the block height and time.\n        let entropy_len = 16 + env.message.sender.len() + entropy.len();\n        let mut rng_entropy = Vec::with_capacity(entropy_len);\n        rng_entropy.extend_from_slice(\u0026env.block.height.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.block.time.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.message.sender.0.as_bytes());\n        rng_entropy.extend_from_slice(entropy);\n\n        let mut rng = Prng::new(seed, \u0026rng_entropy);\n\n        let rand_slice = rng.rand_bytes();\n\n        let key = sha_256(\u0026rand_slice);\n\n        Self(VIEWING_KEY_PREFIX.to_string() + \u0026base64::encode(key))\n    }\n\n    pub fn to_hashed(\u0026self) -\u003e [u8; VIEWING_KEY_SIZE] {\n        create_hashed_password(\u0026self.0)\n    }\n\n    pub fn as_bytes(\u0026self) -\u003e \u0026[u8] {\n        self.0.as_bytes()\n    }\n}\n\nimpl fmt::Display for ViewingKey {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":19,"address":[2142093],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[2142138],"length":1,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[2142176,2143081],"length":1,"stats":{"Line":1},"fn_name":"new"},{"line":26,"address":[5707856,5708013],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[2142413],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[5708048],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[2142772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[2143344],"length":1,"stats":{"Line":1},"fn_name":"to_hashed"},{"line":43,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":16,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","contract.rs"],"content":"use cosmwasm_std::{\n    from_binary, to_binary, Api, BankMsg, Binary, Coin, Context, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, StdError, StdResult, Storage, Uint128,\n    WasmMsg,\n};\n\nuse crate::msg::{CountResponse, HandleMsg, InitMsg, QueryMsg, Snip20Msg};\nuse crate::state::{config, config_read, State};\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let state = State {\n        count: msg.count,\n        owner: deps.api.canonical_address(\u0026env.message.sender)?,\n        known_snip_20: vec![],\n    };\n\n    config(\u0026mut deps.storage).save(\u0026state)?;\n\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        HandleMsg::Increment {} =\u003e try_increment(deps, env),\n        HandleMsg::Reset { count } =\u003e try_reset(deps, env, count),\n        HandleMsg::Register { reg_addr, reg_hash } =\u003e try_register(deps, env, reg_addr, reg_hash),\n        HandleMsg::Receive {\n            sender,\n            from,\n            amount,\n            msg,\n        } =\u003e try_receive(deps, env, sender, from, amount, msg),\n        HandleMsg::Redeem {\n            addr,\n            hash,\n            to,\n            amount,\n        } =\u003e try_redeem(deps, env, addr, hash, to, amount),\n        HandleMsg::Fail {} =\u003e try_fail(),\n    }\n}\n\npub fn try_increment\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    _env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut count = 0;\n    config(\u0026mut deps.storage).update(|mut state| {\n        state.count += 1;\n        count = state.count;\n        Ok(state)\n    })?;\n\n    let mut context = Context::new();\n    context.add_log(\"count\", count.to_string());\n\n    Ok(context.into())\n}\n\npub fn try_reset\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    count: i32,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address_raw = deps.api.canonical_address(\u0026env.message.sender)?;\n    config(\u0026mut deps.storage).update(|mut state| {\n        if sender_address_raw != state.owner {\n            return Err(StdError::Unauthorized { backtrace: None });\n        }\n        state.count = count;\n        Ok(state)\n    })?;\n    Ok(HandleResponse::default())\n}\n\npub fn try_register\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    reg_addr: HumanAddr,\n    reg_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut conf = config(\u0026mut deps.storage);\n    let mut state = conf.load()?;\n    if !state.known_snip_20.contains(\u0026reg_addr) {\n        state.known_snip_20.push(reg_addr.clone());\n    }\n    conf.save(\u0026state)?;\n\n    let msg = to_binary(\u0026Snip20Msg::register_receive(env.contract_code_hash))?;\n    let message = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: reg_addr,\n        callback_code_hash: reg_hash,\n        msg,\n        send: vec![],\n    });\n\n    Ok(HandleResponse {\n        messages: vec![message],\n        log: vec![],\n        data: None,\n    })\n}\n\npub fn try_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    _sender: HumanAddr,\n    _from: HumanAddr,\n    _amount: Uint128,\n    msg: Binary,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let msg: HandleMsg = from_binary(\u0026msg)?;\n\n    if matches!(msg, HandleMsg::Receive { .. }) {\n        return Err(StdError::generic_err(\n            \"Recursive call to receive() is not allowed\",\n        ));\n    }\n\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            env.message.sender\n        )));\n    }\n\n    /* use sender \u0026 amount */\n    handle(deps, env, msg)\n}\n\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    addr: HumanAddr,\n    hash: String,\n    to: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026addr) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            addr\n        )));\n    }\n\n    let msg = to_binary(\u0026Snip20Msg::redeem(amount))?;\n    let secret_redeem = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: addr,\n        callback_code_hash: hash,\n        msg,\n        send: vec![],\n    });\n    let redeem = CosmosMsg::Bank(BankMsg::Send {\n        amount: vec![Coin::new(amount.u128(), \"uscrt\")],\n        from_address: env.contract.address,\n        to_address: to,\n    });\n\n    Ok(HandleResponse {\n        messages: vec![secret_redeem, redeem],\n        log: vec![],\n        data: None,\n    })\n}\n\nfn try_fail() -\u003e StdResult\u003cHandleResponse\u003e {\n    Err(StdError::generic_err(\"intentional failure\"))\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::GetCount {} =\u003e to_binary(\u0026query_count(deps)?),\n    }\n}\n\nfn query_count\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cCountResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    Ok(CountResponse { count: state.count })\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","msg.rs"],"content":"use cosmwasm_std::{Binary, HumanAddr, Uint128};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct InitMsg {\n    pub count: i32,\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    Increment {},\n    Reset {\n        count: i32,\n    },\n    Register {\n        reg_addr: HumanAddr,\n        reg_hash: String,\n    },\n    Receive {\n        sender: HumanAddr,\n        from: HumanAddr,\n        amount: Uint128,\n        msg: Binary,\n    },\n    Redeem {\n        addr: HumanAddr,\n        hash: String,\n        to: HumanAddr,\n        amount: Uint128,\n    },\n    Fail {},\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    // GetCount returns the current count as a json-encoded number\n    GetCount {},\n}\n\n// We define a custom struct for each query response\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct CountResponse {\n    pub count: i32,\n}\n\n// Messages sent to SNIP-20 contracts\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum Snip20Msg {\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    Redeem {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n}\n\nimpl Snip20Msg {\n    pub fn register_receive(code_hash: String) -\u003e Self {\n        Snip20Msg::RegisterReceive {\n            code_hash,\n            padding: None, // TODO add padding calculation\n        }\n    }\n\n    pub fn redeem(amount: Uint128) -\u003e Self {\n        Snip20Msg::Redeem {\n            amount,\n            padding: None, // TODO add padding calculation\n        }\n    }\n}\n","traces":[{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","example-receiver","src","state.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{CanonicalAddr, HumanAddr, Storage};\nuse cosmwasm_storage::{singleton, singleton_read, ReadonlySingleton, Singleton};\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct State {\n    pub count: i32,\n    pub owner: CanonicalAddr,\n    pub known_snip_20: Vec\u003cHumanAddr\u003e,\n}\n\npub fn config\u003cS: Storage\u003e(storage: \u0026mut S) -\u003e Singleton\u003cS, State\u003e {\n    singleton(storage, CONFIG_KEY)\n}\n\npub fn config_read\u003cS: Storage\u003e(storage: \u0026S) -\u003e ReadonlySingleton\u003cS, State\u003e {\n    singleton_read(storage, CONFIG_KEY)\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","lp-token","tests","integration.rs"],"content":"#[test]\n#[ignore]\nfn empty_test() {}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","src","contract.rs"],"content":"use cosmwasm_std::{\n    to_binary, Api, Binary, Env, Extern, HandleResponse, HumanAddr,\n    InitResponse, Querier, StdError, StdResult, Storage, Uint128, log\n};\nuse crate::state::*;\nuse fadroma_scrt_callback::ContractInstance;\nuse fadroma_scrt_migrate::{is_operational, can_set_status, set_status, get_status};\nuse sienna_amm_shared::{\n    snip20,\n    msg::sienna_burner::{HandleMsg, InitMsg, QueryAnswer, QueryMsg, ResponseStatus},\n    admin::{\n        require_admin,\n        multi_admin::{\n            assert_admin, save_admins, multi_admin_handle,\n            multi_admin_query, DefaultHandleImpl, DefaultQueryImpl\n        }\n    }\n};\n\nconst BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    save_token_info(deps, \u0026msg.sienna_token)?;\n    save_burn_pool(deps, \u0026msg.burn_pool)?;\n    \n    let admins = if let Some(mut admins) = msg.admins {\n        admins.push(msg.factory_address);\n        admins\n    } else {\n        vec![ msg.factory_address, env.message.sender ]\n    };\n\n    save_admins(deps, \u0026admins)?;\n\n    if let Some(pairs) = msg.pairs {\n        save_pair_addresses(deps, \u0026pairs)?;\n    }\n\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    with_status!(deps, env, match msg {\n        HandleMsg::Burn { amount } =\u003e burn(deps, env, amount),\n        HandleMsg::AddPairs { pairs } =\u003e add_pairs(deps, env, pairs),\n        HandleMsg::RemovePairs { pairs } =\u003e remove_pairs(deps, env, pairs),\n        HandleMsg::SetBurnPool {address } =\u003e set_burn_pool(deps, env, address),\n        HandleMsg::SetSiennaToken { info } =\u003e set_token(deps, env, info),\n        HandleMsg::Admin(admin_msg) =\u003e multi_admin_handle(deps, env, admin_msg, DefaultHandleImpl)\n    })\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::Status =\u003e to_binary(\u0026get_status(deps)?),\n        QueryMsg::BurnPool =\u003e query_burn_pool(deps),\n        QueryMsg::SiennaToken =\u003e query_token(deps),\n        QueryMsg::Admin(admin_msg) =\u003e multi_admin_query(deps, admin_msg, DefaultQueryImpl)\n    }\n}\n\nfn burn\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    if !pair_address_exists(\u0026deps, \u0026env.message.sender)? {\n        return Err(StdError::unauthorized());\n    }\n\n    let burn_pool = load_burn_pool(\u0026deps)?;\n    let sienna_token = load_token_info(\u0026deps)?;\n\n    Ok(HandleResponse {\n        messages: vec![\n            snip20::burn_from_msg(\n                burn_pool,\n                amount,\n                None,\n                BLOCK_SIZE,\n                sienna_token.code_hash,\n                sienna_token.address\n            )?\n        ],\n        log: vec![\n            log(\"sienna_burned\", amount)\n        ],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn add_pairs\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pairs: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    save_pair_addresses(deps, \u0026pairs)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn remove_pairs\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    pairs: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    remove_pair_addresses(deps, \u0026pairs)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn set_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    save_burn_pool(deps, \u0026address)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\n#[require_admin]\nfn set_token\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    info: ContractInstance\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    save_token_info(deps, \u0026info)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026ResponseStatus::Success)?),\n    })\n}\n\nfn query_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let address = load_burn_pool(deps)?;\n\n    to_binary(\u0026QueryAnswer::BurnPool {\n        address,\n    })\n}\n\nfn query_token\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let info = load_token_info(deps)?;\n\n    to_binary(\u0026QueryAnswer::SiennaToken { \n        info \n    })\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::from_binary;\n    use cosmwasm_std::testing::{\n        MockApi, MockQuerier, MockStorage, mock_dependencies, mock_env\n    };\n    use sienna_amm_shared::admin::multi_admin::{\n        MultiAdminHandleMsg, MultiAdminQueryMsg, MultiAdminQueryResponse, load_admins\n    };\n\n    const FACTORY: \u0026'static str = \"factory_address\";\n    const BURN_POOL: \u0026'static str = \"burn_pool\";\n    const SENDER: \u0026'static str = \"sender\";\n\n    fn initialize(\n        pairs: Option\u003cVec\u003cHumanAddr\u003e\u003e,\n        admins: Option\u003cVec\u003cHumanAddr\u003e\u003e\n    ) -\u003e StdResult\u003cExtern\u003cMockStorage, MockApi, MockQuerier\u003e\u003e {\n        let env = mock_env(SENDER, \u0026[]);\n        let mut deps = mock_dependencies(20, \u0026[]);\n\n        let msg = InitMsg {\n            sienna_token: ContractInstance {\n                address: \"sienna_token\".into(),\n                code_hash: \"sienna_token_hash\".into()\n            },\n            pairs,\n            burn_pool: HumanAddr(BURN_POOL.into()),\n            factory_address: HumanAddr(FACTORY.into()),\n            admins\n        };\n\n        init(\u0026mut deps, env.clone(), msg)?;\n\n        Ok(deps)\n    }\n\n    fn assert_unauthorized(response: StdResult\u003cHandleResponse\u003e) {\n        assert!(response.is_err());\n\n        let err = response.unwrap_err();\n        assert_eq!(err, StdError::unauthorized())\n    }\n\n    #[test]\n    fn test_proper_init() -\u003e StdResult\u003c()\u003e {\n        let sienna_token = ContractInstance {\n            address: \"sienna_token\".into(),\n            code_hash: \"sienna_token_hash\".into()\n        };\n\n        let pairs = vec![ \n            HumanAddr(\"pair1\".into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        assert_eq!(sienna_token, load_token_info(deps)?);\n        assert_eq!(HumanAddr(BURN_POOL.into()), load_burn_pool(deps)?);\n        assert_eq!(\n            vec![ HumanAddr(FACTORY.into()), SENDER.into() ],\n            load_admins(deps)?\n        );\n\n        for i in 0..pairs.len() {\n            assert!(pair_address_exists(deps, \u0026pairs[i])?);\n        }\n\n        let admins = vec![\n            HumanAddr(\"admin1\".into()),\n            HumanAddr(\"admin2\".into()),\n            HumanAddr(\"admin3\".into())\n        ];\n        \n        let ref mut deps = initialize(None, Some(admins.clone()))?;\n\n        assert_eq!(\n            [ admins, vec![ HumanAddr(FACTORY.into()) ] ].concat(),\n            load_admins(deps)?\n        );\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_burn() -\u003e StdResult\u003c()\u003e {\n        let pair_1 = \"pair1\";\n\n        let pairs = vec![ \n            HumanAddr(pair_1.into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        let result = handle(\n            deps,\n            mock_env(pair_1, \u0026[]),\n            HandleMsg::Burn {\n                amount: Uint128(100)\n            }\n        );\n\n        assert!(result.is_ok());\n\n        let result = handle(\n            deps,\n            mock_env(\"unauthorized\", \u0026[]),\n            HandleMsg::Burn {\n                amount: Uint128(100)\n            }\n        );\n\n        assert_unauthorized(result);\n\n        let new_pair = HumanAddr(\"new_pair\".into());\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::AddPairs {\n                pairs: vec![ new_pair.clone() ]\n            }\n        )?;\n\n        let result = handle(\n            deps,\n            mock_env(new_pair, \u0026[]),\n            HandleMsg::Burn {\n                amount: Uint128(100)\n            }\n        );\n\n        assert!(result.is_ok());\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_add_pairs() -\u003e StdResult\u003c()\u003e {\n        let pairs = vec![ \n            HumanAddr(\"pair1\".into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        let new_pairs = vec![ \n            HumanAddr(\"pair4\".into()),\n            HumanAddr(\"pair5\".into())\n        ];\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::AddPairs {\n                pairs: new_pairs.clone()\n            }\n        )?;\n\n        let all_pairs = [ pairs, new_pairs ].concat();\n\n        for i in 0..all_pairs.len() {\n            assert!(pair_address_exists(deps, \u0026all_pairs[i])?);\n        }\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::AddPairs {\n                pairs: vec![ HumanAddr(\"whatever\".into()) ]\n            }\n        );\n        \n        assert_unauthorized(result);\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_remove_pairs() -\u003e StdResult\u003c()\u003e {\n        let pairs = vec![ \n            HumanAddr(\"pair1\".into()),\n            HumanAddr(\"pair2\".into()),\n            HumanAddr(\"pair3\".into())\n        ];\n\n        let ref mut deps = initialize(Some(pairs.clone()), None)?;\n\n        let remove_pairs = vec![ \n            HumanAddr(\"pair3\".into()),\n            HumanAddr(\"non_existant\".into())\n        ];\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::RemovePairs {\n                pairs: remove_pairs.clone()\n            }\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::RemovePairs {\n                pairs: remove_pairs.clone()\n            }\n        )?;\n\n        assert!(pair_address_exists(deps, \u0026pairs[0])?);\n        assert!(pair_address_exists(deps, \u0026pairs[1])?);\n        assert!(!pair_address_exists(deps, \u0026pairs[2])?);\n        assert!(!pair_address_exists(deps, \u0026remove_pairs[1])?);\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_add_admins() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = initialize(None, None)?;\n\n        let new_admins = vec![\n            HumanAddr(\"new_admin1\".into()),\n            HumanAddr(\"new_admin2\".into())\n        ];\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::Admin(MultiAdminHandleMsg::AddAdmins {\n                addresses: new_admins.clone()\n            })\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::Admin(MultiAdminHandleMsg::AddAdmins {\n                addresses: new_admins.clone()\n            })\n        )?;\n\n        let result = query(deps, QueryMsg::Admin(MultiAdminQueryMsg::Admins))?;\n        let result: MultiAdminQueryResponse = from_binary(\u0026result)?;\n\n        assert_eq!(\n            result.addresses,\n            [ \n                vec![ HumanAddr(FACTORY.into()), HumanAddr(SENDER.into()) ],\n                new_admins.clone()\n            ].concat()\n        );\n\n        handle(\n            deps,\n            mock_env(new_admins[0].clone(), \u0026[]),\n            HandleMsg::Admin(MultiAdminHandleMsg::AddAdmins {\n                addresses: new_admins.clone()\n            })\n        )?;\n\n        let result = query(deps, QueryMsg::Admin(MultiAdminQueryMsg::Admins))?;\n        let result: MultiAdminQueryResponse = from_binary(\u0026result)?;\n        assert!(result.addresses.len() == new_admins.len() * 2 + 2);\n        \n        Ok(())\n    }\n\n    #[test]\n    fn test_set_burn_pool() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = initialize(None, None)?;\n        \n        let pool = HumanAddr(\"pool\".into());\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::SetBurnPool {\n                address: pool.clone()\n            }\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::SetBurnPool {\n                address: pool.clone()\n            }\n        )?;\n\n        let result = query(deps, QueryMsg::BurnPool)?;\n        let result: QueryAnswer = from_binary(\u0026result)?;\n\n        match result {\n            QueryAnswer::BurnPool { address } =\u003e {\n                assert_eq!(pool, address)\n            },\n            _ =\u003e panic!(\"Expected QueryAnswer::BurnPool\")\n        }\n\n        Ok(())\n    }\n\n    #[test]\n    fn test_set_sienna_token() -\u003e StdResult\u003c()\u003e {\n        let ref mut deps = initialize(None, None)?;\n        \n        let token = ContractInstance {\n            address: \"new_token\".into(),\n            code_hash: \"new_token_hash\".into()\n        };\n\n        let result = handle(\n            deps,\n            mock_env(\"non_admin\", \u0026[]),\n            HandleMsg::SetSiennaToken {\n                info: token.clone()\n            }\n        );\n\n        assert_unauthorized(result);\n\n        handle(\n            deps,\n            mock_env(SENDER, \u0026[]),\n            HandleMsg::SetSiennaToken {\n                info: token.clone()\n            }\n        )?;\n\n        let result = query(deps, QueryMsg::SiennaToken)?;\n        let result: QueryAnswer = from_binary(\u0026result)?;\n\n        match result {\n            QueryAnswer::SiennaToken { info } =\u003e {\n                assert_eq!(token, info)\n            },\n            _ =\u003e panic!(\"Expected QueryAnswer::SiennaToken\")\n        }\n\n        Ok(())\n    }\n}\n","traces":[{"line":22,"address":[598795,595936],"length":1,"stats":{"Line":7},"fn_name":"init\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":27,"address":[596181,596121,595984,596375],"length":1,"stats":{"Line":14},"fn_name":null},{"line":28,"address":[596154,596437,596723,596511],"length":1,"stats":{"Line":14},"fn_name":null},{"line":30,"address":[596755,597085,596475],"length":1,"stats":{"Line":9},"fn_name":null},{"line":31,"address":[596790],"length":1,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[597037],"length":1,"stats":{"Line":1},"fn_name":null},{"line":34,"address":[596858],"length":1,"stats":{"Line":7},"fn_name":null},{"line":37,"address":[597259,597144,597468,597030,597192],"length":1,"stats":{"Line":21},"fn_name":null},{"line":39,"address":[597527,597582,597223],"length":1,"stats":{"Line":14},"fn_name":null},{"line":40,"address":[597945,597666,597618,597575,597716],"length":1,"stats":{"Line":12},"fn_name":null},{"line":43,"address":[597592,598828],"length":1,"stats":{"Line":6},"fn_name":null},{"line":46,"address":[599904,603540],"length":1,"stats":{"Line":2},"fn_name":"handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":51,"address":[600361,601784,602719,599951,602599,600727,602266,603174,600647],"length":1,"stats":{"Line":8},"fn_name":null},{"line":52,"address":[601764,600778],"length":1,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[600920,601762],"length":1,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[601760,601084],"length":1,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[601758,601248],"length":1,"stats":{"Line":2},"fn_name":null},{"line":56,"address":[601756,601412],"length":1,"stats":{"Line":2},"fn_name":null},{"line":57,"address":[601604],"length":1,"stats":{"Line":1},"fn_name":null},{"line":61,"address":[603584,604025],"length":1,"stats":{"Line":2},"fn_name":"query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":65,"address":[604040,604045,603651],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[603735,603979,603620,603658],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[603700],"length":1,"stats":{"Line":1},"fn_name":null},{"line":68,"address":[603683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":69,"address":[603717],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[607624,604048],"length":1,"stats":{"Line":1},"fn_name":"burn\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":78,"address":[604458,604101,604207],"length":1,"stats":{"Line":2},"fn_name":null},{"line":79,"address":[604521],"length":1,"stats":{"Line":1},"fn_name":null},{"line":82,"address":[604723,604932,604501,604597],"length":1,"stats":{"Line":2},"fn_name":null},{"line":83,"address":[604695,604988,605036,605659,605414],"length":1,"stats":{"Line":3},"fn_name":null},{"line":85,"address":[607034],"length":1,"stats":{"Line":1},"fn_name":null},{"line":86,"address":[605709,606458,605180,606107],"length":1,"stats":{"Line":2},"fn_name":null},{"line":87,"address":[605338,605849,606451,605702],"length":1,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[605206],"length":1,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[605246],"length":1,"stats":{"Line":1},"fn_name":null},{"line":92,"address":[605258],"length":1,"stats":{"Line":1},"fn_name":null},{"line":93,"address":[605298],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[606629,606554],"length":1,"stats":{"Line":2},"fn_name":null},{"line":97,"address":[606580],"length":1,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[607257,606863,606755],"length":1,"stats":{"Line":2},"fn_name":null},{"line":103,"address":[608649,608843,608593,608528],"length":1,"stats":{"Line":3},"fn_name":null},{"line":104,"address":[610068,608480,610083],"length":1,"stats":{"Line":1},"fn_name":"add_pairs\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":109,"address":[608961,608905,609173,608634],"length":1,"stats":{"Line":2},"fn_name":null},{"line":111,"address":[609469],"length":1,"stats":{"Line":1},"fn_name":null},{"line":112,"address":[608946],"length":1,"stats":{"Line":1},"fn_name":null},{"line":113,"address":[609208],"length":1,"stats":{"Line":1},"fn_name":null},{"line":114,"address":[609215,609277,609651,609341],"length":1,"stats":{"Line":3},"fn_name":null},{"line":118,"address":[610459,610265,610209,610144],"length":1,"stats":{"Line":3},"fn_name":null},{"line":119,"address":[611699,611684,610096],"length":1,"stats":{"Line":1},"fn_name":"remove_pairs\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":124,"address":[610521,610789,610250,610577],"length":1,"stats":{"Line":2},"fn_name":null},{"line":126,"address":[611085],"length":1,"stats":{"Line":1},"fn_name":null},{"line":127,"address":[610562],"length":1,"stats":{"Line":1},"fn_name":null},{"line":128,"address":[610824],"length":1,"stats":{"Line":1},"fn_name":null},{"line":129,"address":[610893,610831,610957,611267],"length":1,"stats":{"Line":3},"fn_name":null},{"line":133,"address":[611881,612075,611825,611760],"length":1,"stats":{"Line":3},"fn_name":null},{"line":134,"address":[613315,613300,611712],"length":1,"stats":{"Line":1},"fn_name":"set_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":139,"address":[612137,611866,612193,612405],"length":1,"stats":{"Line":2},"fn_name":null},{"line":141,"address":[612701],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[612178],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[612440],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[612509,612883,612447,612573],"length":1,"stats":{"Line":3},"fn_name":null},{"line":148,"address":[613441,613376,613691,613497],"length":1,"stats":{"Line":3},"fn_name":null},{"line":149,"address":[613328,614931,614916],"length":1,"stats":{"Line":1},"fn_name":"set_token\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":154,"address":[613809,613482,614021,613753],"length":1,"stats":{"Line":2},"fn_name":null},{"line":156,"address":[614317],"length":1,"stats":{"Line":1},"fn_name":null},{"line":157,"address":[613794],"length":1,"stats":{"Line":1},"fn_name":null},{"line":158,"address":[614056],"length":1,"stats":{"Line":1},"fn_name":null},{"line":159,"address":[614063,614189,614499,614125],"length":1,"stats":{"Line":3},"fn_name":null},{"line":163,"address":[608019,608034,607664],"length":1,"stats":{"Line":1},"fn_name":"query_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":164,"address":[607688,607879],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[607820],"length":1,"stats":{"Line":1},"fn_name":null},{"line":167,"address":[607794],"length":1,"stats":{"Line":1},"fn_name":null},{"line":171,"address":[608473,608458,608048],"length":1,"stats":{"Line":1},"fn_name":"query_token\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":172,"address":[608072,608318],"length":1,"stats":{"Line":1},"fn_name":null},{"line":174,"address":[608243],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[608204],"length":1,"stats":{"Line":1},"fn_name":null},{"line":194,"address":[651122,649488],"length":1,"stats":{"Line":2},"fn_name":"initialize"},{"line":198,"address":[649515],"length":1,"stats":{"Line":2},"fn_name":null},{"line":199,"address":[649591],"length":1,"stats":{"Line":6},"fn_name":null},{"line":202,"address":[649801],"length":1,"stats":{"Line":7},"fn_name":null},{"line":207,"address":[649896,649968],"length":1,"stats":{"Line":13},"fn_name":null},{"line":208,"address":[650000,650077],"length":1,"stats":{"Line":13},"fn_name":null},{"line":212,"address":[650915,650404,650337,650540],"length":1,"stats":{"Line":16},"fn_name":null},{"line":214,"address":[651014],"length":1,"stats":{"Line":3},"fn_name":null},{"line":217,"address":[651724,651152],"length":1,"stats":{"Line":1},"fn_name":"assert_unauthorized"},{"line":218,"address":[651164,651361],"length":1,"stats":{"Line":1},"fn_name":null},{"line":220,"address":[651255],"length":1,"stats":{"Line":4},"fn_name":null},{"line":221,"address":[651393,651609,651541],"length":1,"stats":{"Line":8},"fn_name":null},{"line":225,"address":[583737,583728],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":227,"address":[651805],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[651830],"length":1,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[651935,652098,652201,652271],"length":1,"stats":{"Line":2},"fn_name":null},{"line":232,"address":[652035,651951],"length":1,"stats":{"Line":2},"fn_name":null},{"line":233,"address":[652138,652067],"length":1,"stats":{"Line":2},"fn_name":null},{"line":234,"address":[652170,652239],"length":1,"stats":{"Line":2},"fn_name":null},{"line":237,"address":[652995,652786,652619,652438],"length":1,"stats":{"Line":2},"fn_name":null},{"line":239,"address":[653545,653597,653060,653107,652768],"length":1,"stats":{"Line":4},"fn_name":null},{"line":240,"address":[653724],"length":1,"stats":{"Line":1},"fn_name":null},{"line":241,"address":[655239,654803,654938],"length":1,"stats":{"Line":1},"fn_name":null},{"line":242,"address":[654487],"length":1,"stats":{"Line":1},"fn_name":null},{"line":243,"address":[654773,654844,655032],"length":1,"stats":{"Line":2},"fn_name":null},{"line":246,"address":[655441,656102,655690],"length":1,"stats":{"Line":3},"fn_name":null},{"line":247,"address":[655722,656075,656107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[656306,655640,656203,656376],"length":1,"stats":{"Line":2},"fn_name":null},{"line":251,"address":[656140,655656],"length":1,"stats":{"Line":2},"fn_name":null},{"line":252,"address":[656172,656243],"length":1,"stats":{"Line":2},"fn_name":null},{"line":253,"address":[656344,656275],"length":1,"stats":{"Line":2},"fn_name":null},{"line":256,"address":[656532,656990,657199,656734],"length":1,"stats":{"Line":1},"fn_name":null},{"line":258,"address":[658209,657607,657547,657739,658039],"length":1,"stats":{"Line":2},"fn_name":null},{"line":259,"address":[656882,657245],"length":1,"stats":{"Line":2},"fn_name":null},{"line":260,"address":[657832,657600,657540,657645],"length":1,"stats":{"Line":3},"fn_name":null},{"line":263,"address":[658375],"length":1,"stats":{"Line":1},"fn_name":null},{"line":267,"address":[583776,583785],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":268,"address":[658497],"length":1,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[658840,658555,658757,658657],"length":1,"stats":{"Line":2},"fn_name":null},{"line":271,"address":[658573],"length":1,"stats":{"Line":1},"fn_name":null},{"line":272,"address":[658694,658626],"length":1,"stats":{"Line":2},"fn_name":null},{"line":273,"address":[658726,658792],"length":1,"stats":{"Line":2},"fn_name":null},{"line":276,"address":[659029,659179,659552,659343],"length":1,"stats":{"Line":2},"fn_name":null},{"line":280,"address":[659296],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[659595],"length":1,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[659714,659815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":290,"address":[659776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":291,"address":[659847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":296,"address":[659918],"length":1,"stats":{"Line":1},"fn_name":null},{"line":298,"address":[660029],"length":1,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[660100],"length":1,"stats":{"Line":1},"fn_name":null},{"line":303,"address":[660352],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[660157,660237],"length":1,"stats":{"Line":2},"fn_name":null},{"line":310,"address":[661023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":311,"address":[661095],"length":1,"stats":{"Line":1},"fn_name":null},{"line":316,"address":[661266,661174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":318,"address":[661244],"length":1,"stats":{"Line":1},"fn_name":null},{"line":322,"address":[583833,583824],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":323,"address":[661935,661545,661734,661393,661648],"length":1,"stats":{"Line":3},"fn_name":null},{"line":324,"address":[661451],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[661514,661585],"length":1,"stats":{"Line":2},"fn_name":null},{"line":326,"address":[661686,661617],"length":1,"stats":{"Line":2},"fn_name":null},{"line":329,"address":[662099,662281,661943,662490],"length":1,"stats":{"Line":2},"fn_name":null},{"line":331,"address":[662599,662671,662226,662813],"length":1,"stats":{"Line":3},"fn_name":null},{"line":332,"address":[662536,662242],"length":1,"stats":{"Line":2},"fn_name":null},{"line":333,"address":[662639,662568],"length":1,"stats":{"Line":2},"fn_name":null},{"line":338,"address":[662821],"length":1,"stats":{"Line":1},"fn_name":null},{"line":339,"address":[662958],"length":1,"stats":{"Line":1},"fn_name":null},{"line":340,"address":[662890],"length":1,"stats":{"Line":1},"fn_name":null},{"line":344,"address":[663592],"length":1,"stats":{"Line":1},"fn_name":null},{"line":346,"address":[664603,663885,663824,664096],"length":1,"stats":{"Line":4},"fn_name":null},{"line":347,"address":[664495,664128,664608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":352,"address":[664054,664640],"length":1,"stats":{"Line":2},"fn_name":null},{"line":353,"address":[664855],"length":1,"stats":{"Line":1},"fn_name":null},{"line":354,"address":[664662],"length":1,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[664972],"length":1,"stats":{"Line":1},"fn_name":null},{"line":360,"address":[665107],"length":1,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[583872,583881],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":365,"address":[665372,665239,665472,665558],"length":1,"stats":{"Line":2},"fn_name":null},{"line":366,"address":[665278],"length":1,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[665341,665409],"length":1,"stats":{"Line":2},"fn_name":null},{"line":368,"address":[665441,665510],"length":1,"stats":{"Line":2},"fn_name":null},{"line":371,"address":[665753,665903,666085,666294],"length":1,"stats":{"Line":2},"fn_name":null},{"line":373,"address":[666030,666400,666472],"length":1,"stats":{"Line":2},"fn_name":null},{"line":374,"address":[666046,666337],"length":1,"stats":{"Line":2},"fn_name":null},{"line":375,"address":[666369,666440],"length":1,"stats":{"Line":2},"fn_name":null},{"line":380,"address":[666614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":381,"address":[666751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":382,"address":[666683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":386,"address":[666887],"length":1,"stats":{"Line":1},"fn_name":null},{"line":390,"address":[667017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":391,"address":[667091],"length":1,"stats":{"Line":1},"fn_name":null},{"line":392,"address":[667064],"length":1,"stats":{"Line":1},"fn_name":null},{"line":396,"address":[668079,667728,668138],"length":1,"stats":{"Line":1},"fn_name":null},{"line":397,"address":[668549,668191,668490,668106],"length":1,"stats":{"Line":2},"fn_name":null},{"line":398,"address":[668904,668966,668603,668517],"length":1,"stats":{"Line":2},"fn_name":null},{"line":399,"address":[668931,669321,669410,669020],"length":1,"stats":{"Line":2},"fn_name":null},{"line":401,"address":[669384],"length":1,"stats":{"Line":1},"fn_name":null},{"line":405,"address":[583929,583920],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":406,"address":[669760,669495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":408,"address":[669984,669713,669912],"length":1,"stats":{"Line":2},"fn_name":null},{"line":409,"address":[669729,669849],"length":1,"stats":{"Line":2},"fn_name":null},{"line":410,"address":[669952,669881],"length":1,"stats":{"Line":2},"fn_name":null},{"line":415,"address":[670126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":416,"address":[670263],"length":1,"stats":{"Line":1},"fn_name":null},{"line":417,"address":[670195],"length":1,"stats":{"Line":1},"fn_name":null},{"line":421,"address":[670431],"length":1,"stats":{"Line":1},"fn_name":null},{"line":425,"address":[670561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":426,"address":[670635],"length":1,"stats":{"Line":1},"fn_name":null},{"line":427,"address":[670608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":431,"address":[671304,671484,671696],"length":1,"stats":{"Line":1},"fn_name":null},{"line":432,"address":[672160,671787,671951,671469,671739],"length":1,"stats":{"Line":3},"fn_name":null},{"line":434,"address":[672674],"length":1,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[671896,672209],"length":1,"stats":{"Line":2},"fn_name":null},{"line":438,"address":[672487],"length":1,"stats":{"Line":1},"fn_name":null},{"line":439,"address":[672628],"length":1,"stats":{"Line":0},"fn_name":null},{"line":444,"address":[672937],"length":1,"stats":{"Line":1},"fn_name":null},{"line":445,"address":[673058],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[673031],"length":1,"stats":{"Line":1},"fn_name":null},{"line":450,"address":[673907,673727,674119],"length":1,"stats":{"Line":1},"fn_name":null},{"line":451,"address":[674553,674210,674162,674324,673892],"length":1,"stats":{"Line":3},"fn_name":null},{"line":452,"address":[674667,674301,674606,674831],"length":1,"stats":{"Line":3},"fn_name":null},{"line":454,"address":[674805],"length":1,"stats":{"Line":1},"fn_name":null},{"line":458,"address":[583968,583977],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":459,"address":[674993,675226],"length":1,"stats":{"Line":1},"fn_name":null},{"line":461,"address":[675195,675315],"length":1,"stats":{"Line":2},"fn_name":null},{"line":465,"address":[675423,675347],"length":1,"stats":{"Line":2},"fn_name":null},{"line":466,"address":[675492],"length":1,"stats":{"Line":1},"fn_name":null},{"line":467,"address":[675447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":471,"address":[675625],"length":1,"stats":{"Line":1},"fn_name":null},{"line":475,"address":[675755],"length":1,"stats":{"Line":1},"fn_name":null},{"line":476,"address":[675825],"length":1,"stats":{"Line":1},"fn_name":null},{"line":477,"address":[675818],"length":1,"stats":{"Line":1},"fn_name":null},{"line":481,"address":[676459,676636,676848],"length":1,"stats":{"Line":1},"fn_name":null},{"line":482,"address":[677047,676939,676891,677284,676621],"length":1,"stats":{"Line":3},"fn_name":null},{"line":485,"address":[677326,677022],"length":1,"stats":{"Line":2},"fn_name":null},{"line":486,"address":[677606,677531,677374],"length":1,"stats":{"Line":2},"fn_name":null},{"line":488,"address":[677453],"length":1,"stats":{"Line":0},"fn_name":null},{"line":491,"address":[677658],"length":1,"stats":{"Line":1},"fn_name":null},{"line":495,"address":[584025,584016],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":496,"address":[677857,678086],"length":1,"stats":{"Line":1},"fn_name":null},{"line":499,"address":[678059],"length":1,"stats":{"Line":1},"fn_name":null},{"line":500,"address":[678175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":505,"address":[678307,678387],"length":1,"stats":{"Line":2},"fn_name":null},{"line":506,"address":[678463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":507,"address":[678395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":511,"address":[678612],"length":1,"stats":{"Line":1},"fn_name":null},{"line":515,"address":[678742],"length":1,"stats":{"Line":1},"fn_name":null},{"line":516,"address":[678816],"length":1,"stats":{"Line":1},"fn_name":null},{"line":517,"address":[678789],"length":1,"stats":{"Line":1},"fn_name":null},{"line":521,"address":[679855,679643,679466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":522,"address":[679946,680291,679628,679898,680054],"length":1,"stats":{"Line":3},"fn_name":null},{"line":525,"address":[680029,680333],"length":1,"stats":{"Line":2},"fn_name":null},{"line":526,"address":[680558,680633,680397],"length":1,"stats":{"Line":2},"fn_name":null},{"line":528,"address":[680480],"length":1,"stats":{"Line":0},"fn_name":null},{"line":531,"address":[680685],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":228,"coverable":232},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","src","lib.rs"],"content":"#[macro_use] extern crate fadroma_scrt_migrate;\npub mod contract;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","src","state.rs"],"content":"use cosmwasm_std::{\n    Api, CanonicalAddr, Extern, HumanAddr, Querier,\n    ReadonlyStorage, StdResult, Storage, StdError\n};\nuse cosmwasm_storage::{PrefixedStorage, ReadonlyPrefixedStorage};\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstance;\nuse fadroma_scrt_storage::{save, load};\n\nconst SIENNA_TOKEN_KEY: \u0026[u8] = b\"sienna_token\";\nconst BURN_POOL_KEY: \u0026[u8] = b\"burn_pool\";\nconst PAIRS_PREFIX: \u0026[u8] = b\"pairs\";\n\npub fn save_token_info\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    info: \u0026ContractInstance\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, SIENNA_TOKEN_KEY, \u0026info.canonize(\u0026deps.api)?)\n}\n\npub fn load_token_info\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cContractInstance\u003cHumanAddr\u003e\u003e {\n    let stored: ContractInstance\u003cCanonicalAddr\u003e = load(\u0026deps.storage, SIENNA_TOKEN_KEY)?.ok_or(\n        StdError::generic_err(\"Token info doesn't exist in storage.\")\n    )?;\n    stored.humanize(\u0026deps.api)\n}\n\npub fn save_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003c()\u003e {\n    save(\u0026mut deps.storage, BURN_POOL_KEY, \u0026address.canonize(\u0026deps.api)?)\n}\n\npub fn load_burn_pool\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cHumanAddr\u003e {\n    let address: CanonicalAddr = load(\u0026deps.storage, BURN_POOL_KEY)?.ok_or_else(||\n        StdError::generic_err(\"Burn pool address doesn't exist in storage.\")\n    )?;\n    address.humanize(\u0026deps.api)\n}\n\npub fn save_pair_addresses\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    addresses: \u0026Vec\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let mut storage = PrefixedStorage::new(PAIRS_PREFIX, \u0026mut deps.storage);\n    for address in addresses {\n        let canonical = address.canonize(\u0026deps.api)?;\n        storage.set(\u0026canonical.as_slice(), \u0026[1]);\n    }\n    Ok(())\n}\n\npub fn remove_pair_addresses\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    addresses: \u0026Vec\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let mut storage = PrefixedStorage::new(PAIRS_PREFIX, \u0026mut deps.storage);\n    for address in addresses {\n        let canonical = address.canonize(\u0026deps.api)?;\n        storage.remove(canonical.as_slice());\n    }\n    Ok(())\n}\n\npub fn pair_address_exists\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003cbool\u003e {\n    let storage = ReadonlyPrefixedStorage::new(PAIRS_PREFIX, \u0026deps.storage);\n    let canonical = address.canonize(\u0026deps.api)?;\n    let result = storage.get(canonical.as_slice());\n    Ok(result.is_some())\n}\n","traces":[{"line":14,"address":[538144,538491],"length":1,"stats":{"Line":7},"fn_name":"save_token_info\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":18,"address":[538188],"length":1,"stats":{"Line":7},"fn_name":null},{"line":21,"address":[538941,538512],"length":1,"stats":{"Line":1},"fn_name":"load_token_info\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":24,"address":[538840,539149,538753,538921,538542,538985],"length":1,"stats":{"Line":5},"fn_name":null},{"line":25,"address":[538722],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[539075],"length":1,"stats":{"Line":2},"fn_name":null},{"line":30,"address":[539232,539555],"length":1,"stats":{"Line":7},"fn_name":"save_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":34,"address":[539276],"length":1,"stats":{"Line":7},"fn_name":null},{"line":37,"address":[540128,539584,540143],"length":1,"stats":{"Line":1},"fn_name":"load_burn_pool\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":40,"address":[540048,540144,539910,539614,539878],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":41,"address":[540156],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[539974],"length":1,"stats":{"Line":1},"fn_name":null},{"line":46,"address":[541040,540192,541025],"length":1,"stats":{"Line":5},"fn_name":"save_pair_addresses\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":50,"address":[540238],"length":1,"stats":{"Line":4},"fn_name":null},{"line":51,"address":[540439,540265,540351,541020],"length":1,"stats":{"Line":16},"fn_name":null},{"line":52,"address":[540635,540468,540854],"length":1,"stats":{"Line":4},"fn_name":null},{"line":53,"address":[540593,540903],"length":1,"stats":{"Line":8},"fn_name":null},{"line":55,"address":[540412],"length":1,"stats":{"Line":4},"fn_name":null},{"line":58,"address":[541040,541843,541828],"length":1,"stats":{"Line":1},"fn_name":"remove_pair_addresses\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":62,"address":[541086],"length":1,"stats":{"Line":1},"fn_name":null},{"line":63,"address":[541823,541199,541287,541113],"length":1,"stats":{"Line":4},"fn_name":null},{"line":64,"address":[541316,541483,541702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":65,"address":[541756,541441],"length":1,"stats":{"Line":2},"fn_name":null},{"line":67,"address":[541260],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[542602,541856,542587],"length":1,"stats":{"Line":1},"fn_name":"pair_address_exists\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":74,"address":[541902],"length":1,"stats":{"Line":1},"fn_name":null},{"line":75,"address":[541934,542349,542013,542130],"length":1,"stats":{"Line":2},"fn_name":null},{"line":76,"address":[542412,542090],"length":1,"stats":{"Line":2},"fn_name":null},{"line":77,"address":[542465],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":28,"coverable":29},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","sienna-burner","tests","integration.rs"],"content":"//! This integration test tries to run and call the generated wasm.\n//! It depends on a Wasm build being available, which you can create with `cargo wasm`.\n//! Then running `cargo integration-test` will validate we can properly call into that generated Wasm.\n//!\n//! You can easily convert unit tests to integration tests.\n//! 1. First copy them over verbatum,\n//! 2. Then change\n//!      let mut deps = mock_dependencies(20, \u0026[]);\n//!    to\n//!      let mut deps = mock_instance(WASM, \u0026[]);\n//! 3. If you access raw storage, where ever you see something like:\n//!      deps.storage.get(CONFIG_KEY).expect(\"no data stored\");\n//!    replace it with:\n//!      deps.with_storage(|store| {\n//!          let data = store.get(CONFIG_KEY).expect(\"no data stored\");\n//!          //...\n//!      });\n//! 4. Anywhere you see query(\u0026deps, ...) you must replace it with query(\u0026mut deps, ...)\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","examples","schema.rs"],"content":"use std::env::current_dir;\nuse std::fs::create_dir_all;\n\nuse cosmwasm_schema::{export_schema, remove_schemas, schema_for};\n\nuse snip20_reference_impl::msg::{HandleAnswer, HandleMsg, InitMsg, QueryAnswer, QueryMsg};\n\nfn main() {\n    let mut out_dir = current_dir().unwrap();\n    out_dir.push(\"schema\");\n    create_dir_all(\u0026out_dir).unwrap();\n    remove_schemas(\u0026out_dir).unwrap();\n\n    export_schema(\u0026schema_for!(InitMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(HandleMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(HandleAnswer), \u0026out_dir);\n    export_schema(\u0026schema_for!(QueryMsg), \u0026out_dir);\n    export_schema(\u0026schema_for!(QueryAnswer), \u0026out_dir);\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","contract.rs"],"content":"/// This contract implements SNIP-20 standard:\n/// https://github.com/SecretFoundation/SNIPs/blob/master/SNIP-20.md\nuse cosmwasm_std::{\n    log, to_binary, Api, BankMsg, Binary, CanonicalAddr, Coin, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, QueryResult, ReadonlyStorage, StdError,\n    StdResult, Storage, Uint128,\n};\n\nuse crate::msg::{\n    space_pad, ContractStatusLevel, HandleAnswer, HandleMsg, InitMsg, QueryAnswer, QueryMsg,\n    ResponseStatus::Success,\n};\nuse crate::rand::sha_256;\nuse crate::receiver::Snip20ReceiveMsg;\nuse crate::state::{\n    get_receiver_hash, get_transfers, read_allowance, read_viewing_key, set_receiver_hash,\n    store_transfer, write_allowance, write_viewing_key, Balances, Config, Constants,\n    ReadonlyBalances, ReadonlyConfig,\n};\nuse crate::viewing_key::{ViewingKey, VIEWING_KEY_SIZE};\n\n/// We make sure that responses from `handle` are padded to a multiple of this size.\npub const RESPONSE_BLOCK_SIZE: usize = 256;\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let init_config = msg.config();\n    let mut total_supply: u128 = 0;\n    {\n        let mut balances = Balances::from_storage(\u0026mut deps.storage);\n        let initial_balances = msg.initial_balances.unwrap_or_default();\n        for balance in initial_balances {\n            let balance_address = deps.api.canonical_address(\u0026balance.address)?;\n            let amount = balance.amount.u128();\n            balances.set_account_balance(\u0026balance_address, amount);\n            if let Some(new_total_supply) = total_supply.checked_add(amount) {\n                total_supply = new_total_supply;\n            } else {\n                return Err(StdError::generic_err(\n                    \"The sum of all initial balances exceeds the maximum possible total supply\",\n                ));\n            }\n        }\n    }\n\n    // Check name, symbol, decimals\n    if !is_valid_name(\u0026msg.name) {\n        return Err(StdError::generic_err(\n            \"Name is not in the expected format (3-30 UTF-8 bytes)\",\n        ));\n    }\n    if !is_valid_symbol(\u0026msg.symbol) {\n        return Err(StdError::generic_err(\n            \"Ticker symbol is not in expected format [A-Z]{3,6}\",\n        ));\n    }\n    if msg.decimals \u003e 18 {\n        return Err(StdError::generic_err(\"Decimals must not exceed 18\"));\n    }\n\n    let admin = msg.admin.unwrap_or_else(|| env.message.sender);\n\n    let prng_seed_hashed = sha_256(\u0026msg.prng_seed.0);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    config.set_constants(\u0026Constants {\n        name: msg.name,\n        symbol: msg.symbol,\n        decimals: msg.decimals,\n        admin: admin.clone(),\n        prng_seed: prng_seed_hashed.to_vec(),\n        total_supply_is_public: init_config.public_total_supply(),\n    })?;\n    config.set_total_supply(total_supply);\n    config.set_contract_status(ContractStatusLevel::NormalRun);\n    config.set_minters(Vec::from([admin]))?;\n\n    Ok(InitResponse::default())\n}\n\nfn pad_response(response: StdResult\u003cHandleResponse\u003e) -\u003e StdResult\u003cHandleResponse\u003e {\n    response.map(|mut response| {\n        response.data = response.data.map(|mut data| {\n            space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n            data\n        });\n        response\n    })\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n\n    match contract_status {\n        ContractStatusLevel::StopAll | ContractStatusLevel::StopAllButRedeems =\u003e {\n            let response = match msg {\n                HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n                HandleMsg::Redeem { amount, .. }\n                    if contract_status == ContractStatusLevel::StopAllButRedeems =\u003e\n                {\n                    try_redeem(deps, env, amount)\n                }\n                _ =\u003e Err(StdError::generic_err(\n                    \"This contract is stopped and this action is not allowed\",\n                )),\n            };\n            return pad_response(response);\n        }\n        ContractStatusLevel::NormalRun =\u003e {} // If it's a normal run just continue\n    }\n\n    let response = match msg {\n        // Native\n        HandleMsg::Deposit { .. } =\u003e try_deposit(deps, env),\n        HandleMsg::Redeem { amount, .. } =\u003e try_redeem(deps, env, amount),\n\n        // Base\n        HandleMsg::Transfer {\n            recipient, amount, ..\n        } =\u003e try_transfer(deps, env, \u0026recipient, amount),\n        HandleMsg::Send {\n            recipient,\n            amount,\n            msg,\n            ..\n        } =\u003e try_send(deps, env, \u0026recipient, amount, msg),\n        HandleMsg::Burn { amount, .. } =\u003e try_burn(deps, env, amount),\n        HandleMsg::RegisterReceive { code_hash, .. } =\u003e try_register_receive(deps, env, code_hash),\n        HandleMsg::CreateViewingKey { entropy, .. } =\u003e try_create_key(deps, env, entropy),\n        HandleMsg::SetViewingKey { key, .. } =\u003e try_set_key(deps, env, key),\n\n        // Allowance\n        HandleMsg::IncreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_increase_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::DecreaseAllowance {\n            spender,\n            amount,\n            expiration,\n            ..\n        } =\u003e try_decrease_allowance(deps, env, spender, amount, expiration),\n        HandleMsg::TransferFrom {\n            owner,\n            recipient,\n            amount,\n            ..\n        } =\u003e try_transfer_from(deps, env, \u0026owner, \u0026recipient, amount),\n        HandleMsg::SendFrom {\n            owner,\n            recipient,\n            amount,\n            msg,\n            ..\n        } =\u003e try_send_from(deps, env, \u0026owner, \u0026recipient, amount, msg),\n        HandleMsg::BurnFrom { owner, amount, .. } =\u003e try_burn_from(deps, env, \u0026owner, amount),\n\n        // Mint\n        HandleMsg::Mint {\n            recipient, amount, ..\n        } =\u003e try_mint(deps, env, recipient, amount),\n\n        // Other\n        HandleMsg::ChangeAdmin { address, .. } =\u003e change_admin(deps, env, address),\n        HandleMsg::SetContractStatus { level, .. } =\u003e set_contract_status(deps, env, level),\n        HandleMsg::AddMinters { minters, .. } =\u003e add_minters(deps, env, minters),\n        HandleMsg::RemoveMinters { minters, .. } =\u003e remove_minters(deps, env, minters),\n        HandleMsg::SetMinters { minters, .. } =\u003e set_minters(deps, env, minters),\n    };\n\n    pad_response(response)\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e, msg: QueryMsg) -\u003e QueryResult {\n    match msg {\n        QueryMsg::TokenInfo {} =\u003e query_token_info(\u0026deps.storage),\n        QueryMsg::ExchangeRate {} =\u003e query_exchange_rate(),\n        QueryMsg::Minters { .. } =\u003e query_minters(deps),\n        _ =\u003e authenticated_queries(deps, msg),\n    }\n}\n\npub fn authenticated_queries\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e QueryResult {\n    let (addresses, key) = msg.get_validation_params();\n\n    for address in addresses {\n        let canonical_addr = deps.api.canonical_address(address)?;\n\n        let expected_key = read_viewing_key(\u0026deps.storage, \u0026canonical_addr);\n\n        if expected_key.is_none() {\n            // Checking the key will take significant time. We don't want to exit immediately if it isn't set\n            // in a way which will allow to time the command and determine if a viewing key doesn't exist\n            key.check_viewing_key(\u0026[0u8; VIEWING_KEY_SIZE]);\n        } else if key.check_viewing_key(expected_key.unwrap().as_slice()) {\n            return match msg {\n                // Base\n                QueryMsg::Balance { address, .. } =\u003e query_balance(\u0026deps, \u0026address),\n                QueryMsg::TransferHistory {\n                    address,\n                    page,\n                    page_size,\n                    ..\n                } =\u003e query_transactions(\u0026deps, \u0026address, page.unwrap_or(0), page_size),\n                QueryMsg::Allowance { owner, spender, .. } =\u003e {\n                    try_check_allowance(deps, owner, spender)\n                }\n                _ =\u003e panic!(\"This query type does not require authentication\"),\n            };\n        }\n    }\n\n    Ok(to_binary(\u0026QueryAnswer::ViewingKeyError {\n        msg: \"Wrong viewing key for this address or viewing key not set\".to_string(),\n    })?)\n}\n\n/// This function just returns a constant 1:1 rate to uscrt, since that's the purpose of this\n/// contract.\nfn query_exchange_rate() -\u003e QueryResult {\n    to_binary(\u0026QueryAnswer::ExchangeRate {\n        rate: Uint128(1),\n        denom: \"uscrt\".to_string(),\n    })\n}\n\nfn query_token_info\u003cS: ReadonlyStorage\u003e(storage: \u0026S) -\u003e QueryResult {\n    let config = ReadonlyConfig::from_storage(storage);\n    let constants = config.constants()?;\n\n    let total_supply = if constants.total_supply_is_public {\n        Some(Uint128(config.total_supply()))\n    } else {\n        None\n    };\n\n    to_binary(\u0026QueryAnswer::TokenInfo {\n        name: constants.name,\n        symbol: constants.symbol,\n        decimals: constants.decimals,\n        total_supply,\n    })\n}\n\npub fn query_transactions\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account).unwrap();\n    let txs = get_transfers(\u0026deps.api, \u0026deps.storage, \u0026address, page, page_size)?;\n\n    let result = QueryAnswer::TransferHistory { txs };\n    to_binary(\u0026result)\n}\n\npub fn query_balance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    account: \u0026HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let address = deps.api.canonical_address(account)?;\n\n    let amount = Uint128(ReadonlyBalances::from_storage(\u0026deps.storage).account_amount(\u0026address));\n    let response = QueryAnswer::Balance { amount };\n    to_binary(\u0026response)\n}\n\nfn query_minters\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cBinary\u003e {\n    let minters = ReadonlyConfig::from_storage(\u0026deps.storage).minters();\n\n    let response = QueryAnswer::Minters { minters };\n    to_binary(\u0026response)\n}\n\nfn change_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    let mut consts = config.constants()?;\n    consts.admin = address;\n    config.set_constants(\u0026consts)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::ChangeAdmin { status: Success })?),\n    })\n}\n\nfn try_mint\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    address: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    let minters = config.minters();\n    if !minters.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(\n            \"Minting is allowed to minter accounts only\",\n        ));\n    }\n\n    let amount = amount.u128();\n\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_add(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the total supply above the supported maximum\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let receipient_account = \u0026deps.api.canonical_address(\u0026address)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n\n    let mut account_balance = balances.balance(receipient_account);\n\n    if let Some(new_balance) = account_balance.checked_add(amount) {\n        account_balance = new_balance;\n    } else {\n        // This error literally can not happen, since the account's funds are a subset\n        // of the total supply, both are stored as u128, and we check for overflow of\n        // the total supply just a couple lines before.\n        // Still, writing this to cover all overflows.\n        return Err(StdError::generic_err(\n            \"This mint attempt would increase the account's balance above the supported maximum\",\n        ));\n    }\n\n    balances.set_account_balance(receipient_account, account_balance);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Mint { status: Success })?),\n    };\n\n    Ok(res)\n}\n\npub fn try_set_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    key: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let vk = ViewingKey(key);\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026vk);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetViewingKey { status: Success })?),\n    })\n}\n\npub fn try_create_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    entropy: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let constants = ReadonlyConfig::from_storage(\u0026deps.storage).constants()?;\n    let prng_seed = constants.prng_seed;\n\n    let key = ViewingKey::new(\u0026env, \u0026prng_seed, (\u0026entropy).as_ref());\n\n    let message_sender = deps.api.canonical_address(\u0026env.message.sender)?;\n    write_viewing_key(\u0026mut deps.storage, \u0026message_sender, \u0026key);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::CreateViewingKey { key })?),\n    })\n}\n\nfn set_contract_status\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    status_level: ContractStatusLevel,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_contract_status(status_level);\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetContractStatus {\n            status: Success,\n        })?),\n    })\n}\n\npub fn try_check_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    owner: HumanAddr,\n    spender: HumanAddr,\n) -\u003e StdResult\u003cBinary\u003e {\n    let owner_address = deps.api.canonical_address(\u0026owner)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    let response = QueryAnswer::Allowance {\n        owner,\n        spender,\n        allowance: Uint128(allowance.amount),\n        expiration: allowance.expiration,\n    };\n    to_binary(\u0026response)\n}\n\nfn try_deposit\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut amount = Uint128::zero();\n\n    for coin in \u0026env.message.sent_funds {\n        if coin.denom == \"uscrt\" {\n            amount = coin.amount\n        }\n    }\n\n    if amount.is_zero() {\n        return Err(StdError::generic_err(\"No funds were sent to be deposited\"));\n    }\n\n    let amount = amount.u128();\n\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n    if let Some(account_balance) = account_balance.checked_add(amount) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow your balance\",\n        ));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_add(amount) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"This deposit would overflow the currency's total supply\",\n        ));\n    }\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Deposit { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount_raw = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(account_balance) = account_balance.checked_sub(amount_raw) {\n        balances.set_account_balance(\u0026sender_address, account_balance);\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to redeem: balance={}, required={}\",\n            account_balance, amount_raw\n        )));\n    }\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let total_supply = config.total_supply();\n    if let Some(total_supply) = total_supply.checked_sub(amount_raw) {\n        config.set_total_supply(total_supply);\n    } else {\n        return Err(StdError::generic_err(\n            \"You are tyring to redeem more tokens than what is available in the total supply\",\n        ));\n    }\n\n    let withdrawl_coins: Vec\u003cCoin\u003e = vec![Coin {\n        denom: \"uscrt\".to_string(),\n        amount,\n    }];\n\n    let res = HandleResponse {\n        messages: vec![CosmosMsg::Bank(BankMsg::Send {\n            from_address: env.contract.address,\n            to_address: env.message.sender,\n            amount: withdrawl_coins,\n        })],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Redeem { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_transfer_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount.u128(),\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026sender_address,\n        \u0026sender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\nfn try_transfer\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Transfer { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_add_receiver_api_callback\u003cS: ReadonlyStorage\u003e(\n    messages: \u0026mut Vec\u003cCosmosMsg\u003e,\n    storage: \u0026S,\n    recipient: \u0026HumanAddr,\n    msg: Option\u003cBinary\u003e,\n    sender: HumanAddr,\n    from: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let receiver_hash = get_receiver_hash(storage, recipient);\n    if let Some(receiver_hash) = receiver_hash {\n        let receiver_hash = receiver_hash?;\n        let receiver_msg = Snip20ReceiveMsg::new(sender, from, amount, msg);\n        let callback_msg = receiver_msg.into_cosmos_msg(receiver_hash, recipient.clone())?;\n\n        messages.push(callback_msg);\n    }\n    Ok(())\n}\n\nfn try_send\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_impl(deps, env, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender.clone(),\n        sender,\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Send { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_register_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    code_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    set_receiver_hash(\u0026mut deps.storage, \u0026env.message.sender, code_hash);\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![log(\"register_status\", \"success\")],\n        data: Some(to_binary(\u0026HandleAnswer::RegisterReceive {\n            status: Success,\n        })?),\n    };\n    Ok(res)\n}\n\nfn insufficient_allowance(allowance: u128, required: u128) -\u003e StdError {\n    StdError::generic_err(format!(\n        \"insufficient allowance: allowance={}, required={}\",\n        allowance, required\n    ))\n}\n\nfn try_transfer_from_impl\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003c()\u003e {\n    let spender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let owner_address = deps.api.canonical_address(owner)?;\n    let recipient_address = deps.api.canonical_address(recipient)?;\n    let amount_raw = amount.u128();\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    if allowance.expiration.map(|ex| ex \u003c env.block.time) == Some(true) {\n        allowance.amount = 0;\n        write_allowance(\n            \u0026mut deps.storage,\n            \u0026owner_address,\n            \u0026spender_address,\n            allowance,\n        )?;\n        return Err(insufficient_allowance(0, amount_raw));\n    }\n\n    if let Some(new_allowance) = allowance.amount.checked_sub(amount_raw) {\n        allowance.amount = new_allowance;\n    } else {\n        return Err(insufficient_allowance(allowance.amount, amount_raw));\n    }\n\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n    perform_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026recipient_address,\n        amount_raw,\n    )?;\n\n    let symbol = Config::from_storage(\u0026mut deps.storage).constants()?.symbol;\n\n    store_transfer(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        \u0026recipient_address,\n        amount,\n        symbol,\n    )?;\n\n    Ok(())\n}\n\nfn try_transfer_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::TransferFrom { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_send_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    recipient: \u0026HumanAddr,\n    amount: Uint128,\n    msg: Option\u003cBinary\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender = env.message.sender.clone();\n    try_transfer_from_impl(deps, env, owner, recipient, amount)?;\n\n    let mut messages = vec![];\n\n    try_add_receiver_api_callback(\n        \u0026mut messages,\n        \u0026deps.storage,\n        recipient,\n        msg,\n        sender,\n        owner.clone(),\n        amount,\n    )?;\n\n    let res = HandleResponse {\n        messages,\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SendFrom { status: Success })?),\n    };\n    Ok(res)\n}\n\nfn try_burn_from\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    owner: \u0026HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let spender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let owner_address = deps.api.canonical_address(owner)?;\n    let amount = amount.u128();\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n\n    if allowance.expiration.map(|ex| ex \u003c env.block.time) == Some(true) {\n        allowance.amount = 0;\n        write_allowance(\n            \u0026mut deps.storage,\n            \u0026owner_address,\n            \u0026spender_address,\n            allowance,\n        )?;\n        return Err(insufficient_allowance(0, amount));\n    }\n\n    if let Some(new_allowance) = allowance.amount.checked_sub(amount) {\n        allowance.amount = new_allowance;\n    } else {\n        return Err(insufficient_allowance(allowance.amount, amount));\n    }\n\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    // subtract from owner account\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026owner_address);\n\n    if let Some(new_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n    balances.set_account_balance(\u0026owner_address, account_balance);\n\n    // remove from supply\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::BurnFrom { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn try_increase_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_add(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::IncreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn try_decrease_allowance\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    spender: HumanAddr,\n    amount: Uint128,\n    expiration: Option\u003cu64\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let owner_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let spender_address = deps.api.canonical_address(\u0026spender)?;\n\n    let mut allowance = read_allowance(\u0026deps.storage, \u0026owner_address, \u0026spender_address)?;\n    allowance.amount = allowance.amount.saturating_sub(amount.u128());\n    if expiration.is_some() {\n        allowance.expiration = expiration;\n    }\n    let new_amount = allowance.amount;\n    write_allowance(\n        \u0026mut deps.storage,\n        \u0026owner_address,\n        \u0026spender_address,\n        allowance,\n    )?;\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::DecreaseAllowance {\n            owner: env.message.sender,\n            spender,\n            allowance: Uint128(new_amount),\n        })?),\n    };\n    Ok(res)\n}\n\nfn add_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_add: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.add_minters(minters_to_add)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::AddMinters { status: Success })?),\n    })\n}\n\nfn remove_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_remove: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.remove_minters(minters_to_remove)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::RemoveMinters { status: Success })?),\n    })\n}\n\nfn set_minters\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    minters_to_set: Vec\u003cHumanAddr\u003e,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n\n    check_if_admin(\u0026config, \u0026env.message.sender)?;\n\n    config.set_minters(minters_to_set)?;\n\n    Ok(HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::SetMinters { status: Success })?),\n    })\n}\n\n/// Burn tokens\n///\n/// Remove `amount` tokens from the system irreversibly, from signer account\n///\n/// @param amount the amount of money to burn\nfn try_burn\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address = deps.api.canonical_address(\u0026env.message.sender)?;\n    let amount = amount.u128();\n\n    let mut balances = Balances::from_storage(\u0026mut deps.storage);\n    let mut account_balance = balances.balance(\u0026sender_address);\n\n    if let Some(new_account_balance) = account_balance.checked_sub(amount) {\n        account_balance = new_account_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds to burn: balance={}, required={}\",\n            account_balance, amount\n        )));\n    }\n\n    balances.set_account_balance(\u0026sender_address, account_balance);\n\n    let mut config = Config::from_storage(\u0026mut deps.storage);\n    let mut total_supply = config.total_supply();\n    if let Some(new_total_supply) = total_supply.checked_sub(amount) {\n        total_supply = new_total_supply;\n    } else {\n        return Err(StdError::generic_err(\n            \"You're trying to burn more than is available in the total supply\",\n        ));\n    }\n    config.set_total_supply(total_supply);\n\n    let res = HandleResponse {\n        messages: vec![],\n        log: vec![],\n        data: Some(to_binary(\u0026HandleAnswer::Burn { status: Success })?),\n    };\n\n    Ok(res)\n}\n\nfn perform_transfer\u003cT: Storage\u003e(\n    store: \u0026mut T,\n    from: \u0026CanonicalAddr,\n    to: \u0026CanonicalAddr,\n    amount: u128,\n) -\u003e StdResult\u003c()\u003e {\n    let mut balances = Balances::from_storage(store);\n\n    let mut from_balance = balances.balance(from);\n    if let Some(new_from_balance) = from_balance.checked_sub(amount) {\n        from_balance = new_from_balance;\n    } else {\n        return Err(StdError::generic_err(format!(\n            \"insufficient funds: balance={}, required={}\",\n            from_balance, amount\n        )));\n    }\n    balances.set_account_balance(from, from_balance);\n\n    let mut to_balance = balances.balance(to);\n    to_balance = to_balance.checked_add(amount).ok_or_else(|| {\n        StdError::generic_err(\"This tx will literally make them too rich. Try transferring less\")\n    })?;\n    balances.set_account_balance(to, to_balance);\n\n    Ok(())\n}\n\nfn is_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003cbool\u003e {\n    let consts = config.constants()?;\n    if \u0026consts.admin != account {\n        return Ok(false);\n    }\n\n    Ok(true)\n}\n\nfn check_if_admin\u003cS: Storage\u003e(config: \u0026Config\u003cS\u003e, account: \u0026HumanAddr) -\u003e StdResult\u003c()\u003e {\n    if !is_admin(config, account)? {\n        return Err(StdError::generic_err(\n            \"This is an admin command. Admin commands can only be run from admin address\",\n        ));\n    }\n\n    Ok(())\n}\n\nfn is_valid_name(name: \u0026str) -\u003e bool {\n    let len = name.len();\n    3 \u003c= len \u0026\u0026 len \u003c= 30\n}\n\nfn is_valid_symbol(symbol: \u0026str) -\u003e bool {\n    let len = symbol.len();\n    let len_is_valid = 3 \u003c= len \u0026\u0026 len \u003c= 6;\n\n    len_is_valid \u0026\u0026 symbol.bytes().all(|byte| b'A' \u003c= byte \u0026\u0026 byte \u003c= b'Z')\n}\n\n// pub fn migrate\u003cS: Storage, A: Api, Q: Querier\u003e(\n//     _deps: \u0026mut Extern\u003cS, A, Q\u003e,\n//     _env: Env,\n//     _msg: MigrateMsg,\n// ) -\u003e StdResult\u003cMigrateResponse\u003e {\n//     Ok(MigrateResponse::default())\n// }\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use crate::msg::ResponseStatus;\n    use crate::msg::{InitConfig, InitialBalance};\n    use cosmwasm_std::testing::*;\n    use cosmwasm_std::{from_binary, BlockInfo, ContractInfo, MessageInfo, QueryResponse, WasmMsg};\n    use std::any::Any;\n\n    // Helper functions\n\n    fn init_helper(\n        initial_balances: Vec\u003cInitialBalance\u003e,\n    ) -\u003e (\n        StdResult\u003cInitResponse\u003e,\n        Extern\u003cMockStorage, MockApi, MockQuerier\u003e,\n    ) {\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n\n        let init_msg = InitMsg {\n            name: \"sec-sec\".to_string(),\n            admin: Some(HumanAddr(\"admin\".to_string())),\n            symbol: \"SECSEC\".to_string(),\n            decimals: 8,\n            initial_balances: Some(initial_balances),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: None,\n        };\n\n        (init(\u0026mut deps, env, init_msg), deps)\n    }\n\n    // Never used. Only triggers a persistent compile-time warning.\n    ///// Will return a ViewingKey only for the first account in `initial_balances`\n    //fn auth_query_helper(\n        //initial_balances: Vec\u003cInitialBalance\u003e,\n    //) -\u003e (ViewingKey, Extern\u003cMockStorage, MockApi, MockQuerier\u003e) {\n        //let (init_result, mut deps) = init_helper(initial_balances.clone());\n        //assert!(\n            //init_result.is_ok(),\n            //\"Init failed: {}\",\n            //init_result.err().unwrap()\n        //);\n\n        //let account = initial_balances[0].address.clone();\n        //let create_vk_msg = HandleMsg::CreateViewingKey {\n            //entropy: \"42\".to_string(),\n            //padding: None,\n        //};\n        //let handle_response = handle(\u0026mut deps, mock_env(account.0, \u0026[]), create_vk_msg).unwrap();\n        //let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            //HandleAnswer::CreateViewingKey { key } =\u003e key,\n            //_ =\u003e panic!(\"Unexpected result from handle\"),\n        //};\n\n        //(vk, deps)\n    //}\n\n    fn extract_error_msg\u003cT: Any\u003e(error: StdResult\u003cT\u003e) -\u003e String {\n        match error {\n            Ok(response) =\u003e {\n                let bin_err = (\u0026response as \u0026dyn Any)\n                    .downcast_ref::\u003cQueryResponse\u003e()\n                    .expect(\"An error was expected, but no error could be extracted\");\n                match from_binary(bin_err).unwrap() {\n                    QueryAnswer::ViewingKeyError { msg } =\u003e msg,\n                    _ =\u003e panic!(\"Unexpected query answer\"),\n                }\n            }\n            Err(err) =\u003e match err {\n                StdError::GenericErr { msg, .. } =\u003e msg,\n                _ =\u003e panic!(\"Unexpected result from init\"),\n            },\n        }\n    }\n\n    fn ensure_success(handle_result: HandleResponse) -\u003e bool {\n        let handle_result: HandleAnswer = from_binary(\u0026handle_result.data.unwrap()).unwrap();\n\n        match handle_result {\n            HandleAnswer::Deposit { status }\n            | HandleAnswer::Redeem { status }\n            | HandleAnswer::Transfer { status }\n            | HandleAnswer::Send { status }\n            | HandleAnswer::Burn { status }\n            | HandleAnswer::RegisterReceive { status }\n            | HandleAnswer::SetViewingKey { status }\n            | HandleAnswer::TransferFrom { status }\n            | HandleAnswer::SendFrom { status }\n            | HandleAnswer::BurnFrom { status }\n            | HandleAnswer::Mint { status }\n            | HandleAnswer::ChangeAdmin { status }\n            | HandleAnswer::SetContractStatus { status }\n            | HandleAnswer::SetMinters { status }\n            | HandleAnswer::AddMinters { status }\n            | HandleAnswer::RemoveMinters { status } =\u003e {\n                matches!(status, ResponseStatus::Success {..})\n            }\n            _ =\u003e panic!(\"HandleAnswer not supported for success extraction\"),\n        }\n    }\n\n    // Init tests\n\n    #[test]\n    fn test_init_sanity() {\n        let (init_result, deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert_eq!(init_result.unwrap(), InitResponse::default());\n\n        let config = ReadonlyConfig::from_storage(\u0026deps.storage);\n        let constants = config.constants().unwrap();\n        assert_eq!(config.total_supply(), 5000);\n        assert_eq!(config.contract_status(), ContractStatusLevel::NormalRun);\n        assert_eq!(constants.name, \"sec-sec\".to_string());\n        assert_eq!(constants.admin, HumanAddr(\"admin\".to_string()));\n        assert_eq!(constants.symbol, \"SECSEC\".to_string());\n        assert_eq!(constants.decimals, 8);\n        assert_eq!(\n            constants.prng_seed,\n            sha_256(\"lolz fun yay\".to_owned().as_bytes())\n        );\n        assert_eq!(constants.total_supply_is_public, false);\n    }\n\n    #[test]\n    fn test_total_supply_overflow() {\n        let (init_result, _deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(u128::max_value()),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let (init_result, _deps) = init_helper(vec![\n            InitialBalance {\n                address: HumanAddr(\"lebron\".to_string()),\n                amount: Uint128(u128::max_value()),\n            },\n            InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: Uint128(1),\n            },\n        ]);\n        let error = extract_error_msg(init_result);\n        assert_eq!(\n            error,\n            \"The sum of all initial balances exceeds the maximum possible total supply\"\n        );\n    }\n\n    // Handle tests\n\n    #[test]\n    fn test_handle_transfer() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        assert_eq!(5000 - 1000, balances.account_amount(\u0026bob_canonical));\n        assert_eq!(1000, balances.account_amount(\u0026alice_canonical));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(10000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient funds\"));\n    }\n\n    #[test]\n    fn test_handle_send() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let handle_msg = HandleMsg::Send {\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n            msg: Some(to_binary(\"hey hey you you\").unwrap()),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result.clone()));\n        assert!(result.messages.contains(\u0026CosmosMsg::Wasm(WasmMsg::Execute {\n            contract_addr: HumanAddr(\"contract\".to_string()),\n            callback_code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            msg: Snip20ReceiveMsg::new(\n                HumanAddr(\"bob\".to_string()),\n                HumanAddr(\"bob\".to_string()),\n                Uint128(100),\n                Some(to_binary(\"hey hey you you\").unwrap())\n            )\n            .into_binary()\n            .unwrap(),\n            send: vec![]\n        })));\n    }\n\n    #[test]\n    fn test_handle_register_receive() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"this_is_a_hash_of_a_code\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let hash = get_receiver_hash(\u0026deps.storage, \u0026HumanAddr(\"contract\".to_string()))\n            .unwrap()\n            .unwrap();\n        assert_eq!(hash, \"this_is_a_hash_of_a_code\".to_string());\n    }\n\n    #[test]\n    fn test_handle_create_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::CreateViewingKey {\n            entropy: \"\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let answer: HandleAnswer = from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n\n        let key = match answer {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"NOPE\"),\n        };\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(key.check_viewing_key(saved_vk.as_slice()));\n    }\n\n    #[test]\n    fn test_handle_set_viewing_key() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Set VK\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"hi lol\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        // Set valid VK\n        let actual_vk = ViewingKey(\"x\".to_string().repeat(VIEWING_KEY_SIZE));\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: actual_vk.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey { status: Success }).unwrap(),\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let saved_vk = read_viewing_key(\u0026deps.storage, \u0026bob_canonical).unwrap();\n        assert!(actual_vk.check_viewing_key(\u0026saved_vk));\n    }\n\n    #[test]\n    fn test_handle_transfer_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Transfer before allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: Some(1_571_797_420),\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Transfer after allowance expired\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\n            \u0026mut deps,\n            Env {\n                block: BlockInfo {\n                    height: 12_345,\n                    time: 1_571_797_420,\n                    chain_id: \"cosmos-testnet-14002\".to_string(),\n                },\n                message: MessageInfo {\n                    sender: HumanAddr(\"bob\".to_string()),\n                    sent_funds: vec![],\n                },\n                contract: ContractInfo {\n                    address: HumanAddr::from(MOCK_CONTRACT_ADDR),\n                },\n                contract_key: Some(\"\".to_string()),\n                contract_code_hash: \"\".to_string(),\n            },\n            handle_msg,\n        );\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let alice_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026alice_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(alice_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::TransferFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n\n    #[test]\n    fn test_handle_send_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Send before allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Send more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2500),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::RegisterReceive {\n            code_hash: \"lolz\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"contract\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let send_msg = Binary::from(r#\"{ \"some_msg\": { \"some_key\": \"some_val\" } }\"#.as_bytes());\n        let snip20_msg = Snip20ReceiveMsg::new(\n            HumanAddr(\"alice\".to_string()),\n            HumanAddr(\"bob\".to_string()),\n            Uint128(2000),\n            Some(send_msg.clone()),\n        );\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"contract\".to_string()),\n            amount: Uint128(2000),\n            msg: Some(send_msg),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        assert!(handle_result.unwrap().messages.contains(\n            \u0026snip20_msg\n                .into_cosmos_msg(\"lolz\".to_string(), HumanAddr(\"contract\".to_string()))\n                .unwrap()\n        ));\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let contract_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"contract\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        let contract_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026contract_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        assert_eq!(contract_balance, 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000);\n\n        // Second send more than allowance\n        let handle_msg = HandleMsg::SendFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1),\n            msg: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n\n    #[test]\n    fn test_handle_burn_from() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        // Burn before allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Burn more than allowance\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n\n        // Sanity check\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let bob_balance = crate::state::ReadonlyBalances::from_storage(\u0026deps.storage)\n            .account_amount(\u0026bob_canonical);\n        assert_eq!(bob_balance, 5000 - 2000);\n        let total_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(total_supply, 5000 - 2000);\n\n        // Second burn more than allowance\n        let handle_msg = HandleMsg::BurnFrom {\n            owner: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(1),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"alice\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"insufficient allowance\"));\n    }\n\n    #[test]\n    fn test_handle_decrease_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 0,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::DecreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(50),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 1950,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_increase_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let bob_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"bob\".to_string()))\n            .unwrap();\n        let alice_canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"alice\".to_string()))\n            .unwrap();\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 2000,\n                expiration: None\n            }\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let allowance = read_allowance(\u0026deps.storage, \u0026bob_canonical, \u0026alice_canonical).unwrap();\n        assert_eq!(\n            allowance,\n            crate::state::Allowance {\n                amount: 4000,\n                expiration: None\n            }\n        );\n    }\n\n    #[test]\n    fn test_handle_change_admin() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"bob\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let admin = ReadonlyConfig::from_storage(\u0026deps.storage)\n            .constants()\n            .unwrap()\n            .admin;\n        assert_eq!(admin, HumanAddr(\"bob\".to_string()));\n    }\n\n    #[test]\n    fn test_handle_set_contract_status() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"admin\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let contract_status = ReadonlyConfig::from_storage(\u0026deps.storage).contract_status();\n        assert!(matches!(contract_status, ContractStatusLevel::StopAll{..}));\n    }\n\n    #[test]\n    fn test_handle_redeem() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"butler\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Redeem {\n            amount: Uint128(1000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"butler\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"butler\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 4000)\n    }\n\n    #[test]\n    fn test_handle_deposit() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::Deposit { padding: None };\n        let handle_result = handle(\n            \u0026mut deps,\n            mock_env(\n                \"lebron\",\n                \u0026[Coin {\n                    denom: \"uscrt\".to_string(),\n                    amount: Uint128(1000),\n                }],\n            ),\n            handle_msg,\n        );\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let balances = ReadonlyBalances::from_storage(\u0026deps.storage);\n        let canonical = deps\n            .api\n            .canonical_address(\u0026HumanAddr(\"lebron\".to_string()))\n            .unwrap();\n        assert_eq!(balances.account_amount(\u0026canonical), 6000)\n    }\n\n    #[test]\n    fn test_handle_burn() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let burn_amount: u128 = 100;\n        let handle_msg = HandleMsg::Burn {\n            amount: Uint128(burn_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply - burn_amount);\n    }\n\n    #[test]\n    fn test_handle_mint() {\n        let initial_amount: u128 = 5000;\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(initial_amount),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        let mint_amount: u128 = 100;\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(mint_amount),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let new_supply = ReadonlyConfig::from_storage(\u0026deps.storage).total_supply();\n        assert_eq!(new_supply, supply + mint_amount);\n    }\n\n    #[test]\n    fn test_handle_admin_commands() {\n        let admin_err = \"Admin commands can only be run from admin address\".to_string();\n\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), pause_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let mint_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"not_admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), mint_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n\n        let change_admin_msg = HandleMsg::ChangeAdmin {\n            address: HumanAddr(\"not_admin\".to_string()),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"not_admin\", \u0026[]), change_admin_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\u0026admin_err.clone()));\n    }\n\n    #[test]\n    fn test_handle_pause_with_withdrawals() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAllButRedeems,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Withdraw failed: {}\",\n            handle_result.err().unwrap()\n        );\n    }\n\n    #[test]\n    fn test_handle_pause_all() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let pause_msg = HandleMsg::SetContractStatus {\n            level: ContractStatusLevel::StopAll,\n            padding: None,\n        };\n\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), pause_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"Pause handle failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let send_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"account\".to_string()),\n            amount: Uint128(123),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), send_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n\n        let withdraw_msg = HandleMsg::Redeem {\n            amount: Uint128(5000),\n            denom: None,\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), withdraw_msg);\n        let error = extract_error_msg(handle_result);\n        assert_eq!(\n            error,\n            \"This contract is stopped and this action is not allowed\".to_string()\n        );\n    }\n\n    #[test]\n    fn test_handle_set_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::SetMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    #[test]\n    fn test_handle_add_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::AddMinters {\n            minters: vec![HumanAddr(\"bob\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n    }\n\n    #[test]\n    fn test_handle_remove_minters() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"Admin commands can only be run from admin address\"));\n\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        // Removing another extra time to ensure nothing funky happens\n        let handle_msg = HandleMsg::RemoveMinters {\n            minters: vec![HumanAddr(\"admin\".to_string())],\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n\n        let handle_msg = HandleMsg::Mint {\n            recipient: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(100),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"admin\", \u0026[]), handle_msg);\n        let error = extract_error_msg(handle_result);\n        assert!(error.contains(\"allowed to minter accounts only\"));\n    }\n\n    // Query tests\n\n    #[test]\n    fn test_authenticated_queries() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let no_vk_yet_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"no_vk_yet\".to_string(),\n        };\n        let query_result = query(\u0026deps, no_vk_yet_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n\n        let create_vk_msg = HandleMsg::CreateViewingKey {\n            entropy: \"34\".to_string(),\n            padding: None,\n        };\n        let handle_response = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), create_vk_msg).unwrap();\n        let vk = match from_binary(\u0026handle_response.data.unwrap()).unwrap() {\n            HandleAnswer::CreateViewingKey { key } =\u003e key,\n            _ =\u003e panic!(\"Unexpected result from handle\"),\n        };\n\n        let query_balance_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: vk.0,\n        };\n\n        let query_response = query(\u0026deps, query_balance_msg).unwrap();\n        let balance = match from_binary(\u0026query_response).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected result from query\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n\n        let wrong_vk_query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"giannis\".to_string()),\n            key: \"wrong_vk\".to_string(),\n        };\n        let query_result = query(\u0026deps, wrong_vk_query_msg);\n        let error = extract_error_msg(query_result);\n        assert_eq!(\n            error,\n            \"Wrong viewing key for this address or viewing key not set\".to_string()\n        );\n    }\n\n    #[test]\n    fn test_query_token_info() {\n        let init_name = \"sec-sec\".to_string();\n        let init_admin = HumanAddr(\"admin\".to_string());\n        let init_symbol = \"SECSEC\".to_string();\n        let init_decimals = 8;\n        let init_config: InitConfig = from_binary(\u0026Binary::from(\n            r#\"{ \"public_total_supply\": true }\"#.as_bytes(),\n        ))\n        .unwrap();\n        let init_supply = Uint128(5000);\n\n        let mut deps = mock_dependencies(20, \u0026[]);\n        let env = mock_env(\"instantiator\", \u0026[]);\n        let init_msg = InitMsg {\n            name: init_name.clone(),\n            admin: Some(init_admin.clone()),\n            symbol: init_symbol.clone(),\n            decimals: init_decimals.clone(),\n            initial_balances: Some(vec![InitialBalance {\n                address: HumanAddr(\"giannis\".to_string()),\n                amount: init_supply,\n            }]),\n            prng_seed: Binary::from(\"lolz fun yay\".as_bytes()),\n            config: Some(init_config),\n        };\n        let init_result = init(\u0026mut deps, env, init_msg);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let query_msg = QueryMsg::TokenInfo {};\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Init failed: {}\",\n            query_result.err().unwrap()\n        );\n        let query_answer: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        match query_answer {\n            QueryAnswer::TokenInfo {\n                name,\n                symbol,\n                decimals,\n                total_supply,\n            } =\u003e {\n                assert_eq!(name, init_name);\n                assert_eq!(symbol, init_symbol);\n                assert_eq!(decimals, init_decimals);\n                assert_eq!(total_supply, Some(Uint128(5000)));\n            }\n            _ =\u003e panic!(\"unexpected\"),\n        }\n    }\n\n    #[test]\n    fn test_query_allowance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"giannis\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::IncreaseAllowance {\n            spender: HumanAddr(\"lebron\".to_string()),\n            amount: Uint128(2000),\n            padding: None,\n            expiration: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        assert!(\n            handle_result.is_ok(),\n            \"handle() failed: {}\",\n            handle_result.err().unwrap()\n        );\n\n        let vk1 = ViewingKey(\"key1\".to_string());\n        let vk2 = ViewingKey(\"key2\".to_string());\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        assert!(\n            query_result.is_ok(),\n            \"Query failed: {}\",\n            query_result.err().unwrap()\n        );\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk1.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"lebron\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: vk2.0.clone(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"giannis\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk1.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"giannis\".to_string()),\n            spender: HumanAddr(\"lebron\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(2000));\n\n        let query_msg = QueryMsg::Allowance {\n            owner: HumanAddr(\"lebron\".to_string()),\n            spender: HumanAddr(\"giannis\".to_string()),\n            key: vk2.0.clone(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let allowance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Allowance { allowance, .. } =\u003e allowance,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(allowance, Uint128(0));\n    }\n\n    #[test]\n    fn test_query_balance() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let unwrapped_result: HandleAnswer =\n            from_binary(\u0026handle_result.unwrap().data.unwrap()).unwrap();\n        assert_eq!(\n            to_binary(\u0026unwrapped_result).unwrap(),\n            to_binary(\u0026HandleAnswer::SetViewingKey {\n                status: ResponseStatus::Success\n            })\n            .unwrap(),\n        );\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"wrong_key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let error = extract_error_msg(query_result);\n        assert!(error.contains(\"Wrong viewing key\"));\n\n        let query_msg = QueryMsg::Balance {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let balance = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::Balance { amount } =\u003e amount,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(balance, Uint128(5000));\n    }\n\n    #[test]\n    fn test_query_transfer_history() {\n        let (init_result, mut deps) = init_helper(vec![InitialBalance {\n            address: HumanAddr(\"bob\".to_string()),\n            amount: Uint128(5000),\n        }]);\n        assert!(\n            init_result.is_ok(),\n            \"Init failed: {}\",\n            init_result.err().unwrap()\n        );\n\n        let handle_msg = HandleMsg::SetViewingKey {\n            key: \"key\".to_string(),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        assert!(ensure_success(handle_result.unwrap()));\n\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"alice\".to_string()),\n            amount: Uint128(1000),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"banana\".to_string()),\n            amount: Uint128(500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n        let handle_msg = HandleMsg::Transfer {\n            recipient: HumanAddr(\"mango\".to_string()),\n            amount: Uint128(2500),\n            padding: None,\n        };\n        let handle_result = handle(\u0026mut deps, mock_env(\"bob\", \u0026[]), handle_msg);\n        let result = handle_result.unwrap();\n        assert!(ensure_success(result));\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 0,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        // let a: QueryAnswer = from_binary(\u0026query_result.unwrap()).unwrap();\n        // println!(\"{:?}\", a);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert!(transfers.is_empty());\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 10,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 3);\n\n        let query_msg = QueryMsg::TransferHistory {\n            address: HumanAddr(\"bob\".to_string()),\n            key: \"key\".to_string(),\n            page: None,\n            page_size: 2,\n        };\n        let query_result = query(\u0026deps, query_msg);\n        let transfers = match from_binary(\u0026query_result.unwrap()).unwrap() {\n            QueryAnswer::TransferHistory { txs } =\u003e txs,\n            _ =\u003e panic!(\"Unexpected\"),\n        };\n        assert_eq!(transfers.len(), 2);\n    }\n}\n","traces":[{"line":25,"address":[6268312,6263760],"length":1,"stats":{"Line":6},"fn_name":"init\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":30,"address":[6263829],"length":1,"stats":{"Line":2},"fn_name":null},{"line":31,"address":[6263963],"length":1,"stats":{"Line":6},"fn_name":null},{"line":33,"address":[6263995],"length":1,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[6264051],"length":1,"stats":{"Line":6},"fn_name":null},{"line":35,"address":[6265579,6264388,6264352,6264201,6264106],"length":1,"stats":{"Line":12},"fn_name":null},{"line":36,"address":[6264690,6265031,6264596,6264822],"length":1,"stats":{"Line":8},"fn_name":null},{"line":37,"address":[6264773,6265089],"length":1,"stats":{"Line":8},"fn_name":null},{"line":38,"address":[6265121],"length":1,"stats":{"Line":6},"fn_name":null},{"line":39,"address":[6265182],"length":1,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[6265321],"length":1,"stats":{"Line":6},"fn_name":null},{"line":42,"address":[6265359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":50,"address":[6265640],"length":1,"stats":{"Line":6},"fn_name":null},{"line":51,"address":[6265731],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[6265704,6265822],"length":1,"stats":{"Line":8},"fn_name":null},{"line":56,"address":[6265865],"length":1,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[6265853],"length":1,"stats":{"Line":6},"fn_name":null},{"line":61,"address":[6266057],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[6268377,6268352,6266146,6265962],"length":1,"stats":{"Line":8},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":66,"address":[6266154],"length":1,"stats":{"Line":2},"fn_name":null},{"line":68,"address":[6266267],"length":1,"stats":{"Line":6},"fn_name":null},{"line":69,"address":[6266780,6266848,6266515,6267076],"length":1,"stats":{"Line":4},"fn_name":null},{"line":70,"address":[6266282],"length":1,"stats":{"Line":2},"fn_name":null},{"line":71,"address":[6266313],"length":1,"stats":{"Line":6},"fn_name":null},{"line":72,"address":[6266345],"length":1,"stats":{"Line":2},"fn_name":null},{"line":73,"address":[6266368],"length":1,"stats":{"Line":6},"fn_name":null},{"line":74,"address":[6266375],"length":1,"stats":{"Line":2},"fn_name":null},{"line":75,"address":[6266456],"length":1,"stats":{"Line":6},"fn_name":null},{"line":77,"address":[6267168],"length":1,"stats":{"Line":6},"fn_name":null},{"line":78,"address":[6267199],"length":1,"stats":{"Line":2},"fn_name":null},{"line":79,"address":[6267230,6267431,6267643],"length":1,"stats":{"Line":6},"fn_name":null},{"line":81,"address":[6267413,6268067],"length":1,"stats":{"Line":8},"fn_name":null},{"line":84,"address":[3724640],"length":1,"stats":{"Line":1},"fn_name":"pad_response"},{"line":85,"address":[1288112,1288267,1288279],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}"},{"line":86,"address":[6268758,6268656,6268802,6268770],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}"},{"line":87,"address":[1288003],"length":1,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[1288034],"length":1,"stats":{"Line":2},"fn_name":null},{"line":90,"address":[1288205],"length":1,"stats":{"Line":2},"fn_name":null},{"line":94,"address":[6278011,6268960],"length":1,"stats":{"Line":1},"fn_name":"handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":99,"address":[6269469,6269024],"length":1,"stats":{"Line":3},"fn_name":null},{"line":101,"address":[6269545],"length":1,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[6269528],"length":1,"stats":{"Line":4},"fn_name":null},{"line":103,"address":[6270158],"length":1,"stats":{"Line":2},"fn_name":null},{"line":104,"address":[6269598,6269736],"length":1,"stats":{"Line":2},"fn_name":null},{"line":105,"address":[6269986,6269674],"length":1,"stats":{"Line":3},"fn_name":null},{"line":106,"address":[6269686,6269961],"length":1,"stats":{"Line":4},"fn_name":null},{"line":108,"address":[6270026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":110,"address":[6269632,6270116],"length":1,"stats":{"Line":4},"fn_name":null},{"line":114,"address":[6269840],"length":1,"stats":{"Line":2},"fn_name":null},{"line":119,"address":[6272369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":121,"address":[6276436,6269555,6272523],"length":1,"stats":{"Line":4},"fn_name":null},{"line":122,"address":[6272387,6276441],"length":1,"stats":{"Line":2},"fn_name":null},{"line":125,"address":[6272683,6276373],"length":1,"stats":{"Line":2},"fn_name":null},{"line":128,"address":[6272827],"length":1,"stats":{"Line":1},"fn_name":null},{"line":134,"address":[6276305,6273057],"length":1,"stats":{"Line":2},"fn_name":null},{"line":135,"address":[6276300,6273201],"length":1,"stats":{"Line":2},"fn_name":null},{"line":136,"address":[6276295,6273361],"length":1,"stats":{"Line":2},"fn_name":null},{"line":137,"address":[6273521,6276290],"length":1,"stats":{"Line":2},"fn_name":null},{"line":140,"address":[6273753],"length":1,"stats":{"Line":1},"fn_name":null},{"line":146,"address":[6274075,6276280],"length":1,"stats":{"Line":2},"fn_name":null},{"line":152,"address":[6274277],"length":1,"stats":{"Line":1},"fn_name":null},{"line":158,"address":[6274539],"length":1,"stats":{"Line":1},"fn_name":null},{"line":165,"address":[6274775,6275977],"length":1,"stats":{"Line":2},"fn_name":null},{"line":168,"address":[6275972,6275007],"length":1,"stats":{"Line":2},"fn_name":null},{"line":173,"address":[6275601,6275961],"length":1,"stats":{"Line":2},"fn_name":null},{"line":174,"address":[6275755],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[6275139,6275967],"length":1,"stats":{"Line":2},"fn_name":null},{"line":176,"address":[6275293,6275965],"length":1,"stats":{"Line":2},"fn_name":null},{"line":177,"address":[6275447,6275963],"length":1,"stats":{"Line":2},"fn_name":null},{"line":180,"address":[6275847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[6278048,6278318],"length":1,"stats":{"Line":1},"fn_name":"query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":185,"address":[6278228,6278316,6278083],"length":1,"stats":{"Line":3},"fn_name":null},{"line":186,"address":[6278240,6278314],"length":1,"stats":{"Line":0},"fn_name":null},{"line":187,"address":[6278312,6278257],"length":1,"stats":{"Line":0},"fn_name":null},{"line":188,"address":[6278264,6278154],"length":1,"stats":{"Line":2},"fn_name":null},{"line":192,"address":[6281375,6278384],"length":1,"stats":{"Line":1},"fn_name":"authenticated_queries\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":196,"address":[6278422],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[6278849,6278937,6278735,6278589,6280591,6278957],"length":1,"stats":{"Line":5},"fn_name":null},{"line":199,"address":[6279372,6278989,6279159],"length":1,"stats":{"Line":1},"fn_name":null},{"line":201,"address":[6279417,6279123],"length":1,"stats":{"Line":2},"fn_name":null},{"line":203,"address":[6279789,6279632,6279491,6279433],"length":1,"stats":{"Line":4},"fn_name":null},{"line":206,"address":[6279605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[6279653,6279535],"length":1,"stats":{"Line":2},"fn_name":null},{"line":210,"address":[6280060,6280337,6279799],"length":1,"stats":{"Line":3},"fn_name":null},{"line":212,"address":[6280120],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[6280152],"length":1,"stats":{"Line":1},"fn_name":null},{"line":214,"address":[6280172],"length":1,"stats":{"Line":1},"fn_name":null},{"line":216,"address":[6280186],"length":1,"stats":{"Line":1},"fn_name":null},{"line":217,"address":[6279891],"length":1,"stats":{"Line":1},"fn_name":null},{"line":218,"address":[6280397,6279955],"length":1,"stats":{"Line":2},"fn_name":null},{"line":220,"address":[6279848],"length":1,"stats":{"Line":0},"fn_name":null},{"line":225,"address":[6280623,6280720,6280802,6281119],"length":1,"stats":{"Line":2},"fn_name":null},{"line":226,"address":[6280596],"length":1,"stats":{"Line":1},"fn_name":null},{"line":232,"address":[3724878,3724704],"length":1,"stats":{"Line":0},"fn_name":"query_exchange_rate"},{"line":233,"address":[3724769],"length":1,"stats":{"Line":0},"fn_name":null},{"line":234,"address":[3724721],"length":1,"stats":{"Line":0},"fn_name":null},{"line":235,"address":[3724739],"length":1,"stats":{"Line":0},"fn_name":null},{"line":239,"address":[6281856,6282484],"length":1,"stats":{"Line":1},"fn_name":"query_token_info\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":240,"address":[6281881],"length":1,"stats":{"Line":1},"fn_name":null},{"line":241,"address":[6282067,6282290,6281971,6281904],"length":1,"stats":{"Line":2},"fn_name":null},{"line":243,"address":[6282043,6282342,6282445],"length":1,"stats":{"Line":2},"fn_name":null},{"line":244,"address":[6282352],"length":1,"stats":{"Line":1},"fn_name":null},{"line":246,"address":[6282330],"length":1,"stats":{"Line":0},"fn_name":null},{"line":249,"address":[6282591],"length":1,"stats":{"Line":1},"fn_name":null},{"line":250,"address":[6282504],"length":1,"stats":{"Line":1},"fn_name":null},{"line":251,"address":[6282530],"length":1,"stats":{"Line":1},"fn_name":null},{"line":252,"address":[6282559],"length":1,"stats":{"Line":1},"fn_name":null},{"line":253,"address":[6282567],"length":1,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[6283756,6283771,6282944],"length":1,"stats":{"Line":1},"fn_name":"query_transactions\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":263,"address":[6283006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":264,"address":[6283588,6283154,6283356,6283066],"length":1,"stats":{"Line":2},"fn_name":null},{"line":266,"address":[6283253],"length":1,"stats":{"Line":1},"fn_name":null},{"line":267,"address":[6283341],"length":1,"stats":{"Line":1},"fn_name":null},{"line":270,"address":[6284308,6284323,6283776],"length":1,"stats":{"Line":1},"fn_name":"query_balance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":274,"address":[6283938,6283814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":276,"address":[6284038,6284109,6283931],"length":1,"stats":{"Line":3},"fn_name":null},{"line":277,"address":[6284182],"length":1,"stats":{"Line":1},"fn_name":null},{"line":278,"address":[6284230],"length":1,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[6284449,6284336],"length":1,"stats":{"Line":0},"fn_name":"query_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":282,"address":[6284360],"length":1,"stats":{"Line":0},"fn_name":null},{"line":284,"address":[6284468],"length":1,"stats":{"Line":0},"fn_name":null},{"line":285,"address":[6284538],"length":1,"stats":{"Line":0},"fn_name":null},{"line":288,"address":[6287292,6287277,6284672],"length":1,"stats":{"Line":1},"fn_name":"change_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":293,"address":[6284709],"length":1,"stats":{"Line":1},"fn_name":null},{"line":295,"address":[6284861,6284742,6284912,6284820,6285109],"length":1,"stats":{"Line":4},"fn_name":null},{"line":297,"address":[6285694,6285167,6285482,6284897],"length":1,"stats":{"Line":2},"fn_name":null},{"line":298,"address":[6285721,6285781,6285424],"length":1,"stats":{"Line":2},"fn_name":null},{"line":299,"address":[6286190,6285887,6285774,6285965],"length":1,"stats":{"Line":2},"fn_name":null},{"line":301,"address":[6286537],"length":1,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[6285950],"length":1,"stats":{"Line":1},"fn_name":null},{"line":303,"address":[6286244],"length":1,"stats":{"Line":1},"fn_name":null},{"line":304,"address":[6286434,6286723,6286251,6286373,6286329],"length":1,"stats":{"Line":3},"fn_name":null},{"line":308,"address":[6290088,6290103,6287296],"length":1,"stats":{"Line":1},"fn_name":"try_mint\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":314,"address":[6287378],"length":1,"stats":{"Line":1},"fn_name":null},{"line":316,"address":[6287401],"length":1,"stats":{"Line":1},"fn_name":null},{"line":317,"address":[6287599,6287457,6287541],"length":1,"stats":{"Line":3},"fn_name":null},{"line":318,"address":[6287640],"length":1,"stats":{"Line":1},"fn_name":null},{"line":323,"address":[6287744,6287605],"length":1,"stats":{"Line":2},"fn_name":null},{"line":325,"address":[6287768],"length":1,"stats":{"Line":1},"fn_name":null},{"line":326,"address":[6287827],"length":1,"stats":{"Line":1},"fn_name":null},{"line":327,"address":[6287966],"length":1,"stats":{"Line":1},"fn_name":null},{"line":329,"address":[6288013],"length":1,"stats":{"Line":0},"fn_name":null},{"line":333,"address":[6287982],"length":1,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[6288289,6288110,6288501],"length":1,"stats":{"Line":1},"fn_name":null},{"line":337,"address":[6288271],"length":1,"stats":{"Line":1},"fn_name":null},{"line":339,"address":[6288544,6288628],"length":1,"stats":{"Line":2},"fn_name":null},{"line":341,"address":[6288644,6288754],"length":1,"stats":{"Line":2},"fn_name":null},{"line":342,"address":[6288821],"length":1,"stats":{"Line":1},"fn_name":null},{"line":348,"address":[6288876],"length":1,"stats":{"Line":0},"fn_name":null},{"line":353,"address":[6288837],"length":1,"stats":{"Line":1},"fn_name":null},{"line":356,"address":[6288978],"length":1,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[6288993],"length":1,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[6289160,6289535,6289000,6289078,6289122],"length":1,"stats":{"Line":3},"fn_name":null},{"line":361,"address":[6289362],"length":1,"stats":{"Line":1},"fn_name":null},{"line":364,"address":[6291703,6291688,6290112],"length":1,"stats":{"Line":1},"fn_name":"try_set_key\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":369,"address":[6290146],"length":1,"stats":{"Line":1},"fn_name":null},{"line":371,"address":[6290183,6290377,6290270,6290596],"length":1,"stats":{"Line":2},"fn_name":null},{"line":372,"address":[6290362],"length":1,"stats":{"Line":1},"fn_name":null},{"line":374,"address":[6291024],"length":1,"stats":{"Line":1},"fn_name":null},{"line":375,"address":[6290683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":376,"address":[6290736],"length":1,"stats":{"Line":1},"fn_name":null},{"line":377,"address":[6290818,6291211,6290862,6290743,6290921],"length":1,"stats":{"Line":3},"fn_name":null},{"line":381,"address":[6295007,6295022,6291712],"length":1,"stats":{"Line":1},"fn_name":"try_create_key\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":386,"address":[6291755,6291855],"length":1,"stats":{"Line":2},"fn_name":null},{"line":387,"address":[6292432],"length":1,"stats":{"Line":1},"fn_name":null},{"line":389,"address":[6292664,6292472,6292570],"length":1,"stats":{"Line":3},"fn_name":null},{"line":391,"address":[6292681,6292890,6292771,6293112],"length":1,"stats":{"Line":2},"fn_name":null},{"line":392,"address":[6292875],"length":1,"stats":{"Line":2},"fn_name":null},{"line":394,"address":[6293865],"length":1,"stats":{"Line":1},"fn_name":null},{"line":395,"address":[6293320],"length":1,"stats":{"Line":2},"fn_name":null},{"line":396,"address":[6293376],"length":1,"stats":{"Line":2},"fn_name":null},{"line":397,"address":[6293598,6293642,6293383,6293762,6294055],"length":1,"stats":{"Line":6},"fn_name":null},{"line":401,"address":[6296397,6295024,6296412],"length":1,"stats":{"Line":1},"fn_name":"set_contract_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":406,"address":[6295072],"length":1,"stats":{"Line":1},"fn_name":null},{"line":408,"address":[6295157,6295248,6295198,6295083,6295455],"length":1,"stats":{"Line":6},"fn_name":null},{"line":410,"address":[6295225],"length":1,"stats":{"Line":2},"fn_name":null},{"line":412,"address":[6295800],"length":1,"stats":{"Line":2},"fn_name":null},{"line":413,"address":[6295505],"length":1,"stats":{"Line":1},"fn_name":null},{"line":414,"address":[6295520],"length":1,"stats":{"Line":2},"fn_name":null},{"line":415,"address":[6295605,6296183,6295527,6295697],"length":1,"stats":{"Line":4},"fn_name":null},{"line":421,"address":[6296416,6298226],"length":1,"stats":{"Line":1},"fn_name":"try_check_allowance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":426,"address":[6296885,6296456,6296572,6296681],"length":1,"stats":{"Line":2},"fn_name":null},{"line":427,"address":[6296947,6296650,6296992,6297116,6297329],"length":1,"stats":{"Line":3},"fn_name":null},{"line":429,"address":[6297793,6298026,6297391,6297101,6297439],"length":1,"stats":{"Line":3},"fn_name":null},{"line":434,"address":[6297602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":435,"address":[6297634],"length":1,"stats":{"Line":1},"fn_name":null},{"line":437,"address":[6297778],"length":1,"stats":{"Line":1},"fn_name":null},{"line":440,"address":[6301039,6301054,6298256],"length":1,"stats":{"Line":1},"fn_name":"try_deposit\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":444,"address":[6298303],"length":1,"stats":{"Line":1},"fn_name":null},{"line":446,"address":[6298689,6298585,6298470,6298376],"length":1,"stats":{"Line":4},"fn_name":null},{"line":447,"address":[6298622],"length":1,"stats":{"Line":1},"fn_name":null},{"line":448,"address":[6298665],"length":1,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[6298557,6298701],"length":1,"stats":{"Line":2},"fn_name":null},{"line":453,"address":[6298742],"length":1,"stats":{"Line":0},"fn_name":null},{"line":456,"address":[6298863,6298707],"length":1,"stats":{"Line":2},"fn_name":null},{"line":458,"address":[6299258,6299046,6298879],"length":1,"stats":{"Line":1},"fn_name":null},{"line":460,"address":[6299028],"length":1,"stats":{"Line":1},"fn_name":null},{"line":461,"address":[6299301,6299385],"length":1,"stats":{"Line":2},"fn_name":null},{"line":462,"address":[6299401,6299497],"length":1,"stats":{"Line":2},"fn_name":null},{"line":463,"address":[6299580],"length":1,"stats":{"Line":1},"fn_name":null},{"line":465,"address":[6299587],"length":1,"stats":{"Line":0},"fn_name":null},{"line":470,"address":[6299697],"length":1,"stats":{"Line":1},"fn_name":null},{"line":471,"address":[6299712],"length":1,"stats":{"Line":1},"fn_name":null},{"line":472,"address":[6299771,6299867],"length":1,"stats":{"Line":2},"fn_name":null},{"line":473,"address":[6299942],"length":1,"stats":{"Line":1},"fn_name":null},{"line":475,"address":[6299949],"length":1,"stats":{"Line":0},"fn_name":null},{"line":481,"address":[6300051],"length":1,"stats":{"Line":1},"fn_name":null},{"line":482,"address":[6300066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":483,"address":[6300608,6300233,6300195,6300073,6300151],"length":1,"stats":{"Line":3},"fn_name":null},{"line":486,"address":[6300435],"length":1,"stats":{"Line":1},"fn_name":null},{"line":489,"address":[6304802,6301056],"length":1,"stats":{"Line":1},"fn_name":"try_redeem\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":494,"address":[6301586,6301119,6301242,6301377],"length":1,"stats":{"Line":2},"fn_name":null},{"line":495,"address":[6301659,6301325],"length":1,"stats":{"Line":2},"fn_name":null},{"line":497,"address":[6301683],"length":1,"stats":{"Line":1},"fn_name":null},{"line":498,"address":[6301747],"length":1,"stats":{"Line":1},"fn_name":null},{"line":500,"address":[6301808,6301948],"length":1,"stats":{"Line":2},"fn_name":null},{"line":501,"address":[6302031],"length":1,"stats":{"Line":1},"fn_name":null},{"line":503,"address":[6302049],"length":1,"stats":{"Line":0},"fn_name":null},{"line":509,"address":[6302459],"length":1,"stats":{"Line":1},"fn_name":null},{"line":510,"address":[6302474],"length":1,"stats":{"Line":1},"fn_name":null},{"line":511,"address":[6302635,6302523],"length":1,"stats":{"Line":2},"fn_name":null},{"line":512,"address":[6302710],"length":1,"stats":{"Line":1},"fn_name":null},{"line":514,"address":[6302717],"length":1,"stats":{"Line":0},"fn_name":null},{"line":519,"address":[6302821,6302880],"length":1,"stats":{"Line":2},"fn_name":null},{"line":520,"address":[6302837],"length":1,"stats":{"Line":1},"fn_name":null},{"line":521,"address":[6302864],"length":1,"stats":{"Line":1},"fn_name":null},{"line":525,"address":[6303054,6303170],"length":1,"stats":{"Line":2},"fn_name":null},{"line":530,"address":[6303481],"length":1,"stats":{"Line":1},"fn_name":null},{"line":531,"address":[6303648,6303488,6303566,6303610,6304023],"length":1,"stats":{"Line":3},"fn_name":null},{"line":534,"address":[6303850],"length":1,"stats":{"Line":1},"fn_name":null},{"line":537,"address":[6308018,6305232,6308003],"length":1,"stats":{"Line":1},"fn_name":"try_transfer_impl\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":543,"address":[6305290,6305386,6305713,6305504],"length":1,"stats":{"Line":2},"fn_name":null},{"line":544,"address":[6305772,6305473,6305950,6306159,6305817],"length":1,"stats":{"Line":3},"fn_name":null},{"line":550,"address":[6305910],"length":1,"stats":{"Line":1},"fn_name":null},{"line":553,"address":[6307285,6306351,6306640],"length":1,"stats":{"Line":3},"fn_name":null},{"line":560,"address":[6307483],"length":1,"stats":{"Line":1},"fn_name":null},{"line":561,"address":[6307493],"length":1,"stats":{"Line":1},"fn_name":null},{"line":564,"address":[6307661],"length":1,"stats":{"Line":1},"fn_name":null},{"line":567,"address":[6308383,6308032],"length":1,"stats":{"Line":1},"fn_name":"try_transfer\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":573,"address":[6308227,6308112],"length":1,"stats":{"Line":2},"fn_name":null},{"line":576,"address":[6308212],"length":1,"stats":{"Line":1},"fn_name":null},{"line":577,"address":[6308317],"length":1,"stats":{"Line":1},"fn_name":null},{"line":578,"address":[6308858,6308414,6308493,6308458,6308324],"length":1,"stats":{"Line":3},"fn_name":null},{"line":580,"address":[6308783],"length":1,"stats":{"Line":1},"fn_name":null},{"line":583,"address":[6311787,6309184],"length":1,"stats":{"Line":1},"fn_name":"try_add_receiver_api_callback\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":592,"address":[6309304],"length":1,"stats":{"Line":1},"fn_name":null},{"line":593,"address":[6311577,6309706,6309412,6309488],"length":1,"stats":{"Line":3},"fn_name":null},{"line":594,"address":[6310044,6309583,6309759,6310253,6309806],"length":1,"stats":{"Line":2},"fn_name":null},{"line":595,"address":[6309904],"length":1,"stats":{"Line":1},"fn_name":null},{"line":596,"address":[6310528,6311375,6311155,6310320],"length":1,"stats":{"Line":2},"fn_name":null},{"line":598,"address":[6310996],"length":1,"stats":{"Line":1},"fn_name":null},{"line":600,"address":[6309713],"length":1,"stats":{"Line":2},"fn_name":null},{"line":603,"address":[6314235,6311840],"length":1,"stats":{"Line":1},"fn_name":"try_send\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":610,"address":[6311946],"length":1,"stats":{"Line":1},"fn_name":null},{"line":611,"address":[6312466,6312163,6312208,6312257,6312031],"length":1,"stats":{"Line":3},"fn_name":null},{"line":613,"address":[6312242],"length":1,"stats":{"Line":1},"fn_name":null},{"line":619,"address":[6312535],"length":1,"stats":{"Line":1},"fn_name":null},{"line":620,"address":[6312587],"length":1,"stats":{"Line":1},"fn_name":null},{"line":621,"address":[6312614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":627,"address":[6312912],"length":1,"stats":{"Line":1},"fn_name":null},{"line":628,"address":[6313182,6313723,6313342,6313260,6313304],"length":1,"stats":{"Line":3},"fn_name":null},{"line":630,"address":[6313632],"length":1,"stats":{"Line":1},"fn_name":null},{"line":633,"address":[6314272,6315438],"length":1,"stats":{"Line":1},"fn_name":"try_register_receive\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":638,"address":[6314321],"length":1,"stats":{"Line":1},"fn_name":null},{"line":640,"address":[6314362],"length":1,"stats":{"Line":1},"fn_name":null},{"line":641,"address":[6314416],"length":1,"stats":{"Line":1},"fn_name":null},{"line":642,"address":[6314598,6315288,6314740],"length":1,"stats":{"Line":1},"fn_name":null},{"line":646,"address":[6315006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":649,"address":[3724912],"length":1,"stats":{"Line":1},"fn_name":"insufficient_allowance"},{"line":650,"address":[3724949],"length":1,"stats":{"Line":1},"fn_name":null},{"line":656,"address":[6315472,6320365,6320350],"length":1,"stats":{"Line":1},"fn_name":"try_transfer_from_impl\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":663,"address":[6315566,6315662,6315786,6315995],"length":1,"stats":{"Line":2},"fn_name":null},{"line":664,"address":[6316435,6315755,6316226,6316102,6316054],"length":1,"stats":{"Line":3},"fn_name":null},{"line":665,"address":[6316674,6316548,6316195,6316883,6316500],"length":1,"stats":{"Line":3},"fn_name":null},{"line":666,"address":[6316631,6316947],"length":1,"stats":{"Line":2},"fn_name":null},{"line":668,"address":[6317199,6316987,6317408,6317051],"length":1,"stats":{"Line":2},"fn_name":null},{"line":670,"address":[6320381,6320368,6317461,6317146],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":671,"address":[6317585],"length":1,"stats":{"Line":0},"fn_name":null},{"line":676,"address":[6317609],"length":1,"stats":{"Line":0},"fn_name":null},{"line":678,"address":[6318011,6317749],"length":1,"stats":{"Line":0},"fn_name":null},{"line":681,"address":[6317520,6318049],"length":1,"stats":{"Line":2},"fn_name":null},{"line":682,"address":[6318121],"length":1,"stats":{"Line":1},"fn_name":null},{"line":684,"address":[6318218],"length":1,"stats":{"Line":1},"fn_name":null},{"line":691,"address":[6318137],"length":1,"stats":{"Line":1},"fn_name":null},{"line":700,"address":[6318681,6318951,6319596],"length":1,"stats":{"Line":3},"fn_name":null},{"line":707,"address":[6319794],"length":1,"stats":{"Line":1},"fn_name":null},{"line":708,"address":[6319810],"length":1,"stats":{"Line":1},"fn_name":null},{"line":711,"address":[6319986],"length":1,"stats":{"Line":1},"fn_name":null},{"line":714,"address":[6320785,6320400],"length":1,"stats":{"Line":1},"fn_name":"try_transfer_from\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":721,"address":[6320629,6320503],"length":1,"stats":{"Line":2},"fn_name":null},{"line":724,"address":[6320614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":725,"address":[6320719],"length":1,"stats":{"Line":1},"fn_name":null},{"line":726,"address":[6320726,6320816,6320860,6321260,6320895],"length":1,"stats":{"Line":3},"fn_name":null},{"line":728,"address":[6321185],"length":1,"stats":{"Line":1},"fn_name":null},{"line":731,"address":[6324074,6321584],"length":1,"stats":{"Line":1},"fn_name":"try_send_from\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":739,"address":[6321711],"length":1,"stats":{"Line":1},"fn_name":null},{"line":740,"address":[6321947,6322250,6322041,6321804,6321992],"length":1,"stats":{"Line":4},"fn_name":null},{"line":742,"address":[6322026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":748,"address":[6322324],"length":1,"stats":{"Line":1},"fn_name":null},{"line":749,"address":[6322363],"length":1,"stats":{"Line":1},"fn_name":null},{"line":750,"address":[6322416],"length":1,"stats":{"Line":1},"fn_name":null},{"line":756,"address":[6322751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":757,"address":[6323562,6323099,6323021,6323143,6323181],"length":1,"stats":{"Line":3},"fn_name":null},{"line":759,"address":[6323471],"length":1,"stats":{"Line":1},"fn_name":null},{"line":762,"address":[6329069,6329084,6324112],"length":1,"stats":{"Line":1},"fn_name":"try_burn_from\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":768,"address":[6324415,6324282,6324191,6324624],"length":1,"stats":{"Line":2},"fn_name":null},{"line":769,"address":[6324381,6324869,6324686,6324734,6325078],"length":1,"stats":{"Line":3},"fn_name":null},{"line":770,"address":[6324817,6325151],"length":1,"stats":{"Line":2},"fn_name":null},{"line":772,"address":[6325191,6325412,6325621,6325255],"length":1,"stats":{"Line":2},"fn_name":null},{"line":774,"address":[6329088,6325677,6329101,6325353],"length":1,"stats":{"Line":2},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":775,"address":[6325831],"length":1,"stats":{"Line":0},"fn_name":null},{"line":780,"address":[6325855],"length":1,"stats":{"Line":0},"fn_name":null},{"line":782,"address":[6326269,6325975],"length":1,"stats":{"Line":0},"fn_name":null},{"line":785,"address":[6325732,6326335],"length":1,"stats":{"Line":2},"fn_name":null},{"line":786,"address":[6326410],"length":1,"stats":{"Line":1},"fn_name":null},{"line":788,"address":[6326497],"length":1,"stats":{"Line":1},"fn_name":null},{"line":795,"address":[6326426],"length":1,"stats":{"Line":1},"fn_name":null},{"line":799,"address":[6326659],"length":1,"stats":{"Line":1},"fn_name":null},{"line":800,"address":[6326932],"length":1,"stats":{"Line":1},"fn_name":null},{"line":802,"address":[6327133,6326993],"length":1,"stats":{"Line":2},"fn_name":null},{"line":803,"address":[6327200],"length":1,"stats":{"Line":1},"fn_name":null},{"line":805,"address":[6327266],"length":1,"stats":{"Line":0},"fn_name":null},{"line":810,"address":[6327216],"length":1,"stats":{"Line":1},"fn_name":null},{"line":813,"address":[6327676],"length":1,"stats":{"Line":1},"fn_name":null},{"line":814,"address":[6327691],"length":1,"stats":{"Line":1},"fn_name":null},{"line":815,"address":[6327868,6327740],"length":1,"stats":{"Line":2},"fn_name":null},{"line":816,"address":[6327935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":818,"address":[6327982],"length":1,"stats":{"Line":0},"fn_name":null},{"line":822,"address":[6327951],"length":1,"stats":{"Line":1},"fn_name":null},{"line":825,"address":[6328084],"length":1,"stats":{"Line":1},"fn_name":null},{"line":826,"address":[6328099],"length":1,"stats":{"Line":1},"fn_name":null},{"line":827,"address":[6328184,6328106,6328266,6328641,6328228],"length":1,"stats":{"Line":3},"fn_name":null},{"line":830,"address":[6328468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":833,"address":[6329120,6332646],"length":1,"stats":{"Line":1},"fn_name":"try_increase_allowance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":840,"address":[6329658,6329202,6329325,6329449],"length":1,"stats":{"Line":2},"fn_name":null},{"line":841,"address":[6329720,6329418,6329768,6329895,6330104],"length":1,"stats":{"Line":3},"fn_name":null},{"line":843,"address":[6330575,6329880,6330217,6330366,6330169],"length":1,"stats":{"Line":3},"fn_name":null},{"line":844,"address":[6330300,6330749],"length":1,"stats":{"Line":2},"fn_name":null},{"line":845,"address":[6330773],"length":1,"stats":{"Line":1},"fn_name":null},{"line":846,"address":[6330798],"length":1,"stats":{"Line":1},"fn_name":null},{"line":848,"address":[6330835],"length":1,"stats":{"Line":1},"fn_name":null},{"line":853,"address":[6330876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":857,"address":[6331004],"length":1,"stats":{"Line":1},"fn_name":null},{"line":858,"address":[6331266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":859,"address":[6331650,6331372,6332067,6331555],"length":1,"stats":{"Line":2},"fn_name":null},{"line":865,"address":[6332679],"length":1,"stats":{"Line":1},"fn_name":null},{"line":868,"address":[6336817,6333296],"length":1,"stats":{"Line":1},"fn_name":"try_decrease_allowance\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":875,"address":[6333378,6333501,6333834,6333625],"length":1,"stats":{"Line":2},"fn_name":null},{"line":876,"address":[6333944,6334071,6333594,6333896,6334280],"length":1,"stats":{"Line":3},"fn_name":null},{"line":878,"address":[6334345,6334056,6334542,6334751,6334393],"length":1,"stats":{"Line":3},"fn_name":null},{"line":879,"address":[6334920,6334476],"length":1,"stats":{"Line":2},"fn_name":null},{"line":880,"address":[6334944],"length":1,"stats":{"Line":1},"fn_name":null},{"line":881,"address":[6334969],"length":1,"stats":{"Line":0},"fn_name":null},{"line":883,"address":[6335006],"length":1,"stats":{"Line":1},"fn_name":null},{"line":888,"address":[6335047],"length":1,"stats":{"Line":1},"fn_name":null},{"line":892,"address":[6335175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":893,"address":[6335437],"length":1,"stats":{"Line":1},"fn_name":null},{"line":894,"address":[6335821,6336238,6335726,6335543],"length":1,"stats":{"Line":2},"fn_name":null},{"line":900,"address":[6336850],"length":1,"stats":{"Line":1},"fn_name":null},{"line":903,"address":[6337472,6339280,6339295],"length":1,"stats":{"Line":1},"fn_name":"add_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":908,"address":[6337509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":910,"address":[6337620,6337661,6337952,6337755,6337542],"length":1,"stats":{"Line":4},"fn_name":null},{"line":912,"address":[6338278,6338010,6338066,6337688],"length":1,"stats":{"Line":2},"fn_name":null},{"line":914,"address":[6338612],"length":1,"stats":{"Line":1},"fn_name":null},{"line":915,"address":[6338051],"length":1,"stats":{"Line":1},"fn_name":null},{"line":916,"address":[6338332],"length":1,"stats":{"Line":1},"fn_name":null},{"line":917,"address":[6338417,6338339,6338795,6338509,6338461],"length":1,"stats":{"Line":3},"fn_name":null},{"line":921,"address":[6339296,6341104,6341119],"length":1,"stats":{"Line":1},"fn_name":"remove_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":926,"address":[6339333],"length":1,"stats":{"Line":1},"fn_name":null},{"line":928,"address":[6339776,6339366,6339485,6339444,6339579],"length":1,"stats":{"Line":4},"fn_name":null},{"line":930,"address":[6340102,6339512,6339890,6339834],"length":1,"stats":{"Line":2},"fn_name":null},{"line":932,"address":[6340436],"length":1,"stats":{"Line":1},"fn_name":null},{"line":933,"address":[6339875],"length":1,"stats":{"Line":1},"fn_name":null},{"line":934,"address":[6340156],"length":1,"stats":{"Line":1},"fn_name":null},{"line":935,"address":[6340163,6340285,6340619,6340333,6340241],"length":1,"stats":{"Line":3},"fn_name":null},{"line":939,"address":[6341120,6342928,6342943],"length":1,"stats":{"Line":1},"fn_name":"set_minters\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":944,"address":[6341157],"length":1,"stats":{"Line":1},"fn_name":null},{"line":946,"address":[6341309,6341190,6341268,6341600,6341403],"length":1,"stats":{"Line":4},"fn_name":null},{"line":948,"address":[6341336,6341714,6341658,6341926],"length":1,"stats":{"Line":2},"fn_name":null},{"line":950,"address":[6342260],"length":1,"stats":{"Line":1},"fn_name":null},{"line":951,"address":[6341699],"length":1,"stats":{"Line":1},"fn_name":null},{"line":952,"address":[6341980],"length":1,"stats":{"Line":1},"fn_name":null},{"line":953,"address":[6342157,6341987,6342065,6342109,6342443],"length":1,"stats":{"Line":3},"fn_name":null},{"line":962,"address":[6342944,6345755,6345740],"length":1,"stats":{"Line":1},"fn_name":"try_burn\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":967,"address":[6343007,6343098,6343442,6343233],"length":1,"stats":{"Line":2},"fn_name":null},{"line":968,"address":[6343181,6343512],"length":1,"stats":{"Line":2},"fn_name":null},{"line":970,"address":[6343536],"length":1,"stats":{"Line":1},"fn_name":null},{"line":971,"address":[6343600],"length":1,"stats":{"Line":1},"fn_name":null},{"line":973,"address":[6343801,6343661],"length":1,"stats":{"Line":2},"fn_name":null},{"line":974,"address":[6343868],"length":1,"stats":{"Line":1},"fn_name":null},{"line":976,"address":[6343934],"length":1,"stats":{"Line":0},"fn_name":null},{"line":982,"address":[6343884],"length":1,"stats":{"Line":1},"fn_name":null},{"line":984,"address":[6344344],"length":1,"stats":{"Line":1},"fn_name":null},{"line":985,"address":[6344359],"length":1,"stats":{"Line":1},"fn_name":null},{"line":986,"address":[6344408,6344536],"length":1,"stats":{"Line":2},"fn_name":null},{"line":987,"address":[6344603],"length":1,"stats":{"Line":1},"fn_name":null},{"line":989,"address":[6344650],"length":1,"stats":{"Line":0},"fn_name":null},{"line":993,"address":[6344619],"length":1,"stats":{"Line":1},"fn_name":null},{"line":996,"address":[6344752],"length":1,"stats":{"Line":1},"fn_name":null},{"line":997,"address":[6344767],"length":1,"stats":{"Line":1},"fn_name":null},{"line":998,"address":[6344934,6344852,6345309,6344896,6344774],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1001,"address":[6345136],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1004,"address":[6347174,6347189,6345760],"length":1,"stats":{"Line":1},"fn_name":"perform_transfer\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1010,"address":[6345839],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1012,"address":[6345868],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1013,"address":[6346069,6345929],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1014,"address":[6346144],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1016,"address":[6346202],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1021,"address":[6346160],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1023,"address":[6346593],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1024,"address":[6347200,6347089,6346789,6346642],"length":1,"stats":{"Line":1},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1025,"address":[6347212],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1027,"address":[6346847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1029,"address":[6347152],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1032,"address":[6347712,6347248],"length":1,"stats":{"Line":1},"fn_name":"is_admin\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1033,"address":[6347278,6347579],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1034,"address":[6347672,6347540],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1035,"address":[6347756],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1041,"address":[6347776],"length":1,"stats":{"Line":1},"fn_name":"check_if_admin\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":1042,"address":[6347809],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1043,"address":[6347973],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1048,"address":[6347964],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1051,"address":[3725232],"length":1,"stats":{"Line":2},"fn_name":"is_valid_name"},{"line":1052,"address":[3725246],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1053,"address":[3725264],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1056,"address":[3725312],"length":1,"stats":{"Line":6},"fn_name":"is_valid_symbol"},{"line":1057,"address":[3725336],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1058,"address":[3725356],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1060,"address":[1288288,1288308],"length":1,"stats":{"Line":10},"fn_name":"{{closure}}"},{"line":1082,"address":[6135444,6134256],"length":1,"stats":{"Line":4},"fn_name":"init_helper"},{"line":1088,"address":[6134278],"length":1,"stats":{"Line":4},"fn_name":null},{"line":1089,"address":[6134333,6134413],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1092,"address":[6134421],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1093,"address":[6134482,6134547],"length":1,"stats":{"Line":7},"fn_name":null},{"line":1094,"address":[6134611],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1096,"address":[6134684],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1097,"address":[6134873],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1101,"address":[6135108,6135331],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1130,"address":[6352981,6351546,6351952,6351248,6352656,6352259],"length":1,"stats":{"Line":4},"fn_name":"extract_error_msg\u003ccosmwasm_std::encoding::Binary\u003e"},{"line":1131,"address":[6351986,6351282,6352690],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1132,"address":[6351974,6352678,6351289,6351270,6352697,6351993],"length":1,"stats":{"Line":5},"fn_name":null},{"line":1133,"address":[6353048,6352399,6353121,6352326,6352020,6351613,6352742,6351307,6351687],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1136,"address":[6353137,6351703,6352415],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1137,"address":[6353174,6351737,6352449],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1138,"address":[6353292,6351840,6352552],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1141,"address":[6352777,6351342,6352055],"length":1,"stats":{"Line":6},"fn_name":null},{"line":1142,"address":[6351364,6352799,6352077],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1143,"address":[6351476,6352189,6352911],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1148,"address":[6135472,6136159],"length":1,"stats":{"Line":1},"fn_name":"ensure_success"},{"line":1149,"address":[6135484,6135595],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1151,"address":[6135814,6136012,6135937,6136042,6135952,6135832,6135997,6135922,6136027,6135886,6135982,6135967,6135850,6135796,6135868,6135904],"length":1,"stats":{"Line":8},"fn_name":null},{"line":1152,"address":[6135801],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1168,"address":[6136046],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1170,"address":[6135750],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1177,"address":[6136503,6136256],"length":1,"stats":{"Line":3},"fn_name":"test_init_sanity"},{"line":1178,"address":[6136518,6136263,6136356],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1179,"address":[6136297],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1182,"address":[6136870,6136673],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1184,"address":[6137158],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1185,"address":[6137181],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1186,"address":[6137266,6137520],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1187,"address":[6137748,6137488,6137574],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1188,"address":[6137803,6137705],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1189,"address":[6138029],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1190,"address":[6138326],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1191,"address":[6138718,6138579],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1192,"address":[6138668,6138821],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1194,"address":[6138773,6138681],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1196,"address":[6139032,6139138],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1200,"address":[6139296,6139604],"length":1,"stats":{"Line":3},"fn_name":"test_total_supply_overflow"},{"line":1201,"address":[6139422,6139486,6139619,6139303],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1202,"address":[6139345],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1203,"address":[6139462],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1205,"address":[6140035,6139781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1206,"address":[6139764],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1208,"address":[6139885],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1211,"address":[6139839,6140516,6140273],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1212,"address":[6140337],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1213,"address":[6139855,6140223],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1214,"address":[6140313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1216,"address":[6140460],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1217,"address":[6140401],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1221,"address":[6140820],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1222,"address":[6141076,6140955,6141150],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1231,"address":[6141639,6141376],"length":1,"stats":{"Line":3},"fn_name":"test_handle_transfer"},{"line":1232,"address":[6141383,6141492,6141654],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1233,"address":[6141433],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1236,"address":[6141840,6142083],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1237,"address":[6141817],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1239,"address":[6141918],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1243,"address":[6142277,6141888],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1244,"address":[6142309],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1247,"address":[6142457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1248,"address":[6142712],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1249,"address":[6142989,6142838],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1250,"address":[6143059,6142949],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1252,"address":[6142962,6143027],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1254,"address":[6143176,6143294],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1256,"address":[6143189,6143262],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1258,"address":[6143427],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1259,"address":[6143732,6143491],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1260,"address":[6143699,6143789,6143943],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1263,"address":[6143990,6143906],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1264,"address":[6144022],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1267,"address":[6144170],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1268,"address":[6144425],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1269,"address":[6144552,6144655,6144680],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1273,"address":[6144928,6145207],"length":1,"stats":{"Line":3},"fn_name":"test_handle_send"},{"line":1274,"address":[6144935,6145222,6145060],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1275,"address":[6145001],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1278,"address":[6145390,6145624],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1279,"address":[6145373],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1281,"address":[6145468],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1285,"address":[6145438],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1288,"address":[6145904],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1289,"address":[6146159],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1290,"address":[6146285,6146423],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1293,"address":[6146456,6146396],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1294,"address":[6146488],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1296,"address":[6146524,6146622],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1298,"address":[6146798,6146856],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1299,"address":[6147072],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1300,"address":[6147323,6147286,6147214],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1301,"address":[6148404,6147300,6148491,6148074],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1302,"address":[6147376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1303,"address":[6147435],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1304,"address":[6148015,6147970,6147867],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1305,"address":[6147462,6147530],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1306,"address":[6147570,6147635],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1307,"address":[6147675],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1308,"address":[6147699,6147835,6147767],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1312,"address":[6148045],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1317,"address":[6148927,6148672],"length":1,"stats":{"Line":3},"fn_name":"test_handle_register_receive"},{"line":1318,"address":[6148679,6148942,6148780],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1319,"address":[6148721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1322,"address":[6149107,6149338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1323,"address":[6149090],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1325,"address":[6149185],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1329,"address":[6149155],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1332,"address":[6149618],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1333,"address":[6149873],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1334,"address":[6149999,6150150],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1336,"address":[6150123,6150314,6150188],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1339,"address":[6150363,6150439],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1343,"address":[6150800,6151071],"length":1,"stats":{"Line":3},"fn_name":"test_handle_create_viewing_key"},{"line":1344,"address":[6150924,6150807,6151086],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1345,"address":[6150865],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1348,"address":[6151254,6151487],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1349,"address":[6151237],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1351,"address":[6151331],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1355,"address":[6151302],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1358,"address":[6151767,6152022],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1359,"address":[6152407,6152055],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1360,"address":[6152038],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1362,"address":[6152242],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1364,"address":[6152105,6152596,6152927],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1367,"address":[6152983],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1368,"address":[6153136],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1370,"address":[6153096,6153273,6153206],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1372,"address":[6153174,6153109],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1374,"address":[6153432,6153384],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1375,"address":[6153462,6153598,6153573],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1379,"address":[6154183,6153920],"length":1,"stats":{"Line":3},"fn_name":"test_handle_set_viewing_key"},{"line":1380,"address":[6154036,6154198,6153927],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1381,"address":[6153977],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1384,"address":[6154378,6154621],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1385,"address":[6154361],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1387,"address":[6154456],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1392,"address":[6154426],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1395,"address":[6154901],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1396,"address":[6155600,6155156],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1398,"address":[6155783],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1399,"address":[6155672],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1400,"address":[6155731],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1407,"address":[6156059],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1409,"address":[6156244],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1412,"address":[6156403],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1413,"address":[6157102,6156658],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1415,"address":[6157285],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1416,"address":[6157174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1417,"address":[6157233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1419,"address":[6157561,6157638],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1421,"address":[6157574],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1423,"address":[6157779,6157827],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1424,"address":[6157968,6157857,6157993],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1428,"address":[6158256,6158573],"length":1,"stats":{"Line":3},"fn_name":"test_handle_transfer_from"},{"line":1429,"address":[6158588,6158269,6158426],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1430,"address":[6158367],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1433,"address":[6159017,6158774],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1434,"address":[6158751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1436,"address":[6158852],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1441,"address":[6159217,6158822],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1442,"address":[6159249],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1443,"address":[6159308],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1446,"address":[6159568,6159488],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1447,"address":[6159784],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1448,"address":[6160032,6160065,6159911],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1452,"address":[6160098,6160038],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1453,"address":[6160130],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1455,"address":[6160166],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1457,"address":[6160589,6160334],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1458,"address":[6160628,6160869],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1459,"address":[6160605],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1461,"address":[6160704],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1464,"address":[6160674,6161070],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1465,"address":[6161102],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1466,"address":[6161161],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1469,"address":[6161421,6161341],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1470,"address":[6161637],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1471,"address":[6161885,6161918,6161764],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1475,"address":[6161891,6161951],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1476,"address":[6161983],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1477,"address":[6162042],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1482,"address":[6162834],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1483,"address":[6162290],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1486,"address":[6162222],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1488,"address":[6162503],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1489,"address":[6162346,6162414],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1490,"address":[6162446],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1492,"address":[6162639],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1493,"address":[6162567],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1495,"address":[6162671,6162738],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1496,"address":[6162770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1498,"address":[6163026],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1500,"address":[6163242],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1501,"address":[6163523,6163369,6163490],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1505,"address":[6163556,6163496],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1506,"address":[6163588],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1507,"address":[6163647],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1510,"address":[6163827,6163907,6164123],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1511,"address":[6164162,6164419],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1512,"address":[6164139],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1514,"address":[6164254],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1516,"address":[6164660,6164208],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1518,"address":[6164628,6164224],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1520,"address":[6164777,6164901],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1522,"address":[6164793,6164869],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1524,"address":[6165098,6165034],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1525,"address":[6165155],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1526,"address":[6165218],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1527,"address":[6165298],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1528,"address":[6165567,6165353],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1529,"address":[6165647,6165458],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1530,"address":[6165630,6165702],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1531,"address":[6165948,6165814],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1535,"address":[6165911,6165995],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1536,"address":[6166027],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1537,"address":[6166086],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1540,"address":[6166266,6166346],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1541,"address":[6166562],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1542,"address":[6166817,6166792,6166689],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1546,"address":[6167669,6167296],"length":1,"stats":{"Line":3},"fn_name":"test_handle_send_from"},{"line":1547,"address":[6167684,6167522,6167309],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1548,"address":[6167463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1551,"address":[6168113,6167870],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1552,"address":[6167847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1554,"address":[6167948],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1559,"address":[6167918,6168313],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1560,"address":[6168345],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1561,"address":[6168404],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1565,"address":[6168708,6168628],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1566,"address":[6168924],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1567,"address":[6169172,6169205,6169051],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1571,"address":[6169238,6169178],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1572,"address":[6169270],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1576,"address":[6169717,6169462],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1577,"address":[6169756,6169997],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1578,"address":[6169733],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1580,"address":[6169832],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1583,"address":[6170198,6169802],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1584,"address":[6170230],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1585,"address":[6170289],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1589,"address":[6170593,6170513],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1590,"address":[6170809],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1591,"address":[6171090,6170936,6171057],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1595,"address":[6171063],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1598,"address":[6171470,6171215],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1599,"address":[6171804,6171509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1600,"address":[6171486],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1602,"address":[6171639],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1604,"address":[6172021],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1606,"address":[6172048],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1607,"address":[6172183,6172115],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1608,"address":[6172223],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1609,"address":[6172263,6172311],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1612,"address":[6172540,6172475],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1613,"address":[6172640,6172572],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1614,"address":[6172672],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1615,"address":[6172696],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1618,"address":[6172956,6173036,6173252],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1619,"address":[6173291,6173643],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1620,"address":[6173268],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1622,"address":[6173478],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1624,"address":[6174555,6173341,6174052,6174396,6173852],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1625,"address":[6174305,6173913,6174197],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1626,"address":[6174335,6174252,6174025,6174092],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1629,"address":[6174628,6174512],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1631,"address":[6174528,6174596],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1633,"address":[6174745,6174863],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1635,"address":[6174831,6174758],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1637,"address":[6174996,6175060],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1638,"address":[6175117],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1639,"address":[6175180],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1640,"address":[6175260],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1641,"address":[6175529,6175315],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1642,"address":[6175609,6175420],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1643,"address":[6175592,6175664],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1644,"address":[6175910,6175776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1648,"address":[6175873,6175957],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1649,"address":[6175989],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1650,"address":[6176048],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1654,"address":[6176352,6176272],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1655,"address":[6176568],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1656,"address":[6176695,6176823,6176798],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1660,"address":[6177669,6177360],"length":1,"stats":{"Line":3},"fn_name":"test_handle_burn_from"},{"line":1661,"address":[6177522,6177684,6177373],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1662,"address":[6177463],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1665,"address":[6177870,6178113],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1666,"address":[6177847],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1668,"address":[6177948],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1673,"address":[6177918,6178313],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1674,"address":[6178345],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1677,"address":[6178493],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1678,"address":[6178748],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1679,"address":[6178996,6179029,6178875],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1683,"address":[6179062,6179002],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1684,"address":[6179094],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1688,"address":[6179541,6179286],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1689,"address":[6179580,6179821],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1690,"address":[6179557],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1692,"address":[6179656],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1695,"address":[6179626,6180022],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1696,"address":[6180054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1699,"address":[6180202],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1700,"address":[6180457],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1701,"address":[6180584,6180732,6180699],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1705,"address":[6180765,6180705],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1706,"address":[6180797],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1709,"address":[6181200,6180945],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1710,"address":[6181487,6181233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1711,"address":[6181216],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1713,"address":[6181322],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1715,"address":[6181713,6181279],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1717,"address":[6181681,6181292],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1719,"address":[6181846,6181910],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1720,"address":[6181967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1721,"address":[6182022,6182152],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1722,"address":[6182207,6182135],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1723,"address":[6182319,6182453],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1727,"address":[6182500,6182416],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1728,"address":[6182532],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1731,"address":[6182680],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1732,"address":[6182935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1733,"address":[6183062,6183165,6183190],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1737,"address":[6183600,6183901],"length":1,"stats":{"Line":3},"fn_name":"test_handle_decrease_allowance"},{"line":1738,"address":[6183754,6183916,6183613],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1739,"address":[6183695],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1742,"address":[6184345,6184102],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1743,"address":[6184079],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1745,"address":[6184180],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1749,"address":[6184150,6184545],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1750,"address":[6184577],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1754,"address":[6185024,6184769],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1755,"address":[6185317,6185063],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1756,"address":[6185040],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1758,"address":[6185152],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1761,"address":[6185109,6185543],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1763,"address":[6185511,6185122],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1765,"address":[6185778,6185660],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1767,"address":[6185746,6185673],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1770,"address":[6185975,6185927],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1771,"address":[6186138,6186013],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1780,"address":[6186101,6186185],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1781,"address":[6186217],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1785,"address":[6186664,6186409],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1786,"address":[6186938,6186697],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1787,"address":[6186680],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1789,"address":[6186773],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1793,"address":[6187127,6186743],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1794,"address":[6187159],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1798,"address":[6187606,6187351],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1799,"address":[6187892,6187639],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1800,"address":[6187622],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1802,"address":[6187727],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1805,"address":[6188081,6187717],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1806,"address":[6188119,6188230],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1816,"address":[6188608,6188887],"length":1,"stats":{"Line":3},"fn_name":"test_handle_increase_allowance"},{"line":1817,"address":[6188902,6188740,6188615],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1818,"address":[6188681],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1821,"address":[6189331,6189088],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1822,"address":[6189065],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1824,"address":[6189166],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1828,"address":[6189136,6189525],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1829,"address":[6189557],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1833,"address":[6189749,6190004],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1834,"address":[6190037,6190291],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1835,"address":[6190020],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1837,"address":[6190126],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1840,"address":[6190517,6190083],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1842,"address":[6190096,6190485],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1844,"address":[6190634,6190752],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1846,"address":[6190647,6190720],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1849,"address":[6190901,6190949],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1850,"address":[6190987,6191112],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1859,"address":[6191159,6191075],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1860,"address":[6191191],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1864,"address":[6191638,6191383],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1865,"address":[6191924,6191671],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1866,"address":[6191654],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1868,"address":[6191759],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1871,"address":[6191749,6192113],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1872,"address":[6192264,6192151],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1882,"address":[6192839,6192576],"length":1,"stats":{"Line":3},"fn_name":"test_handle_change_admin"},{"line":1883,"address":[6192583,6192854,6192692],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1884,"address":[6192633],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1887,"address":[6193256,6193022],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1888,"address":[6193005],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1890,"address":[6193100],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1894,"address":[6193070,6193444],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1897,"address":[6193568,6193823],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1898,"address":[6193856,6194093],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1899,"address":[6193839],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1901,"address":[6193928],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1904,"address":[6194298,6193918,6194375],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1907,"address":[6194335,6194407],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1908,"address":[6194619],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1912,"address":[6195104,6195367],"length":1,"stats":{"Line":3},"fn_name":"test_handle_set_contract_status"},{"line":1913,"address":[6195382,6195111,6195220],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1914,"address":[6195161],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1917,"address":[6195876,6195547],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1918,"address":[6195530],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1920,"address":[6195723],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1927,"address":[6195681,6196280,6196064],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1928,"address":[6196550,6196313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1929,"address":[6196296],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1931,"address":[6196385],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1934,"address":[6196375,6196747],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1935,"address":[6196886,6196826],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1939,"address":[6197335,6197072],"length":1,"stats":{"Line":3},"fn_name":"test_handle_redeem"},{"line":1940,"address":[6197350,6197188,6197079],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1941,"address":[6197129],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1944,"address":[6197521,6197934],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1945,"address":[6197504],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1947,"address":[6197775],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1951,"address":[6197573],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1955,"address":[6198122,6198338,6197733],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1956,"address":[6198608,6198371],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1957,"address":[6198354],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1959,"address":[6198443],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1962,"address":[6198433],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1963,"address":[6198941,6198874,6198797],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1965,"address":[6198810],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1967,"address":[6199268,6199118,6199044],"length":1,"stats":{"Line":2},"fn_name":null},{"line":1971,"address":[6199767,6199504],"length":1,"stats":{"Line":3},"fn_name":"test_handle_deposit"},{"line":1972,"address":[6199511,6199620,6199782],"length":1,"stats":{"Line":3},"fn_name":null},{"line":1973,"address":[6199561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1976,"address":[6199953,6200254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1977,"address":[6199936],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1979,"address":[6200095],"length":1,"stats":{"Line":0},"fn_name":null},{"line":1982,"address":[6200005],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1985,"address":[6200546],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1987,"address":[6200442],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1988,"address":[6200065],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1992,"address":[6200628],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1994,"address":[6201129,6200932],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1995,"address":[6200874],"length":1,"stats":{"Line":1},"fn_name":null},{"line":1997,"address":[6200964],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2000,"address":[6200954],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2001,"address":[6201462,6201318,6201395],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2003,"address":[6201331],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2005,"address":[6201565,6201639,6201789],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2009,"address":[6202335,6202016],"length":1,"stats":{"Line":3},"fn_name":"test_handle_burn"},{"line":2010,"address":[6202023],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2011,"address":[6202180,6202081,6202350],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2012,"address":[6202097],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2013,"address":[6202156],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2015,"address":[6202524,6202760],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2016,"address":[6202507],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2018,"address":[6202598],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2021,"address":[6202956,6202588],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2022,"address":[6203060],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2024,"address":[6203084],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2027,"address":[6203200,6203455],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2028,"address":[6203488,6203725],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2029,"address":[6203471],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2031,"address":[6203560],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2034,"address":[6203922,6203550],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2035,"address":[6204036,6204251],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2039,"address":[6204767,6204448],"length":1,"stats":{"Line":3},"fn_name":"test_handle_mint"},{"line":2040,"address":[6204455],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2041,"address":[6204513,6204782,6204612],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2042,"address":[6204529],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2043,"address":[6204588],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2045,"address":[6205192,6204956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2046,"address":[6204939],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2048,"address":[6205030],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2051,"address":[6205020,6205388],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2052,"address":[6205492],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2054,"address":[6205516],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2055,"address":[6205575],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2058,"address":[6205978,6205723],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2059,"address":[6206011,6206248],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2060,"address":[6205994],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2062,"address":[6206083],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2065,"address":[6206445,6206073],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2066,"address":[6206559,6206774],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2070,"address":[6212608,6206976],"length":1,"stats":{"Line":3},"fn_name":"test_handle_admin_commands"},{"line":2071,"address":[6206989],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2073,"address":[6207072,6207147,6207346],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2074,"address":[6207088],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2077,"address":[6207540,6207881],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2078,"address":[6207517],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2080,"address":[6207716],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2087,"address":[6208081,6207674],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2088,"address":[6208297],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2089,"address":[6208577,6208736,6208424],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2092,"address":[6208693,6208769],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2095,"address":[6208992],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2096,"address":[6209247],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2097,"address":[6209374,6209527,6209686],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2100,"address":[6209719,6209643],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2103,"address":[6209942],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2104,"address":[6210197],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2105,"address":[6210597,6210324,6210453],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2108,"address":[6210554,6210630],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2111,"address":[6210853],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2112,"address":[6211108],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2113,"address":[6211235,6211364,6211482],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2116,"address":[6211455,6211515],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2119,"address":[6211639],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2120,"address":[6211894],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2121,"address":[6212260,6212150,6212021],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2125,"address":[6212927,6212640],"length":1,"stats":{"Line":3},"fn_name":"test_handle_pause_with_withdrawals"},{"line":2126,"address":[6212780,6212942,6212647],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2127,"address":[6212721],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2130,"address":[6213448,6213113],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2131,"address":[6213096],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2133,"address":[6213289],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2141,"address":[6213636,6213247,6213852],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2142,"address":[6213885,6214126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2143,"address":[6213868],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2145,"address":[6213961],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2149,"address":[6214315,6213931],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2150,"address":[6214347],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2153,"address":[6214495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2154,"address":[6214750],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2155,"address":[6215028,6214904],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2157,"address":[6214869],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2161,"address":[6215150],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2165,"address":[6215310,6215565],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2166,"address":[6215827,6215598],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2167,"address":[6215581],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2169,"address":[6215662],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2174,"address":[6216288,6216567],"length":1,"stats":{"Line":3},"fn_name":"test_handle_pause_all"},{"line":2175,"address":[6216295,6216420,6216582],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2176,"address":[6216361],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2179,"address":[6216753,6217088],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2180,"address":[6216736],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2182,"address":[6216929],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2190,"address":[6217276,6217492,6216887],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2191,"address":[6217525,6217766],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2192,"address":[6217508],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2194,"address":[6217601],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2198,"address":[6217571,6217955],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2199,"address":[6217987],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2202,"address":[6218135],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2203,"address":[6218390],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2204,"address":[6218668,6218544],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2206,"address":[6218509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2210,"address":[6218790],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2214,"address":[6218950],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2215,"address":[6219205],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2216,"address":[6219482,6219359],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2218,"address":[6219324],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2223,"address":[6220141,6219856],"length":1,"stats":{"Line":3},"fn_name":"test_handle_set_minters"},{"line":2224,"address":[6219869,6220156,6219994],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2225,"address":[6219935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2228,"address":[6220324,6220584],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2229,"address":[6220307],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2231,"address":[6220428],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2235,"address":[6220772,6220382],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2238,"address":[6220995],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2239,"address":[6221250],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2240,"address":[6221480,6221539,6221377],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2243,"address":[6221496,6221572],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2246,"address":[6221795],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2247,"address":[6222050,6222234],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2250,"address":[6222207,6222267],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2251,"address":[6222299],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2254,"address":[6222447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2255,"address":[6222886,6222702],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2258,"address":[6222919,6222859],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2259,"address":[6222951],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2262,"address":[6223099],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2263,"address":[6223354],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2264,"address":[6223481,6223584,6223609],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2268,"address":[6223872,6224157],"length":1,"stats":{"Line":3},"fn_name":"test_handle_add_minters"},{"line":2269,"address":[6224010,6224172,6223885],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2270,"address":[6223951],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2273,"address":[6224588,6224334],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2274,"address":[6224317],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2276,"address":[6224438],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2280,"address":[6224392,6224776],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2283,"address":[6224999],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2284,"address":[6225254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2285,"address":[6225381,6225543,6225484],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2288,"address":[6225576,6225500],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2291,"address":[6225799],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2292,"address":[6226238,6226054],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2295,"address":[6226211,6226271],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2296,"address":[6226303],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2299,"address":[6226451],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2300,"address":[6226706,6226890],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2303,"address":[6226923,6226863],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2304,"address":[6226955],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2307,"address":[6227103],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2308,"address":[6227358,6227558],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2312,"address":[6228085,6227776],"length":1,"stats":{"Line":3},"fn_name":"test_handle_remove_minters"},{"line":2313,"address":[6227789,6228100,6227938],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2314,"address":[6227879],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2317,"address":[6228286,6228555],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2318,"address":[6228263],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2320,"address":[6228390],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2324,"address":[6228749,6228344],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2327,"address":[6228972],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2328,"address":[6229227],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2329,"address":[6229354,6229457,6229516],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2332,"address":[6229473,6229549],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2335,"address":[6229772],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2336,"address":[6230027,6230211],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2339,"address":[6230184,6230244],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2340,"address":[6230276],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2343,"address":[6230424],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2344,"address":[6230679],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2345,"address":[6230909,6230806,6230942],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2348,"address":[6230975,6230915],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2349,"address":[6231007],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2352,"address":[6231155],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2353,"address":[6231410],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2354,"address":[6231699,6231537,6231640],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2358,"address":[6231656,6231732],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2361,"address":[6231955],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2362,"address":[6232210,6232394],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2365,"address":[6232367,6232427],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2366,"address":[6232459],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2369,"address":[6232607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2370,"address":[6232862],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2371,"address":[6232989,6233125,6233092],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2374,"address":[6233158,6233098],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2375,"address":[6233190],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2378,"address":[6233338],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2379,"address":[6233593],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2380,"address":[6233823,6233720,6233848],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2386,"address":[6234240,6234503],"length":1,"stats":{"Line":3},"fn_name":"test_authenticated_queries"},{"line":2387,"address":[6234356,6234518,6234247],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2388,"address":[6234297],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2391,"address":[6234926,6234689],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2392,"address":[6234672],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2394,"address":[6234767],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2398,"address":[6234737,6235114],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2399,"address":[6235146],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2401,"address":[6235248],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2402,"address":[6235400],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2403,"address":[6235554,6235678],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2405,"address":[6235519],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2409,"address":[6235800],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2412,"address":[6235919,6236174],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2413,"address":[6236329,6236204],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2414,"address":[6236397],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2415,"address":[6236531],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2419,"address":[6236695],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2420,"address":[6236776],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2423,"address":[6236891],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2424,"address":[6237048],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2425,"address":[6237126],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2426,"address":[6237203],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2428,"address":[6237284,6237409],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2431,"address":[6237372,6237456],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2432,"address":[6237488],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2434,"address":[6237590],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2435,"address":[6237742],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2436,"address":[6237896,6238019],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2438,"address":[6237861],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2443,"address":[6242814,6238448],"length":1,"stats":{"Line":3},"fn_name":"test_query_token_info"},{"line":2444,"address":[6238455],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2445,"address":[6238520],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2446,"address":[6238579],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2447,"address":[6238647],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2448,"address":[6238866,6238793,6238949],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2452,"address":[6238975],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2454,"address":[6238999],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2455,"address":[6239033],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2457,"address":[6239080],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2458,"address":[6239208,6239163],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2459,"address":[6239240],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2460,"address":[6239313],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2461,"address":[6239377,6239506],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2465,"address":[6239792],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2466,"address":[6239865],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2468,"address":[6240053],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2469,"address":[6240305,6240648],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2470,"address":[6240282],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2472,"address":[6240483],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2475,"address":[6240358],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2476,"address":[6240369,6240836],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2477,"address":[6240869,6241224],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2478,"address":[6240852],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2480,"address":[6241059],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2482,"address":[6241429,6240922],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2484,"address":[6241542],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2490,"address":[6242022,6241872,6241756],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2491,"address":[6242182,6242073,6241933],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2492,"address":[6242079,6242324],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2493,"address":[6242237,6242375,6242409],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2495,"address":[6241835],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2500,"address":[6242848,6243141],"length":1,"stats":{"Line":3},"fn_name":"test_query_allowance"},{"line":2501,"address":[6242994,6242861,6243156],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2502,"address":[6242935],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2505,"address":[6243585,6243342],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2506,"address":[6243319],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2508,"address":[6243420],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2512,"address":[6243785,6243390],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2513,"address":[6243817],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2517,"address":[6244264,6244009],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2518,"address":[6244544,6244303],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2519,"address":[6244280],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2521,"address":[6244379],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2524,"address":[6244349,6244745],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2525,"address":[6244777],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2528,"address":[6244903,6244836],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2529,"address":[6244999,6244935],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2530,"address":[6245031],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2532,"address":[6245355,6245203],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2533,"address":[6245742,6245394],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2534,"address":[6245371],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2536,"address":[6245577],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2538,"address":[6245447],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2539,"address":[6245951,6246060,6246093],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2542,"address":[6246066],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2545,"address":[6246218],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2546,"address":[6246473,6246917],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2548,"address":[6247100],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2549,"address":[6246989],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2550,"address":[6247048],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2557,"address":[6247376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2560,"address":[6247495],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2561,"address":[6247750,6248194],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2563,"address":[6248377],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2564,"address":[6248266],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2565,"address":[6248325],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2572,"address":[6248653],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2573,"address":[6248712],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2574,"address":[6248771],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2576,"address":[6248946],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2577,"address":[6249098],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2578,"address":[6249318],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2579,"address":[6249395],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2581,"address":[6249495,6249620],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2584,"address":[6249583,6249667],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2585,"address":[6249699],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2586,"address":[6249758],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2588,"address":[6249933],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2589,"address":[6250085],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2590,"address":[6250305],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2591,"address":[6250382],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2593,"address":[6250482,6250607],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2596,"address":[6250654,6250570],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2597,"address":[6250686],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2598,"address":[6250745],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2600,"address":[6250920],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2601,"address":[6251072],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2602,"address":[6251292],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2603,"address":[6251369],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2605,"address":[6251580,6251469],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2609,"address":[6251952,6252207],"length":1,"stats":{"Line":3},"fn_name":"test_query_balance"},{"line":2610,"address":[6251959,6252060,6252222],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2611,"address":[6252001],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2614,"address":[6252393,6252630],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2615,"address":[6252376],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2617,"address":[6252471],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2621,"address":[6252441],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2624,"address":[6252910],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2625,"address":[6253165,6253609],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2627,"address":[6253792],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2628,"address":[6253681],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2629,"address":[6253740],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2636,"address":[6254068],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2637,"address":[6254127],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2639,"address":[6254229],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2640,"address":[6254381],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2641,"address":[6254644,6254508,6254611],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2644,"address":[6254617,6254677],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2645,"address":[6254709],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2647,"address":[6254811],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2648,"address":[6254963],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2649,"address":[6255183],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2650,"address":[6255260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2652,"address":[6255477,6255360],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2656,"address":[6255664,6255949],"length":1,"stats":{"Line":3},"fn_name":"test_query_transfer_history"},{"line":2657,"address":[6255677,6255964,6255802],"length":1,"stats":{"Line":3},"fn_name":null},{"line":2658,"address":[6255743],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2661,"address":[6256366,6256132],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2662,"address":[6256115],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2664,"address":[6256210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2668,"address":[6256180],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2671,"address":[6256646],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2672,"address":[6256901,6257085],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2675,"address":[6257118,6257058],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2676,"address":[6257150],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2679,"address":[6257298],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2680,"address":[6257553],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2681,"address":[6257817,6257679],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2683,"address":[6257790,6257850],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2684,"address":[6257882],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2687,"address":[6258030],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2688,"address":[6258285],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2689,"address":[6258411,6258549],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2691,"address":[6258522,6258582],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2692,"address":[6258614],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2695,"address":[6258762],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2696,"address":[6259017],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2697,"address":[6259143,6259281],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2700,"address":[6259254,6259314],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2701,"address":[6259346],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2705,"address":[6259498],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2708,"address":[6259650],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2709,"address":[6259870],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2710,"address":[6259996],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2712,"address":[6260239,6260167],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2715,"address":[6260272,6260212],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2716,"address":[6260304],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2720,"address":[6260456],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2721,"address":[6260608],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2722,"address":[6260828],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2723,"address":[6260954],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2725,"address":[6261298,6261125],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2728,"address":[6261261,6261350],"length":1,"stats":{"Line":2},"fn_name":null},{"line":2729,"address":[6261382],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2733,"address":[6261534],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2734,"address":[6261686],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2735,"address":[6261906],"length":1,"stats":{"Line":1},"fn_name":null},{"line":2736,"address":[6262032],"length":1,"stats":{"Line":0},"fn_name":null},{"line":2738,"address":[6262203,6262362],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":1133,"coverable":1243},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\nmod rand;\npub mod receiver;\npub mod state;\nmod utils;\nmod viewing_key;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","msg.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{Binary, HumanAddr, StdError, StdResult, Uint128};\n\nuse crate::state::Tx;\nuse crate::viewing_key::ViewingKey;\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct InitialBalance {\n    pub address: HumanAddr,\n    pub amount: Uint128,\n}\n\n#[derive(Serialize, Deserialize, JsonSchema)]\npub struct InitMsg {\n    pub name: String,\n    pub admin: Option\u003cHumanAddr\u003e,\n    pub symbol: String,\n    pub decimals: u8,\n    pub initial_balances: Option\u003cVec\u003cInitialBalance\u003e\u003e,\n    pub prng_seed: Binary,\n    pub config: Option\u003cInitConfig\u003e,\n}\n\nimpl InitMsg {\n    pub fn config(\u0026self) -\u003e InitConfig {\n        self.config.clone().unwrap_or_default()\n    }\n}\n\n/// This type represents optional configuration values which can be overridden.\n/// All values are optional and have defaults which are more private by default,\n/// but can be overridden if necessary\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Default, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub struct InitConfig {\n    /// Indicates whether the total supply is public or should be kept secret.\n    /// default: False\n    public_total_supply: Option\u003cbool\u003e,\n}\n\nimpl InitConfig {\n    pub fn public_total_supply(\u0026self) -\u003e bool {\n        self.public_total_supply.unwrap_or(false)\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    // Native coin interactions\n    Redeem {\n        amount: Uint128,\n        denom: Option\u003cString\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Deposit {\n        padding: Option\u003cString\u003e,\n    },\n\n    // Base ERC-20 stuff\n    Transfer {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    Send {\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    Burn {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    CreateViewingKey {\n        entropy: String,\n        padding: Option\u003cString\u003e,\n    },\n    SetViewingKey {\n        key: String,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        amount: Uint128,\n        expiration: Option\u003cu64\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    TransferFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    SendFrom {\n        owner: HumanAddr,\n        recipient: HumanAddr,\n        amount: Uint128,\n        msg: Option\u003cBinary\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    BurnFrom {\n        owner: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Mint\n    Mint {\n        recipient: HumanAddr,\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n    AddMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    RemoveMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n    SetMinters {\n        minters: Vec\u003cHumanAddr\u003e,\n        padding: Option\u003cString\u003e,\n    },\n\n    // Admin\n    ChangeAdmin {\n        address: HumanAddr,\n        padding: Option\u003cString\u003e,\n    },\n    SetContractStatus {\n        level: ContractStatusLevel,\n        padding: Option\u003cString\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleAnswer {\n    // Native\n    Deposit {\n        status: ResponseStatus,\n    },\n    Redeem {\n        status: ResponseStatus,\n    },\n\n    // Base\n    Transfer {\n        status: ResponseStatus,\n    },\n    Send {\n        status: ResponseStatus,\n    },\n    Burn {\n        status: ResponseStatus,\n    },\n    RegisterReceive {\n        status: ResponseStatus,\n    },\n    CreateViewingKey {\n        key: ViewingKey,\n    },\n    SetViewingKey {\n        status: ResponseStatus,\n    },\n\n    // Allowance\n    IncreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    DecreaseAllowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n    },\n    TransferFrom {\n        status: ResponseStatus,\n    },\n    SendFrom {\n        status: ResponseStatus,\n    },\n    BurnFrom {\n        status: ResponseStatus,\n    },\n\n    // Mint\n    Mint {\n        status: ResponseStatus,\n    },\n    AddMinters {\n        status: ResponseStatus,\n    },\n    RemoveMinters {\n        status: ResponseStatus,\n    },\n    SetMinters {\n        status: ResponseStatus,\n    },\n\n    // Other\n    ChangeAdmin {\n        status: ResponseStatus,\n    },\n    SetContractStatus {\n        status: ResponseStatus,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    TokenInfo {},\n    ExchangeRate {},\n    Allowance {\n        owner: HumanAddr,\n        spender: HumanAddr,\n        key: String,\n    },\n    Balance {\n        address: HumanAddr,\n        key: String,\n    },\n    TransferHistory {\n        address: HumanAddr,\n        key: String,\n        page: Option\u003cu32\u003e,\n        page_size: u32,\n    },\n    Minters {},\n}\n\nimpl QueryMsg {\n    pub fn get_validation_params(\u0026self) -\u003e (Vec\u003c\u0026HumanAddr\u003e, ViewingKey) {\n        match self {\n            Self::Balance { address, key } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::TransferHistory { address, key, .. } =\u003e (vec![address], ViewingKey(key.clone())),\n            Self::Allowance {\n                owner,\n                spender,\n                key,\n                ..\n            } =\u003e (vec![owner, spender], ViewingKey(key.clone())),\n            _ =\u003e panic!(\"This query type does not require authentication\"),\n        }\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryAnswer {\n    TokenInfo {\n        name: String,\n        symbol: String,\n        decimals: u8,\n        total_supply: Option\u003cUint128\u003e,\n    },\n    ExchangeRate {\n        rate: Uint128,\n        denom: String,\n    },\n    Allowance {\n        spender: HumanAddr,\n        owner: HumanAddr,\n        allowance: Uint128,\n        expiration: Option\u003cu64\u003e,\n    },\n    Balance {\n        amount: Uint128,\n    },\n    TransferHistory {\n        txs: Vec\u003cTx\u003e,\n    },\n\n    ViewingKeyError {\n        msg: String,\n    },\n    Minters {\n        minters: Vec\u003cHumanAddr\u003e,\n    },\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct CreateViewingKeyResponse {\n    pub key: String,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ResponseStatus {\n    Success,\n    Failure,\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub enum ContractStatusLevel {\n    NormalRun,\n    StopAllButRedeems,\n    StopAll,\n}\n\npub fn status_level_to_u8(status_level: ContractStatusLevel) -\u003e u8 {\n    match status_level {\n        ContractStatusLevel::NormalRun =\u003e 0,\n        ContractStatusLevel::StopAllButRedeems =\u003e 1,\n        ContractStatusLevel::StopAll =\u003e 2,\n    }\n}\n\npub fn u8_to_status_level(status_level: u8) -\u003e StdResult\u003cContractStatusLevel\u003e {\n    match status_level {\n        0 =\u003e Ok(ContractStatusLevel::NormalRun),\n        1 =\u003e Ok(ContractStatusLevel::StopAllButRedeems),\n        2 =\u003e Ok(ContractStatusLevel::StopAll),\n        _ =\u003e Err(StdError::generic_err(\"Invalid state level\")),\n    }\n}\n\n// Take a Vec\u003cu8\u003e and pad it up to a multiple of `block_size`, using spaces at the end.\npub fn space_pad(block_size: usize, message: \u0026mut Vec\u003cu8\u003e) -\u003e \u0026mut Vec\u003cu8\u003e {\n    let len = message.len();\n    let surplus = len % block_size;\n    if surplus == 0 {\n        return message;\n    }\n\n    let missing = block_size - surplus;\n    message.reserve(missing);\n    message.extend(std::iter::repeat(b' ').take(missing));\n    message\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::{from_slice, StdResult};\n\n    #[derive(Serialize, Deserialize, JsonSchema, Debug, PartialEq)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum Something {\n        Var { padding: Option\u003cString\u003e },\n    }\n\n    #[test]\n    fn test_deserialization_of_missing_option_fields() -\u003e StdResult\u003c()\u003e {\n        let input = b\"{ \\\"var\\\": {} }\";\n        let obj: Something = from_slice(input)?;\n        assert_eq!(\n            obj,\n            Something::Var { padding: None },\n            \"unexpected value: {:?}\",\n            obj\n        );\n        Ok(())\n    }\n}\n","traces":[{"line":27,"address":[3725536],"length":1,"stats":{"Line":6},"fn_name":"config"},{"line":28,"address":[3725545],"length":1,"stats":{"Line":2},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":45,"address":[3725593],"length":1,"stats":{"Line":6},"fn_name":null},{"line":252,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":253,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":258,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":259,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":262,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":321,"address":[979136],"length":1,"stats":{"Line":6},"fn_name":"status_level_to_u8"},{"line":322,"address":[979184,979191,979177],"length":1,"stats":{"Line":3},"fn_name":null},{"line":323,"address":[979179,979147],"length":1,"stats":{"Line":8},"fn_name":null},{"line":324,"address":[979186],"length":1,"stats":{"Line":1},"fn_name":null},{"line":325,"address":[979193],"length":1,"stats":{"Line":1},"fn_name":null},{"line":329,"address":[979216],"length":1,"stats":{"Line":2},"fn_name":"u8_to_status_level"},{"line":330,"address":[979315,979302,979328],"length":1,"stats":{"Line":6},"fn_name":null},{"line":331,"address":[979295,979240],"length":1,"stats":{"Line":6},"fn_name":null},{"line":332,"address":[979308],"length":1,"stats":{"Line":1},"fn_name":null},{"line":333,"address":[979321],"length":1,"stats":{"Line":1},"fn_name":null},{"line":334,"address":[979334,979266],"length":1,"stats":{"Line":0},"fn_name":null},{"line":339,"address":[979376],"length":1,"stats":{"Line":2},"fn_name":"space_pad"},{"line":340,"address":[979413],"length":1,"stats":{"Line":2},"fn_name":null},{"line":341,"address":[979478,979434],"length":1,"stats":{"Line":2},"fn_name":null},{"line":342,"address":[979470],"length":1,"stats":{"Line":2},"fn_name":null},{"line":343,"address":[979513],"length":1,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[979533,979571],"length":1,"stats":{"Line":2},"fn_name":null},{"line":347,"address":[979563],"length":1,"stats":{"Line":2},"fn_name":null},{"line":348,"address":[979601],"length":1,"stats":{"Line":2},"fn_name":null},{"line":349,"address":[979671],"length":1,"stats":{"Line":2},"fn_name":null},{"line":364,"address":[2521625,2521616],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":365,"address":[2589857],"length":1,"stats":{"Line":1},"fn_name":null},{"line":366,"address":[2589872,2590069],"length":1,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[2590159,2590228,2589991],"length":1,"stats":{"Line":2},"fn_name":null},{"line":373,"address":[2590209],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":32,"coverable":40},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","rand.rs"],"content":"use rand_chacha::ChaChaRng;\nuse rand_core::{RngCore, SeedableRng};\n\nuse sha2::{Digest, Sha256};\n\npub fn sha_256(data: \u0026[u8]) -\u003e [u8; 32] {\n    let mut hasher = Sha256::new();\n    hasher.update(data);\n    let hash = hasher.finalize();\n\n    let mut result = [0u8; 32];\n    result.copy_from_slice(hash.as_slice());\n    result\n}\n\npub struct Prng {\n    rng: ChaChaRng,\n}\n\nimpl Prng {\n    pub fn new(seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        let mut hasher = Sha256::new();\n\n        // write input message\n        hasher.update(\u0026seed);\n        hasher.update(\u0026entropy);\n        let hash = hasher.finalize();\n\n        let mut hash_bytes = [0u8; 32];\n        hash_bytes.copy_from_slice(hash.as_slice());\n\n        let rng: ChaChaRng = ChaChaRng::from_seed(hash_bytes);\n\n        Self { rng }\n    }\n\n    pub fn rand_bytes(\u0026mut self) -\u003e [u8; 32] {\n        let mut bytes = [0u8; 32];\n        self.rng.fill_bytes(\u0026mut bytes);\n\n        bytes\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    /// This test checks that the rng is stateful and generates\n    /// different random bytes every time it is called.\n    #[test]\n    fn test_rng() {\n        let mut rng = Prng::new(b\"foo\", b\"bar!\");\n        let r1: [u8; 32] = [\n            155, 11, 21, 97, 252, 65, 160, 190, 100, 126, 85, 251, 47, 73, 160, 49, 216, 182, 93,\n            30, 185, 67, 166, 22, 34, 10, 213, 112, 21, 136, 49, 214,\n        ];\n        let r2: [u8; 32] = [\n            46, 135, 19, 242, 111, 125, 59, 215, 114, 130, 122, 155, 202, 23, 36, 118, 83, 11, 6,\n            180, 97, 165, 218, 136, 134, 243, 191, 191, 149, 178, 7, 149,\n        ];\n        let r3: [u8; 32] = [\n            9, 2, 131, 50, 199, 170, 6, 68, 168, 28, 242, 182, 35, 114, 15, 163, 65, 139, 101, 221,\n            207, 147, 119, 110, 81, 195, 6, 134, 14, 253, 245, 244,\n        ];\n        let r4: [u8; 32] = [\n            68, 196, 114, 205, 225, 64, 201, 179, 18, 77, 216, 197, 211, 13, 21, 196, 11, 102, 106,\n            195, 138, 250, 29, 185, 51, 38, 183, 0, 5, 169, 65, 190,\n        ];\n        assert_eq!(r1, rng.rand_bytes());\n        assert_eq!(r2, rng.rand_bytes());\n        assert_eq!(r3, rng.rand_bytes());\n        assert_eq!(r4, rng.rand_bytes());\n    }\n}\n","traces":[{"line":6,"address":[1228576],"length":1,"stats":{"Line":6},"fn_name":"sha_256"},{"line":7,"address":[1228619],"length":1,"stats":{"Line":2},"fn_name":null},{"line":8,"address":[735631],"length":1,"stats":{"Line":6},"fn_name":null},{"line":9,"address":[1228651],"length":1,"stats":{"Line":2},"fn_name":null},{"line":11,"address":[735690],"length":1,"stats":{"Line":6},"fn_name":null},{"line":12,"address":[1228722],"length":1,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[735776],"length":1,"stats":{"Line":1},"fn_name":"new"},{"line":22,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[1228848],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[1228909],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":32,"address":[1228992],"length":1,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[6371632,6371637],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":53,"address":[6561431],"length":1,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[6561466],"length":1,"stats":{"Line":1},"fn_name":null},{"line":58,"address":[6561722],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[6561978],"length":1,"stats":{"Line":1},"fn_name":null},{"line":66,"address":[6562234],"length":1,"stats":{"Line":1},"fn_name":null},{"line":70,"address":[6562490,6562631],"length":1,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[6562798,6562675,6562601],"length":1,"stats":{"Line":2},"fn_name":null},{"line":72,"address":[6562768,6562965,6562842],"length":1,"stats":{"Line":2},"fn_name":null},{"line":73,"address":[6563118,6562935,6563009],"length":1,"stats":{"Line":2},"fn_name":null}],"covered":27,"coverable":28},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","receiver.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{to_binary, Binary, CosmosMsg, HumanAddr, StdResult, Uint128, WasmMsg};\n\nuse crate::{contract::RESPONSE_BLOCK_SIZE, msg::space_pad};\n\n/// Snip20ReceiveMsg should be de/serialized under `Receive()` variant in a HandleMsg\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\npub struct Snip20ReceiveMsg {\n    pub sender: HumanAddr,\n    pub from: HumanAddr,\n    pub amount: Uint128,\n    pub msg: Option\u003cBinary\u003e,\n}\n\nimpl Snip20ReceiveMsg {\n    pub fn new(sender: HumanAddr, from: HumanAddr, amount: Uint128, msg: Option\u003cBinary\u003e) -\u003e Self {\n        Self {\n            sender,\n            from,\n            amount,\n            msg,\n        }\n    }\n\n    /// serializes the message, and pads it to 256 bytes\n    pub fn into_binary(self) -\u003e StdResult\u003cBinary\u003e {\n        let msg = ReceiverHandleMsg::Receive(self);\n        let mut data = to_binary(\u0026msg)?;\n        space_pad(RESPONSE_BLOCK_SIZE, \u0026mut data.0);\n        Ok(data)\n    }\n\n    /// creates a cosmos_msg sending this struct to the named contract\n    pub fn into_cosmos_msg(\n        self,\n        callback_code_hash: String,\n        contract_addr: HumanAddr,\n    ) -\u003e StdResult\u003cCosmosMsg\u003e {\n        let msg = self.into_binary()?;\n        let execute = WasmMsg::Execute {\n            msg,\n            callback_code_hash,\n            contract_addr,\n            send: vec![],\n        };\n        Ok(execute.into())\n    }\n}\n\n// This is just a helper to properly serialize the above message\n#[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema, Debug)]\n#[serde(rename_all = \"snake_case\")]\nenum ReceiverHandleMsg {\n    Receive(Snip20ReceiveMsg),\n}\n","traces":[{"line":19,"address":[1291120],"length":1,"stats":{"Line":1},"fn_name":"new"},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[3908176],"length":1,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":2},"fn_name":null}],"covered":10,"coverable":10},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","state.rs"],"content":"use std::any::type_name;\nuse std::convert::TryFrom;\n\nuse cosmwasm_std::{\n    Api, CanonicalAddr, Coin, HumanAddr, ReadonlyStorage, StdError, StdResult, Storage, Uint128,\n};\nuse cosmwasm_storage::{PrefixedStorage, ReadonlyPrefixedStorage};\n\nuse secret_toolkit::storage::{AppendStore, AppendStoreMut, TypedStore, TypedStoreMut};\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse crate::msg::{status_level_to_u8, u8_to_status_level, ContractStatusLevel};\nuse crate::viewing_key::ViewingKey;\nuse serde::de::DeserializeOwned;\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\npub const PREFIX_TXS: \u0026[u8] = b\"transfers\";\n\npub const KEY_CONSTANTS: \u0026[u8] = b\"constants\";\npub const KEY_TOTAL_SUPPLY: \u0026[u8] = b\"total_supply\";\npub const KEY_CONTRACT_STATUS: \u0026[u8] = b\"contract_status\";\npub const KEY_MINTERS: \u0026[u8] = b\"minters\";\npub const KEY_TX_COUNT: \u0026[u8] = b\"tx-count\";\n\npub const PREFIX_CONFIG: \u0026[u8] = b\"config\";\npub const PREFIX_BALANCES: \u0026[u8] = b\"balances\";\npub const PREFIX_ALLOWANCES: \u0026[u8] = b\"allowances\";\npub const PREFIX_VIEW_KEY: \u0026[u8] = b\"viewingkey\";\npub const PREFIX_RECEIVERS: \u0026[u8] = b\"receivers\";\n\n// Note that id is a globally incrementing counter.\n// Since it's 64 bits long, even at 50 tx/s it would take\n// over 11 billion years for it to rollback. I'm pretty sure\n// we'll have bigger issues by then.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct Tx {\n    pub id: u64,\n    pub from: HumanAddr,\n    pub sender: HumanAddr,\n    pub receiver: HumanAddr,\n    pub coins: Coin,\n}\n\nimpl Tx {\n    pub fn into_stored\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cStoredTx\u003e {\n        let tx = StoredTx {\n            id: self.id,\n            from: api.canonical_address(\u0026self.from)?,\n            sender: api.canonical_address(\u0026self.sender)?,\n            receiver: api.canonical_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug)]\npub struct StoredTx {\n    pub id: u64,\n    pub from: CanonicalAddr,\n    pub sender: CanonicalAddr,\n    pub receiver: CanonicalAddr,\n    pub coins: Coin,\n}\n\nimpl StoredTx {\n    pub fn into_humanized\u003cA: Api\u003e(self, api: \u0026A) -\u003e StdResult\u003cTx\u003e {\n        let tx = Tx {\n            id: self.id,\n            from: api.human_address(\u0026self.from)?,\n            sender: api.human_address(\u0026self.sender)?,\n            receiver: api.human_address(\u0026self.receiver)?,\n            coins: self.coins,\n        };\n        Ok(tx)\n    }\n}\n\npub fn store_transfer\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    sender: \u0026CanonicalAddr,\n    receiver: \u0026CanonicalAddr,\n    amount: Uint128,\n    denom: String,\n) -\u003e StdResult\u003c()\u003e {\n    let mut config = Config::from_storage(store);\n    let id = config.tx_count() + 1;\n    config.set_tx_count(id)?;\n\n    let coins = Coin { denom, amount };\n    let tx = StoredTx {\n        id,\n        from: owner.clone(),\n        sender: sender.clone(),\n        receiver: receiver.clone(),\n        coins,\n    };\n\n    if owner != sender {\n        append_tx(store, tx.clone(), \u0026owner)?;\n    }\n    append_tx(store, tx.clone(), \u0026sender)?;\n    append_tx(store, tx, \u0026receiver)?;\n\n    Ok(())\n}\n\nfn append_tx\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    tx: StoredTx,\n    for_address: \u0026CanonicalAddr,\n) -\u003e StdResult\u003c()\u003e {\n    let mut store = PrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], store);\n    let mut store = AppendStoreMut::attach_or_create(\u0026mut store)?;\n    store.push(\u0026tx)\n}\n\npub fn get_transfers\u003cA: Api, S: ReadonlyStorage\u003e(\n    api: \u0026A,\n    storage: \u0026S,\n    for_address: \u0026CanonicalAddr,\n    page: u32,\n    page_size: u32,\n) -\u003e StdResult\u003cVec\u003cTx\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_TXS, for_address.as_slice()], storage);\n\n    // Try to access the storage of txs for the account.\n    // If it doesn't exist yet, return an empty list of transfers.\n    let store = if let Some(result) = AppendStore::\u003cStoredTx, _\u003e::attach(\u0026store) {\n        result?\n    } else {\n        return Ok(vec![]);\n    };\n\n    // Take `page_size` txs starting from the latest tx, potentially skipping `page * page_size`\n    // txs from the start.\n    let tx_iter = store\n        .iter()\n        .rev()\n        .skip((page * page_size) as _)\n        .take(page_size as _);\n    // The `and_then` here flattens the `StdResult\u003cStdResult\u003cTx\u003e\u003e` to an `StdResult\u003cTx\u003e`\n    let txs: StdResult\u003cVec\u003cTx\u003e\u003e = tx_iter\n        .map(|tx| tx.map(|tx| tx.into_humanized(api)).and_then(|x| x))\n        .collect();\n    txs\n}\n\n// Config\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, JsonSchema)]\npub struct Constants {\n    pub name: String,\n    pub admin: HumanAddr,\n    pub symbol: String,\n    pub decimals: u8,\n    pub prng_seed: Vec\u003cu8\u003e,\n    // privacy configuration\n    pub total_supply_is_public: bool,\n}\n\npub struct ReadonlyConfig\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfig\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n}\n\nfn set_bin_data\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, key: \u0026[u8], data: \u0026T) -\u003e StdResult\u003c()\u003e {\n    let bin_data =\n        bincode2::serialize(\u0026data).map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?;\n\n    storage.set(key, \u0026bin_data);\n    Ok(())\n}\n\nfn get_bin_data\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cT\u003e {\n    let bin_data = storage.get(key);\n\n    match bin_data {\n        None =\u003e Err(StdError::not_found(\"Key not found in storage\")),\n        Some(bin_data) =\u003e Ok(bincode2::deserialize::\u003cT\u003e(\u0026bin_data)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cT\u003e(), e))?),\n    }\n}\n\npub struct Config\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Config\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_CONFIG, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyConfigImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyConfigImpl(\u0026self.storage)\n    }\n\n    pub fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        self.as_readonly().constants()\n    }\n\n    pub fn set_constants(\u0026mut self, constants: \u0026Constants) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_CONSTANTS, constants)\n    }\n\n    pub fn total_supply(\u0026self) -\u003e u128 {\n        self.as_readonly().total_supply()\n    }\n\n    pub fn set_total_supply(\u0026mut self, supply: u128) {\n        self.storage.set(KEY_TOTAL_SUPPLY, \u0026supply.to_be_bytes());\n    }\n\n    pub fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        self.as_readonly().contract_status()\n    }\n\n    pub fn set_contract_status(\u0026mut self, status: ContractStatusLevel) {\n        let status_u8 = status_level_to_u8(status);\n        self.storage\n            .set(KEY_CONTRACT_STATUS, \u0026status_u8.to_be_bytes());\n    }\n\n    pub fn set_minters(\u0026mut self, minters_to_set: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_MINTERS, \u0026minters_to_set)\n    }\n\n    pub fn add_minters(\u0026mut self, minters_to_add: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n        minters.extend(minters_to_add);\n\n        self.set_minters(minters)\n    }\n\n    pub fn remove_minters(\u0026mut self, minters_to_remove: Vec\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n        let mut minters = self.minters();\n\n        for minter in minters_to_remove {\n            minters.retain(|x| x != \u0026minter);\n        }\n\n        self.set_minters(minters)\n    }\n\n    pub fn minters(\u0026mut self) -\u003e Vec\u003cHumanAddr\u003e {\n        self.as_readonly().minters()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        self.as_readonly().tx_count()\n    }\n\n    pub fn set_tx_count(\u0026mut self, count: u64) -\u003e StdResult\u003c()\u003e {\n        set_bin_data(\u0026mut self.storage, KEY_TX_COUNT, \u0026count)\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Config` and `ReadonlyConfig`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyConfigImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyConfigImpl\u003c'a, S\u003e {\n    fn constants(\u0026self) -\u003e StdResult\u003cConstants\u003e {\n        let consts_bytes = self\n            .0\n            .get(KEY_CONSTANTS)\n            .ok_or_else(|| StdError::generic_err(\"no constants stored in configuration\"))?;\n        bincode2::deserialize::\u003cConstants\u003e(\u0026consts_bytes)\n            .map_err(|e| StdError::serialize_err(type_name::\u003cConstants\u003e(), e))\n    }\n\n    fn total_supply(\u0026self) -\u003e u128 {\n        let supply_bytes = self\n            .0\n            .get(KEY_TOTAL_SUPPLY)\n            .expect(\"no total supply stored in config\");\n        // This unwrap is ok because we know we stored things correctly\n        slice_to_u128(\u0026supply_bytes).unwrap()\n    }\n\n    fn contract_status(\u0026self) -\u003e ContractStatusLevel {\n        let supply_bytes = self\n            .0\n            .get(KEY_CONTRACT_STATUS)\n            .expect(\"no contract status stored in config\");\n\n        // These unwraps are ok because we know we stored things correctly\n        let status = slice_to_u8(\u0026supply_bytes).unwrap();\n        u8_to_status_level(status).unwrap()\n    }\n\n    fn minters(\u0026self) -\u003e Vec\u003cHumanAddr\u003e {\n        get_bin_data(self.0, KEY_MINTERS).unwrap()\n    }\n\n    pub fn tx_count(\u0026self) -\u003e u64 {\n        get_bin_data(self.0, KEY_TX_COUNT).unwrap_or_default()\n    }\n}\n\n// Balances\n\npub struct ReadonlyBalances\u003c'a, S: ReadonlyStorage\u003e {\n    storage: ReadonlyPrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a S) -\u003e Self {\n        Self {\n            storage: ReadonlyPrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cReadonlyPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n}\n\npub struct Balances\u003c'a, S: Storage\u003e {\n    storage: PrefixedStorage\u003c'a, S\u003e,\n}\n\nimpl\u003c'a, S: Storage\u003e Balances\u003c'a, S\u003e {\n    pub fn from_storage(storage: \u0026'a mut S) -\u003e Self {\n        Self {\n            storage: PrefixedStorage::new(PREFIX_BALANCES, storage),\n        }\n    }\n\n    fn as_readonly(\u0026self) -\u003e ReadonlyBalancesImpl\u003cPrefixedStorage\u003cS\u003e\u003e {\n        ReadonlyBalancesImpl(\u0026self.storage)\n    }\n\n    pub fn balance(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        self.as_readonly().account_amount(account)\n    }\n\n    pub fn set_account_balance(\u0026mut self, account: \u0026CanonicalAddr, amount: u128) {\n        self.storage.set(account.as_slice(), \u0026amount.to_be_bytes())\n    }\n}\n\n/// This struct refactors out the readonly methods that we need for `Balances` and `ReadonlyBalances`\n/// in a way that is generic over their mutability.\n///\n/// This was the only way to prevent code duplication of these methods because of the way\n/// that `ReadonlyPrefixedStorage` and `PrefixedStorage` are implemented in `cosmwasm-std`\nstruct ReadonlyBalancesImpl\u003c'a, S: ReadonlyStorage\u003e(\u0026'a S);\n\nimpl\u003c'a, S: ReadonlyStorage\u003e ReadonlyBalancesImpl\u003c'a, S\u003e {\n    pub fn account_amount(\u0026self, account: \u0026CanonicalAddr) -\u003e u128 {\n        let account_bytes = account.as_slice();\n        let result = self.0.get(account_bytes);\n        match result {\n            // This unwrap is ok because we know we stored things correctly\n            Some(balance_bytes) =\u003e slice_to_u128(\u0026balance_bytes).unwrap(),\n            None =\u003e 0,\n        }\n    }\n}\n\n// Allowances\n\n#[derive(Serialize, Debug, Deserialize, Clone, PartialEq, Default, JsonSchema)]\npub struct Allowance {\n    pub amount: u128,\n    pub expiration: Option\u003cu64\u003e,\n}\n\npub fn read_allowance\u003cS: Storage\u003e(\n    store: \u0026S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n) -\u003e StdResult\u003cAllowance\u003e {\n    let owner_store =\n        ReadonlyPrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let owner_store = TypedStore::attach(\u0026owner_store);\n    let allowance = owner_store.may_load(spender.as_slice());\n    allowance.map(Option::unwrap_or_default)\n}\n\npub fn write_allowance\u003cS: Storage\u003e(\n    store: \u0026mut S,\n    owner: \u0026CanonicalAddr,\n    spender: \u0026CanonicalAddr,\n    allowance: Allowance,\n) -\u003e StdResult\u003c()\u003e {\n    let mut owner_store =\n        PrefixedStorage::multilevel(\u0026[PREFIX_ALLOWANCES, owner.as_slice()], store);\n    let mut owner_store = TypedStoreMut::attach(\u0026mut owner_store);\n\n    owner_store.store(spender.as_slice(), \u0026allowance)\n}\n\n// Viewing Keys\n\npub fn write_viewing_key\u003cS: Storage\u003e(store: \u0026mut S, owner: \u0026CanonicalAddr, key: \u0026ViewingKey) {\n    let mut balance_store = PrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.set(owner.as_slice(), \u0026key.to_hashed());\n}\n\npub fn read_viewing_key\u003cS: Storage\u003e(store: \u0026S, owner: \u0026CanonicalAddr) -\u003e Option\u003cVec\u003cu8\u003e\u003e {\n    let balance_store = ReadonlyPrefixedStorage::new(PREFIX_VIEW_KEY, store);\n    balance_store.get(owner.as_slice())\n}\n\n// Receiver Interface\n\npub fn get_receiver_hash\u003cS: ReadonlyStorage\u003e(\n    store: \u0026S,\n    account: \u0026HumanAddr,\n) -\u003e Option\u003cStdResult\u003cString\u003e\u003e {\n    let store = ReadonlyPrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.get(account.as_str().as_bytes()).map(|data| {\n        String::from_utf8(data)\n            .map_err(|_err| StdError::invalid_utf8(\"stored code hash was not a valid String\"))\n    })\n}\n\npub fn set_receiver_hash\u003cS: Storage\u003e(store: \u0026mut S, account: \u0026HumanAddr, code_hash: String) {\n    let mut store = PrefixedStorage::new(PREFIX_RECEIVERS, store);\n    store.set(account.as_str().as_bytes(), code_hash.as_bytes());\n}\n\n// Helpers\n\n/// Converts 16 bytes value into u128\n/// Errors if data found that is not 16 bytes\nfn slice_to_u128(data: \u0026[u8]) -\u003e StdResult\u003cu128\u003e {\n    match \u003c[u8; 16]\u003e::try_from(data) {\n        Ok(bytes) =\u003e Ok(u128::from_be_bytes(bytes)),\n        Err(_) =\u003e Err(StdError::generic_err(\n            \"Corrupted data found. 16 byte expected.\",\n        )),\n    }\n}\n\n/// Converts 1 byte value into u8\n/// Errors if data found that is not 1 byte\nfn slice_to_u8(data: \u0026[u8]) -\u003e StdResult\u003cu8\u003e {\n    if data.len() == 1 {\n        Ok(data[0])\n    } else {\n        Err(StdError::generic_err(\n            \"Corrupted data found. 1 byte expected.\",\n        ))\n    }\n}\n","traces":[{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":77,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":81,"address":[3981776,3984340],"length":1,"stats":{"Line":1},"fn_name":"store_transfer\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":89,"address":[3981884],"length":1,"stats":{"Line":1},"fn_name":null},{"line":90,"address":[3981933,3982051,3982079,3981994],"length":1,"stats":{"Line":3},"fn_name":null},{"line":91,"address":[3982072,3982499,3982290,3982127],"length":1,"stats":{"Line":2},"fn_name":null},{"line":93,"address":[3982175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[3982262],"length":1,"stats":{"Line":1},"fn_name":null},{"line":97,"address":[3982541],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[3982602],"length":1,"stats":{"Line":1},"fn_name":null},{"line":102,"address":[3982996,3983106,3982949,3982891],"length":1,"stats":{"Line":4},"fn_name":null},{"line":103,"address":[3983017,3983325,3983116],"length":1,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[3983387,3983868,3983656],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[3983911,3983992,3983484,3984204],"length":1,"stats":{"Line":2},"fn_name":null},{"line":108,"address":[3983949],"length":1,"stats":{"Line":1},"fn_name":null},{"line":111,"address":[3985023,3985038,3984368],"length":1,"stats":{"Line":1},"fn_name":"append_tx\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":116,"address":[3984424],"length":1,"stats":{"Line":1},"fn_name":null},{"line":117,"address":[3984949,3984730,3984633,3984569],"length":1,"stats":{"Line":2},"fn_name":null},{"line":118,"address":[3984715],"length":1,"stats":{"Line":1},"fn_name":null},{"line":121,"address":[3986456,3985040,3986441],"length":1,"stats":{"Line":1},"fn_name":"get_transfers\u003ccosmwasm_std::mock::MockApi,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":128,"address":[3985122],"length":1,"stats":{"Line":1},"fn_name":null},{"line":132,"address":[3985231,3985321],"length":1,"stats":{"Line":2},"fn_name":null},{"line":133,"address":[3985718,3985425,3985821],"length":1,"stats":{"Line":2},"fn_name":null},{"line":135,"address":[3985555],"length":1,"stats":{"Line":0},"fn_name":null},{"line":140,"address":[3985806,3986281,3986166,3986218],"length":1,"stats":{"Line":4},"fn_name":null},{"line":143,"address":[3986225,3986181],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[3986261],"length":1,"stats":{"Line":1},"fn_name":null},{"line":146,"address":[3986349,3986288],"length":1,"stats":{"Line":2},"fn_name":null},{"line":147,"address":[3986560,3986592,3986633,3986341,3986572,3986464,3986507],"length":1,"stats":{"Line":7},"fn_name":"{{closure}}\u003ccosmwasm_std::mock::MockApi,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":149,"address":[3986408],"length":1,"stats":{"Line":1},"fn_name":null},{"line":170,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":172,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":176,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":177,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":180,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":185,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":188,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":189,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":192,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":193,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":196,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":197,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":201,"address":[3987546,3987531,3987947,3987962,3987968,3987136,3987552,3988363,3988378],"length":1,"stats":{"Line":9},"fn_name":"set_bin_data\u003csnip20_reference_impl::state::Constants,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":202,"address":[3987197,3987613,3987770,3988186,3988690,3988546,3988402,3987354,3988029,3988672,3988528,3988384],"length":1,"stats":{"Line":9},"fn_name":"{{closure}}\u003csnip20_reference_impl::state::Constants,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":205,"address":[3988296,3987880,3987323,3987739,3988155,3987464],"length":1,"stats":{"Line":18},"fn_name":null},{"line":206,"address":[3987927,3987511,3988343],"length":1,"stats":{"Line":9},"fn_name":null},{"line":209,"address":[3991047,3988816,3990254,3989600,3990336,3989527],"length":1,"stats":{"Line":2},"fn_name":"get_bin_data\u003calloc::vec::Vec\u003ccosmwasm_std::addresses::HumanAddr, alloc::alloc::Global\u003e,cosmwasm_storage::prefixed_storage::ReadonlyPrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":210,"address":[3988857,3989641,3990377],"length":1,"stats":{"Line":2},"fn_name":null},{"line":212,"address":[3989595,3989671,3989597,3990322,3990324,3988887,3990407,3991115,3991117],"length":1,"stats":{"Line":1},"fn_name":null},{"line":213,"address":[3989651,3990291,3988889,3989673,3990409,3989564,3991084,3988867,3990387],"length":1,"stats":{"Line":4},"fn_name":null},{"line":214,"address":[3989946,3990436,3989057,3989477,3990627,3988916,3990577,3989843,3990997,3989700,3989107,3990204],"length":1,"stats":{"Line":4},"fn_name":null},{"line":215,"address":[3990607,3989793,3991138,3991408,3991264,3989087,3990520,3989484,3989929,3991426,3989980,3991120,3989000,3991282,3991004,3990211,3990773,3989253],"length":1,"stats":{"Line":4},"fn_name":"{{closure}}\u003calloc::vec::Vec\u003ccosmwasm_std::addresses::HumanAddr, alloc::alloc::Global\u003e,cosmwasm_storage::prefixed_storage::PrefixedStorage\u003ccosmwasm_std::storage::MemoryStorage\u003e\u003e"},{"line":224,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":226,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":230,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":234,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":235,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":238,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":239,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":242,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":243,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":246,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":247,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":250,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":251,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":254,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":255,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":256,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":257,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":260,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":261,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":264,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":265,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":266,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":268,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":271,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":272,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":274,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":275,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":278,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":281,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":282,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":285,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":286,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":289,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":290,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":302,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":303,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":304,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":305,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":306,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":307,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":308,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":311,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":312,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":313,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":314,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":317,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":320,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":321,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":322,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":323,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":327,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":328,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":331,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":332,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":335,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":336,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":347,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":349,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":353,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":354,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":357,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":358,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":367,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":369,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":373,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":374,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":377,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":378,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":381,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":382,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":394,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":395,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":396,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":397,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":399,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":400,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":413,"address":[3997120,3997538],"length":1,"stats":{"Line":1},"fn_name":"read_allowance\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":418,"address":[3997184],"length":1,"stats":{"Line":1},"fn_name":null},{"line":420,"address":[3997280],"length":1,"stats":{"Line":2},"fn_name":null},{"line":421,"address":[3997313,3997403],"length":1,"stats":{"Line":4},"fn_name":null},{"line":422,"address":[3997415],"length":1,"stats":{"Line":2},"fn_name":null},{"line":425,"address":[3997872,3997568],"length":1,"stats":{"Line":1},"fn_name":"write_allowance\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":431,"address":[3997637],"length":1,"stats":{"Line":1},"fn_name":null},{"line":433,"address":[3997733],"length":1,"stats":{"Line":1},"fn_name":null},{"line":435,"address":[3997853,3997766],"length":1,"stats":{"Line":2},"fn_name":null},{"line":440,"address":[3998110,3997904],"length":1,"stats":{"Line":2},"fn_name":"write_viewing_key\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":441,"address":[3997942],"length":1,"stats":{"Line":2},"fn_name":null},{"line":442,"address":[3998091,3997969],"length":1,"stats":{"Line":4},"fn_name":null},{"line":445,"address":[3998144,3998295],"length":1,"stats":{"Line":1},"fn_name":"read_viewing_key\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":446,"address":[3998176],"length":1,"stats":{"Line":1},"fn_name":null},{"line":447,"address":[3998203],"length":1,"stats":{"Line":1},"fn_name":null},{"line":452,"address":[3998320,3998572],"length":1,"stats":{"Line":1},"fn_name":"get_receiver_hash\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":456,"address":[3998358],"length":1,"stats":{"Line":1},"fn_name":null},{"line":457,"address":[3998385,3998536,3998720],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":458,"address":[3998734],"length":1,"stats":{"Line":1},"fn_name":null},{"line":459,"address":[3998624,3998608],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":463,"address":[3999136,3998800],"length":1,"stats":{"Line":1},"fn_name":"set_receiver_hash\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":464,"address":[3998833],"length":1,"stats":{"Line":1},"fn_name":null},{"line":465,"address":[3999056,3998862],"length":1,"stats":{"Line":2},"fn_name":null},{"line":472,"address":[1279104],"length":1,"stats":{"Line":1},"fn_name":"slice_to_u128"},{"line":473,"address":[1279314,1279161,1279312,1279137],"length":1,"stats":{"Line":2},"fn_name":null},{"line":474,"address":[1279148,1279297,1279163],"length":1,"stats":{"Line":3},"fn_name":null},{"line":475,"address":[1279210],"length":1,"stats":{"Line":0},"fn_name":null},{"line":483,"address":[1279328],"length":1,"stats":{"Line":4},"fn_name":"slice_to_u8"},{"line":484,"address":[1279387,1279514],"length":1,"stats":{"Line":6},"fn_name":null},{"line":485,"address":[1279521,1279414,1279506,1279543],"length":1,"stats":{"Line":6},"fn_name":null},{"line":487,"address":[1279428],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":150,"coverable":174},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","utils.rs"],"content":"use crate::viewing_key::VIEWING_KEY_SIZE;\nuse sha2::{Digest, Sha256};\nuse std::convert::TryInto;\nuse subtle::ConstantTimeEq;\n\npub fn ct_slice_compare(s1: \u0026[u8], s2: \u0026[u8]) -\u003e bool {\n    bool::from(s1.ct_eq(s2))\n}\n\npub fn create_hashed_password(s1: \u0026str) -\u003e [u8; VIEWING_KEY_SIZE] {\n    Sha256::digest(s1.as_bytes())\n        .as_slice()\n        .try_into()\n        .expect(\"Wrong password length\")\n}\n","traces":[{"line":6,"address":[1229520],"length":1,"stats":{"Line":1},"fn_name":"ct_slice_compare"},{"line":7,"address":[1229544],"length":1,"stats":{"Line":1},"fn_name":null},{"line":10,"address":[1229584],"length":1,"stats":{"Line":1},"fn_name":"create_hashed_password"},{"line":11,"address":[1229682],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":4,"coverable":4},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","src","viewing_key.rs"],"content":"use std::fmt;\n\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::Env;\n\nuse crate::rand::{sha_256, Prng};\nuse crate::utils::{create_hashed_password, ct_slice_compare};\n\npub const VIEWING_KEY_SIZE: usize = 32;\npub const VIEWING_KEY_PREFIX: \u0026str = \"api_key_\";\n\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug)]\npub struct ViewingKey(pub String);\n\nimpl ViewingKey {\n    pub fn check_viewing_key(\u0026self, hashed_pw: \u0026[u8]) -\u003e bool {\n        let mine_hashed = create_hashed_password(\u0026self.0);\n\n        ct_slice_compare(\u0026mine_hashed, hashed_pw)\n    }\n\n    pub fn new(env: \u0026Env, seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        // 16 here represents the lengths in bytes of the block height and time.\n        let entropy_len = 16 + env.message.sender.len() + entropy.len();\n        let mut rng_entropy = Vec::with_capacity(entropy_len);\n        rng_entropy.extend_from_slice(\u0026env.block.height.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.block.time.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.message.sender.0.as_bytes());\n        rng_entropy.extend_from_slice(entropy);\n\n        let mut rng = Prng::new(seed, \u0026rng_entropy);\n\n        let rand_slice = rng.rand_bytes();\n\n        let key = sha_256(\u0026rand_slice);\n\n        Self(VIEWING_KEY_PREFIX.to_string() + \u0026base64::encode(key))\n    }\n\n    pub fn to_hashed(\u0026self) -\u003e [u8; VIEWING_KEY_SIZE] {\n        create_hashed_password(\u0026self.0)\n    }\n\n    pub fn as_bytes(\u0026self) -\u003e \u0026[u8] {\n        self.0.as_bytes()\n    }\n}\n\nimpl fmt::Display for ViewingKey {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":19,"address":[1180781],"length":1,"stats":{"Line":1},"fn_name":null},{"line":21,"address":[1180826],"length":1,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[1181769,1180864],"length":1,"stats":{"Line":1},"fn_name":"new"},{"line":26,"address":[6376701,6376544],"length":1,"stats":{"Line":1},"fn_name":null},{"line":27,"address":[1181101],"length":1,"stats":{"Line":1},"fn_name":null},{"line":28,"address":[6376736],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":31,"address":[1181460],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[1182032],"length":1,"stats":{"Line":2},"fn_name":"to_hashed"},{"line":43,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":16,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","contract.rs"],"content":"use cosmwasm_std::{\n    from_binary, to_binary, Api, BankMsg, Binary, Coin, Context, CosmosMsg, Env, Extern,\n    HandleResponse, HumanAddr, InitResponse, Querier, StdError, StdResult, Storage, Uint128,\n    WasmMsg,\n};\n\nuse crate::msg::{CountResponse, HandleMsg, InitMsg, QueryMsg, Snip20Msg};\nuse crate::state::{config, config_read, State};\n\npub fn init\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: InitMsg,\n) -\u003e StdResult\u003cInitResponse\u003e {\n    let state = State {\n        count: msg.count,\n        owner: deps.api.canonical_address(\u0026env.message.sender)?,\n        known_snip_20: vec![],\n    };\n\n    config(\u0026mut deps.storage).save(\u0026state)?;\n\n    Ok(InitResponse::default())\n}\n\npub fn handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: HandleMsg,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        HandleMsg::Increment {} =\u003e try_increment(deps, env),\n        HandleMsg::Reset { count } =\u003e try_reset(deps, env, count),\n        HandleMsg::Register { reg_addr, reg_hash } =\u003e try_register(deps, env, reg_addr, reg_hash),\n        HandleMsg::Receive {\n            sender,\n            from,\n            amount,\n            msg,\n        } =\u003e try_receive(deps, env, sender, from, amount, msg),\n        HandleMsg::Redeem {\n            addr,\n            hash,\n            to,\n            amount,\n        } =\u003e try_redeem(deps, env, addr, hash, to, amount),\n        HandleMsg::Fail {} =\u003e try_fail(),\n    }\n}\n\npub fn try_increment\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    _env: Env,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut count = 0;\n    config(\u0026mut deps.storage).update(|mut state| {\n        state.count += 1;\n        count = state.count;\n        Ok(state)\n    })?;\n\n    let mut context = Context::new();\n    context.add_log(\"count\", count.to_string());\n\n    Ok(context.into())\n}\n\npub fn try_reset\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    count: i32,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let sender_address_raw = deps.api.canonical_address(\u0026env.message.sender)?;\n    config(\u0026mut deps.storage).update(|mut state| {\n        if sender_address_raw != state.owner {\n            return Err(StdError::Unauthorized { backtrace: None });\n        }\n        state.count = count;\n        Ok(state)\n    })?;\n    Ok(HandleResponse::default())\n}\n\npub fn try_register\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    reg_addr: HumanAddr,\n    reg_hash: String,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let mut conf = config(\u0026mut deps.storage);\n    let mut state = conf.load()?;\n    if !state.known_snip_20.contains(\u0026reg_addr) {\n        state.known_snip_20.push(reg_addr.clone());\n    }\n    conf.save(\u0026state)?;\n\n    let msg = to_binary(\u0026Snip20Msg::register_receive(env.contract_code_hash))?;\n    let message = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: reg_addr,\n        callback_code_hash: reg_hash,\n        msg,\n        send: vec![],\n    });\n\n    Ok(HandleResponse {\n        messages: vec![message],\n        log: vec![],\n        data: None,\n    })\n}\n\npub fn try_receive\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    _sender: HumanAddr,\n    _from: HumanAddr,\n    _amount: Uint128,\n    msg: Binary,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let msg: HandleMsg = from_binary(\u0026msg)?;\n\n    if matches!(msg, HandleMsg::Receive { .. }) {\n        return Err(StdError::generic_err(\n            \"Recursive call to receive() is not allowed\",\n        ));\n    }\n\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026env.message.sender) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            env.message.sender\n        )));\n    }\n\n    /* use sender \u0026 amount */\n    handle(deps, env, msg)\n}\n\nfn try_redeem\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    addr: HumanAddr,\n    hash: String,\n    to: HumanAddr,\n    amount: Uint128,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    if !state.known_snip_20.contains(\u0026addr) {\n        return Err(StdError::generic_err(format!(\n            \"{} is not a known SNIP-20 coin that this contract registered to\",\n            addr\n        )));\n    }\n\n    let msg = to_binary(\u0026Snip20Msg::redeem(amount))?;\n    let secret_redeem = CosmosMsg::Wasm(WasmMsg::Execute {\n        contract_addr: addr,\n        callback_code_hash: hash,\n        msg,\n        send: vec![],\n    });\n    let redeem = CosmosMsg::Bank(BankMsg::Send {\n        amount: vec![Coin::new(amount.u128(), \"uscrt\")],\n        from_address: env.contract.address,\n        to_address: to,\n    });\n\n    Ok(HandleResponse {\n        messages: vec![secret_redeem, redeem],\n        log: vec![],\n        data: None,\n    })\n}\n\nfn try_fail() -\u003e StdResult\u003cHandleResponse\u003e {\n    Err(StdError::generic_err(\"intentional failure\"))\n}\n\npub fn query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: QueryMsg,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        QueryMsg::GetCount {} =\u003e to_binary(\u0026query_count(deps)?),\n    }\n}\n\nfn query_count\u003cS: Storage, A: Api, Q: Querier\u003e(deps: \u0026Extern\u003cS, A, Q\u003e) -\u003e StdResult\u003cCountResponse\u003e {\n    let state = config_read(\u0026deps.storage).load()?;\n    Ok(CountResponse { count: state.count })\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","lib.rs"],"content":"pub mod contract;\npub mod msg;\npub mod state;\n\n#[cfg(target_arch = \"wasm32\")]\nmod wasm {\n    use super::contract;\n    use cosmwasm_std::{\n        do_handle, do_init, do_query, ExternalApi, ExternalQuerier, ExternalStorage,\n    };\n\n    #[no_mangle]\n    extern \"C\" fn init(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_init(\n            \u0026contract::init::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn handle(env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n        do_handle(\n            \u0026contract::handle::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            env_ptr,\n            msg_ptr,\n        )\n    }\n\n    #[no_mangle]\n    extern \"C\" fn query(msg_ptr: u32) -\u003e u32 {\n        do_query(\n            \u0026contract::query::\u003cExternalStorage, ExternalApi, ExternalQuerier\u003e,\n            msg_ptr,\n        )\n    }\n\n    // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n    // automatically because we `use cosmwasm_std`.\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","msg.rs"],"content":"use cosmwasm_std::{Binary, HumanAddr, Uint128};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct InitMsg {\n    pub count: i32,\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum HandleMsg {\n    Increment {},\n    Reset {\n        count: i32,\n    },\n    Register {\n        reg_addr: HumanAddr,\n        reg_hash: String,\n    },\n    Receive {\n        sender: HumanAddr,\n        from: HumanAddr,\n        amount: Uint128,\n        msg: Binary,\n    },\n    Redeem {\n        addr: HumanAddr,\n        hash: String,\n        to: HumanAddr,\n        amount: Uint128,\n    },\n    Fail {},\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum QueryMsg {\n    // GetCount returns the current count as a json-encoded number\n    GetCount {},\n}\n\n// We define a custom struct for each query response\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct CountResponse {\n    pub count: i32,\n}\n\n// Messages sent to SNIP-20 contracts\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum Snip20Msg {\n    RegisterReceive {\n        code_hash: String,\n        padding: Option\u003cString\u003e,\n    },\n    Redeem {\n        amount: Uint128,\n        padding: Option\u003cString\u003e,\n    },\n}\n\nimpl Snip20Msg {\n    pub fn register_receive(code_hash: String) -\u003e Self {\n        Snip20Msg::RegisterReceive {\n            code_hash,\n            padding: None, // TODO add padding calculation\n        }\n    }\n\n    pub fn redeem(amount: Uint128) -\u003e Self {\n        Snip20Msg::Redeem {\n            amount,\n            padding: None, // TODO add padding calculation\n        }\n    }\n}\n","traces":[{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","example-receiver","src","state.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse cosmwasm_std::{CanonicalAddr, HumanAddr, Storage};\nuse cosmwasm_storage::{singleton, singleton_read, ReadonlySingleton, Singleton};\n\npub static CONFIG_KEY: \u0026[u8] = b\"config\";\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct State {\n    pub count: i32,\n    pub owner: CanonicalAddr,\n    pub known_snip_20: Vec\u003cHumanAddr\u003e,\n}\n\npub fn config\u003cS: Storage\u003e(storage: \u0026mut S) -\u003e Singleton\u003cS, State\u003e {\n    singleton(storage, CONFIG_KEY)\n}\n\npub fn config_read\u003cS: Storage\u003e(storage: \u0026S) -\u003e ReadonlySingleton\u003cS, State\u003e {\n    singleton_read(storage, CONFIG_KEY)\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","contracts","snip20-reference-impl","tests","integration.rs"],"content":"#[test]\n#[ignore]\nfn empty_test() {}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","data.rs"],"content":"use cosmwasm_std::{HumanAddr, StdResult, Uint128, CosmosMsg, WasmMsg, BankMsg, Coin, to_binary};\nuse crate::token_type::TokenType;\nuse schemars::JsonSchema;\nuse secret_toolkit::snip20;\nuse serde::{Serialize, Deserialize};\n\n#[derive(Serialize, Deserialize, JsonSchema)]\npub struct Pagination {\n    pub start: u64,\n    pub limit: u8\n}\n\npub fn create_send_msg (\n    token:     \u0026TokenType\u003cHumanAddr\u003e,\n    sender:    HumanAddr,\n    recipient: HumanAddr,\n    amount:    Uint128\n) -\u003e StdResult\u003cCosmosMsg\u003e {\n    let msg = match token {\n        TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n            CosmosMsg::Wasm(WasmMsg::Execute {\n                contract_addr: contract_addr.clone(),\n                callback_code_hash: token_code_hash.to_string(),\n                msg: to_binary(\u0026snip20::HandleMsg::Send {\n                    recipient,\n                    amount,\n                    padding: None,\n                    msg: None,\n                })?,\n                send: vec![]\n            })\n        },\n        TokenType::NativeToken { denom } =\u003e {            \n            CosmosMsg::Bank(BankMsg::Send {\n                from_address: sender,\n                to_address: recipient,\n                amount: vec![Coin {\n                    denom: denom.to_string(),\n                    amount: amount\n                }],\n            })\n        }\n    };\n\n    Ok(msg)\n}\n","traces":[{"line":13,"address":[1443860,1441792],"length":1,"stats":{"Line":0},"fn_name":"create_send_msg"},{"line":19,"address":[789766,788403,787794,787838],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[1283461,1283442],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[1285070],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[1283501],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[1442621],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[1284275,1284582,1284467,1284867],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[1442668],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[1284251],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[788647],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[1284648],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[1283526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[1442287],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[787926],"length":1,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[787957],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[788043,787998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[788026],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[788463],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":18},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","display.rs"],"content":"use std::fmt::{Display, Formatter, Result};\nuse crate::{TokenType, TokenTypeAmount, TokenPair, TokenPairAmount, msg::ido::IdoInitConfig};\n\nimpl\u003cA: Display\u003e Display for TokenType\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        match self {\n            TokenType::NativeToken { denom } =\u003e write!(f, \"{}\", denom),\n            TokenType::CustomToken { contract_addr, .. } =\u003e write!(f, \"{}\", contract_addr),\n        }\n    }\n}\n\nimpl\u003cA: Display\u003e Display for TokenTypeAmount\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        write!(f, \"Token type: {} \\n Amount: {}\", self.token, self.amount)\n    }\n}\n\nimpl\u003cA: Display\u003e Display for TokenPair\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        write!(f, \"Token 1: {} \\n Token 2: {}\", self.0, self.1)\n    }\n}\n\nimpl\u003cA: Display + Clone\u003e Display for TokenPairAmount\u003cA\u003e {\n    fn fmt(\u0026self, f: \u0026mut Formatter) -\u003e Result {\n        write!(\n            f, \"Token 1: {} {} \\n Token 2: {} {}\",\n            self.pair.0, self.amount_0, self.pair.1, self.amount_1\n        )\n    }\n}\n\nimpl Display for IdoInitConfig {\n    fn fmt(\u0026self, f: \u0026mut Formatter\u003c'_\u003e) -\u003e Result {\n        write!(\n            f,\n            \"Input token: {}, Rate: {}, Created token: {}({})\",\n            self.input_token, self.rate,\n            self.snip20_init_info.name, self.snip20_init_info.symbol\n        )\n    }\n}\n","traces":[{"line":5,"address":[1058016],"length":1,"stats":{"Line":2},"fn_name":"fmt\u003ccosmwasm_std::addresses::HumanAddr\u003e"},{"line":6,"address":[1689245],"length":1,"stats":{"Line":0},"fn_name":null},{"line":7,"address":[1216497,1216593],"length":1,"stats":{"Line":4},"fn_name":null},{"line":8,"address":[1058068,1058304],"length":1,"stats":{"Line":4},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[648440],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":5,"coverable":17},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","exchange.rs"],"content":"use cosmwasm_std::{HumanAddr, StdResult, Api, CanonicalAddr};\nuse crate::token_pair::TokenPair;\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse fadroma_scrt_callback::ContractInstance;\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\n\n/// Represents the address of an exchange and the pair that it manages\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct Exchange \u003cA: Clone\u003e {\n    /// The pair that the contract manages.\n    pub pair:    TokenPair\u003cA\u003e,\n    /// Address of the contract that manages the exchange.\n    pub address: A\n}\n\nimpl Canonize\u003cExchange\u003cCanonicalAddr\u003e\u003e for Exchange\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cExchange\u003cCanonicalAddr\u003e\u003e {\n        Ok(Exchange {\n            pair:    self.pair.canonize(api)?,\n            address: self.address.canonize(api)?\n        })\n    }\n}\n\nimpl Humanize\u003cExchange\u003cHumanAddr\u003e\u003e for Exchange\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cExchange\u003cHumanAddr\u003e\u003e {\n        Ok(Exchange {\n            pair:    self.pair.humanize(api)?,\n            address: api.human_address(\u0026self.address)?\n        })\n    }\n}\n\n#[deprecated(note=\"please use Exchange\u003cCanonicalAddr\u003e instead\")]\npub type ExchangeStored = Exchange\u003cCanonicalAddr\u003e;\n\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Debug, Clone)]\npub struct ExchangeSettings\u003cA\u003e {\n    pub swap_fee:      Fee,\n    pub sienna_fee:    Fee,\n    pub sienna_burner: Option\u003cContractInstance\u003cA\u003e\u003e\n}\n\n#[deprecated(note=\"please use ExchangeSettings\u003cCanonicalAddr\u003e instead\")]\npub type ExchangeSettingsStored = ExchangeSettings\u003cCanonicalAddr\u003e;\n\nimpl ExchangeSettings\u003cHumanAddr\u003e {\n    pub fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cExchangeSettings\u003cCanonicalAddr\u003e\u003e {\n        Ok(ExchangeSettings {\n            swap_fee:   self.swap_fee,\n            sienna_fee: self.sienna_fee,\n            sienna_burner: if let Some(info) = \u0026self.sienna_burner { \n                Some(info.canonize(api)?) \n            } else {\n                None\n            }\n        })\n    }\n}\n\nimpl ExchangeSettings\u003cCanonicalAddr\u003e {\n    pub fn humanize (self, api: \u0026impl Api) -\u003e StdResult\u003cExchangeSettings\u003cHumanAddr\u003e\u003e {\n        Ok(ExchangeSettings {\n            swap_fee:   self.swap_fee,\n            sienna_fee: self.sienna_fee,\n            sienna_burner: if let Some(info) = self.sienna_burner { \n                Some(info.humanize(api)?)\n            } else {\n                None\n            }\n        })\n    }\n}\n\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Clone, Copy, Debug)]\npub struct Fee {\n    pub nom: u8,\n    pub denom: u16\n}\n\nimpl Fee {\n    pub fn new(nom: u8, denom: u16) -\u003e Self {\n        Self {\n            nom,\n            denom\n        }\n    }\n}\n","traces":[{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[1076868,1076352],"length":1,"stats":{"Line":1},"fn_name":"humanize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":28,"address":[1076981],"length":1,"stats":{"Line":1},"fn_name":null},{"line":29,"address":[1076708,1076395],"length":1,"stats":{"Line":1},"fn_name":null},{"line":30,"address":[1076848,1076685,1076803,1077098,1076883],"length":1,"stats":{"Line":3},"fn_name":null},{"line":49,"address":[1059840],"length":1,"stats":{"Line":2},"fn_name":"canonize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":50,"address":[1059997],"length":1,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":66,"address":[1060370],"length":1,"stats":{"Line":4},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":70,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":3},"fn_name":null}],"covered":17,"coverable":23},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","lib.rs"],"content":"pub use cosmwasm_utils::*;\npub use fadroma_scrt_callback::*;\npub use secret_toolkit::snip20;\npub use composable_admin as admin;\n\npub mod msg;\npub use u256_math;\n\nmod data; pub use data::*;\nmod token_pair; pub use token_pair::*;\nmod token_pair_amount; pub use token_pair_amount::*;\nmod token_type; pub use token_type::*;\nmod token_type_amount; pub use token_type_amount::*;\nmod exchange; pub use exchange::*;\n\nmod display; pub use display::*;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","msg.rs"],"content":"use schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\nuse cosmwasm_std::{HumanAddr, Binary, Uint128, Decimal};\n\nuse crate::{TokenPair, TokenType, TokenTypeAmount, TokenPairAmount};\n\nuse fadroma_scrt_callback::{ContractInstantiationInfo, ContractInstance, Callback};\nuse fadroma_scrt_migrate::types::ContractStatusLevel;\n\npub mod factory {\n    use super::*;\n    use super::ido::IdoInitConfig;\n    use crate::{Pagination, Exchange, ExchangeSettings};\n    use composable_admin::admin::{AdminHandleMsg, AdminQueryMsg};\n\n    #[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n    pub struct InitMsg {\n        pub snip20_contract:   ContractInstantiationInfo,\n        pub lp_token_contract: ContractInstantiationInfo,\n        pub pair_contract:     ContractInstantiationInfo,\n        pub ido_contract:      ContractInstantiationInfo,\n        pub exchange_settings: ExchangeSettings\u003cHumanAddr\u003e\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level: ContractStatusLevel,\n            reason: String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        /// Set contract templates and exchange settings\n        SetConfig {\n            snip20_contract:   Option\u003cContractInstantiationInfo\u003e,\n            lp_token_contract: Option\u003cContractInstantiationInfo\u003e,\n            pair_contract:     Option\u003cContractInstantiationInfo\u003e,\n            ido_contract:      Option\u003cContractInstantiationInfo\u003e,\n            exchange_settings: Option\u003cExchangeSettings\u003cHumanAddr\u003e\u003e\n        },\n        /// Instantiates an exchange pair contract\n        CreateExchange {\n            pair: TokenPair\u003cHumanAddr\u003e\n        },\n        /// Instantiates an IDO contract\n        CreateIdo {\n            info: IdoInitConfig\n        },\n        /// Used by a newly instantiated exchange contract to register\n        /// itself with the factory\n        RegisterExchange {\n            pair: TokenPair\u003cHumanAddr\u003e,\n            signature: Binary\n        },\n        /// Used by a newly instantiated IDO contract to register\n        /// itself with the factory\n        RegisterIdo {\n            signature: Binary\n        },\n\n        Admin(AdminHandleMsg)\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        /// Get configuration (contract templates and exchange settings)\n        GetConfig {},\n        GetExchangeAddress { pair: TokenPair\u003cHumanAddr\u003e },\n        ListIdos { pagination: Pagination },\n        ListExchanges { pagination: Pagination },\n        GetExchangeSettings,\n\n        Admin(AdminQueryMsg)\n    }\n\n    #[derive(Serialize, Deserialize, Debug, JsonSchema, PartialEq)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryResponse {\n        GetExchangeAddress {\n            address: HumanAddr\n        },\n        ListIdos {\n            idos: Vec\u003cHumanAddr\u003e\n        },\n        ListExchanges {\n            exchanges: Vec\u003cExchange\u003cHumanAddr\u003e\u003e\n        },\n        GetExchangeSettings {\n            settings: ExchangeSettings\u003cHumanAddr\u003e\n        },\n        Config {\n            snip20_contract:   ContractInstantiationInfo,\n            lp_token_contract: ContractInstantiationInfo,\n            pair_contract:     ContractInstantiationInfo,\n            ido_contract:      ContractInstantiationInfo,\n            exchange_settings: ExchangeSettings\u003cHumanAddr\u003e\n        }\n    }\n}\n\npub mod exchange {\n    use super::*;\n\n    #[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n    pub struct InitMsg {\n        /// The tokens that will be managed by the exchange\n        pub pair: TokenPair\u003cHumanAddr\u003e,\n        /// LP token instantiation info\n        pub lp_token_contract: ContractInstantiationInfo,\n        /// Used by the exchange contract to\n        /// send back its address to the factory on init\n        pub factory_info: ContractInstance\u003cHumanAddr\u003e,\n        pub callback: Callback\u003cHumanAddr\u003e\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level: ContractStatusLevel,\n            reason: String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        AddLiquidity {\n            deposit: TokenPairAmount\u003cHumanAddr\u003e,\n            /// The amount the price moves in a trading pair between when a transaction is submitted and when it is executed.\n            /// Transactions that exceed this threshold will be rejected.\n            slippage_tolerance: Option\u003cDecimal\u003e\n        },\n        RemoveLiquidity {\n            /// The amount of LP tokens burned.\n            amount: Uint128,\n            /// The account to refund the tokens to.\n            recipient: HumanAddr\n        },\n        Swap {\n            /// The token type to swap from.\n            offer: TokenTypeAmount\u003cHumanAddr\u003e,\n            expected_return: Option\u003cUint128\u003e,\n        },\n        /// Sent by the LP token contract so that we can record its address.\n        OnLpTokenInit\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        PairInfo,\n        SwapSimulation {\n            /// The token type to swap from.\n            offer: TokenTypeAmount\u003cHumanAddr\u003e\n        }\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsgResponse {\n        PairInfo {\n            liquidity_token: ContractInstance\u003cHumanAddr\u003e,\n            factory:         ContractInstance\u003cHumanAddr\u003e,\n            pair:            TokenPair\u003cHumanAddr\u003e,\n            amount_0:        Uint128,\n            amount_1:        Uint128,\n        }\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct SwapSimulationResponse {\n        pub return_amount: Uint128,\n        pub spread_amount: Uint128,\n        pub commission_amount: Uint128,\n    }\n}\n\npub mod ido {\n    use super::*;\n    use super::snip20::Snip20InitConfig;\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct IdoInitMsg {\n        pub snip20_contract: ContractInstantiationInfo,\n        pub info: IdoInitConfig,\n        /// Used by the IDO to register itself with the factory.\n        pub callback: Callback\u003cHumanAddr\u003e\n    }\n    \n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct IdoInitConfig {\n        /// The token that will be used to buy the instantiated SNIP20\n        pub input_token: TokenType\u003cHumanAddr\u003e,\n        pub rate: Uint128,\n        pub snip20_init_info: Snip20TokenInitInfo\n    }\n    \n    #[derive(Serialize, Deserialize, JsonSchema)]\n    /// Used to provide only the essential info\n    /// to an IDO that instantiates a snip20 token\n    pub struct Snip20TokenInitInfo {\n        pub name: String,\n        pub prng_seed: Binary,\n        pub symbol: String,\n        pub decimals: u8,\n        pub config: Option\u003cSnip20InitConfig\u003e\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level: ContractStatusLevel,\n            reason: String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        OnSnip20Init,\n        Swap {\n            amount: Uint128\n        }\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        GetRate\n    }\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsgResponse {\n        GetRate { \n            rate: Uint128 \n        }\n    }\n}\n\npub mod sienna_burner {\n    use super::*;\n    use composable_admin::multi_admin::{\n        MultiAdminHandleMsg, MultiAdminQueryMsg, MultiAdminQueryResponse\n    };\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct InitMsg {\n        /// SIENNA token\n        pub sienna_token: ContractInstance\u003cHumanAddr\u003e,\n        pub pairs: Option\u003cVec\u003cHumanAddr\u003e\u003e,\n        /// The account to burn SIENNA from\n        pub burn_pool: HumanAddr,\n        /// Needs to be added as an admin in order to allow\n        /// it to add new pair addresses.\n        pub factory_address: HumanAddr,\n        pub admins: Option\u003cVec\u003cHumanAddr\u003e\u003e\n    }\n    \n    #[derive(Serialize, Deserialize, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum HandleMsg {\n        /// Set pause/migration status\n        SetStatus {\n            level:       ContractStatusLevel,\n            reason:      String,\n            new_address: Option\u003cHumanAddr\u003e\n        },\n        Burn           { amount: Uint128 },\n        AddPairs       { pairs: Vec\u003cHumanAddr\u003e, },\n        RemovePairs    { pairs: Vec\u003cHumanAddr\u003e, },\n        SetBurnPool    { address: HumanAddr },\n        SetSiennaToken { info: ContractInstance\u003cHumanAddr\u003e },\n        Admin(MultiAdminHandleMsg),\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, Debug, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryMsg {\n        /// Get pause/migration status\n        Status,\n        SiennaToken,\n        BurnPool,\n        Admin(MultiAdminQueryMsg),\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, Debug, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum QueryAnswer {\n        SiennaToken { info: ContractInstance\u003cHumanAddr\u003e },\n        BurnPool { address: HumanAddr },\n        Admin(MultiAdminQueryResponse)\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, Debug, JsonSchema)]\n    #[serde(rename_all = \"snake_case\")]\n    pub enum ResponseStatus {\n        Success,\n        Failure,\n    }\n}\n\npub mod snip20 {\n    use super::*;\n\n    #[derive(Serialize, Deserialize, JsonSchema)]\n    pub struct Snip20InitMsg {\n        pub name: String,\n        pub admin: Option\u003cHumanAddr\u003e,\n        pub symbol: String,\n        pub decimals: u8,\n        pub initial_balances: Option\u003cVec\u003cSnip20InitialBalance\u003e\u003e,\n        pub prng_seed: Binary,\n        pub config: Option\u003cSnip20InitConfig\u003e,\n        pub callback: Option\u003cCallback\u003cHumanAddr\u003e\u003e\n    }\n    \n    #[derive(Serialize, Deserialize, Clone, PartialEq, JsonSchema)]\n    pub struct Snip20InitialBalance {\n        pub address: HumanAddr,\n        pub amount: Uint128,\n    }\n    \n    /// This type represents optional configuration values which can be overridden.\n    /// All values are optional and have defaults which are more private by default,\n    /// but can be overridden if necessary\n    #[derive(Serialize, Deserialize, JsonSchema, Clone, Default, Debug)]\n    pub struct Snip20InitConfig {\n        /// Indicates whether the total supply is public or should be kept secret.\n        /// default: False\n        pub public_total_supply: Option\u003cbool\u003e,\n    }\n    \n    impl Snip20InitMsg {\n        pub fn config(\u0026self) -\u003e Snip20InitConfig {\n            self.config.clone().unwrap_or_default()\n        }\n    }\n    \n    impl Snip20InitConfig {\n        pub fn public_total_supply(\u0026self) -\u003e bool {\n            self.public_total_supply.unwrap_or(false)\n        }\n    }\n}\n","traces":[{"line":339,"address":[2833504],"length":1,"stats":{"Line":0},"fn_name":"config"},{"line":340,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":345,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":346,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":4},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_pair.rs"],"content":"use cosmwasm_std::{Api, StdResult, Querier, HumanAddr, Uint128, CanonicalAddr};\nuse crate::token_type::TokenType;\nuse fadroma_scrt_addr::{Canonize, Humanize};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize, Deserializer, Serializer};\n\n#[derive(Clone, Debug, JsonSchema)]\npub struct TokenPair\u003cA\u003e(\n    pub TokenType\u003cA\u003e,\n    pub TokenType\u003cA\u003e\n);\nimpl Canonize\u003cTokenPair\u003cCanonicalAddr\u003e\u003e for TokenPair\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenPair\u003cCanonicalAddr\u003e\u003e {\n        Ok(TokenPair(self.0.canonize(api)?, self.1.canonize(api)?))\n    }\n}\nimpl Humanize\u003cTokenPair\u003cHumanAddr\u003e\u003e for TokenPair\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenPair\u003cHumanAddr\u003e\u003e {\n        Ok(TokenPair(self.0.humanize(api)?, self.1.humanize(api)?))\n    }\n}\n\n#[deprecated(note=\"please use TokenPair\u003cCanonicalAddr\u003e instead\")]\npub type TokenPairStored = TokenPair\u003cCanonicalAddr\u003e;\n\npub struct TokenPairIterator\u003c'a, A\u003e {\n    pair: \u0026'a TokenPair\u003cA\u003e,\n    index: u8\n}\n\nimpl\u003cA: Clone + PartialEq\u003e TokenPair\u003cA\u003e {\n    /// Returns `true` if one of the token types in the pair is the same as the argument.\n    pub fn contains(\u0026self, token: \u0026TokenType\u003cA\u003e) -\u003e bool {\n        self.0 == *token || self.1 == *token\n    }\n\n    /// Returns the index of the stored token type (0 or 1) that matches the argument.\n    /// Returns `None` if there are no matches.\n    pub fn get_token_index(\u0026self, token: \u0026TokenType\u003cA\u003e) -\u003e Option\u003cusize\u003e {\n        if self.0 == *token {\n            return Some(0);\n        } else if self.1 == *token {\n            return Some(1);\n        }\n\n        None\n    }\n\n    pub fn get_token(\u0026self, index: usize) -\u003e Option\u003c\u0026TokenType\u003cA\u003e\u003e {\n        match index {\n            0 =\u003e Some(\u0026self.0),\n            1 =\u003e Some(\u0026self.1),\n            _ =\u003e None\n        }\n    }\n}\n\nimpl TokenPair\u003cHumanAddr\u003e {\n    /// Returns the balance for each token in the pair. The order of the balances in returned array\n    /// correspond to the token order in the pair i.e `[ self.0 balance, self.1 balance ]`.\n    pub fn query_balances(\n        \u0026self,\n        querier: \u0026impl Querier,\n        exchange_addr: HumanAddr,\n        viewing_key: String\n    ) -\u003e StdResult\u003c[Uint128; 2]\u003e {\n        let amount_0 = self.0.query_balance(querier, exchange_addr.clone(), viewing_key.clone())?;\n        let amount_1 = self.1.query_balance(querier, exchange_addr, viewing_key)?;\n\n        // order is important\n        Ok([amount_0, amount_1])\n    }\n}\n\nimpl\u003cA: PartialEq\u003e PartialEq for TokenPair\u003cA\u003e {\n    fn eq(\u0026self, other: \u0026TokenPair\u003cA\u003e) -\u003e bool {\n        (self.0 == other.0 || self.0 == other.1) \u0026\u0026 (self.1 == other.0 || self.1 == other.1)\n    }\n}\n\nimpl\u003c'a, A: Clone\u003e IntoIterator for \u0026'a TokenPair\u003cA\u003e {\n    type Item = \u0026'a TokenType\u003cA\u003e;\n    type IntoIter = TokenPairIterator\u003c'a, A\u003e;\n    fn into_iter(self) -\u003e Self::IntoIter {\n        TokenPairIterator { pair: self, index: 0 }\n    }\n}\n\nimpl\u003c'a, A: Clone\u003e Iterator for TokenPairIterator\u003c'a, A\u003e {\n    type Item = \u0026'a TokenType\u003cA\u003e;\n\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        let result = match self.index {\n            0 =\u003e Some(\u0026self.pair.0),\n            1 =\u003e Some(\u0026self.pair.1),\n            _ =\u003e None\n        };\n\n        self.index += 1;\n\n        result\n    }\n}\n\n// These are only used for serde, because it doesn't work with struct tuples.\n#[derive(Serialize, Deserialize)]\npub struct TokenPairSerde\u003cA: Clone\u003e {\n    token_0: TokenType\u003cA\u003e,\n    token_1: TokenType\u003cA\u003e,\n}\n\n#[deprecated(note=\"please use TokenPairStoredSerde\u003cCanonicalAddr\u003e instead\")]\npub type TokenPairStoredSerde = TokenPairSerde\u003cCanonicalAddr\u003e;\n\nimpl\u003cA: Clone + Serialize\u003e Serialize for TokenPair\u003cA\u003e {\n    fn serialize\u003cS\u003e(\u0026self, serializer: S) -\u003e Result\u003cS::Ok, S::Error\u003e\n    where\n        S: Serializer,\n    {\n        TokenPairSerde { token_0: self.0.clone(), token_1: self.1.clone() }.serialize(serializer)\n    }\n}\n\nimpl\u003c'de, A: Deserialize\u003c'de\u003e + Clone\u003e Deserialize\u003c'de\u003e for TokenPair\u003cA\u003e {\n    fn deserialize\u003cD\u003e(deserializer: D) -\u003e Result\u003cSelf, D::Error\u003e\n    where\n        D: Deserializer\u003c'de\u003e,\n    {\n        Deserialize::deserialize(deserializer)\n            .map(|TokenPairSerde { token_0, token_1 }| TokenPair(token_0, token_1))\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn token_pair_equality() {\n        let pair: TokenPair\u003cHumanAddr\u003e = TokenPair(\n            TokenType::CustomToken {\n                contract_addr: \"address\".into(),\n                token_code_hash: \"hash\".into()\n            },\n            TokenType::NativeToken {\n                denom: \"denom\".into()\n            }\n        );\n\n        let pair2 = TokenPair(pair.1.clone(), pair.0.clone());\n\n        assert_eq!(pair, pair.clone());\n        assert_eq!(pair2, pair2.clone());\n        assert_eq!(pair, pair2);\n    }\n}\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":19,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":77,"address":[792056],"length":1,"stats":{"Line":3},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":92,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":93,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":94,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":99,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":101,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":116,"address":[605536,605915],"length":1,"stats":{"Line":2},"fn_name":"serialize\u003ccosmwasm_std::addresses::CanonicalAddr,\u0026mut serde_json_wasm::ser::Serializer\u003e"},{"line":120,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":125,"address":[605936,606016],"length":1,"stats":{"Line":2},"fn_name":"deserialize\u003ccosmwasm_std::addresses::CanonicalAddr,serde::__private::de::missing_field::MissingFieldDeserializer\u003cserde_json_wasm::de::errors::Error\u003e\u003e"},{"line":129,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":130,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":139,"address":[621344,621349],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":141,"address":[636911],"length":1,"stats":{"Line":1},"fn_name":null},{"line":142,"address":[636855],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[636880],"length":1,"stats":{"Line":1},"fn_name":null},{"line":145,"address":[637071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":146,"address":[636987],"length":1,"stats":{"Line":1},"fn_name":null},{"line":150,"address":[637310,637250,637502,637354],"length":1,"stats":{"Line":3},"fn_name":null},{"line":152,"address":[637547,637670,637495],"length":1,"stats":{"Line":3},"fn_name":null},{"line":153,"address":[637802],"length":1,"stats":{"Line":1},"fn_name":null},{"line":154,"address":[638025,638139],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":21,"coverable":46},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_pair_amount.rs"],"content":"use cosmwasm_std::{Uint128, Env, StdResult};\nuse crate::{token_type::TokenType, token_pair::TokenPair};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct TokenPairAmount\u003cA: Clone\u003e {\n    pub pair:     TokenPair\u003cA\u003e,\n    pub amount_0: Uint128,\n    pub amount_1: Uint128\n}\n\nimpl\u003cA: Clone\u003e TokenPairAmount\u003cA\u003e {\n    pub fn assert_sent_native_token_balance(\u0026self, env: \u0026Env) -\u003e StdResult\u003c()\u003e {\n        self.pair.0.assert_sent_native_token_balance(env, self.amount_0)?;\n        self.pair.1.assert_sent_native_token_balance(env, self.amount_1)?;\n\n        Ok(())\n    }\n}\n\nimpl\u003c'a, A: Clone\u003e IntoIterator for \u0026'a TokenPairAmount\u003cA\u003e {\n    type Item = (Uint128, \u0026'a TokenType\u003cA\u003e);\n    type IntoIter = TokenPairAmountIterator\u003c'a, A\u003e;\n    fn into_iter(self) -\u003e Self::IntoIter {\n        TokenPairAmountIterator {\n            pair: self,\n            index: 0\n        }\n    }\n}\n\npub struct TokenPairAmountIterator\u003c'a, A: Clone\u003e {\n    pair: \u0026'a TokenPairAmount\u003cA\u003e,\n    index: u8\n}\n\nimpl\u003c'a, A: Clone\u003e Iterator for TokenPairAmountIterator\u003c'a, A\u003e {\n    type Item = (Uint128, \u0026'a TokenType\u003cA\u003e);\n    fn next(\u0026mut self) -\u003e Option\u003cSelf::Item\u003e {\n        let result = match self.index {\n            0 =\u003e Some((self.pair.amount_0, \u0026self.pair.pair.0)),\n            1 =\u003e Some((self.pair.amount_1, \u0026self.pair.pair.1)),\n            _ =\u003e None\n        };\n        self.index += 1;\n        result\n    }\n}\n","traces":[{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":18,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":12},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_type.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, Api, StdResult, Querier, Uint128, StdError, Env};\nuse fadroma_scrt_addr::{Canonize, Humanize};\nuse schemars::JsonSchema;\nuse secret_toolkit::snip20;\nuse serde::{Deserialize, Serialize};\n\nconst BLOCK_SIZE: usize = 256;\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n#[serde(rename_all = \"snake_case\")]\npub enum TokenType\u003cA\u003e {\n    CustomToken {\n        contract_addr: A,\n        token_code_hash: String,\n        //viewing_key: String,\n    },\n    NativeToken {\n        denom: String,\n    },\n}\nimpl Canonize\u003cTokenType\u003cCanonicalAddr\u003e\u003e for TokenType\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenType\u003cCanonicalAddr\u003e\u003e {\n        Ok(match self {\n            Self::CustomToken { contract_addr, token_code_hash } =\u003e TokenType::CustomToken {\n                contract_addr: contract_addr.canonize(api)?,\n                token_code_hash: token_code_hash.clone()\n            },\n            Self::NativeToken { denom } =\u003e TokenType::NativeToken {\n                denom: denom.clone()\n            }\n        })\n    }\n}\nimpl Humanize\u003cTokenType\u003cHumanAddr\u003e\u003e for TokenType\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cTokenType\u003cHumanAddr\u003e\u003e {\n        Ok(match self {\n            Self::CustomToken { contract_addr, token_code_hash } =\u003e TokenType::CustomToken {\n                contract_addr: contract_addr.humanize(api)?,\n                token_code_hash: token_code_hash.clone()\n            },\n            Self::NativeToken { denom } =\u003e TokenType::NativeToken {\n                denom: denom.clone()\n            }\n        })\n    }\n}\n\n#[deprecated(note=\"please use TokenType\u003cCanonicalAddr\u003e instead\")]\npub type TokenTypeStored = TokenType\u003cCanonicalAddr\u003e;\n\nimpl\u003cA: Clone\u003e TokenType\u003cA\u003e {\n    pub fn is_native_token(\u0026self) -\u003e bool {\n        match self {\n            TokenType::NativeToken { .. } =\u003e true,\n            TokenType::CustomToken { .. } =\u003e false,\n        }\n    }\n    pub fn is_custom_token(\u0026self) -\u003e bool {\n        match self {\n            TokenType::NativeToken { .. } =\u003e false,\n            TokenType::CustomToken { .. } =\u003e true,\n        }\n    }\n    pub fn assert_sent_native_token_balance(\u0026self, env: \u0026Env, amount: Uint128) -\u003e StdResult\u003c()\u003e {\n        if let TokenType::NativeToken { denom } = \u0026self {\n            return match env.message.sent_funds.iter().find(|x| x.denom == *denom) {\n                Some(coin) =\u003e {\n                    if amount == coin.amount {\n                        Ok(())\n                    } else {\n                        Err(StdError::generic_err(\"Native token balance missmatch between the argument and the transferred\"))\n                    }\n                }\n                None =\u003e {\n                    if amount.is_zero() {\n                        Ok(())\n                    } else {\n                        Err(StdError::generic_err(\"Native token balance missmatch between the argument and the transferred\"))\n                    }\n                }\n            }\n        }\n\n        Ok(())\n    }\n}\n\nimpl TokenType\u003cHumanAddr\u003e {\n    pub fn query_balance(\n        \u0026self,\n        querier: \u0026impl Querier,\n        exchange_addr: HumanAddr,\n        viewing_key: String\n    ) -\u003e StdResult\u003cUint128\u003e {\n        match self {\n            TokenType::NativeToken { denom } =\u003e {\n                let result = querier.query_balance(exchange_addr, denom)?;\n                Ok(result.amount)\n            },\n            TokenType::CustomToken { contract_addr, token_code_hash } =\u003e {\n                let result = snip20::balance_query(\n                    querier,\n                    exchange_addr.clone(),\n                    viewing_key,\n                    BLOCK_SIZE,\n                    token_code_hash.clone(),\n                    contract_addr.clone()\n                )?;\n                Ok(result.amount)\n            }\n        }\n    }\n}\n","traces":[{"line":22,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":9},"fn_name":null},{"line":25,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":5},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":38,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":67,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":69,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":71,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":76,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":89,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":96,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":97,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":98,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":100,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":102,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":104,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":105,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":106,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":107,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":109,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":14,"coverable":47},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","amm-shared","src","token_type_amount.rs"],"content":"use cosmwasm_std::{Uint128, Env, StdResult};\nuse crate::token_type::TokenType;\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\npub struct TokenTypeAmount\u003cA\u003e {\n    pub token: TokenType\u003cA\u003e,\n    pub amount: Uint128\n}\n\nimpl\u003cA: Clone\u003e TokenTypeAmount\u003cA\u003e {\n    pub fn assert_sent_native_token_balance(\u0026self, env: \u0026Env) -\u003e StdResult\u003c()\u003e {\n        self.token.assert_sent_native_token_balance(env, self.amount)\n    }\n}\n","traces":[{"line":13,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":2},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-addr","lib.rs"],"content":"//! `HumanAddr`\u003c-\u003e`CanonicalAddr` conversion\n\nuse cosmwasm_std::{Api, CanonicalAddr, HumanAddr, StdResult};\n\npub trait Humanize\u003cT\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cT\u003e;\n}\nimpl Humanize\u003cHumanAddr\u003e for CanonicalAddr {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cHumanAddr\u003e {\n        api.human_address(self)\n    }\n}\nimpl\u003cT: Humanize\u003cU\u003e, U\u003e Humanize\u003cVec\u003cU\u003e\u003e for Vec\u003cT\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cVec\u003cU\u003e\u003e {\n        self.iter().map(|x|x.humanize(api)).collect()\n    }\n}\n\npub trait Canonize\u003cT\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cT\u003e;\n}\nimpl Canonize\u003cCanonicalAddr\u003e for HumanAddr {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCanonicalAddr\u003e {\n        api.canonical_address(self)\n    }\n}\nimpl\u003cT: Canonize\u003cU\u003e, U\u003e Canonize\u003cVec\u003cU\u003e\u003e for Vec\u003cT\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cVec\u003cU\u003e\u003e {\n        self.iter().map(|x|x.canonize(api)).collect()\n    }\n}\n","traces":[{"line":9,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":10,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":14,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":24,"address":[],"length":0,"stats":{"Line":10},"fn_name":null},{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":8},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","composable-admin","src","admin.rs"],"content":"use cosmwasm_std::{\n    HumanAddr, CanonicalAddr, StdResult, Extern, Env,\n    Api, Querier, Storage, StdError, HandleResponse,\n    Binary, to_binary\n};\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\n\nconst ADMIN_KEY: \u0026[u8] = b\"ltp5P6sFZT\";\n\npub fn admin_handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: AdminHandleMsg,\n    handle: impl AdminHandle,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        AdminHandleMsg::ChangeAdmin { address } =\u003e handle.change_admin(deps, env, address)\n    }\n}\n\npub fn admin_query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: AdminQueryMsg,\n    query: impl AdminQuery,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        AdminQueryMsg::Admin =\u003e query.query_admin(deps)\n    }\n}\n\npub trait AdminHandle {\n    fn change_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        address: HumanAddr,\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        assert_admin(deps, \u0026env)?;\n        save_admin(deps, \u0026address)?;\n    \n        Ok(HandleResponse::default())\n    }\n}\n\npub trait AdminQuery {\n    fn query_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026Extern\u003cS, A, Q\u003e\n    )-\u003e StdResult\u003cBinary\u003e {\n        let address = load_admin(deps)?;\n    \n        to_binary(\u0026AdminQueryResponse { \n            address\n        })\n    }\n}\n\npub struct DefaultHandleImpl;\n\nimpl AdminHandle for DefaultHandleImpl { }\n\npub struct DefaultQueryImpl;\n\nimpl AdminQuery for DefaultQueryImpl { }\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum AdminHandleMsg {\n    ChangeAdmin {\n        address: HumanAddr\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum AdminQueryMsg {\n    Admin\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub struct AdminQueryResponse {\n    pub address: HumanAddr\n}\n\npub fn load_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cHumanAddr\u003e {\n    let result = deps.storage.get(ADMIN_KEY);\n\n    if let Some(bytes) = result {\n        let admin = CanonicalAddr::from(bytes);\n\n        deps.api.human_address(\u0026admin)\n    } else {\n        Ok(HumanAddr::default())\n    }\n}\n\npub fn save_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    address: \u0026HumanAddr\n) -\u003e StdResult\u003c()\u003e {\n    let admin = deps.api.canonical_address(address)?;\n    deps.storage.set(ADMIN_KEY, \u0026admin.as_slice());\n\n    Ok(())\n}\n\npub fn assert_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    env: \u0026Env\n) -\u003e StdResult\u003c()\u003e {\n    let admin = load_admin(deps)?;\n\n    if admin == env.message.sender {\n        return Ok(());\n    }\n\n    Err(StdError::unauthorized())\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::from_binary;\n    use cosmwasm_std::testing::{mock_dependencies, mock_env};\n\n    #[test]\n    fn test_handle() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let admin = HumanAddr::from(\"admin\");\n        save_admin(deps, \u0026admin).unwrap();\n\n        let msg = AdminHandleMsg::ChangeAdmin { \n            address: HumanAddr::from(\"will fail\")\n        };\n\n        let result = admin_handle(\n            deps,\n            mock_env(\"unauthorized\", \u0026[]),\n            msg,\n            DefaultHandleImpl\n        ).unwrap_err();\n        \n        match result {\n            StdError::Unauthorized { .. } =\u003e { },\n            _ =\u003e panic!(\"Expected \\\"StdError::Unauthorized\\\"\")\n        };\n\n        let new_admin = HumanAddr::from(\"new_admin\");\n\n        let msg = AdminHandleMsg::ChangeAdmin { \n            address: new_admin.clone()\n        };\n\n        admin_handle(\n            deps,\n            mock_env(admin, \u0026[]),\n            msg,\n            DefaultHandleImpl\n        ).unwrap();\n\n        assert!(load_admin(deps).unwrap() == new_admin);\n    }\n\n    #[test]\n    fn test_query() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let result = admin_query(deps, AdminQueryMsg::Admin, DefaultQueryImpl).unwrap();\n\n        let response: AdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.address == HumanAddr::default());\n\n        let admin = HumanAddr::from(\"admin\");\n        save_admin(deps, \u0026admin).unwrap();\n\n        let result = admin_query(deps, AdminQueryMsg::Admin, DefaultQueryImpl).unwrap();\n\n        let response: AdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.address == admin);\n    }\n}\n","traces":[{"line":11,"address":[609520,609689],"length":1,"stats":{"Line":1},"fn_name":"admin_handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::admin::DefaultHandleImpl\u003e"},{"line":18,"address":[609561],"length":1,"stats":{"Line":1},"fn_name":null},{"line":22,"address":[609728,609780],"length":1,"stats":{"Line":1},"fn_name":"admin_query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::admin::DefaultQueryImpl\u003e"},{"line":28,"address":[609753],"length":1,"stats":{"Line":1},"fn_name":null},{"line":33,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":1},"fn_name":null},{"line":87,"address":[611120,611523],"length":1,"stats":{"Line":2},"fn_name":"load_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":90,"address":[611149],"length":1,"stats":{"Line":2},"fn_name":null},{"line":92,"address":[611188,611346],"length":1,"stats":{"Line":3},"fn_name":null},{"line":93,"address":[611239],"length":1,"stats":{"Line":3},"fn_name":null},{"line":95,"address":[611439],"length":1,"stats":{"Line":3},"fn_name":null},{"line":97,"address":[611291],"length":1,"stats":{"Line":1},"fn_name":null},{"line":101,"address":[612002,612017,611600],"length":1,"stats":{"Line":3},"fn_name":"save_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":105,"address":[611638,611783],"length":1,"stats":{"Line":3},"fn_name":null},{"line":106,"address":[611751,611883],"length":1,"stats":{"Line":6},"fn_name":null},{"line":108,"address":[611979],"length":1,"stats":{"Line":3},"fn_name":null},{"line":111,"address":[612032,612410,612425],"length":1,"stats":{"Line":2},"fn_name":"assert_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":115,"address":[612070,612196],"length":1,"stats":{"Line":2},"fn_name":null},{"line":117,"address":[612286,612174],"length":1,"stats":{"Line":4},"fn_name":null},{"line":118,"address":[612351],"length":1,"stats":{"Line":2},"fn_name":null},{"line":121,"address":[612327,612376],"length":1,"stats":{"Line":2},"fn_name":null},{"line":131,"address":[558464,559731],"length":1,"stats":{"Line":3},"fn_name":"test_handle"},{"line":132,"address":[558471],"length":1,"stats":{"Line":1},"fn_name":null},{"line":134,"address":[558535],"length":1,"stats":{"Line":1},"fn_name":null},{"line":135,"address":[558639,558566],"length":1,"stats":{"Line":2},"fn_name":null},{"line":138,"address":[558699],"length":1,"stats":{"Line":1},"fn_name":null},{"line":143,"address":[558770],"length":1,"stats":{"Line":1},"fn_name":null},{"line":144,"address":[558809],"length":1,"stats":{"Line":1},"fn_name":null},{"line":149,"address":[558956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":150,"address":[558998],"length":1,"stats":{"Line":0},"fn_name":null},{"line":153,"address":[558967],"length":1,"stats":{"Line":1},"fn_name":null},{"line":156,"address":[559087],"length":1,"stats":{"Line":1},"fn_name":null},{"line":161,"address":[559134],"length":1,"stats":{"Line":1},"fn_name":null},{"line":162,"address":[559247],"length":1,"stats":{"Line":1},"fn_name":null},{"line":166,"address":[559422,559596],"length":1,"stats":{"Line":1},"fn_name":null},{"line":170,"address":[560657,559760],"length":1,"stats":{"Line":3},"fn_name":"test_query"},{"line":171,"address":[559767],"length":1,"stats":{"Line":1},"fn_name":null},{"line":173,"address":[559815],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[559905],"length":1,"stats":{"Line":1},"fn_name":null},{"line":176,"address":[560075,560180,560001],"length":1,"stats":{"Line":2},"fn_name":null},{"line":178,"address":[560149],"length":1,"stats":{"Line":1},"fn_name":null},{"line":179,"address":[560233],"length":1,"stats":{"Line":1},"fn_name":null},{"line":181,"address":[560316],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[560369],"length":1,"stats":{"Line":1},"fn_name":null},{"line":184,"address":[560540,560463],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":50,"coverable":51},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","composable-admin","src","lib.rs"],"content":"pub use require_admin::require_admin;\n\npub mod multi_admin;\npub mod admin;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","composable-admin","src","multi_admin.rs"],"content":"use cosmwasm_std::{\n    HumanAddr, CanonicalAddr, StdResult, Extern, Env,\n    Api, Querier, Storage, to_vec, StdError, HandleResponse,\n    Binary, to_binary, from_slice, ReadonlyStorage\n};\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\nuse serde::de::DeserializeOwned;\n\nconst ADMINS_KEY: \u0026[u8] = b\"i801onL3kf\";\n\npub fn multi_admin_handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: MultiAdminHandleMsg,\n    handle: impl MultiAdminHandle,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        MultiAdminHandleMsg::AddAdmins { addresses } =\u003e handle.add_admins(deps, env, addresses)\n    }\n}\n\npub fn multi_admin_query\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    msg: MultiAdminQueryMsg,\n    query: impl MultiAdminQuery,\n) -\u003e StdResult\u003cBinary\u003e {\n    match msg {\n        MultiAdminQueryMsg::Admins =\u003e query.query_admins(deps)\n    }\n}\n\npub trait MultiAdminHandle {\n    fn add_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        addresses: Vec\u003cHumanAddr\u003e,\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        assert_admin(deps, \u0026env)?;\n        save_admins(deps, \u0026addresses)?;\n    \n        Ok(HandleResponse::default())\n    }\n}\n\npub trait MultiAdminQuery {\n    fn query_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026Extern\u003cS, A, Q\u003e\n    )-\u003e StdResult\u003cBinary\u003e {\n        let addresses = load_admins(deps)?;\n    \n        to_binary(\u0026MultiAdminQueryResponse { \n            addresses\n        })\n    }\n}\n\npub struct DefaultHandleImpl;\n\nimpl MultiAdminHandle for DefaultHandleImpl { }\n\npub struct DefaultQueryImpl;\n\nimpl MultiAdminQuery for DefaultQueryImpl { }\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum MultiAdminHandleMsg {\n    AddAdmins {\n        addresses: Vec\u003cHumanAddr\u003e,\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum MultiAdminQueryMsg {\n    Admins\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub struct MultiAdminQueryResponse {\n    pub addresses: Vec\u003cHumanAddr\u003e\n}\n\npub fn save_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    addresses: \u0026Vec\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    let mut admins: Vec\u003cCanonicalAddr\u003e = \n        load(\u0026deps.storage, ADMINS_KEY).unwrap_or(vec![]);\n    \n    for address in addresses {\n        let canonical = deps.api.canonical_address(address)?;\n        admins.push(canonical);\n    }\n\n    deps.storage.set(ADMINS_KEY, \u0026to_vec(\u0026admins)?);\n\n    Ok(())\n}\n\npub fn load_admins\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003cVec\u003cHumanAddr\u003e\u003e {\n    let admins: Vec\u003cCanonicalAddr\u003e =\n        load(\u0026deps.storage, ADMINS_KEY).unwrap_or(vec![]);\n    \n    let mut result = Vec::with_capacity(admins.len());\n\n    for admin in admins {\n        result.push(deps.api.human_address(\u0026admin)?)\n    }\n\n    Ok(result)\n}\n\npub fn assert_admin\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    env: \u0026Env,\n) -\u003e StdResult\u003c()\u003e {\n    let admins = load_admins(deps)?;\n\n    if admins.contains(\u0026env.message.sender) {\n        return Ok(());\n    }\n\n    Err(StdError::unauthorized())\n}\n\nfn load\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cT\u003e {\n    let result = storage.get(key).ok_or_else(||\n        StdError::SerializeErr { \n            source: \"load\".into(),\n            msg: \"key not found\".into(),\n            backtrace: None\n        }\n    )?;\n    \n    from_slice(\u0026result)\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::from_binary;\n    use cosmwasm_std::testing::{mock_dependencies, mock_env};\n\n    #[test]\n    fn test_handle() {\n        const ADMIN: \u0026str = \"goshu\";\n\n        fn run_msg\u003cS: Storage, A: Api, Q: Querier\u003e(\n            deps: \u0026mut Extern\u003cS, A, Q\u003e,\n            addresses: Vec\u003cHumanAddr\u003e,\n            assert_len: usize\n        ) {\n            let msg = MultiAdminHandleMsg::AddAdmins {\n                addresses\n            };\n    \n            let result = multi_admin_handle(\n                deps,\n                mock_env(HumanAddr::from(ADMIN), \u0026[]),\n                msg,\n                DefaultHandleImpl\n            );\n    \n            assert!(result.is_ok());\n    \n            let admins = load_admins(deps).unwrap();\n            assert!(\n                admins.len() == assert_len,\n                \"Assert admins.len() failed: Expected: {}, Got: {}\", admins.len(), assert_len\n            );\n        }\n\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let admin = HumanAddr::from(\"goshu\");\n        save_admins(deps, \u0026vec![ admin.clone() ]).unwrap();\n\n        let msg = MultiAdminHandleMsg::AddAdmins {\n            addresses: vec![ HumanAddr::from(\"will fail\") ]\n        };\n\n        let result = multi_admin_handle(\n            deps,\n            mock_env(HumanAddr::from(\"unauthorized\"), \u0026[]),\n            msg,\n            DefaultHandleImpl\n        )\n        .unwrap_err();\n\n        match result {\n            StdError::Unauthorized { .. } =\u003e { },\n            _ =\u003e panic!(\"Expected \\\"StdError::Unauthorized\\\"\")\n        };\n\n        run_msg(deps, vec![], 1);\n\n        run_msg(\n            deps,\n            vec![\n                HumanAddr::from(\"archer\"),\n                HumanAddr::from(\"lana\")\n            ],\n            3\n        );\n\n        run_msg(\n            deps,\n            vec![\n                HumanAddr::from(\"pam\"),\n            ],\n            4\n        );\n    }\n\n    #[test]\n    fn test_query() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let result = multi_admin_query(deps, MultiAdminQueryMsg::Admins, DefaultQueryImpl).unwrap();\n\n        let response: MultiAdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.addresses.len() == 0);\n\n        let admins = vec![\n            HumanAddr::from(\"archer\"),\n            HumanAddr::from(\"lana\")\n        ];\n\n        save_admins(deps, \u0026admins).unwrap();\n\n        let result = multi_admin_query(deps, MultiAdminQueryMsg::Admins, DefaultQueryImpl).unwrap();\n\n        let response: MultiAdminQueryResponse = from_binary(\u0026result).unwrap();\n        assert!(response.addresses == admins);\n    }\n}\n","traces":[{"line":12,"address":[525289,525120],"length":1,"stats":{"Line":2},"fn_name":"multi_admin_handle\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::multi_admin::DefaultHandleImpl\u003e"},{"line":19,"address":[525161],"length":1,"stats":{"Line":2},"fn_name":null},{"line":23,"address":[525380,525328],"length":1,"stats":{"Line":2},"fn_name":"multi_admin_query\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e,composable_admin::multi_admin::DefaultQueryImpl\u003e"},{"line":29,"address":[525353],"length":1,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":6},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":4},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":2},"fn_name":null},{"line":88,"address":[526927,526720],"length":1,"stats":{"Line":8},"fn_name":"save_admins\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":92,"address":[526763],"length":1,"stats":{"Line":8},"fn_name":null},{"line":95,"address":[527024,527115,527622,526964,526904],"length":1,"stats":{"Line":40},"fn_name":null},{"line":96,"address":[527572,527147,527355],"length":1,"stats":{"Line":8},"fn_name":null},{"line":97,"address":[527287],"length":1,"stats":{"Line":8},"fn_name":null},{"line":100,"address":[528048,527100,527683,528103],"length":1,"stats":{"Line":24},"fn_name":null},{"line":102,"address":[528189],"length":1,"stats":{"Line":8},"fn_name":null},{"line":105,"address":[528224,528426],"length":1,"stats":{"Line":6},"fn_name":"load_admins\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":108,"address":[528441,528278],"length":1,"stats":{"Line":6},"fn_name":null},{"line":111,"address":[528411,528466],"length":1,"stats":{"Line":12},"fn_name":null},{"line":113,"address":[528511,528690,528794,529486,528761],"length":1,"stats":{"Line":26},"fn_name":null},{"line":114,"address":[529033,528938],"length":1,"stats":{"Line":14},"fn_name":null},{"line":117,"address":[529530],"length":1,"stats":{"Line":6},"fn_name":null},{"line":120,"address":[530075,529664,530090],"length":1,"stats":{"Line":5},"fn_name":"assert_admin\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":124,"address":[529829,529702],"length":1,"stats":{"Line":5},"fn_name":null},{"line":126,"address":[529985,529930,529806],"length":1,"stats":{"Line":18},"fn_name":null},{"line":127,"address":[530015],"length":1,"stats":{"Line":2},"fn_name":null},{"line":130,"address":[529991,530042],"length":1,"stats":{"Line":10},"fn_name":null},{"line":133,"address":[530460,530445,530096],"length":1,"stats":{"Line":8},"fn_name":"load\u003calloc::vec::Vec\u003ccosmwasm_std::addresses::CanonicalAddr, alloc::alloc::Global\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":134,"address":[530677,530689,530348,530464,530205,530137],"length":1,"stats":{"Line":27},"fn_name":"{{closure}}\u003calloc::vec::Vec\u003ccosmwasm_std::addresses::CanonicalAddr, alloc::alloc::Global\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":135,"address":[530546],"length":1,"stats":{"Line":9},"fn_name":null},{"line":136,"address":[530477],"length":1,"stats":{"Line":9},"fn_name":null},{"line":137,"address":[530500],"length":1,"stats":{"Line":9},"fn_name":null},{"line":138,"address":[530537],"length":1,"stats":{"Line":9},"fn_name":null},{"line":142,"address":[530259,530390],"length":1,"stats":{"Line":14},"fn_name":null},{"line":152,"address":[572033,570576],"length":1,"stats":{"Line":3},"fn_name":"test_handle"},{"line":155,"address":[574017,573152],"length":1,"stats":{"Line":1},"fn_name":"run_msg\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":166,"address":[573242],"length":1,"stats":{"Line":1},"fn_name":null},{"line":167,"address":[573351],"length":1,"stats":{"Line":1},"fn_name":null},{"line":171,"address":[573424,573509],"length":1,"stats":{"Line":1},"fn_name":null},{"line":173,"address":[573541,573502],"length":1,"stats":{"Line":2},"fn_name":null},{"line":174,"address":[573607,573717],"length":1,"stats":{"Line":1},"fn_name":null},{"line":175,"address":[573579],"length":1,"stats":{"Line":1},"fn_name":null},{"line":176,"address":[573681],"length":1,"stats":{"Line":0},"fn_name":null},{"line":180,"address":[570583],"length":1,"stats":{"Line":1},"fn_name":null},{"line":182,"address":[570627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":183,"address":[570742,570876,570668],"length":1,"stats":{"Line":3},"fn_name":null},{"line":186,"address":[570989],"length":1,"stats":{"Line":1},"fn_name":null},{"line":191,"address":[571175],"length":1,"stats":{"Line":1},"fn_name":null},{"line":192,"address":[571279],"length":1,"stats":{"Line":1},"fn_name":null},{"line":198,"address":[571383],"length":1,"stats":{"Line":1},"fn_name":null},{"line":199,"address":[571409],"length":1,"stats":{"Line":0},"fn_name":null},{"line":202,"address":[571498,571402],"length":1,"stats":{"Line":2},"fn_name":null},{"line":206,"address":[571593,571515],"length":1,"stats":{"Line":1},"fn_name":null},{"line":207,"address":[571531],"length":1,"stats":{"Line":1},"fn_name":null},{"line":208,"address":[571562],"length":1,"stats":{"Line":1},"fn_name":null},{"line":215,"address":[571790,571837],"length":1,"stats":{"Line":2},"fn_name":null},{"line":216,"address":[571806],"length":1,"stats":{"Line":1},"fn_name":null},{"line":223,"address":[572064,573088],"length":1,"stats":{"Line":3},"fn_name":"test_query"},{"line":224,"address":[572071],"length":1,"stats":{"Line":1},"fn_name":null},{"line":226,"address":[572119],"length":1,"stats":{"Line":1},"fn_name":null},{"line":228,"address":[572209],"length":1,"stats":{"Line":1},"fn_name":null},{"line":229,"address":[572292,572421],"length":1,"stats":{"Line":1},"fn_name":null},{"line":231,"address":[572484,572374],"length":1,"stats":{"Line":1},"fn_name":null},{"line":232,"address":[572390],"length":1,"stats":{"Line":1},"fn_name":null},{"line":233,"address":[572453],"length":1,"stats":{"Line":1},"fn_name":null},{"line":236,"address":[572669],"length":1,"stats":{"Line":1},"fn_name":null},{"line":238,"address":[572751],"length":1,"stats":{"Line":1},"fn_name":null},{"line":240,"address":[572804],"length":1,"stats":{"Line":1},"fn_name":null},{"line":241,"address":[572898,572975],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":70,"coverable":72},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-admin","require-admin","src","lib.rs"],"content":"use proc_macro::TokenStream;\nuse syn::{FnArg, ItemFn, PathArguments, Stmt, Type, parse_macro_input, parse_quote, Pat, PatIdent};\nuse syn::punctuated::Punctuated;\nuse syn::token::Comma;\nuse quote::quote;\n\n#[proc_macro_attribute]\npub fn require_admin(_attr: TokenStream, func: TokenStream) -\u003e TokenStream {\n    let mut ast = parse_macro_input!(func as ItemFn);\n\n    let (deps, env) = find_extern_arg(\u0026ast.sig.inputs);\n\n    let stmt = create_require_admin_stmt(deps, env);\n    ast.block.stmts.insert(0, stmt);\n\n    let result = quote! {\n        #ast\n    };\n\n    TokenStream::from(result)\n}\n\nfn find_extern_arg(args: \u0026Punctuated\u003cFnArg, Comma\u003e) -\u003e (PatIdent, PatIdent) {\n    let mut deps: Option\u003cPatIdent\u003e = None;\n    let mut env: Option\u003cPatIdent\u003e = None;\n\n    for arg in args {\n        match arg {\n            FnArg::Typed(item) =\u003e {\n                match item.ty.as_ref() {\n                    Type::Reference(reference) =\u003e {\n                        match reference.elem.as_ref() {\n                            Type::Path(type_path) =\u003e {\n                                let result = type_path.path.segments.iter()\n                                    .find(|i| {\n                                        if let PathArguments::AngleBracketed(_) = i.arguments {\n                                            if i.ident.to_string() == \"Extern\" {\n                                                return true\n                                            }\n                                        }\n\n                                        false\n                                    });\n\n                                if let Some(_) = result {\n                                    if let Pat::Ident(ident) = item.pat.as_ref() {\n                                        deps = Some(ident.clone())\n                                    }\n                                }\n                            },\n                            _ =\u003e continue\n                        }\n                    },\n                    Type::Path(type_path) =\u003e {\n                        let result = type_path.path.segments.iter()\n                            .find(|i| {\n                                if i.ident.to_string() == \"Env\" {\n                                    return true\n                                }\n                    \n                                false\n                            });\n                \n                        if let Some(_) = result {\n                            if let Pat::Ident(ident) = item.pat.as_ref() {\n                                env = Some(ident.clone())\n                            }\n                        }\n                    }\n                    _ =\u003e continue\n                }\n            },\n            _ =\u003e continue\n        }\n    }\n    \n    return (\n        deps.unwrap_or_else(|| panic!(\"Couldn't find argument of type \\\"Extern\u003cStorage, Api, Querier\u003e\\\"\")),\n        env.unwrap_or_else(|| panic!(\"Couldn't find arguments of type \\\"Env\\\"\"))\n    );\n}\n\nfn create_require_admin_stmt(deps: PatIdent, env: PatIdent) -\u003e Stmt {\n    let code = quote! {\n        assert_admin(#deps, \u0026#env)?;\n    };\n\n    parse_quote!(#code)\n}\n","traces":[{"line":8,"address":[268760,267392,268775],"length":1,"stats":{"Line":0},"fn_name":"require_admin"},{"line":9,"address":[267625,267423,267530],"length":1,"stats":{"Line":0},"fn_name":null},{"line":11,"address":[267840,267599],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[268048],"length":1,"stats":{"Line":0},"fn_name":null},{"line":14,"address":[268325],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[268599,268435],"length":1,"stats":{"Line":0},"fn_name":null},{"line":20,"address":[268644,268526],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[270704,268784],"length":1,"stats":{"Line":0},"fn_name":"find_extern_arg"},{"line":24,"address":[268828],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[268863],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[269111,268986,268882,269087,269585],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[269148],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[269183],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[269211,269301],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[269316],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[269344],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[269376],"length":1,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[276110,275984],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":36,"address":[276003,276132,276034],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[276126,276043,276018],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[276134],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[276036],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[269529,269583],"length":1,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[269637,269560,269595,269784],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[269789,269618,269639],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[269247],"length":1,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[269262,269860],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[276255,276160],"length":1,"stats":{"Line":0},"fn_name":"{{closure}}"},{"line":57,"address":[276174,276271],"length":1,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[276284],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[276277],"length":1,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[269972,270026],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[270228,270078,270003,270036],"length":1,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[270059,270083,270233],"length":1,"stats":{"Line":0},"fn_name":null},{"line":77,"address":[270556],"length":1,"stats":{"Line":0},"fn_name":null},{"line":78,"address":[270294],"length":1,"stats":{"Line":0},"fn_name":null},{"line":79,"address":[270421],"length":1,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[271456,270736],"length":1,"stats":{"Line":0},"fn_name":"create_require_admin_stmt"},{"line":84,"address":[270765,270846],"length":1,"stats":{"Line":0},"fn_name":null},{"line":88,"address":[271167,271248],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":40},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-auth","composable-auth","src","lib.rs"],"content":"pub use cosmwasm_utils::viewing_key::{ViewingKey, VIEWING_KEY_SIZE};\n\nuse cosmwasm_std::{\n    StdResult, Extern, Env, Api, Querier, Storage,\n    StdError, HandleResponse, to_binary\n};\nuse schemars::JsonSchema;\nuse serde::{Serialize, Deserialize};\nuse cosmwasm_utils::storage::{ns_save, ns_load};\n\nconst VIEWING_KEYS: \u0026[u8] = b\"XXzo7ZXRJ2\";\n\npub fn auth_handle\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    msg: AuthHandleMsg,\n    handle: impl AuthHandle,\n) -\u003e StdResult\u003cHandleResponse\u003e {\n    match msg {\n        AuthHandleMsg::CreateViewingKey { entropy, .. } =\u003e\n            handle.create_viewing_key(deps, env, entropy),\n        AuthHandleMsg::SetViewingKey { key, .. } =\u003e \n            handle.set_viewing_key(deps, env, key)\n    }\n}\n\npub trait AuthHandle {\n    fn create_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        entropy: String\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        let prng_seed = [ \n            env.block.time.to_be_bytes(),\n            env.block.height.to_be_bytes() \n        ].concat();\n\n        let key = ViewingKey::new(\u0026env, \u0026prng_seed, \u0026(entropy).as_ref());\n        let address = deps.api.canonical_address(\u0026env.message.sender)?;\n        save_viewing_key(deps, address.as_slice(), \u0026key)?;\n\n        Ok(HandleResponse {\n            messages: vec![],\n            log: vec![],\n            data: Some(to_binary(\u0026CreateViewingKeyData {\n                key: key.0\n            })?)\n        })\n    }\n\n    fn set_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n        \u0026self,\n        deps: \u0026mut Extern\u003cS, A, Q\u003e,\n        env: Env,\n        key: String\n    ) -\u003e StdResult\u003cHandleResponse\u003e {\n        let key = ViewingKey(key);\n        let address = deps.api.canonical_address(\u0026env.message.sender)?;\n        save_viewing_key(deps, address.as_slice(), \u0026key)?;\n\n        Ok(HandleResponse::default())\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub enum AuthHandleMsg {\n    CreateViewingKey {\n        entropy: String,\n        padding: Option\u003cString\u003e,\n    },\n    SetViewingKey {\n        key: String,\n        padding: Option\u003cString\u003e,\n    }\n}\n\n#[derive(JsonSchema, Serialize, Deserialize, Debug, Clone, PartialEq)]\n#[serde(rename_all = \"snake_case\")]\npub struct CreateViewingKeyData {\n    pub key: String\n}\n\npub struct DefaultHandleImpl;\n\nimpl AuthHandle for DefaultHandleImpl { }\n\n#[inline]\npub fn save_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    key: \u0026[u8],\n    viewing_key: \u0026ViewingKey\n) -\u003e StdResult\u003c()\u003e {\n    ns_save(\u0026mut deps.storage, VIEWING_KEYS, key, \u0026viewing_key)\n}\n\n#[inline]\npub fn load_viewing_key\u003cS: Storage, A: Api, Q: Querier\u003e(\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    key: \u0026[u8],\n) -\u003e StdResult\u003cOption\u003cViewingKey\u003e\u003e {\n    ns_load(\u0026deps.storage, VIEWING_KEYS, key)\n}\n\npub fn authenticate(\n    storage: \u0026impl Storage,\n    provided_key: \u0026ViewingKey,\n    storage_key: \u0026[u8]\n) -\u003e StdResult\u003c()\u003e {\n    let stored_vk: Option\u003cViewingKey\u003e = ns_load(storage, VIEWING_KEYS, storage_key)?;\n\n    if let Some(key) = stored_vk {\n        if provided_key.check_viewing_key(\u0026key.to_hashed()) {\n            return Ok(());\n        }\n    }\n\n    provided_key.check_viewing_key(\u0026[0u8; VIEWING_KEY_SIZE]);\n\n    return Err(StdError::unauthorized());\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use cosmwasm_std::{from_binary, HumanAddr};\n    use cosmwasm_std::testing::{mock_dependencies, mock_env};\n\n    #[test]\n    fn test_handle() {\n        let ref mut deps = mock_dependencies(10, \u0026[]);\n\n        let sender = HumanAddr(\"sender\".into());\n        let sender_canonical = deps.api.canonical_address(\u0026sender).unwrap();\n        let env = mock_env(sender, \u0026[]);\n\n        let result = auth_handle(\n            deps,\n            env.clone(),\n            AuthHandleMsg::CreateViewingKey { entropy: \"123\".into(), padding: None },\n            DefaultHandleImpl\n        ).unwrap();\n\n        let created_vk: CreateViewingKeyData = from_binary(\u0026result.data.unwrap()).unwrap();\n        let created_vk = ViewingKey(created_vk.key);\n        \n        assert_eq!(created_vk, load_viewing_key(deps, sender_canonical.as_slice()).unwrap().unwrap());\n\n        let auth_result = authenticate(\u0026deps.storage, \u0026ViewingKey(\"invalid\".into()), sender_canonical.as_slice());\n        assert_eq!(auth_result.unwrap_err(), StdError::unauthorized());\n\n        let auth_result = authenticate(\u0026deps.storage, \u0026created_vk, sender_canonical.as_slice());\n        assert!(auth_result.is_ok());\n\n        let new_key = String::from(\"new_key\");\n\n        auth_handle(\n            deps,\n            env.clone(),\n            AuthHandleMsg::SetViewingKey { key: new_key.clone(), padding: None },\n            DefaultHandleImpl\n        ).unwrap();\n\n        assert_eq!(ViewingKey(new_key.clone()), load_viewing_key(deps, sender_canonical.as_slice()).unwrap().unwrap());\n\n        let auth_result = authenticate(\u0026deps.storage, \u0026ViewingKey(new_key), sender_canonical.as_slice());\n        assert!(auth_result.is_ok());\n    }\n}\n","traces":[{"line":28,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":59,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":60,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":62,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":95,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":103,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-callback","lib.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, StdResult, Api, Binary};\nuse fadroma_scrt_addr::{Humanize, Canonize};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\n/// Info needed to instantiate a contract.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInstantiationInfo {\n    pub code_hash: String,\n    pub id: u64\n}\n\n/// Info needed to talk to a contract instance.\n#[derive(Default, Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInstance\u003cA\u003e {\n    pub address: A,\n    pub code_hash: String\n}\nimpl Canonize\u003cContractInstance\u003cCanonicalAddr\u003e\u003e for ContractInstance\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractInstance\u003cCanonicalAddr\u003e\u003e {\n        Ok(ContractInstance {\n            address:   self.address.canonize(api)?,\n            code_hash: self.code_hash.clone()\n        })\n    }\n}\nimpl Humanize\u003cContractInstance\u003cHumanAddr\u003e\u003e for ContractInstance\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractInstance\u003cHumanAddr\u003e\u003e {\n        Ok(ContractInstance {\n            address:   self.address.humanize(api)?,\n            code_hash: self.code_hash.clone()\n        })\n    }\n}\n\n#[deprecated(note=\"Please use ContractInstance\u003cHumanAddr\u003e instead.\")]\npub type ContractInfo = ContractInstance\u003cHumanAddr\u003e;\n\n#[deprecated(note=\"Please use ContractInstance\u003cCanonicalAddr\u003e instead.\")]\npub type ContractInfoStored = ContractInstance\u003cCanonicalAddr\u003e;\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n/// Info needed to have the other contract respond.\npub struct Callback\u003cA\u003e {\n    /// The message to call.\n    pub msg: Binary,\n    /// Info about the contract requesting the callback.\n    pub contract: ContractInstance\u003cA\u003e\n}\nimpl Canonize\u003cCallback\u003cCanonicalAddr\u003e\u003e for Callback\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCallback\u003cCanonicalAddr\u003e\u003e {\n        Ok(Callback { msg: self.msg.clone(), contract: self.contract.canonize(api)? })\n    }\n}\nimpl Humanize\u003cCallback\u003cHumanAddr\u003e\u003e for Callback\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCallback\u003cHumanAddr\u003e\u003e {\n        Ok(Callback { msg: self.msg.clone(), contract: self.contract.humanize(api)? })\n    }\n}\n\n#[deprecated(note=\"Please use Callback\u003cCanonicalAddr\u003e instead.\")]\npub type CallbackStored = Callback\u003cCanonicalAddr\u003e;\n","traces":[{"line":20,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":21,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":22,"address":[1094008,1093878],"length":1,"stats":{"Line":8},"fn_name":null},{"line":23,"address":[],"length":0,"stats":{"Line":8},"fn_name":null},{"line":28,"address":[786571,786160,786556],"length":1,"stats":{"Line":3},"fn_name":"humanize\u003ccosmwasm_std::mock::MockApi\u003e"},{"line":29,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":31,"address":[],"length":0,"stats":{"Line":3},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":8,"coverable":12},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-contract","lib.rs"],"content":"//! # Fadroma\n\n/// Import commonly used definitions that need to be available everywhere in the contract\n#[macro_export] macro_rules! prelude {\n    () =\u003e { use cosmwasm_std::{\n        Storage, Api, Querier, Extern, Env,\n        HumanAddr, CanonicalAddr, Coin, Uint128,\n        StdResult, StdError,\n        InitResponse, HandleResponse, LogAttribute, Binary,\n        CosmosMsg, BankMsg, WasmMsg, to_binary,\n        log\n    }; };\n}\n\n/// Define an enum that implements the necessary traits\n/// (de/serialization, schema generation, cloning, debug printing, equality comparison)\n#[macro_export] macro_rules! message {\n    ( $Msg:ident { $( $(#[$meta:meta])* $field:ident : $type:ty ),* } ) =\u003e {\n        #[derive(serde::Serialize,serde::Deserialize,Clone,Debug,PartialEq,schemars::JsonSchema)]\n        #[serde(rename_all = \"snake_case\")]\n        pub struct $Msg { $( $(#[$meta])* pub $field: $type ),* } } }\n\n/// Define an enum with variants that implement the necessary traits\n#[macro_export] macro_rules! messages {\n    ( $( $Enum:ident { $( $(#[$meta:meta])* $Msg:ident { $( $field:ident : $type:ty ),* } )* } )*\n    ) =\u003e { $(\n        #[derive(serde::Serialize,serde::Deserialize,Clone,Debug,PartialEq,schemars::JsonSchema)]\n        #[serde(rename_all = \"snake_case\")]\n        pub enum $Enum { $( $(#[$meta])* $Msg { $($field : $type),* } ),* } )* } }\n\n/// Define the state singleton.\n// TODO: Support other shapes of state\n#[macro_export] macro_rules! define_state_singleton {\n    (\n        $State:ident\n        { $( $(#[$meta:meta])* $state_field:ident : $state_field_type:ty ),* }\n    ) =\u003e {\n        /// State singleton\n        message!($State { $($(#[$meta])* $state_field:$state_field_type),* });\n        use cosmwasm_storage::{Singleton, singleton, ReadonlySingleton, singleton_read};\n        pub static CONFIG_KEY: \u0026[u8] = b\"fadroma_root_state\";\n        pub fn get_store_rw\u003cS: Storage\u003e(storage: \u0026mut S) -\u003e Singleton\u003cS, $State\u003e {\n            singleton(storage, CONFIG_KEY)\n        }\n        pub fn get_store_ro\u003cS: Storage\u003e(storage: \u0026S) -\u003e ReadonlySingleton\u003cS, $State\u003e {\n            singleton_read(storage, CONFIG_KEY)\n        }\n    }\n}\n\n/// Instantiation interface.\n#[macro_export] macro_rules! define_init_message {\n    // if imported:\n    ($_:ident, $Import:ident) =\u003e { pub use super::$Import; };\n    // if defined in place:\n    ($Name:ident, { $(\n        $(#[$meta:meta])* $arg:ident : $type:ty\n    ),* }) =\u003e {\n        message!($Name { $($arg: $type),* });\n    }\n}\n\n/// Query interface.\n#[macro_export] macro_rules! define_q_messages {\n    // if imported:\n    ($_1:tt, $Import:ident, { $($_2:tt)* }) =\u003e { pub use super::$Import; };\n    // if defined in place:\n    ($Name:ident, { $(\n        $(#[$meta:meta])* $Variant:ident ( $($arg:ident : $type:ty),* )\n    )* }) =\u003e {\n        messages!($Name { $( $(#[$meta])* $Variant {$($arg: $type),*} )* });\n    };\n}\n\n/// Transaction interface.\n#[macro_export] macro_rules! define_tx_messages {\n    // if imported:\n    ($_1:tt, $Import:ident, { $($_2:tt)* }) =\u003e { pub use super::$Import; };\n    // if defined in place:\n    ($Name:ident, { $(\n        $(#[$meta:meta])* $Variant:ident ( $($arg:ident : $type:ty),* )\n    )* }) =\u003e {\n        messages!($Name { $( $(#[$meta])* $Variant {$($arg: $type),*} )* });\n    };\n}\n\n/// Instatiation. Either defines or imports an `InitMsg`, and hooks up your init logic to it.\n/// Function body must return the initial value of `State`.\n#[macro_export] macro_rules! implement_init {\n    // define the InitMsg in place:\n    (\n        $(#[$InitMeta:meta])* [$Init:ident]\n        ($deps:ident, $env:ident, $msg:ident :{ $($field:ident : $type:ty),* }) $body:block\n    ) =\u003e {\n        use msg::$Init;\n        $(#[$InitMeta])*\n        pub fn init \u003cS: Storage, A: Api, Q: Querier\u003e(\n            $deps: \u0026mut Extern\u003cS, A, Q\u003e, $env: Env, $msg: $Init\n        ) -\u003e StdResult\u003cInitResponse\u003e {\n            $(let $field : $type = $msg.$field;)*\n            get_store_rw(\u0026mut $deps.storage).save(\u0026$body)?;\n            Ok(InitResponse::default())\n        }\n    };\n    // or import it from an external module:\n    (\n        $(#[$InitMeta:meta])* [$_:ident]\n        ($deps:ident, $env:ident, $msg:ident : $InitExt:ty ) $body:block\n    ) =\u003e {\n        $(#[$InitMeta])*\n        pub fn init \u003cS: Storage, A: Api, Q: Querier\u003e(\n            $deps: \u0026mut Extern\u003cS, A, Q\u003e, $env: Env, $msg: $InitExt\n        ) -\u003e StdResult\u003cInitResponse\u003e {\n            // no auto-destructuring\n            get_store_rw(\u0026mut $deps.storage).save(\u0026$body)?;\n            Ok(InitResponse::default())\n        }\n    };\n}\n\n/// Query implementations.\n#[macro_export] macro_rules! implement_queries {\n    // for external query message type, ignore the name in the brackets\n    // and pass through to the next macro variantb\n    (\n        $State:ident, $EnumExt:ident, $_:ident\n        ( $deps:ident, $state:ident, $msg:ident ) -\u003e $Response:ident { $($bodies:tt)* }\n    ) =\u003e {\n        implement_queries!($State, $EnumExt ( $deps, $state, $msg ) -\u003e $Response { $($bodies)* });\n    };\n\n    // implement queries defined in $body\n    (\n        $State:ident, $Enum:ident\n        ( $deps:ident, $state:ident, $msg:ident ) -\u003e $Response:ident { $(\n            $(#[$meta:meta])* $Variant:ident ( $($field:ident : $type:ty),*)\n            $body:tt\n        )* }\n    ) =\u003e {\n        /// Query dispatcher.\n        pub fn query \u003cS: Storage, A: Api, Q: Querier\u003e (\n            $deps: \u0026Extern\u003cS, A, Q\u003e, $msg: msg::$Enum\n        ) -\u003e StdResult\u003cBinary\u003e {\n            let state = get_store_ro(\u0026$deps.storage).load()?; // get snapshot of contract state\n            let result = match $msg { $( // find the matching handler\n                msg::$Enum::$Variant {..} =\u003e self::queries::$Variant($deps, state, $msg),\n            )* };\n            Ok(cosmwasm_std::to_binary(\u0026result?)?) // return handler result\n        }\n        /// Query handlers.\n        mod queries {\n            prelude!();\n            use super::{*, msg::Response};\n            // for every query message variant, define a handler \n            $(\n                $(#[$meta])*\n                #[allow(non_snake_case)]\n                pub fn $Variant \u003cS: Storage, A: Api, Q: Querier\u003e(\n                    $deps: \u0026Extern\u003cS, A, Q\u003e, $state: $State, $msg: msg::$Enum,\n                ) -\u003e StdResult\u003c$Response\u003e {\n                    if let super::msg::$Enum::$Variant {$($field),*} = $msg { // destructure the message\n                        $body // perform user-specified actions\n                    } else { unreachable!() }\n                }\n            )*\n        }\n\n    }\n}\n\n/// Transaction implementations\n#[macro_export] macro_rules! implement_transactions {\n    (   $State:ident, $Enum:ident, $_:ident\n        ($deps:ident, $env:ident, $state:ident, $msg:ident) -\u003e $Response:ident { $($bodies:tt)* }\n    ) =\u003e {\n        implement_transactions!($State, $Enum ($deps, $env, $state, $msg) -\u003e $Response { $($bodies)* });\n    };\n    (   $State:ident, $Enum:ident\n        ($deps:ident, $env:ident, $state:ident, $msg:ident) -\u003e $Response:ident {\n            $($(#[$meta:meta])* $Variant:ident ( $($arg:ident $(: $type:ty)?),* ) $body:block)*\n        }\n    ) =\u003e {\n        /// Transaction dispatcher\n        pub fn handle \u003cS: Storage, A: Api, Q: Querier\u003e (\n            $deps: \u0026mut Extern\u003cS, A, Q\u003e, $env: Env, $msg: msg::$Enum,\n        ) -\u003e StdResult\u003cHandleResponse\u003e {\n            // pick the handler that matches the message and call it:\n            match $msg { $(\n                msg::$Enum::$Variant {..} =\u003e self::handle::$Variant($deps, $env, $msg),\n            )* }\n        }\n        /// Transaction handlers\n        mod handle {\n            prelude!();\n            use super::*;\n            // shorthand for saving state\n            // define a handler for every tx message variant\n            $(#[allow(non_snake_case)] pub fn $Variant \u003cS: Storage, A: Api, Q: Querier\u003e(\n                $deps: \u0026mut Extern\u003cS, A, Q\u003e,\n                $env:  Env,\n                $msg:  msg::$Enum,\n            ) -\u003e StdResult\u003cHandleResponse\u003e {\n                // get mutable snapshot of current state:\n                let mut $state = get_store_rw(\u0026mut $deps.storage).load()?;\n                macro_rules! save_state {\n                    () =\u003e { get_store_rw(\u0026mut $deps.storage).save(\u0026$state)?; }\n                };\n                if let super::msg::$Enum::$Variant {$($arg),*} = $msg {\n                    // perform user-specified actions\n                    $body\n                } else {\n                    unreachable!()\n                }\n            })*\n        }\n    };\n}\n\n/// Define a smart contract\n#[macro_export] macro_rules! contract {\n\n    // This pattern matching is ugly!\n    (\n        // passed to `define_state_singleton!`\n        [$State:ident]\n        { $( $(#[$meta:meta])* $state_field:ident : $state_field_type:ty ),* }\n\n        // Define the signature of the init message, how it's handled.\n        //\n        $(#[$InitMeta:meta])*\n        [$Init:ident]\n        ( $init_deps:ident, $init_env:ident, $init_msg:ident : $($init_msg_definition:tt)+\n        ) $init_body:block\n\n        // Define query messages and how they're handled:\n        [$Q:ident]\n        ( $q_deps:ident, $q_state:ident, $q_msg:ident $( : $ExtQ:ident)? )\n        -\u003e $QResponse:ident { $(\n            $(#[$QVariantMeta:meta])* $QVariant:ident\n            ($($q_arg:ident $(: $q_arg_type:ty)?),*) $q_body:tt\n        )* }\n\n        // Define possible responses:\n        [$Response:ident] {\n        $( $(#[$response_meta:meta])* $ResponseMsg:ident { $($resp_field:ident : $resp_field_type:ty),* } )* }\n\n        // Define transaction messages and how they're handled:\n        [$TX:ident]\n        ( $tx_deps:ident, $tx_env:ident, $tx_state:ident, $tx_msg:ident $( : $ExtTX:ident)? )\n        -\u003e $TXResponse:ident { $(\n            $(#[$TXVariantMeta:meta])* $TXVariant:ident\n            ($($tx_arg:ident $(: $tx_arg_type:ty)?),*) $tx_body:tt\n        )* }\n\n    ) =\u003e {\n\n        prelude!();\n\n        /// WASM entry points.\n        // Similar in spirit to [`create_entry_points`](https://docs.rs/cosmwasm-std/0.10.1/src/cosmwasm_std/entry_points.rs.html#49),\n        // but doesn't need the implementation to be in a sibling module (the `super::contract` on L65)\n        // TODO custom `migrate` for SecretNetwork\n        #[cfg(target_arch = \"wasm32\")]\n        mod wasm {\n            //use super::contract;\n            use cosmwasm_std::{\n                ExternalStorage as Storage, ExternalApi as Api, ExternalQuerier as Querier,\n                do_init, do_handle, do_query\n            };\n            #[no_mangle] extern \"C\" fn init (env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n                do_init(\u0026super::init::\u003cStorage, Api, Querier\u003e, env_ptr, msg_ptr)\n            }\n            #[no_mangle] extern \"C\" fn handle (env_ptr: u32, msg_ptr: u32) -\u003e u32 {\n                do_handle(\u0026super::handle::\u003cStorage, Api, Querier\u003e, env_ptr, msg_ptr)\n            }\n            #[no_mangle] extern \"C\" fn query (msg_ptr: u32) -\u003e u32 {\n                do_query(\u0026super::query::\u003cStorage, Api, Querier\u003e, msg_ptr,)\n            }\n            // Other C externs like cosmwasm_vm_version_1, allocate, deallocate are available\n            // automatically because we `use cosmwasm_std`.\n        }\n\n        /// This contract's on-chain API.\n        pub mod msg {\n            // The argument sets of the {Init,Query,Handle}Msg handlers\n            // are used to automatically generate the corresponding\n            // protocol messages.\n            // * This is why the @Q/@TX/@Response sub-sections are not just passed in as opaque `tt`s\n            // * Only responses can't be inferred and need to be pre-defined.\n            // * Although, with some more macro trickery, they could be defined in place\n            //   (e.g. the return types of $Q handlers could be defined as\n            //   `-\u003e Foo { field: type }` and then populated with `return Self { field: value }`\n            // * Let's revisit this once some we have some more examples of custom responses\n            //\n            prelude!();\n\n            use super::*;\n\n            define_init_message!($Init, $($init_msg_definition)+);\n\n            define_q_messages!($Q, $($ExtQ,)? {\n                $( $(#[$QVariantMeta])* $QVariant ($($q_arg $(: $q_arg_type)?),*))*\n            });\n\n            define_tx_messages!($TX, $($ExtTX,)? {\n                $( $(#[$TXVariantMeta])* $TXVariant ($( $tx_arg $(: $tx_arg_type)?),*))*\n            });\n\n            messages!($Response { $(\n                $(#[$response_meta])* $ResponseMsg {$($resp_field: $resp_field_type),*}\n            )* });\n        }\n\n        /// Implementations\n        //use msg::{$Init,$Q,$TX,$Response};\n\n        define_state_singleton! {\n            $State { $( $(#[$meta])* $state_field : $state_field_type ),* }\n        }\n\n        implement_init! {\n            $(#[$InitMeta])* [$Init]\n            ($init_deps, $init_env, $init_msg : $($init_msg_definition)+) $init_body\n        }\n\n        implement_queries! {\n            $State, $($ExtQ,)? $Q ($q_deps, $q_state, $q_msg) -\u003e $QResponse { $(\n                $(#[$QVariantMeta])* $QVariant\n                ($($q_arg $(: $q_arg_type)?),*) $q_body\n            )* }\n        }\n\n        implement_transactions! {\n            $State, $($ExtTX,)? $TX ($tx_deps, $tx_env, $tx_state, $tx_msg) -\u003e $TXResponse { $(\n                $(#[$TXVariantMeta])* $TXVariant\n                ($( $tx_arg $(: $tx_arg_type)?),*) $tx_body\n            )* }\n        }\n\n    };\n\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","checks.rs"],"content":"use cosmwasm_std::{StdResult, StdError, HumanAddr};\nuse crate::types::{ContractStatus, ContractStatusLevel};\n\nmacro_rules! migration_message {\n    (paused: $reason:expr) =\u003e { format!(\n         \"This contract has been paused. Reason: {}\",\n         \u0026$reason\n    ) };\n    (migration: $reason:expr, $new_address:expr) =\u003e { format!(\n         \"This contract is being migrated to {}, please use that address instead. Reason: {}\",\n         \u0026$new_address.unwrap_or(HumanAddr::default()),\n         \u0026$reason\n    ) };\n}\n\npub fn is_operational (status: \u0026ContractStatus\u003cHumanAddr\u003e) -\u003e StdResult\u003c()\u003e {\n    let ContractStatus { level, reason, new_address } = status;\n    match level {\n        ContractStatusLevel::Operational =\u003e Ok(()),\n        ContractStatusLevel::Paused =\u003e Err(StdError::GenericErr {\n            backtrace: None,\n            msg: migration_message!(paused: reason)\n        }),\n        ContractStatusLevel::Migrating =\u003e Err(StdError::GenericErr {\n            backtrace: None,\n            msg: migration_message!(migration: reason, new_address.clone())\n        }),\n    }\n}\n\npub fn can_set_status (\n    status:           \u0026ContractStatus\u003cHumanAddr\u003e,\n    new_status_level: \u0026ContractStatusLevel\n) -\u003e StdResult\u003c()\u003e {\n    let ContractStatus { level, reason, new_address } = status;\n    match level {\n        ContractStatusLevel::Operational =\u003e Ok(()),\n        ContractStatusLevel::Paused =\u003e Ok(()),\n        ContractStatusLevel::Migrating =\u003e match new_status_level {\n            // if already migrating, allow message and new_address to be updated\n            ContractStatusLevel::Migrating =\u003e Ok(()),\n            // but prevent reverting from migration status\n            _ =\u003e Err(StdError::GenericErr {\n                backtrace: None,\n                msg: migration_message!(migration: reason, new_address.clone())\n            })\n        }\n    }\n}\n","traces":[{"line":16,"address":[495712,496740],"length":1,"stats":{"Line":7},"fn_name":"is_operational"},{"line":17,"address":[2053081],"length":1,"stats":{"Line":7},"fn_name":null},{"line":18,"address":[2053160,2054435,2054440,2054045,2053174],"length":1,"stats":{"Line":7},"fn_name":null},{"line":19,"address":[2053129,2053167],"length":1,"stats":{"Line":14},"fn_name":null},{"line":20,"address":[2860011],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[2053179],"length":1,"stats":{"Line":0},"fn_name":null},{"line":22,"address":[2859838,2859931,2858908],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[496555],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[495934],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[2053373,2053290,2054047],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[498090,497104],"length":1,"stats":{"Line":0},"fn_name":"can_set_status"},{"line":35,"address":[497142],"length":1,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[497235,497221,497252],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[497228,497190],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[2054589],"length":1,"stats":{"Line":0},"fn_name":null},{"line":39,"address":[498047,497283],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[497262],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[497914],"length":1,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[497293],"length":1,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[497388,497305,498049],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","lib.rs"],"content":"pub mod types;\nmod storage;\nmod checks;\n\nuse cosmwasm_std::{Extern, Storage, Api, Querier, Env, HumanAddr, StdResult};\nuse composable_admin::{require_admin, admin::assert_admin};\nuse fadroma_scrt_addr::{Humanize, Canonize};\n\n/// Return the current contract status. Defaults to operational if nothing was stored.\npub fn get_status \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003ctypes::ContractStatus\u003cHumanAddr\u003e\u003e {\n    storage::load(\u0026deps.storage)?.humanize(\u0026deps.api)\n}\n\n/// Fail if the current contract status level is other than `Operational`.\npub fn is_operational \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026Extern\u003cS, A, Q\u003e\n) -\u003e StdResult\u003c()\u003e {\n    checks::is_operational(\u0026get_status(deps)?)\n}\n\n/// Fail if trying to return from `Migrating` status.\npub fn can_set_status \u003cS: Storage, A: Api, Q: Querier\u003e  (\n    deps: \u0026Extern\u003cS, A, Q\u003e,\n    to_level: \u0026types::ContractStatusLevel\n) -\u003e StdResult\u003c()\u003e {\n    checks::can_set_status(\u0026get_status(deps)?, to_level)\n}\n\n/// Store a new contract status.\n#[require_admin]\npub fn set_status \u003cS: Storage, A: Api, Q: Querier\u003e (\n    deps: \u0026mut Extern\u003cS, A, Q\u003e,\n    env: Env,\n    level: types::ContractStatusLevel,\n    reason: String,\n    new_address: Option\u003cHumanAddr\u003e\n) -\u003e StdResult\u003c()\u003e {\n    storage::save(\u0026mut deps.storage, \u0026types::ContractStatus { level, reason, new_address: match new_address {\n        Some(new_address) =\u003e Some(new_address.canonize(\u0026deps.api)?),\n        None =\u003e None\n    } })\n}\n\n/// Wrap status levels around the `match` statement that does your handle dispatch.\n#[macro_export] macro_rules! with_status {\n    // by default, assumes the handle msg enum is called `HandleMsg` and imported\n    ($deps:ident, $env:ident, match $msg:ident { $($rest:tt)* }) =\u003e {\n        with_status!(HandleMsg, $deps, $env, match $msg { $($rest)* })\n    };\n    // but an alternative name can be passed\n    ($HandleMsg:ty, $deps:ident, $env:ident, match $msg:ident { $($rest:tt)* }) =\u003e {\n        if let HandleMsg::SetStatus { level, reason, new_address } = $msg {\n            fadroma_scrt_migrate::can_set_status(\u0026$deps, \u0026level)?;\n            fadroma_scrt_migrate::set_status($deps, $env, level, reason, new_address)?;\n            Ok(HandleResponse::default())\n        } else {\n            fadroma_scrt_migrate::is_operational(\u0026$deps)?;\n            match $msg {\n                HandleMsg::SetStatus { .. } =\u003e unreachable!(),\n                $($rest)*\n            }\n        }\n    }\n}\n","traces":[{"line":10,"address":[579500,579152],"length":1,"stats":{"Line":4},"fn_name":"get_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":13,"address":[579182],"length":1,"stats":{"Line":4},"fn_name":null},{"line":17,"address":[581788,581456],"length":1,"stats":{"Line":3},"fn_name":"is_operational\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":20,"address":[581480],"length":1,"stats":{"Line":4},"fn_name":null},{"line":24,"address":[581428,581072],"length":1,"stats":{"Line":0},"fn_name":"can_set_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":28,"address":[581110],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[580000,579700,579803,579576],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[579520,581058,581043],"length":1,"stats":{"Line":0},"fn_name":"set_status\u003ccosmwasm_std::storage::MemoryStorage,cosmwasm_std::mock::MockApi,cosmwasm_std::mock::MockQuerier\u003ccosmwasm_std::types::Empty\u003e\u003e"},{"line":40,"address":[579742,580076,580840,580062],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[579773,580091],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[580064],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":11},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","storage.rs"],"content":"use cosmwasm_std::{StdResult, CanonicalAddr, Storage};\nuse crate::types::ContractStatus;\n\npub const PREFIX: \u0026[u8] = b\"fadroma_migration_state\";\n\npub fn load (storage: \u0026impl Storage) -\u003e StdResult\u003cContractStatus\u003cCanonicalAddr\u003e\u003e {\n    match cosmwasm_utils::storage::load(storage, PREFIX)? {\n        Some(status) =\u003e status,\n        None =\u003e Ok(ContractStatus::default())\n    }\n}\npub fn save (storage: \u0026mut impl Storage, status: \u0026ContractStatus\u003cCanonicalAddr\u003e) -\u003e StdResult\u003c()\u003e {\n    cosmwasm_utils::storage::save(storage, PREFIX, status)\n}\n","traces":[{"line":6,"address":[571968],"length":1,"stats":{"Line":5},"fn_name":"load\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":7,"address":[572434,572432,571992,572331,572246],"length":1,"stats":{"Line":12},"fn_name":null},{"line":8,"address":[572348,572225],"length":1,"stats":{"Line":5},"fn_name":null},{"line":9,"address":[572399,572333],"length":1,"stats":{"Line":13},"fn_name":null},{"line":12,"address":[572448],"length":1,"stats":{"Line":0},"fn_name":"save\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":13,"address":[572472],"length":1,"stats":{"Line":0},"fn_name":null}],"covered":4,"coverable":6},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","test.rs"],"content":"// TODO\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-migrate","types.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, StdResult, Api};\nuse serde::{Serialize, Deserialize};\nuse schemars::JsonSchema;\nuse fadroma_scrt_addr::{Humanize, Canonize};\n\n/// Possible states of a contract.\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Debug, Clone)]\npub enum ContractStatusLevel {\n    /// Live\n    Operational,\n    /// Temporarily disabled\n    Paused,\n    /// Permanently disabled\n    Migrating,\n}\n\n// TODO once serde-json-wasm finally supports serializing Rusty enums,\n// this structure can be merged with `ContractStatusLevel`, with\n// `reason` and `new_address` becoming propeties of `Migrating`\n/// Current state of a contract w/ optional description and pointer to new version\n#[derive(Serialize, Deserialize, JsonSchema, PartialEq, Debug, Clone)]\npub struct ContractStatus\u003cA\u003e {\n    pub level:       ContractStatusLevel,\n    pub reason:      String,\n    pub new_address: Option\u003cA\u003e\n}\nimpl\u003cA\u003e Default for ContractStatus\u003cA\u003e {\n    fn default () -\u003e Self { Self {\n        level:       ContractStatusLevel::Operational,\n        reason:      String::new(),\n        new_address: None\n    } }\n}\nimpl Humanize\u003cContractStatus\u003cHumanAddr\u003e\u003e for ContractStatus\u003cCanonicalAddr\u003e {\n    fn humanize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractStatus\u003cHumanAddr\u003e\u003e {\n        Ok(ContractStatus {\n            level: self.level.clone(),\n            reason: self.reason.clone(),\n            new_address: match \u0026self.new_address {\n                Some(canon_addr) =\u003e Some(api.human_address(\u0026canon_addr)?),\n                None =\u003e None\n            }\n        })\n    }\n}\nimpl Canonize\u003cContractStatus\u003cCanonicalAddr\u003e\u003e for ContractStatus\u003cHumanAddr\u003e {\n    fn canonize (\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractStatus\u003cCanonicalAddr\u003e\u003e {\n        Ok(ContractStatus {\n            level: self.level.clone(),\n            reason: self.reason.clone(),\n            new_address: match \u0026self.new_address {\n                Some(human_addr) =\u003e Some(api.canonical_address(\u0026human_addr)?),\n                None =\u003e None\n            }\n        })\n    }\n}\n","traces":[{"line":28,"address":[749504,749550],"length":1,"stats":{"Line":14},"fn_name":"default\u003ccosmwasm_std::addresses::CanonicalAddr\u003e"},{"line":30,"address":[999874],"length":1,"stats":{"Line":7},"fn_name":null},{"line":35,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":36,"address":[999293],"length":1,"stats":{"Line":7},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":38,"address":[748309],"length":1,"stats":{"Line":7},"fn_name":null},{"line":39,"address":[],"length":0,"stats":{"Line":14},"fn_name":null},{"line":40,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":7},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":51,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":53,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":9,"coverable":16},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-storage","lib.rs"],"content":"use serde::Serialize;\nuse serde::de::DeserializeOwned;\nuse cosmwasm_std::{ReadonlyStorage, StdResult, Storage, from_slice, to_vec};\n\npub fn save\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, key: \u0026[u8], value: \u0026T) -\u003e StdResult\u003c()\u003e {\n    storage.set(key, \u0026to_vec(value)?);\n    Ok(())\n}\n\npub fn remove\u003cS: Storage\u003e(storage: \u0026mut S, key: \u0026[u8]) {\n    storage.remove(key);\n}\n\npub fn load\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, key: \u0026[u8]) -\u003e StdResult\u003cOption\u003cT\u003e\u003e {\n    let result = storage.get(key);\n\n    if let Some(data) = result {\n        from_slice(\u0026data)\n    } else {\n        Ok(None)\n    }\n}\n\npub fn ns_save\u003cT: Serialize, S: Storage\u003e(storage: \u0026mut S, namespace: \u0026[u8], key: \u0026[u8], value: \u0026T) -\u003e StdResult\u003c()\u003e {\n    let key = concat(namespace, key);\n    storage.set(\u0026key, \u0026to_vec(value)?);\n\n    Ok(())\n}\n\npub fn ns_remove\u003cS: Storage\u003e(storage: \u0026mut S, namespace: \u0026[u8], key: \u0026[u8]) {\n    let key = concat(namespace, key);\n    storage.remove(\u0026key);\n}\n\npub fn ns_load\u003cT: DeserializeOwned, S: ReadonlyStorage\u003e(storage: \u0026S, namespace: \u0026[u8], key: \u0026[u8]) -\u003e StdResult\u003cOption\u003cT\u003e\u003e {\n    let key = concat(namespace, key);\n\n    load(storage, \u0026key)\n}\n\n#[inline]\nfn concat(namespace: \u0026[u8], key: \u0026[u8]) -\u003e Vec\u003cu8\u003e {\n    let mut k = namespace.to_vec();\n    k.extend_from_slice(key);\n\n    k\n}\n\n","traces":[{"line":5,"address":[648570,648192,649024,648986,648608,649402],"length":1,"stats":{"Line":19},"fn_name":"save\u003ccosmwasm_std::addresses::CanonicalAddr,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":6,"address":[648510,649342,649101,648926,648685,648269],"length":1,"stats":{"Line":39},"fn_name":null},{"line":7,"address":[816702,815454,816286,815870,815038],"length":1,"stats":{"Line":21},"fn_name":null},{"line":10,"address":[816720],"length":1,"stats":{"Line":1},"fn_name":"remove\u003ccosmwasm_std::storage::MemoryStorage\u003e"},{"line":11,"address":[816738],"length":1,"stats":{"Line":1},"fn_name":null},{"line":14,"address":[647779,647136,648125,647840,647488,647427],"length":1,"stats":{"Line":12},"fn_name":"load\u003ccore::result::Result\u003cfadroma_scrt_migrate::types::ContractStatus\u003ccosmwasm_std::addresses::CanonicalAddr\u003e, cosmwasm_std::errors::std_error::StdError\u003e,cosmwasm_std::storage::MemoryStorage\u003e"},{"line":15,"address":[647881,647177,647529],"length":1,"stats":{"Line":12},"fn_name":null},{"line":17,"address":[666692],"length":1,"stats":{"Line":13},"fn_name":null},{"line":18,"address":[647607,648070,647950,647372,647255,647724],"length":1,"stats":{"Line":16},"fn_name":null},{"line":20,"address":[647292,647644,647987],"length":1,"stats":{"Line":7},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":10,"coverable":14},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","convert.rs"],"content":"use cosmwasm_std::{StdResult, StdError};\nuse crate::u256_math;\nuse crate::u256_math::U256;\n\n/// Convert between tokens with different decimals.\n///\n/// # Arguments\n///\n/// * `amount` - the amount of the input token to convert\n/// * `rate` - corresponds to the output token decimals. E.g: If we want 1:1 rate and the output token has 6 decimals, then rate = 1_000_000\n/// * `input_decimals` - the number of decimals of the input token\n/// * `output_decimals` - the number of decimals of the output token\npub fn convert_token(\n    amount: u128,\n    rate: u128,\n    input_decimals: u8,\n    output_decimals: u8\n) -\u003e StdResult\u003cu128\u003e {\n    let err_msg = \"u128 overflow detected.\";\n\n    // result = amount * rate / one whole output token\n \n    let amount = Some(U256::from(amount));\n    let rate = Some(U256::from(rate));\n\n    let mut result = u256_math::mul(amount, rate).ok_or_else(|| \n        StdError::generic_err(err_msg)\n    )?;\n\n    // But, if tokens have different number of decimals, we need to compensate either by \n    // dividing or multiplying (depending on which token has more decimals) the difference\n    if input_decimals \u003c output_decimals {\n        let compensation = get_whole_token_representation(\n            output_decimals - input_decimals\n        );\n        let compensation = Some(U256::from(compensation));\n\n        result = u256_math::mul(Some(result), compensation).ok_or_else(|| \n            StdError::generic_err(err_msg) \n        )?;\n    } else if output_decimals \u003c input_decimals {\n        let compensation = get_whole_token_representation(\n            input_decimals - output_decimals\n        );\n        let compensation = Some(U256::from(compensation));\n\n        result = u256_math::div(Some(result), compensation).ok_or_else(|| \n            StdError::generic_err(err_msg) \n        )?;\n    }\n\n    let whole_token = Some(U256::from(\n        get_whole_token_representation(output_decimals)\n    ));\n\n    let result = u256_math::div(Some(result), whole_token).ok_or_else(||\n        StdError::generic_err(err_msg)\n    )?;\n\n    // Check if resulting u128 would overflow\n    if result.0[3] \u003e 0 {\n        return Err(StdError::generic_err(err_msg));\n    }\n\n    Ok(result.low_u128())\n}\n\n/// Get the amount needed to represent 1 whole token given its decimals.\n/// Ex. Given token A that has 3 decimals, 1 A == 1000\npub fn get_whole_token_representation(decimals: u8) -\u003e u128 {\n    let mut whole_token = 1u128;\n\n    for _ in 0..decimals {\n        whole_token *= 10;\n    };\n\n    whole_token\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_convert_token() {\n        // Assuming the user friendly (in the UI) exchange rate has been set to\n        // 1 swapped_token (9 decimals) == 1.5 input_token (9 decimals):\n        // the rate would be 1 / 1.5 = 0.(6) or 666666666 (0.(6) ** 10 * 9)\n        // meaning the price for 1 whole swapped_token is\n        // 1500000000 (1.5 * 10 ** 9 decimals) of input_token.\n\n        // If we want to get 2 of swapped_token, we need to send 3 input_token\n        // i.e. amount = 3000000000 (3 * 10 ** 9 decimals)\n\n        let rate = 666_666_666;\n        let amount = 3_000_000_000;\n\n        let result = convert_token(amount, rate, 9, 9).unwrap();\n        assert_eq!(result, 1_999_999_998);\n\n        // Should work the same even if input_token has less decimals (ex. 6)\n        // Here amount has 3 zeroes less because input_token now has 6 decimals, so\n        // 1 input_token = 3000000 (3 * 10 ** 6)\n\n        let rate = 666_666_666;\n        let amount = 3_000_000;\n\n        let result = convert_token(amount, rate, 6, 9).unwrap();\n        assert_eq!(result, 1_999_999_998);\n\n        // And the other way around - when swap_token has 6 decimals.\n        // Here the rate and result have 3 less digits - to account for the less decimals\n\n        let rate = 666_666;\n        let amount = 3_000_000_000;\n\n        let result = convert_token(amount, rate, 9, 6).unwrap();\n        assert_eq!(result, 1_999_998);\n    }\n}\n","traces":[{"line":13,"address":[554592],"length":1,"stats":{"Line":1},"fn_name":"convert_token"},{"line":19,"address":[554678],"length":1,"stats":{"Line":1},"fn_name":null},{"line":23,"address":[554705],"length":1,"stats":{"Line":1},"fn_name":null},{"line":24,"address":[554808],"length":1,"stats":{"Line":1},"fn_name":null},{"line":26,"address":[1910256],"length":1,"stats":{"Line":1},"fn_name":"{{closure}}"},{"line":27,"address":[540452],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[555206,555997],"length":1,"stats":{"Line":2},"fn_name":null},{"line":34,"address":[555330,555389],"length":1,"stats":{"Line":1},"fn_name":null},{"line":36,"address":[555429],"length":1,"stats":{"Line":1},"fn_name":null},{"line":38,"address":[555522,555803,556060],"length":1,"stats":{"Line":1},"fn_name":null},{"line":39,"address":[540500],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[555309,556105,556782],"length":1,"stats":{"Line":3},"fn_name":null},{"line":43,"address":[556115,556174],"length":1,"stats":{"Line":1},"fn_name":null},{"line":45,"address":[556214],"length":1,"stats":{"Line":1},"fn_name":null},{"line":47,"address":[540528],"length":1,"stats":{"Line":1},"fn_name":"{{closure}}"},{"line":48,"address":[540548],"length":1,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[556876],"length":1,"stats":{"Line":1},"fn_name":null},{"line":53,"address":[556082],"length":1,"stats":{"Line":1},"fn_name":null},{"line":56,"address":[557250,556969,557454],"length":1,"stats":{"Line":1},"fn_name":null},{"line":57,"address":[540596],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[557380],"length":1,"stats":{"Line":1},"fn_name":null},{"line":62,"address":[557496],"length":1,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[557472,557584],"length":1,"stats":{"Line":2},"fn_name":null},{"line":70,"address":[557616],"length":1,"stats":{"Line":1},"fn_name":"get_whole_token_representation"},{"line":71,"address":[557627],"length":1,"stats":{"Line":1},"fn_name":null},{"line":73,"address":[557645,557748,557852],"length":1,"stats":{"Line":3},"fn_name":null},{"line":74,"address":[557887,557857,557760],"length":1,"stats":{"Line":1},"fn_name":null},{"line":85,"address":[559141,559136],"length":1,"stats":{"Line":3},"fn_name":"{{closure}}"},{"line":95,"address":[557927],"length":1,"stats":{"Line":1},"fn_name":null},{"line":96,"address":[557956],"length":1,"stats":{"Line":1},"fn_name":null},{"line":98,"address":[557976],"length":1,"stats":{"Line":1},"fn_name":null},{"line":99,"address":[558051,558254],"length":1,"stats":{"Line":1},"fn_name":null},{"line":105,"address":[558148],"length":1,"stats":{"Line":1},"fn_name":null},{"line":106,"address":[558172],"length":1,"stats":{"Line":1},"fn_name":null},{"line":108,"address":[558298,558196],"length":1,"stats":{"Line":2},"fn_name":null},{"line":109,"address":[558342,558546],"length":1,"stats":{"Line":1},"fn_name":null},{"line":114,"address":[558439],"length":1,"stats":{"Line":1},"fn_name":null},{"line":115,"address":[558468],"length":1,"stats":{"Line":1},"fn_name":null},{"line":117,"address":[558488,558590],"length":1,"stats":{"Line":2},"fn_name":null},{"line":118,"address":[558749,558634],"length":1,"stats":{"Line":1},"fn_name":null}],"covered":35,"coverable":40},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","crypto.rs"],"content":"use rand_chacha::ChaChaRng;\nuse rand_core::{RngCore, SeedableRng};\nuse subtle::ConstantTimeEq;\nuse sha2::{Digest, Sha256};\n\npub struct Prng {\n    rng: ChaChaRng,\n}\n\npub fn sha_256(data: \u0026[u8]) -\u003e [u8; 32] {\n    let mut hasher = Sha256::new();\n    hasher.update(data);\n    let hash = hasher.finalize();\n\n    let mut result = [0u8; 32];\n    result.copy_from_slice(hash.as_slice());\n    \n    result\n}\n\npub fn compare_slice_ct_time(s1: \u0026[u8], s2: \u0026[u8]) -\u003e bool {\n    bool::from(s1.ct_eq(s2))\n}\n\nimpl Prng {\n    pub fn new(seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        let mut hasher = Sha256::new();\n\n        // write input message\n        hasher.update(\u0026seed);\n        hasher.update(\u0026entropy);\n        let hash = hasher.finalize();\n\n        let mut hash_bytes = [0u8; 32];\n        hash_bytes.copy_from_slice(hash.as_slice());\n\n        let rng: ChaChaRng = ChaChaRng::from_seed(hash_bytes);\n\n        Self { rng }\n    }\n\n    pub fn rand_bytes(\u0026mut self) -\u003e [u8; 32] {\n        let mut bytes = [0u8; 32];\n        self.rng.fill_bytes(\u0026mut bytes);\n\n        bytes\n    }\n}","traces":[{"line":10,"address":[536528],"length":1,"stats":{"Line":0},"fn_name":"sha_256"},{"line":11,"address":[536571],"length":1,"stats":{"Line":0},"fn_name":null},{"line":12,"address":[1913184],"length":1,"stats":{"Line":0},"fn_name":null},{"line":13,"address":[536601],"length":1,"stats":{"Line":0},"fn_name":null},{"line":15,"address":[1913245],"length":1,"stats":{"Line":0},"fn_name":null},{"line":16,"address":[536671],"length":1,"stats":{"Line":0},"fn_name":null},{"line":21,"address":[1913328],"length":1,"stats":{"Line":0},"fn_name":"compare_slice_ct_time"},{"line":22,"address":[536760],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[536800],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":27,"address":[1913429],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[1913440],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[536862],"length":1,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":35,"address":[536941],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":44,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":20},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","data.rs"],"content":"use cosmwasm_std::{HumanAddr, CanonicalAddr, StdResult, Api, Binary};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\nuse crate::{humanize_maybe_empty, canonicalize_maybe_empty};\n\n/// Code hash and address of a contract.\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInfo {\n    pub code_hash: String,\n    pub address: HumanAddr,\n}\n/// Code hash and address of a contract.\n#[derive(Serialize, Deserialize, Clone, PartialEq, Debug)]\npub struct ContractInfoStored {\n    pub code_hash: String,\n    pub address: CanonicalAddr,\n}\n\n/// Info used to instantiate a contract\n#[derive(Serialize, Deserialize, JsonSchema, Clone, PartialEq, Debug)]\npub struct ContractInstantiationInfo {\n    pub code_hash: String,\n    pub id: u64\n}\n\n#[derive(Serialize, Deserialize, Clone, Debug, PartialEq, JsonSchema)]\n/// Used to ask a contract to send back a message.\npub struct Callback {\n    /// The message to call.\n    pub msg: Binary,\n    /// Info about the contract requesting the callback.\n    pub contract: ContractInfo\n}\n\n#[derive(Serialize, Deserialize, Clone, PartialEq, Debug)]\n/// Used to ask a contract to send back a message.\npub struct CallbackStored {\n    /// The message to call.\n    pub msg: Binary,\n    /// Info about the contract requesting the callback.\n    pub contract: ContractInfoStored\n}\n\nimpl Default for ContractInfo {\n    fn default() -\u003e Self {\n        ContractInfo {\n            code_hash: \"\".into(),\n            address: HumanAddr::default()\n        }\n    }\n}\n\nimpl ContractInfo {\n    pub fn to_stored(\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cContractInfoStored\u003e {\n        Ok(ContractInfoStored {\n            code_hash: self.code_hash.clone(),\n            address: canonicalize_maybe_empty(api, \u0026self.address)?\n        })\n    }\n}\n\nimpl ContractInfoStored {\n    pub fn to_normal(self, api: \u0026impl Api) -\u003e StdResult\u003cContractInfo\u003e {\n        Ok(ContractInfo {\n            code_hash: self.code_hash,\n            address: humanize_maybe_empty(api, \u0026self.address)?\n        })\n    }\n}\n\nimpl Callback {\n    pub fn to_stored(\u0026self, api: \u0026impl Api) -\u003e StdResult\u003cCallbackStored\u003e {\n        Ok(CallbackStored{\n            msg: self.msg.clone(),\n            contract: self.contract.to_stored(api)?\n        })\n    }\n}\n\nimpl CallbackStored {\n    pub fn to_normal(self, api: \u0026impl Api) -\u003e StdResult\u003cCallback\u003e {\n        Ok(Callback{\n            msg: self.msg.clone(),\n            contract: self.contract.to_normal(api)?\n        })\n    }\n}\n","traces":[{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[527502],"length":1,"stats":{"Line":0},"fn_name":null},{"line":48,"address":[527529],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":55,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":64,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":65,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":66,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":73,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":74,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":75,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":81,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":82,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":83,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":84,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":19},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","lib.rs"],"content":"use cosmwasm_std::{CanonicalAddr, HumanAddr, Api, StdResult};\n\npub mod viewing_key;\npub mod storage;\npub mod crypto;\npub mod convert;\npub mod u256_math;\n\nmod data;\n\npub use data::*;\n\n/// Attempting to canonicalize an empty address will fail. \n/// This function skips calling `canonical_address` if the input is empty\n/// and returns `CanonicalAddr::default()` instead.\npub fn canonicalize_maybe_empty(api: \u0026impl Api, addr: \u0026HumanAddr) -\u003e StdResult\u003cCanonicalAddr\u003e {\n    Ok(\n        if *addr == HumanAddr::default() {\n            CanonicalAddr::default()\n        } else {\n            api.canonical_address(addr)?\n        }\n    )\n}\n\n/// Attempting to humanize an empty address will fail. \n/// This function skips calling `human_address` if the input is empty\n/// and returns `HumanAddr::default()` instead.\npub fn humanize_maybe_empty(api: \u0026impl Api, addr: \u0026CanonicalAddr) -\u003e StdResult\u003cHumanAddr\u003e {\n    Ok(\n        if *addr == CanonicalAddr::default() {\n            HumanAddr::default()\n        } else {\n            api.human_address(addr)?\n        }\n    )\n}\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","storage.rs"],"content":"#![deprecated(note=\"Please use fadroma_scrt_storage instead\")]\npub use fadroma_scrt_storage::*;\n","traces":[],"covered":0,"coverable":0},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","u256_math.rs"],"content":"// Copied from https://github.com/enigmampc/SecretSwap/blob/master/contracts/secretswap_pair/src/u256_math.rs\n\npub use primitive_types::U256;\n\n/// U256 sqrt ported from here: https://ethereum.stackexchange.com/a/87713/12112\n///\n/// function sqrt(uint y) internal pure returns (uint z) {\n///     if (y \u003e 3) {\n///         z = y;\n///         uint x = y / 2 + 1;\n///         while (x \u003c z) {\n///             z = x;\n///             x = (y / x + x) / 2;\n///         }\n///     } else if (y != 0) {\n///         z = 1;\n///     }\n/// }\n///\n/// Tested it here: https://github.com/enigmampc/u256-sqrt-test/blob/aa7693/src/main.rs\npub fn sqrt(y: U256) -\u003e Option\u003cU256\u003e {\n    let mut z = U256::from(0);\n    if y.gt(\u0026U256::from(3)) {\n        z = y.clone();\n        let mut x = y.checked_div(U256::from(2))?.checked_add(U256::from(1))?;\n        while x.lt(\u0026z) {\n            z = x.clone();\n            x = y\n                .checked_div(x)?\n                .checked_add(x)?\n                .checked_div(U256::from(2))?;\n        }\n    } else if !y.is_zero() {\n        z = U256::from(1);\n    }\n\n    return Some(z);\n}\n\npub fn sub(a: Option\u003cU256\u003e, b: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match b {\n        Some(b) =\u003e a.and_then(checked_sub(b)),\n        None =\u003e None,\n    }\n}\n\npub fn div(nom: Option\u003cU256\u003e, denom: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match denom {\n        Some(denom) =\u003e nom.and_then(checked_div(denom)),\n        None =\u003e None,\n    }\n}\n\npub fn add(a: Option\u003cU256\u003e, b: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match b {\n        Some(b) =\u003e a.and_then(checked_add(b)),\n        None =\u003e None,\n    }\n}\n\npub fn mul(a: Option\u003cU256\u003e, b: Option\u003cU256\u003e) -\u003e Option\u003cU256\u003e {\n    match b {\n        Some(b) =\u003e a.and_then(checked_mul(b)),\n        None =\u003e None,\n    }\n}\n\nfn checked_sub(b: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |a: U256| a.checked_sub(b)\n}\n\nfn checked_div(denom: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |nom: U256| nom.checked_div(denom)\n}\n\nfn checked_add(b: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |a: U256| a.checked_add(b)\n}\n\nfn checked_mul(b: U256) -\u003e impl Fn(U256) -\u003e Option\u003cU256\u003e {\n    move |a: U256| a.checked_mul(b)\n}\n","traces":[{"line":21,"address":[537408],"length":1,"stats":{"Line":0},"fn_name":"sqrt"},{"line":22,"address":[537430],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[537443,538130],"length":1,"stats":{"Line":0},"fn_name":null},{"line":24,"address":[537513],"length":1,"stats":{"Line":0},"fn_name":null},{"line":25,"address":[538087,537568,537879],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[539108,538097,538080],"length":1,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[538135],"length":1,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[538395,538914,538677,538324,538213,539118,538589,538833],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[538375,538260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[538525,538657],"length":1,"stats":{"Line":0},"fn_name":null},{"line":31,"address":[538807,538894],"length":1,"stats":{"Line":0},"fn_name":null},{"line":33,"address":[539336,539249,537494,539331],"length":1,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[539260],"length":1,"stats":{"Line":0},"fn_name":null},{"line":37,"address":[539133],"length":1,"stats":{"Line":0},"fn_name":null},{"line":40,"address":[539344],"length":1,"stats":{"Line":0},"fn_name":"sub"},{"line":41,"address":[539396,539382],"length":1,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[539410,539370],"length":1,"stats":{"Line":0},"fn_name":null},{"line":43,"address":[539389],"length":1,"stats":{"Line":0},"fn_name":null},{"line":47,"address":[539568],"length":1,"stats":{"Line":1},"fn_name":"div"},{"line":48,"address":[539620,539606],"length":1,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[539634,539594],"length":1,"stats":{"Line":2},"fn_name":null},{"line":50,"address":[539613],"length":1,"stats":{"Line":0},"fn_name":null},{"line":54,"address":[539792],"length":1,"stats":{"Line":0},"fn_name":"add"},{"line":55,"address":[539844,539830],"length":1,"stats":{"Line":0},"fn_name":null},{"line":56,"address":[539858,539818],"length":1,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[539837],"length":1,"stats":{"Line":0},"fn_name":null},{"line":61,"address":[540016],"length":1,"stats":{"Line":1},"fn_name":"mul"},{"line":62,"address":[540068,540054],"length":1,"stats":{"Line":0},"fn_name":null},{"line":63,"address":[540082,540042],"length":1,"stats":{"Line":2},"fn_name":null},{"line":64,"address":[540061],"length":1,"stats":{"Line":0},"fn_name":null},{"line":68,"address":[540240],"length":1,"stats":{"Line":0},"fn_name":"checked_sub"},{"line":69,"address":[540243],"length":1,"stats":{"Line":0},"fn_name":null},{"line":72,"address":[540288],"length":1,"stats":{"Line":1},"fn_name":"checked_div"},{"line":73,"address":[540291],"length":1,"stats":{"Line":3},"fn_name":null},{"line":76,"address":[540336],"length":1,"stats":{"Line":0},"fn_name":"checked_add"},{"line":77,"address":[540339],"length":1,"stats":{"Line":0},"fn_name":null},{"line":80,"address":[540384],"length":1,"stats":{"Line":1},"fn_name":"checked_mul"},{"line":81,"address":[540387],"length":1,"stats":{"Line":3},"fn_name":null}],"covered":8,"coverable":38},{"path":["/","home","hack_lenovo_03","sienna","amm","libraries","fadroma","scrt-utils","src","viewing_key.rs"],"content":"//Copied from https://github.com/enigmampc/snip20-reference-impl/blob/master/src/viewing_key.rs\n\nuse std::fmt;\n\nuse cosmwasm_std::{Env, Binary};\nuse schemars::JsonSchema;\nuse serde::{Deserialize, Serialize};\n\nuse crate::crypto::{sha_256, Prng, compare_slice_ct_time};\n\npub const VIEWING_KEY_SIZE: usize = 32;\nconst VIEWING_KEY_PREFIX: \u0026str = \"api_key_\";\n\n#[derive(Serialize, Deserialize, JsonSchema, Clone, Debug, PartialEq)]\npub struct ViewingKey(pub String);\n\npub fn create_hashed_password(s1: \u0026str) -\u003e [u8; VIEWING_KEY_SIZE] {\n    sha_256(s1.as_bytes())\n}\n\nimpl ViewingKey {\n    ///A good source for the `seed` and `entropy` values is https://www.random.org/strings/\n    pub fn new(env: \u0026Env, seed: \u0026[u8], entropy: \u0026[u8]) -\u003e Self {\n        // 16 here represents the lengths in bytes of the block height and time.\n        let entropy_len = 16 + env.message.sender.len() + entropy.len();\n        let mut rng_entropy = Vec::with_capacity(entropy_len);\n        rng_entropy.extend_from_slice(\u0026env.block.height.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.block.time.to_be_bytes());\n        rng_entropy.extend_from_slice(\u0026env.message.sender.0.as_bytes());\n        rng_entropy.extend_from_slice(entropy);\n\n        let mut rng = Prng::new(seed, \u0026rng_entropy);\n\n        let rand_slice = rng.rand_bytes();\n\n        let key = sha_256(\u0026rand_slice);\n\n        Self(VIEWING_KEY_PREFIX.to_string() + \u0026Binary::from(\u0026key).to_base64())\n    }\n\n    pub fn to_hashed(\u0026self) -\u003e [u8; VIEWING_KEY_SIZE] {\n        create_hashed_password(\u0026self.0)\n    }\n\n    pub fn as_bytes(\u0026self) -\u003e \u0026[u8] {\n        self.0.as_bytes()\n    }\n\n    pub fn check_viewing_key(\u0026self, hashed_pw: \u0026[u8]) -\u003e bool {\n        let mine_hashed = create_hashed_password(\u0026self.0);\n\n        compare_slice_ct_time(\u0026mine_hashed, hashed_pw)\n    }\n}\n\nimpl fmt::Display for ViewingKey {\n    fn fmt(\u0026self, f: \u0026mut fmt::Formatter\u003c'_\u003e) -\u003e fmt::Result {\n        write!(f, \"{}\", self.0)\n    }\n}\n","traces":[{"line":17,"address":[547664],"length":1,"stats":{"Line":0},"fn_name":"create_hashed_password"},{"line":18,"address":[547743],"length":1,"stats":{"Line":0},"fn_name":null},{"line":23,"address":[547760,548626],"length":1,"stats":{"Line":0},"fn_name":"new"},{"line":25,"address":[548013,547856],"length":1,"stats":{"Line":0},"fn_name":null},{"line":26,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":27,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":28,"address":[1905645],"length":1,"stats":{"Line":0},"fn_name":null},{"line":29,"address":[548258],"length":1,"stats":{"Line":0},"fn_name":null},{"line":30,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":32,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":34,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":36,"address":[548489],"length":1,"stats":{"Line":0},"fn_name":null},{"line":38,"address":[548748,548649,548496,548887],"length":1,"stats":{"Line":0},"fn_name":null},{"line":41,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":42,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":45,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":46,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":49,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":50,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":52,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":57,"address":[],"length":0,"stats":{"Line":0},"fn_name":null},{"line":58,"address":[],"length":0,"stats":{"Line":0},"fn_name":null}],"covered":0,"coverable":22}]};
    </script>
    <script crossorigin>/** @license React v16.13.1
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
'use strict';(function(d,r){"object"===typeof exports&&"undefined"!==typeof module?r(exports):"function"===typeof define&&define.amd?define(["exports"],r):(d=d||self,r(d.React={}))})(this,function(d){function r(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function w(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function da(){}function L(a,b,c){this.props=a;this.context=b;this.refs=ba;this.updater=c||ca}function ea(a,b,c){var g,e={},fa=null,d=null;if(null!=b)for(g in void 0!==b.ref&&(d=b.ref),void 0!==b.key&&(fa=""+b.key),b)ha.call(b,g)&&!ia.hasOwnProperty(g)&&(e[g]=b[g]);var h=arguments.length-2;if(1===h)e.children=c;else if(1<h){for(var k=Array(h),f=0;f<h;f++)k[f]=arguments[f+2];e.children=k}if(a&&a.defaultProps)for(g in h=a.defaultProps,
h)void 0===e[g]&&(e[g]=h[g]);return{$$typeof:x,type:a,key:fa,ref:d,props:e,_owner:M.current}}function va(a,b){return{$$typeof:x,type:a.type,key:b,ref:a.ref,props:a.props,_owner:a._owner}}function N(a){return"object"===typeof a&&null!==a&&a.$$typeof===x}function wa(a){var b={"=":"=0",":":"=2"};return"$"+(""+a).replace(/[=:]/g,function(a){return b[a]})}function ja(a,b,c,g){if(C.length){var e=C.pop();e.result=a;e.keyPrefix=b;e.func=c;e.context=g;e.count=0;return e}return{result:a,keyPrefix:b,func:c,
context:g,count:0}}function ka(a){a.result=null;a.keyPrefix=null;a.func=null;a.context=null;a.count=0;10>C.length&&C.push(a)}function O(a,b,c,g){var e=typeof a;if("undefined"===e||"boolean"===e)a=null;var d=!1;if(null===a)d=!0;else switch(e){case "string":case "number":d=!0;break;case "object":switch(a.$$typeof){case x:case xa:d=!0}}if(d)return c(g,a,""===b?"."+P(a,0):b),1;d=0;b=""===b?".":b+":";if(Array.isArray(a))for(var f=0;f<a.length;f++){e=a[f];var h=b+P(e,f);d+=O(e,h,c,g)}else if(null===a||
"object"!==typeof a?h=null:(h=la&&a[la]||a["@@iterator"],h="function"===typeof h?h:null),"function"===typeof h)for(a=h.call(a),f=0;!(e=a.next()).done;)e=e.value,h=b+P(e,f++),d+=O(e,h,c,g);else if("object"===e)throw c=""+a,Error(r(31,"[object Object]"===c?"object with keys {"+Object.keys(a).join(", ")+"}":c,""));return d}function Q(a,b,c){return null==a?0:O(a,"",b,c)}function P(a,b){return"object"===typeof a&&null!==a&&null!=a.key?wa(a.key):b.toString(36)}function ya(a,b,c){a.func.call(a.context,b,
a.count++)}function za(a,b,c){var g=a.result,e=a.keyPrefix;a=a.func.call(a.context,b,a.count++);Array.isArray(a)?R(a,g,c,function(a){return a}):null!=a&&(N(a)&&(a=va(a,e+(!a.key||b&&b.key===a.key?"":(""+a.key).replace(ma,"$&/")+"/")+c)),g.push(a))}function R(a,b,c,g,e){var d="";null!=c&&(d=(""+c).replace(ma,"$&/")+"/");b=ja(b,d,g,e);Q(a,za,b);ka(b)}function t(){var a=na.current;if(null===a)throw Error(r(321));return a}function S(a,b){var c=a.length;a.push(b);a:for(;;){var g=c-1>>>1,e=a[g];if(void 0!==
e&&0<D(e,b))a[g]=b,a[c]=e,c=g;else break a}}function n(a){a=a[0];return void 0===a?null:a}function E(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;a:for(var g=0,e=a.length;g<e;){var d=2*(g+1)-1,f=a[d],h=d+1,k=a[h];if(void 0!==f&&0>D(f,c))void 0!==k&&0>D(k,f)?(a[g]=k,a[h]=c,g=h):(a[g]=f,a[d]=c,g=d);else if(void 0!==k&&0>D(k,c))a[g]=k,a[h]=c,g=h;else break a}}return b}return null}function D(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}function F(a){for(var b=n(u);null!==
b;){if(null===b.callback)E(u);else if(b.startTime<=a)E(u),b.sortIndex=b.expirationTime,S(p,b);else break;b=n(u)}}function T(a){y=!1;F(a);if(!v)if(null!==n(p))v=!0,z(U);else{var b=n(u);null!==b&&G(T,b.startTime-a)}}function U(a,b){v=!1;y&&(y=!1,V());H=!0;var c=m;try{F(b);for(l=n(p);null!==l&&(!(l.expirationTime>b)||a&&!W());){var g=l.callback;if(null!==g){l.callback=null;m=l.priorityLevel;var e=g(l.expirationTime<=b);b=q();"function"===typeof e?l.callback=e:l===n(p)&&E(p);F(b)}else E(p);l=n(p)}if(null!==
l)var d=!0;else{var f=n(u);null!==f&&G(T,f.startTime-b);d=!1}return d}finally{l=null,m=c,H=!1}}function oa(a){switch(a){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1E4;default:return 5E3}}var f="function"===typeof Symbol&&Symbol.for,x=f?Symbol.for("react.element"):60103,xa=f?Symbol.for("react.portal"):60106,Aa=f?Symbol.for("react.fragment"):60107,Ba=f?Symbol.for("react.strict_mode"):60108,Ca=f?Symbol.for("react.profiler"):60114,Da=f?Symbol.for("react.provider"):60109,
Ea=f?Symbol.for("react.context"):60110,Fa=f?Symbol.for("react.forward_ref"):60112,Ga=f?Symbol.for("react.suspense"):60113,Ha=f?Symbol.for("react.memo"):60115,Ia=f?Symbol.for("react.lazy"):60116,la="function"===typeof Symbol&&Symbol.iterator,pa=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,Ka=Object.prototype.propertyIsEnumerable,I=function(){try{if(!Object.assign)return!1;var a=new String("abc");a[5]="de";if("5"===Object.getOwnPropertyNames(a)[0])return!1;var b={};for(a=0;10>a;a++)b["_"+
String.fromCharCode(a)]=a;if("0123456789"!==Object.getOwnPropertyNames(b).map(function(a){return b[a]}).join(""))return!1;var c={};"abcdefghijklmnopqrst".split("").forEach(function(a){c[a]=a});return"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},c)).join("")?!1:!0}catch(g){return!1}}()?Object.assign:function(a,b){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");var c=Object(a);for(var g,e=1;e<arguments.length;e++){var d=Object(arguments[e]);
for(var f in d)Ja.call(d,f)&&(c[f]=d[f]);if(pa){g=pa(d);for(var h=0;h<g.length;h++)Ka.call(d,g[h])&&(c[g[h]]=d[g[h]])}}return c},ca={isMounted:function(a){return!1},enqueueForceUpdate:function(a,b,c){},enqueueReplaceState:function(a,b,c,d){},enqueueSetState:function(a,b,c,d){}},ba={};w.prototype.isReactComponent={};w.prototype.setState=function(a,b){if("object"!==typeof a&&"function"!==typeof a&&null!=a)throw Error(r(85));this.updater.enqueueSetState(this,a,b,"setState")};w.prototype.forceUpdate=
function(a){this.updater.enqueueForceUpdate(this,a,"forceUpdate")};da.prototype=w.prototype;f=L.prototype=new da;f.constructor=L;I(f,w.prototype);f.isPureReactComponent=!0;var M={current:null},ha=Object.prototype.hasOwnProperty,ia={key:!0,ref:!0,__self:!0,__source:!0},ma=/\/+/g,C=[],na={current:null},X;if("undefined"===typeof window||"function"!==typeof MessageChannel){var A=null,qa=null,ra=function(){if(null!==A)try{var a=q();A(!0,a);A=null}catch(b){throw setTimeout(ra,0),b;}},La=Date.now();var q=
function(){return Date.now()-La};var z=function(a){null!==A?setTimeout(z,0,a):(A=a,setTimeout(ra,0))};var G=function(a,b){qa=setTimeout(a,b)};var V=function(){clearTimeout(qa)};var W=function(){return!1};f=X=function(){}}else{var Y=window.performance,sa=window.Date,Ma=window.setTimeout,Na=window.clearTimeout;"undefined"!==typeof console&&(f=window.cancelAnimationFrame,"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),
"function"!==typeof f&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));if("object"===typeof Y&&"function"===typeof Y.now)q=function(){return Y.now()};else{var Oa=sa.now();q=function(){return sa.now()-Oa}}var J=!1,K=null,Z=-1,ta=5,ua=0;W=function(){return q()>=ua};f=function(){};X=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):
ta=0<a?Math.floor(1E3/a):5};var B=new MessageChannel,aa=B.port2;B.port1.onmessage=function(){if(null!==K){var a=q();ua=a+ta;try{K(!0,a)?aa.postMessage(null):(J=!1,K=null)}catch(b){throw aa.postMessage(null),b;}}else J=!1};z=function(a){K=a;J||(J=!0,aa.postMessage(null))};G=function(a,b){Z=Ma(function(){a(q())},b)};V=function(){Na(Z);Z=-1}}var p=[],u=[],Pa=1,l=null,m=3,H=!1,v=!1,y=!1,Qa=0;B={ReactCurrentDispatcher:na,ReactCurrentOwner:M,IsSomeRendererActing:{current:!1},assign:I};I(B,{Scheduler:{__proto__:null,
unstable_ImmediatePriority:1,unstable_UserBlockingPriority:2,unstable_NormalPriority:3,unstable_IdlePriority:5,unstable_LowPriority:4,unstable_runWithPriority:function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=m;m=a;try{return b()}finally{m=c}},unstable_next:function(a){switch(m){case 1:case 2:case 3:var b=3;break;default:b=m}var c=m;m=b;try{return a()}finally{m=c}},unstable_scheduleCallback:function(a,b,c){var d=q();if("object"===typeof c&&null!==c){var e=c.delay;
e="number"===typeof e&&0<e?d+e:d;c="number"===typeof c.timeout?c.timeout:oa(a)}else c=oa(a),e=d;c=e+c;a={id:Pa++,callback:b,priorityLevel:a,startTime:e,expirationTime:c,sortIndex:-1};e>d?(a.sortIndex=e,S(u,a),null===n(p)&&a===n(u)&&(y?V():y=!0,G(T,e-d))):(a.sortIndex=c,S(p,a),v||H||(v=!0,z(U)));return a},unstable_cancelCallback:function(a){a.callback=null},unstable_wrapCallback:function(a){var b=m;return function(){var c=m;m=b;try{return a.apply(this,arguments)}finally{m=c}}},unstable_getCurrentPriorityLevel:function(){return m},
unstable_shouldYield:function(){var a=q();F(a);var b=n(p);return b!==l&&null!==l&&null!==b&&null!==b.callback&&b.startTime<=a&&b.expirationTime<l.expirationTime||W()},unstable_requestPaint:f,unstable_continueExecution:function(){v||H||(v=!0,z(U))},unstable_pauseExecution:function(){},unstable_getFirstCallbackNode:function(){return n(p)},get unstable_now(){return q},get unstable_forceFrameRate(){return X},unstable_Profiling:null},SchedulerTracing:{__proto__:null,__interactionsRef:null,__subscriberRef:null,
unstable_clear:function(a){return a()},unstable_getCurrent:function(){return null},unstable_getThreadID:function(){return++Qa},unstable_trace:function(a,b,c){return c()},unstable_wrap:function(a){return a},unstable_subscribe:function(a){},unstable_unsubscribe:function(a){}}});d.Children={map:function(a,b,c){if(null==a)return a;var d=[];R(a,d,null,b,c);return d},forEach:function(a,b,c){if(null==a)return a;b=ja(null,null,b,c);Q(a,ya,b);ka(b)},count:function(a){return Q(a,function(){return null},null)},
toArray:function(a){var b=[];R(a,b,null,function(a){return a});return b},only:function(a){if(!N(a))throw Error(r(143));return a}};d.Component=w;d.Fragment=Aa;d.Profiler=Ca;d.PureComponent=L;d.StrictMode=Ba;d.Suspense=Ga;d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B;d.cloneElement=function(a,b,c){if(null===a||void 0===a)throw Error(r(267,a));var d=I({},a.props),e=a.key,f=a.ref,m=a._owner;if(null!=b){void 0!==b.ref&&(f=b.ref,m=M.current);void 0!==b.key&&(e=""+b.key);if(a.type&&a.type.defaultProps)var h=
a.type.defaultProps;for(k in b)ha.call(b,k)&&!ia.hasOwnProperty(k)&&(d[k]=void 0===b[k]&&void 0!==h?h[k]:b[k])}var k=arguments.length-2;if(1===k)d.children=c;else if(1<k){h=Array(k);for(var l=0;l<k;l++)h[l]=arguments[l+2];d.children=h}return{$$typeof:x,type:a.type,key:e,ref:f,props:d,_owner:m}};d.createContext=function(a,b){void 0===b&&(b=null);a={$$typeof:Ea,_calculateChangedBits:b,_currentValue:a,_currentValue2:a,_threadCount:0,Provider:null,Consumer:null};a.Provider={$$typeof:Da,_context:a};return a.Consumer=
a};d.createElement=ea;d.createFactory=function(a){var b=ea.bind(null,a);b.type=a;return b};d.createRef=function(){return{current:null}};d.forwardRef=function(a){return{$$typeof:Fa,render:a}};d.isValidElement=N;d.lazy=function(a){return{$$typeof:Ia,_ctor:a,_status:-1,_result:null}};d.memo=function(a,b){return{$$typeof:Ha,type:a,compare:void 0===b?null:b}};d.useCallback=function(a,b){return t().useCallback(a,b)};d.useContext=function(a,b){return t().useContext(a,b)};d.useDebugValue=function(a,b){};
d.useEffect=function(a,b){return t().useEffect(a,b)};d.useImperativeHandle=function(a,b,c){return t().useImperativeHandle(a,b,c)};d.useLayoutEffect=function(a,b){return t().useLayoutEffect(a,b)};d.useMemo=function(a,b){return t().useMemo(a,b)};d.useReducer=function(a,b,c){return t().useReducer(a,b,c)};d.useRef=function(a){return t().useRef(a)};d.useState=function(a){return t().useState(a)};d.version="16.13.1"});
</script>
    <script crossorigin>/** @license React v16.13.1
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
/*
 Modernizr 3.0.0pre (Custom Build) | MIT
*/
'use strict';(function(I,ea){"object"===typeof exports&&"undefined"!==typeof module?ea(exports,require("react")):"function"===typeof define&&define.amd?define(["exports","react"],ea):(I=I||self,ea(I.ReactDOM={},I.React))})(this,function(I,ea){function k(a){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+a,c=1;c<arguments.length;c++)b+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+a+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}
function ji(a,b,c,d,e,f,g,h,m){yb=!1;gc=null;ki.apply(li,arguments)}function mi(a,b,c,d,e,f,g,h,m){ji.apply(this,arguments);if(yb){if(yb){var n=gc;yb=!1;gc=null}else throw Error(k(198));hc||(hc=!0,pd=n)}}function lf(a,b,c){var d=a.type||"unknown-event";a.currentTarget=mf(c);mi(d,b,void 0,a);a.currentTarget=null}function nf(){if(ic)for(var a in cb){var b=cb[a],c=ic.indexOf(a);if(!(-1<c))throw Error(k(96,a));if(!jc[c]){if(!b.extractEvents)throw Error(k(97,a));jc[c]=b;c=b.eventTypes;for(var d in c){var e=
void 0;var f=c[d],g=b,h=d;if(qd.hasOwnProperty(h))throw Error(k(99,h));qd[h]=f;var m=f.phasedRegistrationNames;if(m){for(e in m)m.hasOwnProperty(e)&&of(m[e],g,h);e=!0}else f.registrationName?(of(f.registrationName,g,h),e=!0):e=!1;if(!e)throw Error(k(98,d,a));}}}}function of(a,b,c){if(db[a])throw Error(k(100,a));db[a]=b;rd[a]=b.eventTypes[c].dependencies}function pf(a){var b=!1,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(!cb.hasOwnProperty(c)||cb[c]!==d){if(cb[c])throw Error(k(102,c));cb[c]=
d;b=!0}}b&&nf()}function qf(a){if(a=rf(a)){if("function"!==typeof sd)throw Error(k(280));var b=a.stateNode;b&&(b=td(b),sd(a.stateNode,a.type,b))}}function sf(a){eb?fb?fb.push(a):fb=[a]:eb=a}function tf(){if(eb){var a=eb,b=fb;fb=eb=null;qf(a);if(b)for(a=0;a<b.length;a++)qf(b[a])}}function ud(){if(null!==eb||null!==fb)vd(),tf()}function uf(a,b,c){if(wd)return a(b,c);wd=!0;try{return vf(a,b,c)}finally{wd=!1,ud()}}function ni(a){if(wf.call(xf,a))return!0;if(wf.call(yf,a))return!1;if(oi.test(a))return xf[a]=
!0;yf[a]=!0;return!1}function pi(a,b,c,d){if(null!==c&&0===c.type)return!1;switch(typeof b){case "function":case "symbol":return!0;case "boolean":if(d)return!1;if(null!==c)return!c.acceptsBooleans;a=a.toLowerCase().slice(0,5);return"data-"!==a&&"aria-"!==a;default:return!1}}function qi(a,b,c,d){if(null===b||"undefined"===typeof b||pi(a,b,c,d))return!0;if(d)return!1;if(null!==c)switch(c.type){case 3:return!b;case 4:return!1===b;case 5:return isNaN(b);case 6:return isNaN(b)||1>b}return!1}function L(a,
b,c,d,e,f){this.acceptsBooleans=2===b||3===b||4===b;this.attributeName=d;this.attributeNamespace=e;this.mustUseProperty=c;this.propertyName=a;this.type=b;this.sanitizeURL=f}function xd(a,b,c,d){var e=E.hasOwnProperty(b)?E[b]:null;var f=null!==e?0===e.type:d?!1:!(2<b.length)||"o"!==b[0]&&"O"!==b[0]||"n"!==b[1]&&"N"!==b[1]?!1:!0;f||(qi(b,c,e,d)&&(c=null),d||null===e?ni(b)&&(null===c?a.removeAttribute(b):a.setAttribute(b,""+c)):e.mustUseProperty?a[e.propertyName]=null===c?3===e.type?!1:"":c:(b=e.attributeName,
d=e.attributeNamespace,null===c?a.removeAttribute(b):(e=e.type,c=3===e||4===e&&!0===c?"":""+c,d?a.setAttributeNS(d,b,c):a.setAttribute(b,c))))}function zb(a){if(null===a||"object"!==typeof a)return null;a=zf&&a[zf]||a["@@iterator"];return"function"===typeof a?a:null}function ri(a){if(-1===a._status){a._status=0;var b=a._ctor;b=b();a._result=b;b.then(function(b){0===a._status&&(b=b.default,a._status=1,a._result=b)},function(b){0===a._status&&(a._status=2,a._result=b)})}}function na(a){if(null==a)return null;
if("function"===typeof a)return a.displayName||a.name||null;if("string"===typeof a)return a;switch(a){case Ma:return"Fragment";case gb:return"Portal";case kc:return"Profiler";case Af:return"StrictMode";case lc:return"Suspense";case yd:return"SuspenseList"}if("object"===typeof a)switch(a.$$typeof){case Bf:return"Context.Consumer";case Cf:return"Context.Provider";case zd:var b=a.render;b=b.displayName||b.name||"";return a.displayName||(""!==b?"ForwardRef("+b+")":"ForwardRef");case Ad:return na(a.type);
case Df:return na(a.render);case Ef:if(a=1===a._status?a._result:null)return na(a)}return null}function Bd(a){var b="";do{a:switch(a.tag){case 3:case 4:case 6:case 7:case 10:case 9:var c="";break a;default:var d=a._debugOwner,e=a._debugSource,f=na(a.type);c=null;d&&(c=na(d.type));d=f;f="";e?f=" (at "+e.fileName.replace(si,"")+":"+e.lineNumber+")":c&&(f=" (created by "+c+")");c="\n    in "+(d||"Unknown")+f}b+=c;a=a.return}while(a);return b}function va(a){switch(typeof a){case "boolean":case "number":case "object":case "string":case "undefined":return a;
default:return""}}function Ff(a){var b=a.type;return(a=a.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===b||"radio"===b)}function ti(a){var b=Ff(a)?"checked":"value",c=Object.getOwnPropertyDescriptor(a.constructor.prototype,b),d=""+a[b];if(!a.hasOwnProperty(b)&&"undefined"!==typeof c&&"function"===typeof c.get&&"function"===typeof c.set){var e=c.get,f=c.set;Object.defineProperty(a,b,{configurable:!0,get:function(){return e.call(this)},set:function(a){d=""+a;f.call(this,a)}});Object.defineProperty(a,
b,{enumerable:c.enumerable});return{getValue:function(){return d},setValue:function(a){d=""+a},stopTracking:function(){a._valueTracker=null;delete a[b]}}}}function mc(a){a._valueTracker||(a._valueTracker=ti(a))}function Gf(a){if(!a)return!1;var b=a._valueTracker;if(!b)return!0;var c=b.getValue();var d="";a&&(d=Ff(a)?a.checked?"true":"false":a.value);a=d;return a!==c?(b.setValue(a),!0):!1}function Cd(a,b){var c=b.checked;return M({},b,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=
c?c:a._wrapperState.initialChecked})}function Hf(a,b){var c=null==b.defaultValue?"":b.defaultValue,d=null!=b.checked?b.checked:b.defaultChecked;c=va(null!=b.value?b.value:c);a._wrapperState={initialChecked:d,initialValue:c,controlled:"checkbox"===b.type||"radio"===b.type?null!=b.checked:null!=b.value}}function If(a,b){b=b.checked;null!=b&&xd(a,"checked",b,!1)}function Dd(a,b){If(a,b);var c=va(b.value),d=b.type;if(null!=c)if("number"===d){if(0===c&&""===a.value||a.value!=c)a.value=""+c}else a.value!==
""+c&&(a.value=""+c);else if("submit"===d||"reset"===d){a.removeAttribute("value");return}b.hasOwnProperty("value")?Ed(a,b.type,c):b.hasOwnProperty("defaultValue")&&Ed(a,b.type,va(b.defaultValue));null==b.checked&&null!=b.defaultChecked&&(a.defaultChecked=!!b.defaultChecked)}function Jf(a,b,c){if(b.hasOwnProperty("value")||b.hasOwnProperty("defaultValue")){var d=b.type;if(!("submit"!==d&&"reset"!==d||void 0!==b.value&&null!==b.value))return;b=""+a._wrapperState.initialValue;c||b===a.value||(a.value=
b);a.defaultValue=b}c=a.name;""!==c&&(a.name="");a.defaultChecked=!!a._wrapperState.initialChecked;""!==c&&(a.name=c)}function Ed(a,b,c){if("number"!==b||a.ownerDocument.activeElement!==a)null==c?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+c&&(a.defaultValue=""+c)}function ui(a){var b="";ea.Children.forEach(a,function(a){null!=a&&(b+=a)});return b}function Fd(a,b){a=M({children:void 0},b);if(b=ui(b.children))a.children=b;return a}function hb(a,b,c,d){a=a.options;if(b){b={};
for(var e=0;e<c.length;e++)b["$"+c[e]]=!0;for(c=0;c<a.length;c++)e=b.hasOwnProperty("$"+a[c].value),a[c].selected!==e&&(a[c].selected=e),e&&d&&(a[c].defaultSelected=!0)}else{c=""+va(c);b=null;for(e=0;e<a.length;e++){if(a[e].value===c){a[e].selected=!0;d&&(a[e].defaultSelected=!0);return}null!==b||a[e].disabled||(b=a[e])}null!==b&&(b.selected=!0)}}function Gd(a,b){if(null!=b.dangerouslySetInnerHTML)throw Error(k(91));return M({},b,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}
function Kf(a,b){var c=b.value;if(null==c){c=b.children;b=b.defaultValue;if(null!=c){if(null!=b)throw Error(k(92));if(Array.isArray(c)){if(!(1>=c.length))throw Error(k(93));c=c[0]}b=c}null==b&&(b="");c=b}a._wrapperState={initialValue:va(c)}}function Lf(a,b){var c=va(b.value),d=va(b.defaultValue);null!=c&&(c=""+c,c!==a.value&&(a.value=c),null==b.defaultValue&&a.defaultValue!==c&&(a.defaultValue=c));null!=d&&(a.defaultValue=""+d)}function Mf(a,b){b=a.textContent;b===a._wrapperState.initialValue&&""!==
b&&null!==b&&(a.value=b)}function Nf(a){switch(a){case "svg":return"http://www.w3.org/2000/svg";case "math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hd(a,b){return null==a||"http://www.w3.org/1999/xhtml"===a?Nf(b):"http://www.w3.org/2000/svg"===a&&"foreignObject"===b?"http://www.w3.org/1999/xhtml":a}function nc(a,b){var c={};c[a.toLowerCase()]=b.toLowerCase();c["Webkit"+a]="webkit"+b;c["Moz"+a]="moz"+b;return c}function oc(a){if(Id[a])return Id[a];
if(!ib[a])return a;var b=ib[a],c;for(c in b)if(b.hasOwnProperty(c)&&c in Of)return Id[a]=b[c];return a}function Jd(a){var b=Pf.get(a);void 0===b&&(b=new Map,Pf.set(a,b));return b}function Na(a){var b=a,c=a;if(a.alternate)for(;b.return;)b=b.return;else{a=b;do b=a,0!==(b.effectTag&1026)&&(c=b.return),a=b.return;while(a)}return 3===b.tag?c:null}function Qf(a){if(13===a.tag){var b=a.memoizedState;null===b&&(a=a.alternate,null!==a&&(b=a.memoizedState));if(null!==b)return b.dehydrated}return null}function Rf(a){if(Na(a)!==
a)throw Error(k(188));}function vi(a){var b=a.alternate;if(!b){b=Na(a);if(null===b)throw Error(k(188));return b!==a?null:a}for(var c=a,d=b;;){var e=c.return;if(null===e)break;var f=e.alternate;if(null===f){d=e.return;if(null!==d){c=d;continue}break}if(e.child===f.child){for(f=e.child;f;){if(f===c)return Rf(e),a;if(f===d)return Rf(e),b;f=f.sibling}throw Error(k(188));}if(c.return!==d.return)c=e,d=f;else{for(var g=!1,h=e.child;h;){if(h===c){g=!0;c=e;d=f;break}if(h===d){g=!0;d=e;c=f;break}h=h.sibling}if(!g){for(h=
f.child;h;){if(h===c){g=!0;c=f;d=e;break}if(h===d){g=!0;d=f;c=e;break}h=h.sibling}if(!g)throw Error(k(189));}}if(c.alternate!==d)throw Error(k(190));}if(3!==c.tag)throw Error(k(188));return c.stateNode.current===c?a:b}function Sf(a){a=vi(a);if(!a)return null;for(var b=a;;){if(5===b.tag||6===b.tag)return b;if(b.child)b.child.return=b,b=b.child;else{if(b===a)break;for(;!b.sibling;){if(!b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}}return null}function jb(a,b){if(null==
b)throw Error(k(30));if(null==a)return b;if(Array.isArray(a)){if(Array.isArray(b))return a.push.apply(a,b),a;a.push(b);return a}return Array.isArray(b)?[a].concat(b):[a,b]}function Kd(a,b,c){Array.isArray(a)?a.forEach(b,c):a&&b.call(c,a)}function pc(a){null!==a&&(Ab=jb(Ab,a));a=Ab;Ab=null;if(a){Kd(a,wi);if(Ab)throw Error(k(95));if(hc)throw a=pd,hc=!1,pd=null,a;}}function Ld(a){a=a.target||a.srcElement||window;a.correspondingUseElement&&(a=a.correspondingUseElement);return 3===a.nodeType?a.parentNode:
a}function Tf(a){if(!wa)return!1;a="on"+a;var b=a in document;b||(b=document.createElement("div"),b.setAttribute(a,"return;"),b="function"===typeof b[a]);return b}function Uf(a){a.topLevelType=null;a.nativeEvent=null;a.targetInst=null;a.ancestors.length=0;10>qc.length&&qc.push(a)}function Vf(a,b,c,d){if(qc.length){var e=qc.pop();e.topLevelType=a;e.eventSystemFlags=d;e.nativeEvent=b;e.targetInst=c;return e}return{topLevelType:a,eventSystemFlags:d,nativeEvent:b,targetInst:c,ancestors:[]}}function Wf(a){var b=
a.targetInst,c=b;do{if(!c){a.ancestors.push(c);break}var d=c;if(3===d.tag)d=d.stateNode.containerInfo;else{for(;d.return;)d=d.return;d=3!==d.tag?null:d.stateNode.containerInfo}if(!d)break;b=c.tag;5!==b&&6!==b||a.ancestors.push(c);c=Bb(d)}while(c);for(c=0;c<a.ancestors.length;c++){b=a.ancestors[c];var e=Ld(a.nativeEvent);d=a.topLevelType;var f=a.nativeEvent,g=a.eventSystemFlags;0===c&&(g|=64);for(var h=null,m=0;m<jc.length;m++){var n=jc[m];n&&(n=n.extractEvents(d,b,f,e,g))&&(h=jb(h,n))}pc(h)}}function Md(a,
b,c){if(!c.has(a)){switch(a){case "scroll":Cb(b,"scroll",!0);break;case "focus":case "blur":Cb(b,"focus",!0);Cb(b,"blur",!0);c.set("blur",null);c.set("focus",null);break;case "cancel":case "close":Tf(a)&&Cb(b,a,!0);break;case "invalid":case "submit":case "reset":break;default:-1===Db.indexOf(a)&&w(a,b)}c.set(a,null)}}function xi(a,b){var c=Jd(b);Nd.forEach(function(a){Md(a,b,c)});yi.forEach(function(a){Md(a,b,c)})}function Od(a,b,c,d,e){return{blockedOn:a,topLevelType:b,eventSystemFlags:c|32,nativeEvent:e,
container:d}}function Xf(a,b){switch(a){case "focus":case "blur":xa=null;break;case "dragenter":case "dragleave":ya=null;break;case "mouseover":case "mouseout":za=null;break;case "pointerover":case "pointerout":Eb.delete(b.pointerId);break;case "gotpointercapture":case "lostpointercapture":Fb.delete(b.pointerId)}}function Gb(a,b,c,d,e,f){if(null===a||a.nativeEvent!==f)return a=Od(b,c,d,e,f),null!==b&&(b=Hb(b),null!==b&&Yf(b)),a;a.eventSystemFlags|=d;return a}function zi(a,b,c,d,e){switch(b){case "focus":return xa=
Gb(xa,a,b,c,d,e),!0;case "dragenter":return ya=Gb(ya,a,b,c,d,e),!0;case "mouseover":return za=Gb(za,a,b,c,d,e),!0;case "pointerover":var f=e.pointerId;Eb.set(f,Gb(Eb.get(f)||null,a,b,c,d,e));return!0;case "gotpointercapture":return f=e.pointerId,Fb.set(f,Gb(Fb.get(f)||null,a,b,c,d,e)),!0}return!1}function Ai(a){var b=Bb(a.target);if(null!==b){var c=Na(b);if(null!==c)if(b=c.tag,13===b){if(b=Qf(c),null!==b){a.blockedOn=b;Pd(a.priority,function(){Bi(c)});return}}else if(3===b&&c.stateNode.hydrate){a.blockedOn=
3===c.tag?c.stateNode.containerInfo:null;return}}a.blockedOn=null}function rc(a){if(null!==a.blockedOn)return!1;var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);if(null!==b){var c=Hb(b);null!==c&&Yf(c);a.blockedOn=b;return!1}return!0}function Zf(a,b,c){rc(a)&&c.delete(b)}function Ci(){for(Rd=!1;0<fa.length;){var a=fa[0];if(null!==a.blockedOn){a=Hb(a.blockedOn);null!==a&&Di(a);break}var b=Qd(a.topLevelType,a.eventSystemFlags,a.container,a.nativeEvent);null!==b?a.blockedOn=b:fa.shift()}null!==
xa&&rc(xa)&&(xa=null);null!==ya&&rc(ya)&&(ya=null);null!==za&&rc(za)&&(za=null);Eb.forEach(Zf);Fb.forEach(Zf)}function Ib(a,b){a.blockedOn===b&&(a.blockedOn=null,Rd||(Rd=!0,$f(ag,Ci)))}function bg(a){if(0<fa.length){Ib(fa[0],a);for(var b=1;b<fa.length;b++){var c=fa[b];c.blockedOn===a&&(c.blockedOn=null)}}null!==xa&&Ib(xa,a);null!==ya&&Ib(ya,a);null!==za&&Ib(za,a);b=function(b){return Ib(b,a)};Eb.forEach(b);Fb.forEach(b);for(b=0;b<Jb.length;b++)c=Jb[b],c.blockedOn===a&&(c.blockedOn=null);for(;0<Jb.length&&
(b=Jb[0],null===b.blockedOn);)Ai(b),null===b.blockedOn&&Jb.shift()}function Sd(a,b){for(var c=0;c<a.length;c+=2){var d=a[c],e=a[c+1],f="on"+(e[0].toUpperCase()+e.slice(1));f={phasedRegistrationNames:{bubbled:f,captured:f+"Capture"},dependencies:[d],eventPriority:b};Td.set(d,b);cg.set(d,f);dg[e]=f}}function w(a,b){Cb(b,a,!1)}function Cb(a,b,c){var d=Td.get(b);switch(void 0===d?2:d){case 0:d=Ei.bind(null,b,1,a);break;case 1:d=Fi.bind(null,b,1,a);break;default:d=sc.bind(null,b,1,a)}c?a.addEventListener(b,
d,!0):a.addEventListener(b,d,!1)}function Ei(a,b,c,d){Oa||vd();var e=sc,f=Oa;Oa=!0;try{eg(e,a,b,c,d)}finally{(Oa=f)||ud()}}function Fi(a,b,c,d){Gi(Hi,sc.bind(null,a,b,c,d))}function sc(a,b,c,d){if(tc)if(0<fa.length&&-1<Nd.indexOf(a))a=Od(null,a,b,c,d),fa.push(a);else{var e=Qd(a,b,c,d);if(null===e)Xf(a,d);else if(-1<Nd.indexOf(a))a=Od(e,a,b,c,d),fa.push(a);else if(!zi(e,a,b,c,d)){Xf(a,d);a=Vf(a,d,null,b);try{uf(Wf,a)}finally{Uf(a)}}}}function Qd(a,b,c,d){c=Ld(d);c=Bb(c);if(null!==c){var e=Na(c);if(null===
e)c=null;else{var f=e.tag;if(13===f){c=Qf(e);if(null!==c)return c;c=null}else if(3===f){if(e.stateNode.hydrate)return 3===e.tag?e.stateNode.containerInfo:null;c=null}else e!==c&&(c=null)}}a=Vf(a,d,c,b);try{uf(Wf,a)}finally{Uf(a)}return null}function fg(a,b,c){return null==b||"boolean"===typeof b||""===b?"":c||"number"!==typeof b||0===b||Kb.hasOwnProperty(a)&&Kb[a]?(""+b).trim():b+"px"}function gg(a,b){a=a.style;for(var c in b)if(b.hasOwnProperty(c)){var d=0===c.indexOf("--"),e=fg(c,b[c],d);"float"===
c&&(c="cssFloat");d?a.setProperty(c,e):a[c]=e}}function Ud(a,b){if(b){if(Ii[a]&&(null!=b.children||null!=b.dangerouslySetInnerHTML))throw Error(k(137,a,""));if(null!=b.dangerouslySetInnerHTML){if(null!=b.children)throw Error(k(60));if(!("object"===typeof b.dangerouslySetInnerHTML&&"__html"in b.dangerouslySetInnerHTML))throw Error(k(61));}if(null!=b.style&&"object"!==typeof b.style)throw Error(k(62,""));}}function Vd(a,b){if(-1===a.indexOf("-"))return"string"===typeof b.is;switch(a){case "annotation-xml":case "color-profile":case "font-face":case "font-face-src":case "font-face-uri":case "font-face-format":case "font-face-name":case "missing-glyph":return!1;
default:return!0}}function oa(a,b){a=9===a.nodeType||11===a.nodeType?a:a.ownerDocument;var c=Jd(a);b=rd[b];for(var d=0;d<b.length;d++)Md(b[d],a,c)}function uc(){}function Wd(a){a=a||("undefined"!==typeof document?document:void 0);if("undefined"===typeof a)return null;try{return a.activeElement||a.body}catch(b){return a.body}}function hg(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ig(a,b){var c=hg(a);a=0;for(var d;c;){if(3===c.nodeType){d=a+c.textContent.length;if(a<=b&&d>=b)return{node:c,
offset:b-a};a=d}a:{for(;c;){if(c.nextSibling){c=c.nextSibling;break a}c=c.parentNode}c=void 0}c=hg(c)}}function jg(a,b){return a&&b?a===b?!0:a&&3===a.nodeType?!1:b&&3===b.nodeType?jg(a,b.parentNode):"contains"in a?a.contains(b):a.compareDocumentPosition?!!(a.compareDocumentPosition(b)&16):!1:!1}function kg(){for(var a=window,b=Wd();b instanceof a.HTMLIFrameElement;){try{var c="string"===typeof b.contentWindow.location.href}catch(d){c=!1}if(c)a=b.contentWindow;else break;b=Wd(a.document)}return b}
function Xd(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return b&&("input"===b&&("text"===a.type||"search"===a.type||"tel"===a.type||"url"===a.type||"password"===a.type)||"textarea"===b||"true"===a.contentEditable)}function lg(a,b){switch(a){case "button":case "input":case "select":case "textarea":return!!b.autoFocus}return!1}function Yd(a,b){return"textarea"===a||"option"===a||"noscript"===a||"string"===typeof b.children||"number"===typeof b.children||"object"===typeof b.dangerouslySetInnerHTML&&
null!==b.dangerouslySetInnerHTML&&null!=b.dangerouslySetInnerHTML.__html}function kb(a){for(;null!=a;a=a.nextSibling){var b=a.nodeType;if(1===b||3===b)break}return a}function mg(a){a=a.previousSibling;for(var b=0;a;){if(8===a.nodeType){var c=a.data;if(c===ng||c===Zd||c===$d){if(0===b)return a;b--}else c===og&&b++}a=a.previousSibling}return null}function Bb(a){var b=a[Aa];if(b)return b;for(var c=a.parentNode;c;){if(b=c[Lb]||c[Aa]){c=b.alternate;if(null!==b.child||null!==c&&null!==c.child)for(a=mg(a);null!==
a;){if(c=a[Aa])return c;a=mg(a)}return b}a=c;c=a.parentNode}return null}function Hb(a){a=a[Aa]||a[Lb];return!a||5!==a.tag&&6!==a.tag&&13!==a.tag&&3!==a.tag?null:a}function Pa(a){if(5===a.tag||6===a.tag)return a.stateNode;throw Error(k(33));}function ae(a){return a[vc]||null}function pa(a){do a=a.return;while(a&&5!==a.tag);return a?a:null}function pg(a,b){var c=a.stateNode;if(!c)return null;var d=td(c);if(!d)return null;c=d[b];a:switch(b){case "onClick":case "onClickCapture":case "onDoubleClick":case "onDoubleClickCapture":case "onMouseDown":case "onMouseDownCapture":case "onMouseMove":case "onMouseMoveCapture":case "onMouseUp":case "onMouseUpCapture":case "onMouseEnter":(d=
!d.disabled)||(a=a.type,d=!("button"===a||"input"===a||"select"===a||"textarea"===a));a=!d;break a;default:a=!1}if(a)return null;if(c&&"function"!==typeof c)throw Error(k(231,b,typeof c));return c}function qg(a,b,c){if(b=pg(a,c.dispatchConfig.phasedRegistrationNames[b]))c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a)}function Ji(a){if(a&&a.dispatchConfig.phasedRegistrationNames){for(var b=a._targetInst,c=[];b;)c.push(b),b=pa(b);for(b=c.length;0<b--;)qg(c[b],
"captured",a);for(b=0;b<c.length;b++)qg(c[b],"bubbled",a)}}function be(a,b,c){a&&c&&c.dispatchConfig.registrationName&&(b=pg(a,c.dispatchConfig.registrationName))&&(c._dispatchListeners=jb(c._dispatchListeners,b),c._dispatchInstances=jb(c._dispatchInstances,a))}function Ki(a){a&&a.dispatchConfig.registrationName&&be(a._targetInst,null,a)}function lb(a){Kd(a,Ji)}function rg(){if(wc)return wc;var a,b=ce,c=b.length,d,e="value"in Ba?Ba.value:Ba.textContent,f=e.length;for(a=0;a<c&&b[a]===e[a];a++);var g=
c-a;for(d=1;d<=g&&b[c-d]===e[f-d];d++);return wc=e.slice(a,1<d?1-d:void 0)}function xc(){return!0}function yc(){return!1}function R(a,b,c,d){this.dispatchConfig=a;this._targetInst=b;this.nativeEvent=c;a=this.constructor.Interface;for(var e in a)a.hasOwnProperty(e)&&((b=a[e])?this[e]=b(c):"target"===e?this.target=d:this[e]=c[e]);this.isDefaultPrevented=(null!=c.defaultPrevented?c.defaultPrevented:!1===c.returnValue)?xc:yc;this.isPropagationStopped=yc;return this}function Li(a,b,c,d){if(this.eventPool.length){var e=
this.eventPool.pop();this.call(e,a,b,c,d);return e}return new this(a,b,c,d)}function Mi(a){if(!(a instanceof this))throw Error(k(279));a.destructor();10>this.eventPool.length&&this.eventPool.push(a)}function sg(a){a.eventPool=[];a.getPooled=Li;a.release=Mi}function tg(a,b){switch(a){case "keyup":return-1!==Ni.indexOf(b.keyCode);case "keydown":return 229!==b.keyCode;case "keypress":case "mousedown":case "blur":return!0;default:return!1}}function ug(a){a=a.detail;return"object"===typeof a&&"data"in
a?a.data:null}function Oi(a,b){switch(a){case "compositionend":return ug(b);case "keypress":if(32!==b.which)return null;vg=!0;return wg;case "textInput":return a=b.data,a===wg&&vg?null:a;default:return null}}function Pi(a,b){if(mb)return"compositionend"===a||!de&&tg(a,b)?(a=rg(),wc=ce=Ba=null,mb=!1,a):null;switch(a){case "paste":return null;case "keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;
case "compositionend":return xg&&"ko"!==b.locale?null:b.data;default:return null}}function yg(a){var b=a&&a.nodeName&&a.nodeName.toLowerCase();return"input"===b?!!Qi[a.type]:"textarea"===b?!0:!1}function zg(a,b,c){a=R.getPooled(Ag.change,a,b,c);a.type="change";sf(c);lb(a);return a}function Ri(a){pc(a)}function zc(a){var b=Pa(a);if(Gf(b))return a}function Si(a,b){if("change"===a)return b}function Bg(){Mb&&(Mb.detachEvent("onpropertychange",Cg),Nb=Mb=null)}function Cg(a){if("value"===a.propertyName&&
zc(Nb))if(a=zg(Nb,a,Ld(a)),Oa)pc(a);else{Oa=!0;try{ee(Ri,a)}finally{Oa=!1,ud()}}}function Ti(a,b,c){"focus"===a?(Bg(),Mb=b,Nb=c,Mb.attachEvent("onpropertychange",Cg)):"blur"===a&&Bg()}function Ui(a,b){if("selectionchange"===a||"keyup"===a||"keydown"===a)return zc(Nb)}function Vi(a,b){if("click"===a)return zc(b)}function Wi(a,b){if("input"===a||"change"===a)return zc(b)}function Xi(a){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(a):(a=Yi[a])?!!b[a]:!1}function fe(a){return Xi}
function Zi(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}function Ob(a,b){if(Qa(a,b))return!0;if("object"!==typeof a||null===a||"object"!==typeof b||null===b)return!1;var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++)if(!$i.call(b,c[d])||!Qa(a[c[d]],b[c[d]]))return!1;return!0}function Dg(a,b){var c=b.window===b?b.document:9===b.nodeType?b:b.ownerDocument;if(ge||null==nb||nb!==Wd(c))return null;c=nb;"selectionStart"in c&&Xd(c)?c={start:c.selectionStart,
end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset});return Pb&&Ob(Pb,c)?null:(Pb=c,a=R.getPooled(Eg.select,he,a,b),a.type="select",a.target=nb,lb(a),a)}function Ac(a){var b=a.keyCode;"charCode"in a?(a=a.charCode,0===a&&13===b&&(a=13)):a=b;10===a&&(a=13);return 32<=a||13===a?a:0}function q(a,b){0>ob||(a.current=ie[ob],ie[ob]=null,ob--)}function y(a,b,c){ob++;
ie[ob]=a.current;a.current=b}function pb(a,b){var c=a.type.contextTypes;if(!c)return Ca;var d=a.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===b)return d.__reactInternalMemoizedMaskedChildContext;var e={},f;for(f in c)e[f]=b[f];d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=b,a.__reactInternalMemoizedMaskedChildContext=e);return e}function N(a){a=a.childContextTypes;return null!==a&&void 0!==a}function Fg(a,b,c){if(B.current!==Ca)throw Error(k(168));y(B,b);y(G,c)}
function Gg(a,b,c){var d=a.stateNode;a=b.childContextTypes;if("function"!==typeof d.getChildContext)return c;d=d.getChildContext();for(var e in d)if(!(e in a))throw Error(k(108,na(b)||"Unknown",e));return M({},c,{},d)}function Bc(a){a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Ca;Ra=B.current;y(B,a);y(G,G.current);return!0}function Hg(a,b,c){var d=a.stateNode;if(!d)throw Error(k(169));c?(a=Gg(a,b,Ra),d.__reactInternalMemoizedMergedChildContext=a,q(G),q(B),y(B,a)):q(G);y(G,c)}function Cc(){switch(aj()){case Dc:return 99;
case Ig:return 98;case Jg:return 97;case Kg:return 96;case Lg:return 95;default:throw Error(k(332));}}function Mg(a){switch(a){case 99:return Dc;case 98:return Ig;case 97:return Jg;case 96:return Kg;case 95:return Lg;default:throw Error(k(332));}}function Da(a,b){a=Mg(a);return bj(a,b)}function Ng(a,b,c){a=Mg(a);return je(a,b,c)}function Og(a){null===qa?(qa=[a],Ec=je(Dc,Pg)):qa.push(a);return Qg}function ha(){if(null!==Ec){var a=Ec;Ec=null;Rg(a)}Pg()}function Pg(){if(!ke&&null!==qa){ke=!0;var a=0;
try{var b=qa;Da(99,function(){for(;a<b.length;a++){var c=b[a];do c=c(!0);while(null!==c)}});qa=null}catch(c){throw null!==qa&&(qa=qa.slice(a+1)),je(Dc,ha),c;}finally{ke=!1}}}function Fc(a,b,c){c/=10;return 1073741821-(((1073741821-a+b/10)/c|0)+1)*c}function aa(a,b){if(a&&a.defaultProps){b=M({},b);a=a.defaultProps;for(var c in a)void 0===b[c]&&(b[c]=a[c])}return b}function le(){Gc=qb=Hc=null}function me(a){var b=Ic.current;q(Ic);a.type._context._currentValue=b}function Sg(a,b){for(;null!==a;){var c=
a.alternate;if(a.childExpirationTime<b)a.childExpirationTime=b,null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);else if(null!==c&&c.childExpirationTime<b)c.childExpirationTime=b;else break;a=a.return}}function rb(a,b){Hc=a;Gc=qb=null;a=a.dependencies;null!==a&&null!==a.firstContext&&(a.expirationTime>=b&&(ia=!0),a.firstContext=null)}function W(a,b){if(Gc!==a&&!1!==b&&0!==b){if("number"!==typeof b||1073741823===b)Gc=a,b=1073741823;b={context:a,observedBits:b,next:null};if(null===qb){if(null===
Hc)throw Error(k(308));qb=b;Hc.dependencies={expirationTime:0,firstContext:b,responders:null}}else qb=qb.next=b}return a._currentValue}function ne(a){a.updateQueue={baseState:a.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function oe(a,b){a=a.updateQueue;b.updateQueue===a&&(b.updateQueue={baseState:a.baseState,baseQueue:a.baseQueue,shared:a.shared,effects:a.effects})}function Ea(a,b){a={expirationTime:a,suspenseConfig:b,tag:Tg,payload:null,callback:null,next:null};return a.next=
a}function Fa(a,b){a=a.updateQueue;if(null!==a){a=a.shared;var c=a.pending;null===c?b.next=b:(b.next=c.next,c.next=b);a.pending=b}}function Ug(a,b){var c=a.alternate;null!==c&&oe(c,a);a=a.updateQueue;c=a.baseQueue;null===c?(a.baseQueue=b.next=b,b.next=b):(b.next=c.next,c.next=b)}function Qb(a,b,c,d){var e=a.updateQueue;Ga=!1;var f=e.baseQueue,g=e.shared.pending;if(null!==g){if(null!==f){var h=f.next;f.next=g.next;g.next=h}f=g;e.shared.pending=null;h=a.alternate;null!==h&&(h=h.updateQueue,null!==h&&
(h.baseQueue=g))}if(null!==f){h=f.next;var m=e.baseState,n=0,k=null,ba=null,l=null;if(null!==h){var p=h;do{g=p.expirationTime;if(g<d){var t={expirationTime:p.expirationTime,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null};null===l?(ba=l=t,k=m):l=l.next=t;g>n&&(n=g)}else{null!==l&&(l=l.next={expirationTime:1073741823,suspenseConfig:p.suspenseConfig,tag:p.tag,payload:p.payload,callback:p.callback,next:null});Vg(g,p.suspenseConfig);a:{var q=a,r=p;g=b;t=c;switch(r.tag){case 1:q=
r.payload;if("function"===typeof q){m=q.call(t,m,g);break a}m=q;break a;case 3:q.effectTag=q.effectTag&-4097|64;case Tg:q=r.payload;g="function"===typeof q?q.call(t,m,g):q;if(null===g||void 0===g)break a;m=M({},m,g);break a;case Jc:Ga=!0}}null!==p.callback&&(a.effectTag|=32,g=e.effects,null===g?e.effects=[p]:g.push(p))}p=p.next;if(null===p||p===h)if(g=e.shared.pending,null===g)break;else p=f.next=g.next,g.next=h,e.baseQueue=f=g,e.shared.pending=null}while(1)}null===l?k=m:l.next=ba;e.baseState=k;e.baseQueue=
l;Kc(n);a.expirationTime=n;a.memoizedState=m}}function Wg(a,b,c){a=b.effects;b.effects=null;if(null!==a)for(b=0;b<a.length;b++){var d=a[b],e=d.callback;if(null!==e){d.callback=null;d=e;e=c;if("function"!==typeof d)throw Error(k(191,d));d.call(e)}}}function Lc(a,b,c,d){b=a.memoizedState;c=c(d,b);c=null===c||void 0===c?b:M({},b,c);a.memoizedState=c;0===a.expirationTime&&(a.updateQueue.baseState=c)}function Xg(a,b,c,d,e,f,g){a=a.stateNode;return"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(d,
f,g):b.prototype&&b.prototype.isPureReactComponent?!Ob(c,d)||!Ob(e,f):!0}function Yg(a,b,c){var d=!1,e=Ca;var f=b.contextType;"object"===typeof f&&null!==f?f=W(f):(e=N(b)?Ra:B.current,d=b.contextTypes,f=(d=null!==d&&void 0!==d)?pb(a,e):Ca);b=new b(c,f);a.memoizedState=null!==b.state&&void 0!==b.state?b.state:null;b.updater=Mc;a.stateNode=b;b._reactInternalFiber=a;d&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=e,a.__reactInternalMemoizedMaskedChildContext=f);return b}function Zg(a,
b,c,d){a=b.state;"function"===typeof b.componentWillReceiveProps&&b.componentWillReceiveProps(c,d);"function"===typeof b.UNSAFE_componentWillReceiveProps&&b.UNSAFE_componentWillReceiveProps(c,d);b.state!==a&&Mc.enqueueReplaceState(b,b.state,null)}function pe(a,b,c,d){var e=a.stateNode;e.props=c;e.state=a.memoizedState;e.refs=$g;ne(a);var f=b.contextType;"object"===typeof f&&null!==f?e.context=W(f):(f=N(b)?Ra:B.current,e.context=pb(a,f));Qb(a,c,e,d);e.state=a.memoizedState;f=b.getDerivedStateFromProps;
"function"===typeof f&&(Lc(a,b,f,c),e.state=a.memoizedState);"function"===typeof b.getDerivedStateFromProps||"function"===typeof e.getSnapshotBeforeUpdate||"function"!==typeof e.UNSAFE_componentWillMount&&"function"!==typeof e.componentWillMount||(b=e.state,"function"===typeof e.componentWillMount&&e.componentWillMount(),"function"===typeof e.UNSAFE_componentWillMount&&e.UNSAFE_componentWillMount(),b!==e.state&&Mc.enqueueReplaceState(e,e.state,null),Qb(a,c,e,d),e.state=a.memoizedState);"function"===
typeof e.componentDidMount&&(a.effectTag|=4)}function Rb(a,b,c){a=c.ref;if(null!==a&&"function"!==typeof a&&"object"!==typeof a){if(c._owner){c=c._owner;if(c){if(1!==c.tag)throw Error(k(309));var d=c.stateNode}if(!d)throw Error(k(147,a));var e=""+a;if(null!==b&&null!==b.ref&&"function"===typeof b.ref&&b.ref._stringRef===e)return b.ref;b=function(a){var b=d.refs;b===$g&&(b=d.refs={});null===a?delete b[e]:b[e]=a};b._stringRef=e;return b}if("string"!==typeof a)throw Error(k(284));if(!c._owner)throw Error(k(290,
a));}return a}function Nc(a,b){if("textarea"!==a.type)throw Error(k(31,"[object Object]"===Object.prototype.toString.call(b)?"object with keys {"+Object.keys(b).join(", ")+"}":b,""));}function ah(a){function b(b,c){if(a){var d=b.lastEffect;null!==d?(d.nextEffect=c,b.lastEffect=c):b.firstEffect=b.lastEffect=c;c.nextEffect=null;c.effectTag=8}}function c(c,d){if(!a)return null;for(;null!==d;)b(c,d),d=d.sibling;return null}function d(a,b){for(a=new Map;null!==b;)null!==b.key?a.set(b.key,b):a.set(b.index,
b),b=b.sibling;return a}function e(a,b){a=Sa(a,b);a.index=0;a.sibling=null;return a}function f(b,c,d){b.index=d;if(!a)return c;d=b.alternate;if(null!==d)return d=d.index,d<c?(b.effectTag=2,c):d;b.effectTag=2;return c}function g(b){a&&null===b.alternate&&(b.effectTag=2);return b}function h(a,b,c,d){if(null===b||6!==b.tag)return b=qe(c,a.mode,d),b.return=a,b;b=e(b,c);b.return=a;return b}function m(a,b,c,d){if(null!==b&&b.elementType===c.type)return d=e(b,c.props),d.ref=Rb(a,b,c),d.return=a,d;d=Oc(c.type,
c.key,c.props,null,a.mode,d);d.ref=Rb(a,b,c);d.return=a;return d}function n(a,b,c,d){if(null===b||4!==b.tag||b.stateNode.containerInfo!==c.containerInfo||b.stateNode.implementation!==c.implementation)return b=re(c,a.mode,d),b.return=a,b;b=e(b,c.children||[]);b.return=a;return b}function l(a,b,c,d,f){if(null===b||7!==b.tag)return b=Ha(c,a.mode,d,f),b.return=a,b;b=e(b,c);b.return=a;return b}function ba(a,b,c){if("string"===typeof b||"number"===typeof b)return b=qe(""+b,a.mode,c),b.return=a,b;if("object"===
typeof b&&null!==b){switch(b.$$typeof){case Pc:return c=Oc(b.type,b.key,b.props,null,a.mode,c),c.ref=Rb(a,null,b),c.return=a,c;case gb:return b=re(b,a.mode,c),b.return=a,b}if(Qc(b)||zb(b))return b=Ha(b,a.mode,c,null),b.return=a,b;Nc(a,b)}return null}function p(a,b,c,d){var e=null!==b?b.key:null;if("string"===typeof c||"number"===typeof c)return null!==e?null:h(a,b,""+c,d);if("object"===typeof c&&null!==c){switch(c.$$typeof){case Pc:return c.key===e?c.type===Ma?l(a,b,c.props.children,d,e):m(a,b,c,
d):null;case gb:return c.key===e?n(a,b,c,d):null}if(Qc(c)||zb(c))return null!==e?null:l(a,b,c,d,null);Nc(a,c)}return null}function t(a,b,c,d,e){if("string"===typeof d||"number"===typeof d)return a=a.get(c)||null,h(b,a,""+d,e);if("object"===typeof d&&null!==d){switch(d.$$typeof){case Pc:return a=a.get(null===d.key?c:d.key)||null,d.type===Ma?l(b,a,d.props.children,e,d.key):m(b,a,d,e);case gb:return a=a.get(null===d.key?c:d.key)||null,n(b,a,d,e)}if(Qc(d)||zb(d))return a=a.get(c)||null,l(b,a,d,e,null);
Nc(b,d)}return null}function q(e,g,h,m){for(var n=null,k=null,l=g,r=g=0,C=null;null!==l&&r<h.length;r++){l.index>r?(C=l,l=null):C=l.sibling;var O=p(e,l,h[r],m);if(null===O){null===l&&(l=C);break}a&&l&&null===O.alternate&&b(e,l);g=f(O,g,r);null===k?n=O:k.sibling=O;k=O;l=C}if(r===h.length)return c(e,l),n;if(null===l){for(;r<h.length;r++)l=ba(e,h[r],m),null!==l&&(g=f(l,g,r),null===k?n=l:k.sibling=l,k=l);return n}for(l=d(e,l);r<h.length;r++)C=t(l,e,r,h[r],m),null!==C&&(a&&null!==C.alternate&&l.delete(null===
C.key?r:C.key),g=f(C,g,r),null===k?n=C:k.sibling=C,k=C);a&&l.forEach(function(a){return b(e,a)});return n}function w(e,g,h,n){var m=zb(h);if("function"!==typeof m)throw Error(k(150));h=m.call(h);if(null==h)throw Error(k(151));for(var l=m=null,r=g,C=g=0,O=null,v=h.next();null!==r&&!v.done;C++,v=h.next()){r.index>C?(O=r,r=null):O=r.sibling;var q=p(e,r,v.value,n);if(null===q){null===r&&(r=O);break}a&&r&&null===q.alternate&&b(e,r);g=f(q,g,C);null===l?m=q:l.sibling=q;l=q;r=O}if(v.done)return c(e,r),m;
if(null===r){for(;!v.done;C++,v=h.next())v=ba(e,v.value,n),null!==v&&(g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);return m}for(r=d(e,r);!v.done;C++,v=h.next())v=t(r,e,C,v.value,n),null!==v&&(a&&null!==v.alternate&&r.delete(null===v.key?C:v.key),g=f(v,g,C),null===l?m=v:l.sibling=v,l=v);a&&r.forEach(function(a){return b(e,a)});return m}return function(a,d,f,h){var m="object"===typeof f&&null!==f&&f.type===Ma&&null===f.key;m&&(f=f.props.children);var n="object"===typeof f&&null!==f;if(n)switch(f.$$typeof){case Pc:a:{n=
f.key;for(m=d;null!==m;){if(m.key===n){switch(m.tag){case 7:if(f.type===Ma){c(a,m.sibling);d=e(m,f.props.children);d.return=a;a=d;break a}break;default:if(m.elementType===f.type){c(a,m.sibling);d=e(m,f.props);d.ref=Rb(a,m,f);d.return=a;a=d;break a}}c(a,m);break}else b(a,m);m=m.sibling}f.type===Ma?(d=Ha(f.props.children,a.mode,h,f.key),d.return=a,a=d):(h=Oc(f.type,f.key,f.props,null,a.mode,h),h.ref=Rb(a,d,f),h.return=a,a=h)}return g(a);case gb:a:{for(m=f.key;null!==d;){if(d.key===m)if(4===d.tag&&d.stateNode.containerInfo===
f.containerInfo&&d.stateNode.implementation===f.implementation){c(a,d.sibling);d=e(d,f.children||[]);d.return=a;a=d;break a}else{c(a,d);break}else b(a,d);d=d.sibling}d=re(f,a.mode,h);d.return=a;a=d}return g(a)}if("string"===typeof f||"number"===typeof f)return f=""+f,null!==d&&6===d.tag?(c(a,d.sibling),d=e(d,f),d.return=a,a=d):(c(a,d),d=qe(f,a.mode,h),d.return=a,a=d),g(a);if(Qc(f))return q(a,d,f,h);if(zb(f))return w(a,d,f,h);n&&Nc(a,f);if("undefined"===typeof f&&!m)switch(a.tag){case 1:case 0:throw a=
a.type,Error(k(152,a.displayName||a.name||"Component"));}return c(a,d)}}function Ta(a){if(a===Sb)throw Error(k(174));return a}function se(a,b){y(Tb,b);y(Ub,a);y(ja,Sb);a=b.nodeType;switch(a){case 9:case 11:b=(b=b.documentElement)?b.namespaceURI:Hd(null,"");break;default:a=8===a?b.parentNode:b,b=a.namespaceURI||null,a=a.tagName,b=Hd(b,a)}q(ja);y(ja,b)}function tb(a){q(ja);q(Ub);q(Tb)}function bh(a){Ta(Tb.current);var b=Ta(ja.current);var c=Hd(b,a.type);b!==c&&(y(Ub,a),y(ja,c))}function te(a){Ub.current===
a&&(q(ja),q(Ub))}function Rc(a){for(var b=a;null!==b;){if(13===b.tag){var c=b.memoizedState;if(null!==c&&(c=c.dehydrated,null===c||c.data===$d||c.data===Zd))return b}else if(19===b.tag&&void 0!==b.memoizedProps.revealOrder){if(0!==(b.effectTag&64))return b}else if(null!==b.child){b.child.return=b;b=b.child;continue}if(b===a)break;for(;null===b.sibling;){if(null===b.return||b.return===a)return null;b=b.return}b.sibling.return=b.return;b=b.sibling}return null}function ue(a,b){return{responder:a,props:b}}
function S(){throw Error(k(321));}function ve(a,b){if(null===b)return!1;for(var c=0;c<b.length&&c<a.length;c++)if(!Qa(a[c],b[c]))return!1;return!0}function we(a,b,c,d,e,f){Ia=f;z=b;b.memoizedState=null;b.updateQueue=null;b.expirationTime=0;Sc.current=null===a||null===a.memoizedState?dj:ej;a=c(d,e);if(b.expirationTime===Ia){f=0;do{b.expirationTime=0;if(!(25>f))throw Error(k(301));f+=1;J=K=null;b.updateQueue=null;Sc.current=fj;a=c(d,e)}while(b.expirationTime===Ia)}Sc.current=Tc;b=null!==K&&null!==K.next;
Ia=0;J=K=z=null;Uc=!1;if(b)throw Error(k(300));return a}function ub(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};null===J?z.memoizedState=J=a:J=J.next=a;return J}function vb(){if(null===K){var a=z.alternate;a=null!==a?a.memoizedState:null}else a=K.next;var b=null===J?z.memoizedState:J.next;if(null!==b)J=b,K=a;else{if(null===a)throw Error(k(310));K=a;a={memoizedState:K.memoizedState,baseState:K.baseState,baseQueue:K.baseQueue,queue:K.queue,next:null};null===J?z.memoizedState=
J=a:J=J.next=a}return J}function Ua(a,b){return"function"===typeof b?b(a):b}function Vc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=K,e=d.baseQueue,f=c.pending;if(null!==f){if(null!==e){var g=e.next;e.next=f.next;f.next=g}d.baseQueue=e=f;c.pending=null}if(null!==e){e=e.next;d=d.baseState;var h=g=f=null,m=e;do{var n=m.expirationTime;if(n<Ia){var l={expirationTime:m.expirationTime,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,
next:null};null===h?(g=h=l,f=d):h=h.next=l;n>z.expirationTime&&(z.expirationTime=n,Kc(n))}else null!==h&&(h=h.next={expirationTime:1073741823,suspenseConfig:m.suspenseConfig,action:m.action,eagerReducer:m.eagerReducer,eagerState:m.eagerState,next:null}),Vg(n,m.suspenseConfig),d=m.eagerReducer===a?m.eagerState:a(d,m.action);m=m.next}while(null!==m&&m!==e);null===h?f=d:h.next=g;Qa(d,b.memoizedState)||(ia=!0);b.memoizedState=d;b.baseState=f;b.baseQueue=h;c.lastRenderedState=d}return[b.memoizedState,
c.dispatch]}function Wc(a,b,c){b=vb();c=b.queue;if(null===c)throw Error(k(311));c.lastRenderedReducer=a;var d=c.dispatch,e=c.pending,f=b.memoizedState;if(null!==e){c.pending=null;var g=e=e.next;do f=a(f,g.action),g=g.next;while(g!==e);Qa(f,b.memoizedState)||(ia=!0);b.memoizedState=f;null===b.baseQueue&&(b.baseState=f);c.lastRenderedState=f}return[f,d]}function xe(a){var b=ub();"function"===typeof a&&(a=a());b.memoizedState=b.baseState=a;a=b.queue={pending:null,dispatch:null,lastRenderedReducer:Ua,
lastRenderedState:a};a=a.dispatch=ch.bind(null,z,a);return[b.memoizedState,a]}function ye(a,b,c,d){a={tag:a,create:b,destroy:c,deps:d,next:null};b=z.updateQueue;null===b?(b={lastEffect:null},z.updateQueue=b,b.lastEffect=a.next=a):(c=b.lastEffect,null===c?b.lastEffect=a.next=a:(d=c.next,c.next=a,a.next=d,b.lastEffect=a));return a}function dh(a){return vb().memoizedState}function ze(a,b,c,d){var e=ub();z.effectTag|=a;e.memoizedState=ye(1|b,c,void 0,void 0===d?null:d)}function Ae(a,b,c,d){var e=vb();
d=void 0===d?null:d;var f=void 0;if(null!==K){var g=K.memoizedState;f=g.destroy;if(null!==d&&ve(d,g.deps)){ye(b,c,f,d);return}}z.effectTag|=a;e.memoizedState=ye(1|b,c,f,d)}function eh(a,b){return ze(516,4,a,b)}function Xc(a,b){return Ae(516,4,a,b)}function fh(a,b){return Ae(4,2,a,b)}function gh(a,b){if("function"===typeof b)return a=a(),b(a),function(){b(null)};if(null!==b&&void 0!==b)return a=a(),b.current=a,function(){b.current=null}}function hh(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;
return Ae(4,2,gh.bind(null,b,a),c)}function Be(a,b){}function ih(a,b){ub().memoizedState=[a,void 0===b?null:b];return a}function Yc(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];c.memoizedState=[a,b];return a}function jh(a,b){var c=vb();b=void 0===b?null:b;var d=c.memoizedState;if(null!==d&&null!==b&&ve(b,d[1]))return d[0];a=a();c.memoizedState=[a,b];return a}function Ce(a,b,c){var d=Cc();Da(98>d?98:d,function(){a(!0)});Da(97<d?97:d,function(){var d=
X.suspense;X.suspense=void 0===b?null:b;try{a(!1),c()}finally{X.suspense=d}})}function ch(a,b,c){var d=ka(),e=Vb.suspense;d=Va(d,a,e);e={expirationTime:d,suspenseConfig:e,action:c,eagerReducer:null,eagerState:null,next:null};var f=b.pending;null===f?e.next=e:(e.next=f.next,f.next=e);b.pending=e;f=a.alternate;if(a===z||null!==f&&f===z)Uc=!0,e.expirationTime=Ia,z.expirationTime=Ia;else{if(0===a.expirationTime&&(null===f||0===f.expirationTime)&&(f=b.lastRenderedReducer,null!==f))try{var g=b.lastRenderedState,
h=f(g,c);e.eagerReducer=f;e.eagerState=h;if(Qa(h,g))return}catch(m){}finally{}Ja(a,d)}}function kh(a,b){var c=la(5,null,null,0);c.elementType="DELETED";c.type="DELETED";c.stateNode=b;c.return=a;c.effectTag=8;null!==a.lastEffect?(a.lastEffect.nextEffect=c,a.lastEffect=c):a.firstEffect=a.lastEffect=c}function lh(a,b){switch(a.tag){case 5:var c=a.type;b=1!==b.nodeType||c.toLowerCase()!==b.nodeName.toLowerCase()?null:b;return null!==b?(a.stateNode=b,!0):!1;case 6:return b=""===a.pendingProps||3!==b.nodeType?
null:b,null!==b?(a.stateNode=b,!0):!1;case 13:return!1;default:return!1}}function De(a){if(Wa){var b=Ka;if(b){var c=b;if(!lh(a,b)){b=kb(c.nextSibling);if(!b||!lh(a,b)){a.effectTag=a.effectTag&-1025|2;Wa=!1;ra=a;return}kh(ra,c)}ra=a;Ka=kb(b.firstChild)}else a.effectTag=a.effectTag&-1025|2,Wa=!1,ra=a}}function mh(a){for(a=a.return;null!==a&&5!==a.tag&&3!==a.tag&&13!==a.tag;)a=a.return;ra=a}function Zc(a){if(a!==ra)return!1;if(!Wa)return mh(a),Wa=!0,!1;var b=a.type;if(5!==a.tag||"head"!==b&&"body"!==
b&&!Yd(b,a.memoizedProps))for(b=Ka;b;)kh(a,b),b=kb(b.nextSibling);mh(a);if(13===a.tag){a=a.memoizedState;a=null!==a?a.dehydrated:null;if(!a)throw Error(k(317));a:{a=a.nextSibling;for(b=0;a;){if(8===a.nodeType){var c=a.data;if(c===og){if(0===b){Ka=kb(a.nextSibling);break a}b--}else c!==ng&&c!==Zd&&c!==$d||b++}a=a.nextSibling}Ka=null}}else Ka=ra?kb(a.stateNode.nextSibling):null;return!0}function Ee(){Ka=ra=null;Wa=!1}function T(a,b,c,d){b.child=null===a?Fe(b,null,c,d):wb(b,a.child,c,d)}function nh(a,
b,c,d,e){c=c.render;var f=b.ref;rb(b,e);d=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,d,e);return b.child}function oh(a,b,c,d,e,f){if(null===a){var g=c.type;if("function"===typeof g&&!Ge(g)&&void 0===g.defaultProps&&null===c.compare&&void 0===c.defaultProps)return b.tag=15,b.type=g,ph(a,b,g,d,e,f);a=Oc(c.type,null,d,null,b.mode,f);a.ref=b.ref;a.return=b;return b.child=a}g=a.child;if(e<
f&&(e=g.memoizedProps,c=c.compare,c=null!==c?c:Ob,c(e,d)&&a.ref===b.ref))return sa(a,b,f);b.effectTag|=1;a=Sa(g,d);a.ref=b.ref;a.return=b;return b.child=a}function ph(a,b,c,d,e,f){return null!==a&&Ob(a.memoizedProps,d)&&a.ref===b.ref&&(ia=!1,e<f)?(b.expirationTime=a.expirationTime,sa(a,b,f)):He(a,b,c,d,f)}function qh(a,b){var c=b.ref;if(null===a&&null!==c||null!==a&&a.ref!==c)b.effectTag|=128}function He(a,b,c,d,e){var f=N(c)?Ra:B.current;f=pb(b,f);rb(b,e);c=we(a,b,c,d,f,e);if(null!==a&&!ia)return b.updateQueue=
a.updateQueue,b.effectTag&=-517,a.expirationTime<=e&&(a.expirationTime=0),sa(a,b,e);b.effectTag|=1;T(a,b,c,e);return b.child}function rh(a,b,c,d,e){if(N(c)){var f=!0;Bc(b)}else f=!1;rb(b,e);if(null===b.stateNode)null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),Yg(b,c,d),pe(b,c,d,e),d=!0;else if(null===a){var g=b.stateNode,h=b.memoizedProps;g.props=h;var m=g.context,n=c.contextType;"object"===typeof n&&null!==n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n));var l=c.getDerivedStateFromProps,k="function"===
typeof l||"function"===typeof g.getSnapshotBeforeUpdate;k||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n);Ga=!1;var p=b.memoizedState;g.state=p;Qb(b,d,g,e);m=b.memoizedState;h!==d||p!==m||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),m=b.memoizedState),(h=Ga||Xg(b,c,h,d,p,m,n))?(k||"function"!==typeof g.UNSAFE_componentWillMount&&"function"!==typeof g.componentWillMount||("function"===typeof g.componentWillMount&&
g.componentWillMount(),"function"===typeof g.UNSAFE_componentWillMount&&g.UNSAFE_componentWillMount()),"function"===typeof g.componentDidMount&&(b.effectTag|=4)):("function"===typeof g.componentDidMount&&(b.effectTag|=4),b.memoizedProps=d,b.memoizedState=m),g.props=d,g.state=m,g.context=n,d=h):("function"===typeof g.componentDidMount&&(b.effectTag|=4),d=!1)}else g=b.stateNode,oe(a,b),h=b.memoizedProps,g.props=b.type===b.elementType?h:aa(b.type,h),m=g.context,n=c.contextType,"object"===typeof n&&null!==
n?n=W(n):(n=N(c)?Ra:B.current,n=pb(b,n)),l=c.getDerivedStateFromProps,(k="function"===typeof l||"function"===typeof g.getSnapshotBeforeUpdate)||"function"!==typeof g.UNSAFE_componentWillReceiveProps&&"function"!==typeof g.componentWillReceiveProps||(h!==d||m!==n)&&Zg(b,g,d,n),Ga=!1,m=b.memoizedState,g.state=m,Qb(b,d,g,e),p=b.memoizedState,h!==d||m!==p||G.current||Ga?("function"===typeof l&&(Lc(b,c,l,d),p=b.memoizedState),(l=Ga||Xg(b,c,h,d,m,p,n))?(k||"function"!==typeof g.UNSAFE_componentWillUpdate&&
"function"!==typeof g.componentWillUpdate||("function"===typeof g.componentWillUpdate&&g.componentWillUpdate(d,p,n),"function"===typeof g.UNSAFE_componentWillUpdate&&g.UNSAFE_componentWillUpdate(d,p,n)),"function"===typeof g.componentDidUpdate&&(b.effectTag|=4),"function"===typeof g.getSnapshotBeforeUpdate&&(b.effectTag|=256)):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===
a.memoizedState||(b.effectTag|=256),b.memoizedProps=d,b.memoizedState=p),g.props=d,g.state=p,g.context=n,d=l):("function"!==typeof g.componentDidUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=4),"function"!==typeof g.getSnapshotBeforeUpdate||h===a.memoizedProps&&m===a.memoizedState||(b.effectTag|=256),d=!1);return Ie(a,b,c,d,f,e)}function Ie(a,b,c,d,e,f){qh(a,b);var g=0!==(b.effectTag&64);if(!d&&!g)return e&&Hg(b,c,!1),sa(a,b,f);d=b.stateNode;gj.current=b;var h=g&&"function"!==typeof c.getDerivedStateFromError?
null:d.render();b.effectTag|=1;null!==a&&g?(b.child=wb(b,a.child,null,f),b.child=wb(b,null,h,f)):T(a,b,h,f);b.memoizedState=d.state;e&&Hg(b,c,!0);return b.child}function sh(a){var b=a.stateNode;b.pendingContext?Fg(a,b.pendingContext,b.pendingContext!==b.context):b.context&&Fg(a,b.context,!1);se(a,b.containerInfo)}function th(a,b,c){var d=b.mode,e=b.pendingProps,f=D.current,g=!1,h;(h=0!==(b.effectTag&64))||(h=0!==(f&2)&&(null===a||null!==a.memoizedState));h?(g=!0,b.effectTag&=-65):null!==a&&null===
a.memoizedState||void 0===e.fallback||!0===e.unstable_avoidThisFallback||(f|=1);y(D,f&1);if(null===a){void 0!==e.fallback&&De(b);if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;b.memoizedState=Je;b.child=e;return c}d=e.children;b.memoizedState=null;return b.child=Fe(b,null,d,c)}if(null!==a.memoizedState){a=a.child;d=a.sibling;if(g){e=e.fallback;
c=Sa(a,a.pendingProps);c.return=b;if(0===(b.mode&2)&&(g=null!==b.memoizedState?b.child.child:b.child,g!==a.child))for(c.child=g;null!==g;)g.return=c,g=g.sibling;d=Sa(d,e);d.return=b;c.sibling=d;c.childExpirationTime=0;b.memoizedState=Je;b.child=c;return d}c=wb(b,a.child,e.children,c);b.memoizedState=null;return b.child=c}a=a.child;if(g){g=e.fallback;e=Ha(null,d,0,null);e.return=b;e.child=a;null!==a&&(a.return=e);if(0===(b.mode&2))for(a=null!==b.memoizedState?b.child.child:b.child,e.child=a;null!==
a;)a.return=e,a=a.sibling;c=Ha(g,d,c,null);c.return=b;e.sibling=c;c.effectTag|=2;e.childExpirationTime=0;b.memoizedState=Je;b.child=e;return c}b.memoizedState=null;return b.child=wb(b,a,e.children,c)}function uh(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);Sg(a.return,b)}function Ke(a,b,c,d,e,f){var g=a.memoizedState;null===g?a.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:d,tail:c,tailExpiration:0,tailMode:e,
lastEffect:f}:(g.isBackwards=b,g.rendering=null,g.renderingStartTime=0,g.last=d,g.tail=c,g.tailExpiration=0,g.tailMode=e,g.lastEffect=f)}function vh(a,b,c){var d=b.pendingProps,e=d.revealOrder,f=d.tail;T(a,b,d.children,c);d=D.current;if(0!==(d&2))d=d&1|2,b.effectTag|=64;else{if(null!==a&&0!==(a.effectTag&64))a:for(a=b.child;null!==a;){if(13===a.tag)null!==a.memoizedState&&uh(a,c);else if(19===a.tag)uh(a,c);else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===b)break a;for(;null===a.sibling;){if(null===
a.return||a.return===b)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}d&=1}y(D,d);if(0===(b.mode&2))b.memoizedState=null;else switch(e){case "forwards":c=b.child;for(e=null;null!==c;)a=c.alternate,null!==a&&null===Rc(a)&&(e=c),c=c.sibling;c=e;null===c?(e=b.child,b.child=null):(e=c.sibling,c.sibling=null);Ke(b,!1,e,c,f,b.lastEffect);break;case "backwards":c=null;e=b.child;for(b.child=null;null!==e;){a=e.alternate;if(null!==a&&null===Rc(a)){b.child=e;break}a=e.sibling;e.sibling=c;c=e;e=a}Ke(b,
!0,c,null,f,b.lastEffect);break;case "together":Ke(b,!1,null,null,void 0,b.lastEffect);break;default:b.memoizedState=null}return b.child}function sa(a,b,c){null!==a&&(b.dependencies=a.dependencies);var d=b.expirationTime;0!==d&&Kc(d);if(b.childExpirationTime<c)return null;if(null!==a&&b.child!==a.child)throw Error(k(153));if(null!==b.child){a=b.child;c=Sa(a,a.pendingProps);b.child=c;for(c.return=b;null!==a.sibling;)a=a.sibling,c=c.sibling=Sa(a,a.pendingProps),c.return=b;c.sibling=null}return b.child}
function $c(a,b){switch(a.tailMode){case "hidden":b=a.tail;for(var c=null;null!==b;)null!==b.alternate&&(c=b),b=b.sibling;null===c?a.tail=null:c.sibling=null;break;case "collapsed":c=a.tail;for(var d=null;null!==c;)null!==c.alternate&&(d=c),c=c.sibling;null===d?b||null===a.tail?a.tail=null:a.tail.sibling=null:d.sibling=null}}function hj(a,b,c){var d=b.pendingProps;switch(b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return N(b.type)&&(q(G),q(B)),
null;case 3:return tb(),q(G),q(B),c=b.stateNode,c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),null!==a&&null!==a.child||!Zc(b)||(b.effectTag|=4),wh(b),null;case 5:te(b);c=Ta(Tb.current);var e=b.type;if(null!==a&&null!=b.stateNode)ij(a,b,e,d,c),a.ref!==b.ref&&(b.effectTag|=128);else{if(!d){if(null===b.stateNode)throw Error(k(166));return null}a=Ta(ja.current);if(Zc(b)){d=b.stateNode;e=b.type;var f=b.memoizedProps;d[Aa]=b;d[vc]=f;switch(e){case "iframe":case "object":case "embed":w("load",
d);break;case "video":case "audio":for(a=0;a<Db.length;a++)w(Db[a],d);break;case "source":w("error",d);break;case "img":case "image":case "link":w("error",d);w("load",d);break;case "form":w("reset",d);w("submit",d);break;case "details":w("toggle",d);break;case "input":Hf(d,f);w("invalid",d);oa(c,"onChange");break;case "select":d._wrapperState={wasMultiple:!!f.multiple};w("invalid",d);oa(c,"onChange");break;case "textarea":Kf(d,f),w("invalid",d),oa(c,"onChange")}Ud(e,f);a=null;for(var g in f)if(f.hasOwnProperty(g)){var h=
f[g];"children"===g?"string"===typeof h?d.textContent!==h&&(a=["children",h]):"number"===typeof h&&d.textContent!==""+h&&(a=["children",""+h]):db.hasOwnProperty(g)&&null!=h&&oa(c,g)}switch(e){case "input":mc(d);Jf(d,f,!0);break;case "textarea":mc(d);Mf(d);break;case "select":case "option":break;default:"function"===typeof f.onClick&&(d.onclick=uc)}c=a;b.updateQueue=c;null!==c&&(b.effectTag|=4)}else{g=9===c.nodeType?c:c.ownerDocument;"http://www.w3.org/1999/xhtml"===a&&(a=Nf(e));"http://www.w3.org/1999/xhtml"===
a?"script"===e?(a=g.createElement("div"),a.innerHTML="<script>\x3c/script>",a=a.removeChild(a.firstChild)):"string"===typeof d.is?a=g.createElement(e,{is:d.is}):(a=g.createElement(e),"select"===e&&(g=a,d.multiple?g.multiple=!0:d.size&&(g.size=d.size))):a=g.createElementNS(a,e);a[Aa]=b;a[vc]=d;jj(a,b,!1,!1);b.stateNode=a;g=Vd(e,d);switch(e){case "iframe":case "object":case "embed":w("load",a);h=d;break;case "video":case "audio":for(h=0;h<Db.length;h++)w(Db[h],a);h=d;break;case "source":w("error",a);
h=d;break;case "img":case "image":case "link":w("error",a);w("load",a);h=d;break;case "form":w("reset",a);w("submit",a);h=d;break;case "details":w("toggle",a);h=d;break;case "input":Hf(a,d);h=Cd(a,d);w("invalid",a);oa(c,"onChange");break;case "option":h=Fd(a,d);break;case "select":a._wrapperState={wasMultiple:!!d.multiple};h=M({},d,{value:void 0});w("invalid",a);oa(c,"onChange");break;case "textarea":Kf(a,d);h=Gd(a,d);w("invalid",a);oa(c,"onChange");break;default:h=d}Ud(e,h);var m=h;for(f in m)if(m.hasOwnProperty(f)){var n=
m[f];"style"===f?gg(a,n):"dangerouslySetInnerHTML"===f?(n=n?n.__html:void 0,null!=n&&xh(a,n)):"children"===f?"string"===typeof n?("textarea"!==e||""!==n)&&Wb(a,n):"number"===typeof n&&Wb(a,""+n):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(db.hasOwnProperty(f)?null!=n&&oa(c,f):null!=n&&xd(a,f,n,g))}switch(e){case "input":mc(a);Jf(a,d,!1);break;case "textarea":mc(a);Mf(a);break;case "option":null!=d.value&&a.setAttribute("value",""+va(d.value));break;case "select":a.multiple=
!!d.multiple;c=d.value;null!=c?hb(a,!!d.multiple,c,!1):null!=d.defaultValue&&hb(a,!!d.multiple,d.defaultValue,!0);break;default:"function"===typeof h.onClick&&(a.onclick=uc)}lg(e,d)&&(b.effectTag|=4)}null!==b.ref&&(b.effectTag|=128)}return null;case 6:if(a&&null!=b.stateNode)kj(a,b,a.memoizedProps,d);else{if("string"!==typeof d&&null===b.stateNode)throw Error(k(166));c=Ta(Tb.current);Ta(ja.current);Zc(b)?(c=b.stateNode,d=b.memoizedProps,c[Aa]=b,c.nodeValue!==d&&(b.effectTag|=4)):(c=(9===c.nodeType?
c:c.ownerDocument).createTextNode(d),c[Aa]=b,b.stateNode=c)}return null;case 13:q(D);d=b.memoizedState;if(0!==(b.effectTag&64))return b.expirationTime=c,b;c=null!==d;d=!1;null===a?void 0!==b.memoizedProps.fallback&&Zc(b):(e=a.memoizedState,d=null!==e,c||null===e||(e=a.child.sibling,null!==e&&(f=b.firstEffect,null!==f?(b.firstEffect=e,e.nextEffect=f):(b.firstEffect=b.lastEffect=e,e.nextEffect=null),e.effectTag=8)));if(c&&!d&&0!==(b.mode&2))if(null===a&&!0!==b.memoizedProps.unstable_avoidThisFallback||
0!==(D.current&1))F===Xa&&(F=ad);else{if(F===Xa||F===ad)F=bd;0!==Xb&&null!==U&&(Ya(U,P),yh(U,Xb))}if(c||d)b.effectTag|=4;return null;case 4:return tb(),wh(b),null;case 10:return me(b),null;case 17:return N(b.type)&&(q(G),q(B)),null;case 19:q(D);d=b.memoizedState;if(null===d)return null;e=0!==(b.effectTag&64);f=d.rendering;if(null===f)if(e)$c(d,!1);else{if(F!==Xa||null!==a&&0!==(a.effectTag&64))for(f=b.child;null!==f;){a=Rc(f);if(null!==a){b.effectTag|=64;$c(d,!1);e=a.updateQueue;null!==e&&(b.updateQueue=
e,b.effectTag|=4);null===d.lastEffect&&(b.firstEffect=null);b.lastEffect=d.lastEffect;for(d=b.child;null!==d;)e=d,f=c,e.effectTag&=2,e.nextEffect=null,e.firstEffect=null,e.lastEffect=null,a=e.alternate,null===a?(e.childExpirationTime=0,e.expirationTime=f,e.child=null,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null):(e.childExpirationTime=a.childExpirationTime,e.expirationTime=a.expirationTime,e.child=a.child,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,
e.updateQueue=a.updateQueue,f=a.dependencies,e.dependencies=null===f?null:{expirationTime:f.expirationTime,firstContext:f.firstContext,responders:f.responders}),d=d.sibling;y(D,D.current&1|2);return b.child}f=f.sibling}}else{if(!e)if(a=Rc(f),null!==a){if(b.effectTag|=64,e=!0,c=a.updateQueue,null!==c&&(b.updateQueue=c,b.effectTag|=4),$c(d,!0),null===d.tail&&"hidden"===d.tailMode&&!f.alternate)return b=b.lastEffect=d.lastEffect,null!==b&&(b.nextEffect=null),null}else 2*Y()-d.renderingStartTime>d.tailExpiration&&
1<c&&(b.effectTag|=64,e=!0,$c(d,!1),b.expirationTime=b.childExpirationTime=c-1);d.isBackwards?(f.sibling=b.child,b.child=f):(c=d.last,null!==c?c.sibling=f:b.child=f,d.last=f)}return null!==d.tail?(0===d.tailExpiration&&(d.tailExpiration=Y()+500),c=d.tail,d.rendering=c,d.tail=c.sibling,d.lastEffect=b.lastEffect,d.renderingStartTime=Y(),c.sibling=null,b=D.current,y(D,e?b&1|2:b&1),c):null}throw Error(k(156,b.tag));}function lj(a,b){switch(a.tag){case 1:return N(a.type)&&(q(G),q(B)),b=a.effectTag,b&4096?
(a.effectTag=b&-4097|64,a):null;case 3:tb();q(G);q(B);b=a.effectTag;if(0!==(b&64))throw Error(k(285));a.effectTag=b&-4097|64;return a;case 5:return te(a),null;case 13:return q(D),b=a.effectTag,b&4096?(a.effectTag=b&-4097|64,a):null;case 19:return q(D),null;case 4:return tb(),null;case 10:return me(a),null;default:return null}}function Le(a,b){return{value:a,source:b,stack:Bd(b)}}function Me(a,b){var c=b.source,d=b.stack;null===d&&null!==c&&(d=Bd(c));null!==c&&na(c.type);b=b.value;null!==a&&1===a.tag&&
na(a.type);try{console.error(b)}catch(e){setTimeout(function(){throw e;})}}function mj(a,b){try{b.props=a.memoizedProps,b.state=a.memoizedState,b.componentWillUnmount()}catch(c){Za(a,c)}}function zh(a){var b=a.ref;if(null!==b)if("function"===typeof b)try{b(null)}catch(c){Za(a,c)}else b.current=null}function nj(a,b){switch(b.tag){case 0:case 11:case 15:case 22:return;case 1:if(b.effectTag&256&&null!==a){var c=a.memoizedProps,d=a.memoizedState;a=b.stateNode;b=a.getSnapshotBeforeUpdate(b.elementType===
b.type?c:aa(b.type,c),d);a.__reactInternalSnapshotBeforeUpdate=b}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(k(163));}function Ah(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.destroy;c.destroy=void 0;void 0!==d&&d()}c=c.next}while(c!==b)}}function Bh(a,b){b=b.updateQueue;b=null!==b?b.lastEffect:null;if(null!==b){var c=b=b.next;do{if((c.tag&a)===a){var d=c.create;c.destroy=d()}c=c.next}while(c!==b)}}function oj(a,b,c,d){switch(c.tag){case 0:case 11:case 15:case 22:Bh(3,
c);return;case 1:a=c.stateNode;c.effectTag&4&&(null===b?a.componentDidMount():(d=c.elementType===c.type?b.memoizedProps:aa(c.type,b.memoizedProps),a.componentDidUpdate(d,b.memoizedState,a.__reactInternalSnapshotBeforeUpdate)));b=c.updateQueue;null!==b&&Wg(c,b,a);return;case 3:b=c.updateQueue;if(null!==b){a=null;if(null!==c.child)switch(c.child.tag){case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}Wg(c,b,a)}return;case 5:a=c.stateNode;null===b&&c.effectTag&4&&lg(c.type,c.memoizedProps)&&
a.focus();return;case 6:return;case 4:return;case 12:return;case 13:null===c.memoizedState&&(c=c.alternate,null!==c&&(c=c.memoizedState,null!==c&&(c=c.dehydrated,null!==c&&bg(c))));return;case 19:case 17:case 20:case 21:return}throw Error(k(163));}function Ch(a,b,c){"function"===typeof Ne&&Ne(b);switch(b.tag){case 0:case 11:case 14:case 15:case 22:a=b.updateQueue;if(null!==a&&(a=a.lastEffect,null!==a)){var d=a.next;Da(97<c?97:c,function(){var a=d;do{var c=a.destroy;if(void 0!==c){var g=b;try{c()}catch(h){Za(g,
h)}}a=a.next}while(a!==d)})}break;case 1:zh(b);c=b.stateNode;"function"===typeof c.componentWillUnmount&&mj(b,c);break;case 5:zh(b);break;case 4:Dh(a,b,c)}}function Eh(a){var b=a.alternate;a.return=null;a.child=null;a.memoizedState=null;a.updateQueue=null;a.dependencies=null;a.alternate=null;a.firstEffect=null;a.lastEffect=null;a.pendingProps=null;a.memoizedProps=null;a.stateNode=null;null!==b&&Eh(b)}function Fh(a){return 5===a.tag||3===a.tag||4===a.tag}function Gh(a){a:{for(var b=a.return;null!==
b;){if(Fh(b)){var c=b;break a}b=b.return}throw Error(k(160));}b=c.stateNode;switch(c.tag){case 5:var d=!1;break;case 3:b=b.containerInfo;d=!0;break;case 4:b=b.containerInfo;d=!0;break;default:throw Error(k(161));}c.effectTag&16&&(Wb(b,""),c.effectTag&=-17);a:b:for(c=a;;){for(;null===c.sibling;){if(null===c.return||Fh(c.return)){c=null;break a}c=c.return}c.sibling.return=c.return;for(c=c.sibling;5!==c.tag&&6!==c.tag&&18!==c.tag;){if(c.effectTag&2)continue b;if(null===c.child||4===c.tag)continue b;
else c.child.return=c,c=c.child}if(!(c.effectTag&2)){c=c.stateNode;break a}}d?Oe(a,c,b):Pe(a,c,b)}function Oe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?8===c.nodeType?c.parentNode.insertBefore(a,b):c.insertBefore(a,b):(8===c.nodeType?(b=c.parentNode,b.insertBefore(a,c)):(b=c,b.appendChild(a)),c=c._reactRootContainer,null!==c&&void 0!==c||null!==b.onclick||(b.onclick=uc));else if(4!==d&&(a=a.child,null!==a))for(Oe(a,b,c),a=a.sibling;null!==a;)Oe(a,b,c),a=a.sibling}
function Pe(a,b,c){var d=a.tag,e=5===d||6===d;if(e)a=e?a.stateNode:a.stateNode.instance,b?c.insertBefore(a,b):c.appendChild(a);else if(4!==d&&(a=a.child,null!==a))for(Pe(a,b,c),a=a.sibling;null!==a;)Pe(a,b,c),a=a.sibling}function Dh(a,b,c){for(var d=b,e=!1,f,g;;){if(!e){e=d.return;a:for(;;){if(null===e)throw Error(k(160));f=e.stateNode;switch(e.tag){case 5:g=!1;break a;case 3:f=f.containerInfo;g=!0;break a;case 4:f=f.containerInfo;g=!0;break a}e=e.return}e=!0}if(5===d.tag||6===d.tag){a:for(var h=
a,m=d,n=c,l=m;;)if(Ch(h,l,n),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===m)break a;for(;null===l.sibling;){if(null===l.return||l.return===m)break a;l=l.return}l.sibling.return=l.return;l=l.sibling}g?(h=f,m=d.stateNode,8===h.nodeType?h.parentNode.removeChild(m):h.removeChild(m)):f.removeChild(d.stateNode)}else if(4===d.tag){if(null!==d.child){f=d.stateNode.containerInfo;g=!0;d.child.return=d;d=d.child;continue}}else if(Ch(a,d,c),null!==d.child){d.child.return=d;d=d.child;continue}if(d===
b)break;for(;null===d.sibling;){if(null===d.return||d.return===b)return;d=d.return;4===d.tag&&(e=!1)}d.sibling.return=d.return;d=d.sibling}}function Qe(a,b){switch(b.tag){case 0:case 11:case 14:case 15:case 22:Ah(3,b);return;case 1:return;case 5:var c=b.stateNode;if(null!=c){var d=b.memoizedProps,e=null!==a?a.memoizedProps:d;a=b.type;var f=b.updateQueue;b.updateQueue=null;if(null!==f){c[vc]=d;"input"===a&&"radio"===d.type&&null!=d.name&&If(c,d);Vd(a,e);b=Vd(a,d);for(e=0;e<f.length;e+=2){var g=f[e],
h=f[e+1];"style"===g?gg(c,h):"dangerouslySetInnerHTML"===g?xh(c,h):"children"===g?Wb(c,h):xd(c,g,h,b)}switch(a){case "input":Dd(c,d);break;case "textarea":Lf(c,d);break;case "select":b=c._wrapperState.wasMultiple,c._wrapperState.wasMultiple=!!d.multiple,a=d.value,null!=a?hb(c,!!d.multiple,a,!1):b!==!!d.multiple&&(null!=d.defaultValue?hb(c,!!d.multiple,d.defaultValue,!0):hb(c,!!d.multiple,d.multiple?[]:"",!1))}}}return;case 6:if(null===b.stateNode)throw Error(k(162));b.stateNode.nodeValue=b.memoizedProps;
return;case 3:b=b.stateNode;b.hydrate&&(b.hydrate=!1,bg(b.containerInfo));return;case 12:return;case 13:c=b;null===b.memoizedState?d=!1:(d=!0,c=b.child,Re=Y());if(null!==c)a:for(a=c;;){if(5===a.tag)f=a.stateNode,d?(f=f.style,"function"===typeof f.setProperty?f.setProperty("display","none","important"):f.display="none"):(f=a.stateNode,e=a.memoizedProps.style,e=void 0!==e&&null!==e&&e.hasOwnProperty("display")?e.display:null,f.style.display=fg("display",e));else if(6===a.tag)a.stateNode.nodeValue=d?
"":a.memoizedProps;else if(13===a.tag&&null!==a.memoizedState&&null===a.memoizedState.dehydrated){f=a.child.sibling;f.return=a;a=f;continue}else if(null!==a.child){a.child.return=a;a=a.child;continue}if(a===c)break;for(;null===a.sibling;){if(null===a.return||a.return===c)break a;a=a.return}a.sibling.return=a.return;a=a.sibling}Hh(b);return;case 19:Hh(b);return;case 17:return}throw Error(k(163));}function Hh(a){var b=a.updateQueue;if(null!==b){a.updateQueue=null;var c=a.stateNode;null===c&&(c=a.stateNode=
new pj);b.forEach(function(b){var d=qj.bind(null,a,b);c.has(b)||(c.add(b),b.then(d,d))})}}function Ih(a,b,c){c=Ea(c,null);c.tag=3;c.payload={element:null};var d=b.value;c.callback=function(){cd||(cd=!0,Se=d);Me(a,b)};return c}function Jh(a,b,c){c=Ea(c,null);c.tag=3;var d=a.type.getDerivedStateFromError;if("function"===typeof d){var e=b.value;c.payload=function(){Me(a,b);return d(e)}}var f=a.stateNode;null!==f&&"function"===typeof f.componentDidCatch&&(c.callback=function(){"function"!==typeof d&&
(null===La?La=new Set([this]):La.add(this),Me(a,b));var c=b.stack;this.componentDidCatch(b.value,{componentStack:null!==c?c:""})});return c}function ka(){return(p&(ca|ma))!==H?1073741821-(Y()/10|0):0!==dd?dd:dd=1073741821-(Y()/10|0)}function Va(a,b,c){b=b.mode;if(0===(b&2))return 1073741823;var d=Cc();if(0===(b&4))return 99===d?1073741823:1073741822;if((p&ca)!==H)return P;if(null!==c)a=Fc(a,c.timeoutMs|0||5E3,250);else switch(d){case 99:a=1073741823;break;case 98:a=Fc(a,150,100);break;case 97:case 96:a=
Fc(a,5E3,250);break;case 95:a=2;break;default:throw Error(k(326));}null!==U&&a===P&&--a;return a}function ed(a,b){a.expirationTime<b&&(a.expirationTime=b);var c=a.alternate;null!==c&&c.expirationTime<b&&(c.expirationTime=b);var d=a.return,e=null;if(null===d&&3===a.tag)e=a.stateNode;else for(;null!==d;){c=d.alternate;d.childExpirationTime<b&&(d.childExpirationTime=b);null!==c&&c.childExpirationTime<b&&(c.childExpirationTime=b);if(null===d.return&&3===d.tag){e=d.stateNode;break}d=d.return}null!==e&&
(U===e&&(Kc(b),F===bd&&Ya(e,P)),yh(e,b));return e}function fd(a){var b=a.lastExpiredTime;if(0!==b)return b;b=a.firstPendingTime;if(!Kh(a,b))return b;var c=a.lastPingedTime;a=a.nextKnownPendingLevel;a=c>a?c:a;return 2>=a&&b!==a?0:a}function V(a){if(0!==a.lastExpiredTime)a.callbackExpirationTime=1073741823,a.callbackPriority=99,a.callbackNode=Og(Te.bind(null,a));else{var b=fd(a),c=a.callbackNode;if(0===b)null!==c&&(a.callbackNode=null,a.callbackExpirationTime=0,a.callbackPriority=90);else{var d=ka();
1073741823===b?d=99:1===b||2===b?d=95:(d=10*(1073741821-b)-10*(1073741821-d),d=0>=d?99:250>=d?98:5250>=d?97:95);if(null!==c){var e=a.callbackPriority;if(a.callbackExpirationTime===b&&e>=d)return;c!==Qg&&Rg(c)}a.callbackExpirationTime=b;a.callbackPriority=d;b=1073741823===b?Og(Te.bind(null,a)):Ng(d,Lh.bind(null,a),{timeout:10*(1073741821-b)-Y()});a.callbackNode=b}}}function Lh(a,b){dd=0;if(b)return b=ka(),Ue(a,b),V(a),null;var c=fd(a);if(0!==c){b=a.callbackNode;if((p&(ca|ma))!==H)throw Error(k(327));
xb();a===U&&c===P||$a(a,c);if(null!==t){var d=p;p|=ca;var e=Mh();do try{rj();break}catch(h){Nh(a,h)}while(1);le();p=d;gd.current=e;if(F===hd)throw b=id,$a(a,c),Ya(a,c),V(a),b;if(null===t)switch(e=a.finishedWork=a.current.alternate,a.finishedExpirationTime=c,d=F,U=null,d){case Xa:case hd:throw Error(k(345));case Oh:Ue(a,2<c?2:c);break;case ad:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(1073741823===ta&&(e=Re+Ph-Y(),10<e)){if(jd){var f=a.lastPingedTime;if(0===f||f>=c){a.lastPingedTime=
c;$a(a,c);break}}f=fd(a);if(0!==f&&f!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}a.timeoutHandle=We(ab.bind(null,a),e);break}ab(a);break;case bd:Ya(a,c);d=a.lastSuspendedTime;c===d&&(a.nextKnownPendingLevel=Ve(e));if(jd&&(e=a.lastPingedTime,0===e||e>=c)){a.lastPingedTime=c;$a(a,c);break}e=fd(a);if(0!==e&&e!==c)break;if(0!==d&&d!==c){a.lastPingedTime=d;break}1073741823!==Yb?d=10*(1073741821-Yb)-Y():1073741823===ta?d=0:(d=10*(1073741821-ta)-5E3,e=Y(),c=10*(1073741821-c)-e,d=e-d,0>d&&(d=0),d=
(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3E3>d?3E3:4320>d?4320:1960*sj(d/1960))-d,c<d&&(d=c));if(10<d){a.timeoutHandle=We(ab.bind(null,a),d);break}ab(a);break;case Xe:if(1073741823!==ta&&null!==kd){f=ta;var g=kd;d=g.busyMinDurationMs|0;0>=d?d=0:(e=g.busyDelayMs|0,f=Y()-(10*(1073741821-f)-(g.timeoutMs|0||5E3)),d=f<=e?0:e+d-f);if(10<d){Ya(a,c);a.timeoutHandle=We(ab.bind(null,a),d);break}}ab(a);break;default:throw Error(k(329));}V(a);if(a.callbackNode===b)return Lh.bind(null,a)}}return null}function Te(a){var b=
a.lastExpiredTime;b=0!==b?b:1073741823;if((p&(ca|ma))!==H)throw Error(k(327));xb();a===U&&b===P||$a(a,b);if(null!==t){var c=p;p|=ca;var d=Mh();do try{tj();break}catch(e){Nh(a,e)}while(1);le();p=c;gd.current=d;if(F===hd)throw c=id,$a(a,b),Ya(a,b),V(a),c;if(null!==t)throw Error(k(261));a.finishedWork=a.current.alternate;a.finishedExpirationTime=b;U=null;ab(a);V(a)}return null}function uj(){if(null!==bb){var a=bb;bb=null;a.forEach(function(a,c){Ue(c,a);V(c)});ha()}}function Qh(a,b){var c=p;p|=1;try{return a(b)}finally{p=
c,p===H&&ha()}}function Rh(a,b){var c=p;p&=-2;p|=Ye;try{return a(b)}finally{p=c,p===H&&ha()}}function $a(a,b){a.finishedWork=null;a.finishedExpirationTime=0;var c=a.timeoutHandle;-1!==c&&(a.timeoutHandle=-1,vj(c));if(null!==t)for(c=t.return;null!==c;){var d=c;switch(d.tag){case 1:d=d.type.childContextTypes;null!==d&&void 0!==d&&(q(G),q(B));break;case 3:tb();q(G);q(B);break;case 5:te(d);break;case 4:tb();break;case 13:q(D);break;case 19:q(D);break;case 10:me(d)}c=c.return}U=a;t=Sa(a.current,null);
P=b;F=Xa;id=null;Yb=ta=1073741823;kd=null;Xb=0;jd=!1}function Nh(a,b){do{try{le();Sc.current=Tc;if(Uc)for(var c=z.memoizedState;null!==c;){var d=c.queue;null!==d&&(d.pending=null);c=c.next}Ia=0;J=K=z=null;Uc=!1;if(null===t||null===t.return)return F=hd,id=b,t=null;a:{var e=a,f=t.return,g=t,h=b;b=P;g.effectTag|=2048;g.firstEffect=g.lastEffect=null;if(null!==h&&"object"===typeof h&&"function"===typeof h.then){var m=h;if(0===(g.mode&2)){var n=g.alternate;n?(g.updateQueue=n.updateQueue,g.memoizedState=
n.memoizedState,g.expirationTime=n.expirationTime):(g.updateQueue=null,g.memoizedState=null)}var l=0!==(D.current&1),k=f;do{var p;if(p=13===k.tag){var q=k.memoizedState;if(null!==q)p=null!==q.dehydrated?!0:!1;else{var w=k.memoizedProps;p=void 0===w.fallback?!1:!0!==w.unstable_avoidThisFallback?!0:l?!1:!0}}if(p){var y=k.updateQueue;if(null===y){var r=new Set;r.add(m);k.updateQueue=r}else y.add(m);if(0===(k.mode&2)){k.effectTag|=64;g.effectTag&=-2981;if(1===g.tag)if(null===g.alternate)g.tag=17;else{var O=
Ea(1073741823,null);O.tag=Jc;Fa(g,O)}g.expirationTime=1073741823;break a}h=void 0;g=b;var v=e.pingCache;null===v?(v=e.pingCache=new wj,h=new Set,v.set(m,h)):(h=v.get(m),void 0===h&&(h=new Set,v.set(m,h)));if(!h.has(g)){h.add(g);var x=xj.bind(null,e,m,g);m.then(x,x)}k.effectTag|=4096;k.expirationTime=b;break a}k=k.return}while(null!==k);h=Error((na(g.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+
Bd(g))}F!==Xe&&(F=Oh);h=Le(h,g);k=f;do{switch(k.tag){case 3:m=h;k.effectTag|=4096;k.expirationTime=b;var A=Ih(k,m,b);Ug(k,A);break a;case 1:m=h;var u=k.type,B=k.stateNode;if(0===(k.effectTag&64)&&("function"===typeof u.getDerivedStateFromError||null!==B&&"function"===typeof B.componentDidCatch&&(null===La||!La.has(B)))){k.effectTag|=4096;k.expirationTime=b;var H=Jh(k,m,b);Ug(k,H);break a}}k=k.return}while(null!==k)}t=Sh(t)}catch(cj){b=cj;continue}break}while(1)}function Mh(a){a=gd.current;gd.current=
Tc;return null===a?Tc:a}function Vg(a,b){a<ta&&2<a&&(ta=a);null!==b&&a<Yb&&2<a&&(Yb=a,kd=b)}function Kc(a){a>Xb&&(Xb=a)}function tj(){for(;null!==t;)t=Th(t)}function rj(){for(;null!==t&&!yj();)t=Th(t)}function Th(a){var b=zj(a.alternate,a,P);a.memoizedProps=a.pendingProps;null===b&&(b=Sh(a));Uh.current=null;return b}function Sh(a){t=a;do{var b=t.alternate;a=t.return;if(0===(t.effectTag&2048)){b=hj(b,t,P);if(1===P||1!==t.childExpirationTime){for(var c=0,d=t.child;null!==d;){var e=d.expirationTime,
f=d.childExpirationTime;e>c&&(c=e);f>c&&(c=f);d=d.sibling}t.childExpirationTime=c}if(null!==b)return b;null!==a&&0===(a.effectTag&2048)&&(null===a.firstEffect&&(a.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==a.lastEffect&&(a.lastEffect.nextEffect=t.firstEffect),a.lastEffect=t.lastEffect),1<t.effectTag&&(null!==a.lastEffect?a.lastEffect.nextEffect=t:a.firstEffect=t,a.lastEffect=t))}else{b=lj(t);if(null!==b)return b.effectTag&=2047,b;null!==a&&(a.firstEffect=a.lastEffect=null,a.effectTag|=
2048)}b=t.sibling;if(null!==b)return b;t=a}while(null!==t);F===Xa&&(F=Xe);return null}function Ve(a){var b=a.expirationTime;a=a.childExpirationTime;return b>a?b:a}function ab(a){var b=Cc();Da(99,Aj.bind(null,a,b));return null}function Aj(a,b){do xb();while(null!==Zb);if((p&(ca|ma))!==H)throw Error(k(327));var c=a.finishedWork,d=a.finishedExpirationTime;if(null===c)return null;a.finishedWork=null;a.finishedExpirationTime=0;if(c===a.current)throw Error(k(177));a.callbackNode=null;a.callbackExpirationTime=
0;a.callbackPriority=90;a.nextKnownPendingLevel=0;var e=Ve(c);a.firstPendingTime=e;d<=a.lastSuspendedTime?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:d<=a.firstSuspendedTime&&(a.firstSuspendedTime=d-1);d<=a.lastPingedTime&&(a.lastPingedTime=0);d<=a.lastExpiredTime&&(a.lastExpiredTime=0);a===U&&(t=U=null,P=0);1<c.effectTag?null!==c.lastEffect?(c.lastEffect.nextEffect=c,e=c.firstEffect):e=c:e=c.firstEffect;if(null!==e){var f=p;p|=ma;Uh.current=null;Ze=tc;var g=kg();if(Xd(g)){if("selectionStart"in
g)var h={start:g.selectionStart,end:g.selectionEnd};else a:{h=(h=g.ownerDocument)&&h.defaultView||window;var m=h.getSelection&&h.getSelection();if(m&&0!==m.rangeCount){h=m.anchorNode;var n=m.anchorOffset,q=m.focusNode;m=m.focusOffset;try{h.nodeType,q.nodeType}catch(sb){h=null;break a}var ba=0,w=-1,y=-1,B=0,D=0,r=g,z=null;b:for(;;){for(var v;;){r!==h||0!==n&&3!==r.nodeType||(w=ba+n);r!==q||0!==m&&3!==r.nodeType||(y=ba+m);3===r.nodeType&&(ba+=r.nodeValue.length);if(null===(v=r.firstChild))break;z=r;
r=v}for(;;){if(r===g)break b;z===h&&++B===n&&(w=ba);z===q&&++D===m&&(y=ba);if(null!==(v=r.nextSibling))break;r=z;z=r.parentNode}r=v}h=-1===w||-1===y?null:{start:w,end:y}}else h=null}h=h||{start:0,end:0}}else h=null;$e={activeElementDetached:null,focusedElem:g,selectionRange:h};tc=!1;l=e;do try{Bj()}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=e;do try{for(g=a,h=b;null!==l;){var x=l.effectTag;x&16&&Wb(l.stateNode,"");if(x&128){var A=l.alternate;if(null!==A){var u=
A.ref;null!==u&&("function"===typeof u?u(null):u.current=null)}}switch(x&1038){case 2:Gh(l);l.effectTag&=-3;break;case 6:Gh(l);l.effectTag&=-3;Qe(l.alternate,l);break;case 1024:l.effectTag&=-1025;break;case 1028:l.effectTag&=-1025;Qe(l.alternate,l);break;case 4:Qe(l.alternate,l);break;case 8:n=l,Dh(g,n,h),Eh(n)}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);u=$e;A=kg();x=u.focusedElem;h=u.selectionRange;if(A!==x&&x&&x.ownerDocument&&jg(x.ownerDocument.documentElement,
x)){null!==h&&Xd(x)&&(A=h.start,u=h.end,void 0===u&&(u=A),"selectionStart"in x?(x.selectionStart=A,x.selectionEnd=Math.min(u,x.value.length)):(u=(A=x.ownerDocument||document)&&A.defaultView||window,u.getSelection&&(u=u.getSelection(),n=x.textContent.length,g=Math.min(h.start,n),h=void 0===h.end?g:Math.min(h.end,n),!u.extend&&g>h&&(n=h,h=g,g=n),n=ig(x,g),q=ig(x,h),n&&q&&(1!==u.rangeCount||u.anchorNode!==n.node||u.anchorOffset!==n.offset||u.focusNode!==q.node||u.focusOffset!==q.offset)&&(A=A.createRange(),
A.setStart(n.node,n.offset),u.removeAllRanges(),g>h?(u.addRange(A),u.extend(q.node,q.offset)):(A.setEnd(q.node,q.offset),u.addRange(A))))));A=[];for(u=x;u=u.parentNode;)1===u.nodeType&&A.push({element:u,left:u.scrollLeft,top:u.scrollTop});"function"===typeof x.focus&&x.focus();for(x=0;x<A.length;x++)u=A[x],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}tc=!!Ze;$e=Ze=null;a.current=c;l=e;do try{for(x=a;null!==l;){var F=l.effectTag;F&36&&oj(x,l.alternate,l);if(F&128){A=void 0;var E=l.ref;if(null!==
E){var G=l.stateNode;switch(l.tag){case 5:A=G;break;default:A=G}"function"===typeof E?E(A):E.current=A}}l=l.nextEffect}}catch(sb){if(null===l)throw Error(k(330));Za(l,sb);l=l.nextEffect}while(null!==l);l=null;Cj();p=f}else a.current=c;if(ld)ld=!1,Zb=a,$b=b;else for(l=e;null!==l;)b=l.nextEffect,l.nextEffect=null,l=b;b=a.firstPendingTime;0===b&&(La=null);1073741823===b?a===af?ac++:(ac=0,af=a):ac=0;"function"===typeof bf&&bf(c.stateNode,d);V(a);if(cd)throw cd=!1,a=Se,Se=null,a;if((p&Ye)!==H)return null;
ha();return null}function Bj(){for(;null!==l;){var a=l.effectTag;0!==(a&256)&&nj(l.alternate,l);0===(a&512)||ld||(ld=!0,Ng(97,function(){xb();return null}));l=l.nextEffect}}function xb(){if(90!==$b){var a=97<$b?97:$b;$b=90;return Da(a,Dj)}}function Dj(){if(null===Zb)return!1;var a=Zb;Zb=null;if((p&(ca|ma))!==H)throw Error(k(331));var b=p;p|=ma;for(a=a.current.firstEffect;null!==a;){try{var c=a;if(0!==(c.effectTag&512))switch(c.tag){case 0:case 11:case 15:case 22:Ah(5,c),Bh(5,c)}}catch(d){if(null===
a)throw Error(k(330));Za(a,d)}c=a.nextEffect;a.nextEffect=null;a=c}p=b;ha();return!0}function Vh(a,b,c){b=Le(c,b);b=Ih(a,b,1073741823);Fa(a,b);a=ed(a,1073741823);null!==a&&V(a)}function Za(a,b){if(3===a.tag)Vh(a,a,b);else for(var c=a.return;null!==c;){if(3===c.tag){Vh(c,a,b);break}else if(1===c.tag){var d=c.stateNode;if("function"===typeof c.type.getDerivedStateFromError||"function"===typeof d.componentDidCatch&&(null===La||!La.has(d))){a=Le(b,a);a=Jh(c,a,1073741823);Fa(c,a);c=ed(c,1073741823);null!==
c&&V(c);break}}c=c.return}}function xj(a,b,c){var d=a.pingCache;null!==d&&d.delete(b);U===a&&P===c?F===bd||F===ad&&1073741823===ta&&Y()-Re<Ph?$a(a,P):jd=!0:Kh(a,c)&&(b=a.lastPingedTime,0!==b&&b<c||(a.lastPingedTime=c,V(a)))}function qj(a,b){var c=a.stateNode;null!==c&&c.delete(b);b=0;0===b&&(b=ka(),b=Va(b,a,null));a=ed(a,b);null!==a&&V(a)}function Ej(a){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)return!0;try{var c=
b.inject(a);bf=function(a,e){try{b.onCommitFiberRoot(c,a,void 0,64===(a.current.effectTag&64))}catch(f){}};Ne=function(a){try{b.onCommitFiberUnmount(c,a)}catch(e){}}}catch(d){}return!0}function Fj(a,b,c,d){this.tag=a;this.key=c;this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null;this.index=0;this.ref=null;this.pendingProps=b;this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null;this.mode=d;this.effectTag=0;this.lastEffect=this.firstEffect=this.nextEffect=
null;this.childExpirationTime=this.expirationTime=0;this.alternate=null}function Ge(a){a=a.prototype;return!(!a||!a.isReactComponent)}function Gj(a){if("function"===typeof a)return Ge(a)?1:0;if(void 0!==a&&null!==a){a=a.$$typeof;if(a===zd)return 11;if(a===Ad)return 14}return 2}function Sa(a,b){var c=a.alternate;null===c?(c=la(a.tag,b,a.key,a.mode),c.elementType=a.elementType,c.type=a.type,c.stateNode=a.stateNode,c.alternate=a,a.alternate=c):(c.pendingProps=b,c.effectTag=0,c.nextEffect=null,c.firstEffect=
null,c.lastEffect=null);c.childExpirationTime=a.childExpirationTime;c.expirationTime=a.expirationTime;c.child=a.child;c.memoizedProps=a.memoizedProps;c.memoizedState=a.memoizedState;c.updateQueue=a.updateQueue;b=a.dependencies;c.dependencies=null===b?null:{expirationTime:b.expirationTime,firstContext:b.firstContext,responders:b.responders};c.sibling=a.sibling;c.index=a.index;c.ref=a.ref;return c}function Oc(a,b,c,d,e,f){var g=2;d=a;if("function"===typeof a)Ge(a)&&(g=1);else if("string"===typeof a)g=
5;else a:switch(a){case Ma:return Ha(c.children,e,f,b);case Hj:g=8;e|=7;break;case Af:g=8;e|=1;break;case kc:return a=la(12,c,b,e|8),a.elementType=kc,a.type=kc,a.expirationTime=f,a;case lc:return a=la(13,c,b,e),a.type=lc,a.elementType=lc,a.expirationTime=f,a;case yd:return a=la(19,c,b,e),a.elementType=yd,a.expirationTime=f,a;default:if("object"===typeof a&&null!==a)switch(a.$$typeof){case Cf:g=10;break a;case Bf:g=9;break a;case zd:g=11;break a;case Ad:g=14;break a;case Ef:g=16;d=null;break a;case Df:g=
22;break a}throw Error(k(130,null==a?a:typeof a,""));}b=la(g,c,b,e);b.elementType=a;b.type=d;b.expirationTime=f;return b}function Ha(a,b,c,d){a=la(7,a,d,b);a.expirationTime=c;return a}function qe(a,b,c){a=la(6,a,null,b);a.expirationTime=c;return a}function re(a,b,c){b=la(4,null!==a.children?a.children:[],a.key,b);b.expirationTime=c;b.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation};return b}function Ij(a,b,c){this.tag=b;this.current=null;this.containerInfo=
a;this.pingCache=this.pendingChildren=null;this.finishedExpirationTime=0;this.finishedWork=null;this.timeoutHandle=-1;this.pendingContext=this.context=null;this.hydrate=c;this.callbackNode=null;this.callbackPriority=90;this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Kh(a,b){var c=a.firstSuspendedTime;a=a.lastSuspendedTime;return 0!==c&&c>=b&&a<=b}function Ya(a,b){var c=a.firstSuspendedTime,d=a.lastSuspendedTime;
c<b&&(a.firstSuspendedTime=b);if(d>b||0===c)a.lastSuspendedTime=b;b<=a.lastPingedTime&&(a.lastPingedTime=0);b<=a.lastExpiredTime&&(a.lastExpiredTime=0)}function yh(a,b){b>a.firstPendingTime&&(a.firstPendingTime=b);var c=a.firstSuspendedTime;0!==c&&(b>=c?a.firstSuspendedTime=a.lastSuspendedTime=a.nextKnownPendingLevel=0:b>=a.lastSuspendedTime&&(a.lastSuspendedTime=b+1),b>a.nextKnownPendingLevel&&(a.nextKnownPendingLevel=b))}function Ue(a,b){var c=a.lastExpiredTime;if(0===c||c>b)a.lastExpiredTime=b}
function md(a,b,c,d){var e=b.current,f=ka(),g=Vb.suspense;f=Va(f,e,g);a:if(c){c=c._reactInternalFiber;b:{if(Na(c)!==c||1!==c.tag)throw Error(k(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break b;case 1:if(N(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break b}}h=h.return}while(null!==h);throw Error(k(171));}if(1===c.tag){var m=c.type;if(N(m)){c=Gg(c,m,h);break a}}c=h}else c=Ca;null===b.context?b.context=c:b.pendingContext=c;b=Ea(f,g);b.payload={element:a};d=void 0===
d?null:d;null!==d&&(b.callback=d);Fa(e,b);Ja(e,f);return f}function cf(a){a=a.current;if(!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Wh(a,b){a=a.memoizedState;null!==a&&null!==a.dehydrated&&a.retryTime<b&&(a.retryTime=b)}function df(a,b){Wh(a,b);(a=a.alternate)&&Wh(a,b)}function ef(a,b,c){c=null!=c&&!0===c.hydrate;var d=new Ij(a,b,c),e=la(3,null,null,2===b?7:1===b?3:0);d.current=e;e.stateNode=d;ne(e);a[Lb]=d.current;c&&0!==b&&
xi(a,9===a.nodeType?a:a.ownerDocument);this._internalRoot=d}function bc(a){return!(!a||1!==a.nodeType&&9!==a.nodeType&&11!==a.nodeType&&(8!==a.nodeType||" react-mount-point-unstable "!==a.nodeValue))}function Jj(a,b){b||(b=a?9===a.nodeType?a.documentElement:a.firstChild:null,b=!(!b||1!==b.nodeType||!b.hasAttribute("data-reactroot")));if(!b)for(var c;c=a.lastChild;)a.removeChild(c);return new ef(a,0,b?{hydrate:!0}:void 0)}function nd(a,b,c,d,e){var f=c._reactRootContainer;if(f){var g=f._internalRoot;
if("function"===typeof e){var h=e;e=function(){var a=cf(g);h.call(a)}}md(b,g,a,e)}else{f=c._reactRootContainer=Jj(c,d);g=f._internalRoot;if("function"===typeof e){var m=e;e=function(){var a=cf(g);m.call(a)}}Rh(function(){md(b,g,a,e)})}return cf(g)}function Kj(a,b,c){var d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:gb,key:null==d?null:""+d,children:a,containerInfo:b,implementation:c}}function Xh(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;
if(!bc(b))throw Error(k(200));return Kj(a,b,null,c)}if(!ea)throw Error(k(227));var ki=function(a,b,c,d,e,f,g,h,m){var n=Array.prototype.slice.call(arguments,3);try{b.apply(c,n)}catch(C){this.onError(C)}},yb=!1,gc=null,hc=!1,pd=null,li={onError:function(a){yb=!0;gc=a}},td=null,rf=null,mf=null,ic=null,cb={},jc=[],qd={},db={},rd={},wa=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),M=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.assign,
sd=null,eb=null,fb=null,ee=function(a,b){return a(b)},eg=function(a,b,c,d,e){return a(b,c,d,e)},vd=function(){},vf=ee,Oa=!1,wd=!1,Z=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Scheduler,Lj=Z.unstable_cancelCallback,ff=Z.unstable_now,$f=Z.unstable_scheduleCallback,Mj=Z.unstable_shouldYield,Yh=Z.unstable_requestPaint,Pd=Z.unstable_runWithPriority,Nj=Z.unstable_getCurrentPriorityLevel,Oj=Z.unstable_ImmediatePriority,Zh=Z.unstable_UserBlockingPriority,ag=Z.unstable_NormalPriority,Pj=Z.unstable_LowPriority,
Qj=Z.unstable_IdlePriority,oi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wf=Object.prototype.hasOwnProperty,yf={},xf={},E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=
new L(a,0,!1,a,null,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var b=a[0];E[b]=new L(b,1,!1,a[1],null,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new L(a,2,!1,a.toLowerCase(),null,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new L(a,2,!1,a,null,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=
new L(a,3,!1,a.toLowerCase(),null,!1)});["checked","multiple","muted","selected"].forEach(function(a){E[a]=new L(a,3,!0,a,null,!1)});["capture","download"].forEach(function(a){E[a]=new L(a,4,!1,a,null,!1)});["cols","rows","size","span"].forEach(function(a){E[a]=new L(a,6,!1,a,null,!1)});["rowSpan","start"].forEach(function(a){E[a]=new L(a,5,!1,a.toLowerCase(),null,!1)});var gf=/[\-:]([a-z])/g,hf=function(a){return a[1].toUpperCase()};"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var b=
a.replace(gf,hf);E[b]=new L(b,1,!1,a,null,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/1999/xlink",!1)});["xml:base","xml:lang","xml:space"].forEach(function(a){var b=a.replace(gf,hf);E[b]=new L(b,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1)});["tabIndex","crossOrigin"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!1)});E.xlinkHref=new L("xlinkHref",1,
!1,"xlink:href","http://www.w3.org/1999/xlink",!0);["src","href","action","formAction"].forEach(function(a){E[a]=new L(a,1,!1,a.toLowerCase(),null,!0)});var da=ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;da.hasOwnProperty("ReactCurrentDispatcher")||(da.ReactCurrentDispatcher={current:null});da.hasOwnProperty("ReactCurrentBatchConfig")||(da.ReactCurrentBatchConfig={suspense:null});var si=/^(.*)[\\\/]/,Q="function"===typeof Symbol&&Symbol.for,Pc=Q?Symbol.for("react.element"):60103,gb=Q?Symbol.for("react.portal"):
60106,Ma=Q?Symbol.for("react.fragment"):60107,Af=Q?Symbol.for("react.strict_mode"):60108,kc=Q?Symbol.for("react.profiler"):60114,Cf=Q?Symbol.for("react.provider"):60109,Bf=Q?Symbol.for("react.context"):60110,Hj=Q?Symbol.for("react.concurrent_mode"):60111,zd=Q?Symbol.for("react.forward_ref"):60112,lc=Q?Symbol.for("react.suspense"):60113,yd=Q?Symbol.for("react.suspense_list"):60120,Ad=Q?Symbol.for("react.memo"):60115,Ef=Q?Symbol.for("react.lazy"):60116,Df=Q?Symbol.for("react.block"):60121,zf="function"===
typeof Symbol&&Symbol.iterator,od,xh=function(a){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(b,c,d,e){MSApp.execUnsafeLocalFunction(function(){return a(b,c,d,e)})}:a}(function(a,b){if("http://www.w3.org/2000/svg"!==a.namespaceURI||"innerHTML"in a)a.innerHTML=b;else{od=od||document.createElement("div");od.innerHTML="<svg>"+b.valueOf().toString()+"</svg>";for(b=od.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;b.firstChild;)a.appendChild(b.firstChild)}}),Wb=function(a,
b){if(b){var c=a.firstChild;if(c&&c===a.lastChild&&3===c.nodeType){c.nodeValue=b;return}}a.textContent=b},ib={animationend:nc("Animation","AnimationEnd"),animationiteration:nc("Animation","AnimationIteration"),animationstart:nc("Animation","AnimationStart"),transitionend:nc("Transition","TransitionEnd")},Id={},Of={};wa&&(Of=document.createElement("div").style,"AnimationEvent"in window||(delete ib.animationend.animation,delete ib.animationiteration.animation,delete ib.animationstart.animation),"TransitionEvent"in
window||delete ib.transitionend.transition);var $h=oc("animationend"),ai=oc("animationiteration"),bi=oc("animationstart"),ci=oc("transitionend"),Db="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pf=new ("function"===typeof WeakMap?WeakMap:Map),Ab=null,wi=function(a){if(a){var b=a._dispatchListeners,c=a._dispatchInstances;
if(Array.isArray(b))for(var d=0;d<b.length&&!a.isPropagationStopped();d++)lf(a,b[d],c[d]);else b&&lf(a,b,c);a._dispatchListeners=null;a._dispatchInstances=null;a.isPersistent()||a.constructor.release(a)}},qc=[],Rd=!1,fa=[],xa=null,ya=null,za=null,Eb=new Map,Fb=new Map,Jb=[],Nd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),
yi="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" "),dg={},cg=new Map,Td=new Map,Rj=["abort","abort",$h,"animationEnd",ai,"animationIteration",bi,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata",
"loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ci,"transitionEnd","waiting","waiting"];Sd("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),
0);Sd("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1);Sd(Rj,2);(function(a,b){for(var c=0;c<a.length;c++)Td.set(a[c],b)})("change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),0);var Hi=Zh,Gi=Pd,tc=!0,Kb={animationIterationCount:!0,
borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,
strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sj=["Webkit","ms","Moz","O"];Object.keys(Kb).forEach(function(a){Sj.forEach(function(b){b=b+a.charAt(0).toUpperCase()+a.substring(1);Kb[b]=Kb[a]})});var Ii=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),ng="$",og="/$",$d="$?",Zd="$!",Ze=null,$e=null,We="function"===typeof setTimeout?setTimeout:void 0,vj="function"===
typeof clearTimeout?clearTimeout:void 0,jf=Math.random().toString(36).slice(2),Aa="__reactInternalInstance$"+jf,vc="__reactEventHandlers$"+jf,Lb="__reactContainere$"+jf,Ba=null,ce=null,wc=null;M(R.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():"unknown"!==typeof a.returnValue&&(a.returnValue=!1),this.isDefaultPrevented=xc)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():"unknown"!==
typeof a.cancelBubble&&(a.cancelBubble=!0),this.isPropagationStopped=xc)},persist:function(){this.isPersistent=xc},isPersistent:yc,destructor:function(){var a=this.constructor.Interface,b;for(b in a)this[b]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null;this.isPropagationStopped=this.isDefaultPrevented=yc;this._dispatchInstances=this._dispatchListeners=null}});R.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(a){return a.timeStamp||
Date.now()},defaultPrevented:null,isTrusted:null};R.extend=function(a){function b(){return c.apply(this,arguments)}var c=this,d=function(){};d.prototype=c.prototype;d=new d;M(d,b.prototype);b.prototype=d;b.prototype.constructor=b;b.Interface=M({},c.Interface,a);b.extend=c.extend;sg(b);return b};sg(R);var Tj=R.extend({data:null}),Uj=R.extend({data:null}),Ni=[9,13,27,32],de=wa&&"CompositionEvent"in window,cc=null;wa&&"documentMode"in document&&(cc=document.documentMode);var Vj=wa&&"TextEvent"in window&&
!cc,xg=wa&&(!de||cc&&8<cc&&11>=cc),wg=String.fromCharCode(32),ua={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},
dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},vg=!1,mb=!1,Wj={eventTypes:ua,extractEvents:function(a,b,c,d,e){var f;if(de)b:{switch(a){case "compositionstart":var g=ua.compositionStart;break b;case "compositionend":g=ua.compositionEnd;break b;case "compositionupdate":g=
ua.compositionUpdate;break b}g=void 0}else mb?tg(a,c)&&(g=ua.compositionEnd):"keydown"===a&&229===c.keyCode&&(g=ua.compositionStart);g?(xg&&"ko"!==c.locale&&(mb||g!==ua.compositionStart?g===ua.compositionEnd&&mb&&(f=rg()):(Ba=d,ce="value"in Ba?Ba.value:Ba.textContent,mb=!0)),e=Tj.getPooled(g,b,c,d),f?e.data=f:(f=ug(c),null!==f&&(e.data=f)),lb(e),f=e):f=null;(a=Vj?Oi(a,c):Pi(a,c))?(b=Uj.getPooled(ua.beforeInput,b,c,d),b.data=a,lb(b)):b=null;return null===f?b:null===b?f:[f,b]}},Qi={color:!0,date:!0,
datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Ag={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}},Mb=null,Nb=null,kf=!1;wa&&(kf=Tf("input")&&(!document.documentMode||9<document.documentMode));var Xj={eventTypes:Ag,_isInputEventSupported:kf,extractEvents:function(a,b,c,d,e){e=b?Pa(b):window;var f=
e.nodeName&&e.nodeName.toLowerCase();if("select"===f||"input"===f&&"file"===e.type)var g=Si;else if(yg(e))if(kf)g=Wi;else{g=Ui;var h=Ti}else(f=e.nodeName)&&"input"===f.toLowerCase()&&("checkbox"===e.type||"radio"===e.type)&&(g=Vi);if(g&&(g=g(a,b)))return zg(g,c,d);h&&h(a,e,b);"blur"===a&&(a=e._wrapperState)&&a.controlled&&"number"===e.type&&Ed(e,"number",e.value)}},dc=R.extend({view:null,detail:null}),Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},di=0,ei=0,fi=!1,gi=!1,ec=dc.extend({screenX:null,
screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:fe,button:null,buttons:null,relatedTarget:function(a){return a.relatedTarget||(a.fromElement===a.srcElement?a.toElement:a.fromElement)},movementX:function(a){if("movementX"in a)return a.movementX;var b=di;di=a.screenX;return fi?"mousemove"===a.type?a.screenX-b:0:(fi=!0,0)},movementY:function(a){if("movementY"in a)return a.movementY;var b=ei;ei=a.screenY;return gi?"mousemove"===
a.type?a.screenY-b:0:(gi=!0,0)}}),hi=ec.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),fc={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout",
"pointerover"]}},Yj={eventTypes:fc,extractEvents:function(a,b,c,d,e){var f="mouseover"===a||"pointerover"===a,g="mouseout"===a||"pointerout"===a;if(f&&0===(e&32)&&(c.relatedTarget||c.fromElement)||!g&&!f)return null;f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window;if(g){if(g=b,b=(b=c.relatedTarget||c.toElement)?Bb(b):null,null!==b){var h=Na(b);if(b!==h||5!==b.tag&&6!==b.tag)b=null}}else g=null;if(g===b)return null;if("mouseout"===a||"mouseover"===a){var m=ec;var n=fc.mouseLeave;
var l=fc.mouseEnter;var k="mouse"}else if("pointerout"===a||"pointerover"===a)m=hi,n=fc.pointerLeave,l=fc.pointerEnter,k="pointer";a=null==g?f:Pa(g);f=null==b?f:Pa(b);n=m.getPooled(n,g,c,d);n.type=k+"leave";n.target=a;n.relatedTarget=f;c=m.getPooled(l,b,c,d);c.type=k+"enter";c.target=f;c.relatedTarget=a;d=g;k=b;if(d&&k)a:{m=d;l=k;g=0;for(a=m;a;a=pa(a))g++;a=0;for(b=l;b;b=pa(b))a++;for(;0<g-a;)m=pa(m),g--;for(;0<a-g;)l=pa(l),a--;for(;g--;){if(m===l||m===l.alternate)break a;m=pa(m);l=pa(l)}m=null}else m=
null;l=m;for(m=[];d&&d!==l;){g=d.alternate;if(null!==g&&g===l)break;m.push(d);d=pa(d)}for(d=[];k&&k!==l;){g=k.alternate;if(null!==g&&g===l)break;d.push(k);k=pa(k)}for(k=0;k<m.length;k++)be(m[k],"bubbled",n);for(k=d.length;0<k--;)be(d[k],"captured",c);return 0===(e&64)?[n]:[n,c]}},Qa="function"===typeof Object.is?Object.is:Zi,$i=Object.prototype.hasOwnProperty,Zj=wa&&"documentMode"in document&&11>=document.documentMode,Eg={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},
dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},nb=null,he=null,Pb=null,ge=!1,ak={eventTypes:Eg,extractEvents:function(a,b,c,d,e,f){e=f||(d.window===d?d.document:9===d.nodeType?d:d.ownerDocument);if(!(f=!e)){a:{e=Jd(e);f=rd.onSelect;for(var g=0;g<f.length;g++)if(!e.has(f[g])){e=!1;break a}e=!0}f=!e}if(f)return null;e=b?Pa(b):window;switch(a){case "focus":if(yg(e)||"true"===e.contentEditable)nb=e,he=b,Pb=null;break;case "blur":Pb=he=nb=null;
break;case "mousedown":ge=!0;break;case "contextmenu":case "mouseup":case "dragend":return ge=!1,Dg(c,d);case "selectionchange":if(Zj)break;case "keydown":case "keyup":return Dg(c,d)}return null}},bk=R.extend({animationName:null,elapsedTime:null,pseudoElement:null}),ck=R.extend({clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dk=dc.extend({relatedTarget:null}),ek={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",
Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",
224:"Meta"},gk=dc.extend({key:function(a){if(a.key){var b=ek[a.key]||a.key;if("Unidentified"!==b)return b}return"keypress"===a.type?(a=Ac(a),13===a?"Enter":String.fromCharCode(a)):"keydown"===a.type||"keyup"===a.type?fk[a.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:fe,charCode:function(a){return"keypress"===a.type?Ac(a):0},keyCode:function(a){return"keydown"===a.type||"keyup"===a.type?a.keyCode:0},which:function(a){return"keypress"===
a.type?Ac(a):"keydown"===a.type||"keyup"===a.type?a.keyCode:0}}),hk=ec.extend({dataTransfer:null}),ik=dc.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:fe}),jk=R.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),kk=ec.extend({deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?
-a.wheelDelta:0},deltaZ:null,deltaMode:null}),lk={eventTypes:dg,extractEvents:function(a,b,c,d,e){e=cg.get(a);if(!e)return null;switch(a){case "keypress":if(0===Ac(c))return null;case "keydown":case "keyup":a=gk;break;case "blur":case "focus":a=dk;break;case "click":if(2===c.button)return null;case "auxclick":case "dblclick":case "mousedown":case "mousemove":case "mouseup":case "mouseout":case "mouseover":case "contextmenu":a=ec;break;case "drag":case "dragend":case "dragenter":case "dragexit":case "dragleave":case "dragover":case "dragstart":case "drop":a=
hk;break;case "touchcancel":case "touchend":case "touchmove":case "touchstart":a=ik;break;case $h:case ai:case bi:a=bk;break;case ci:a=jk;break;case "scroll":a=dc;break;case "wheel":a=kk;break;case "copy":case "cut":case "paste":a=ck;break;case "gotpointercapture":case "lostpointercapture":case "pointercancel":case "pointerdown":case "pointermove":case "pointerout":case "pointerover":case "pointerup":a=hi;break;default:a=R}b=a.getPooled(e,b,c,d);lb(b);return b}};(function(a){if(ic)throw Error(k(101));
ic=Array.prototype.slice.call(a);nf()})("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" "));(function(a,b,c){td=a;rf=b;mf=c})(ae,Hb,Pa);pf({SimpleEventPlugin:lk,EnterLeaveEventPlugin:Yj,ChangeEventPlugin:Xj,SelectEventPlugin:ak,BeforeInputEventPlugin:Wj});var ie=[],ob=-1,Ca={},B={current:Ca},G={current:!1},Ra=Ca,bj=Pd,je=$f,Rg=Lj,aj=Nj,Dc=Oj,Ig=Zh,Jg=ag,Kg=Pj,Lg=Qj,Qg={},yj=Mj,Cj=void 0!==Yh?Yh:function(){},qa=null,
Ec=null,ke=!1,ii=ff(),Y=1E4>ii?ff:function(){return ff()-ii},Ic={current:null},Hc=null,qb=null,Gc=null,Tg=0,Jc=2,Ga=!1,Vb=da.ReactCurrentBatchConfig,$g=(new ea.Component).refs,Mc={isMounted:function(a){return(a=a._reactInternalFiber)?Na(a)===a:!1},enqueueSetState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;d=Va(d,a,e);e=Ea(d,e);e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueReplaceState:function(a,b,c){a=a._reactInternalFiber;var d=ka(),e=Vb.suspense;
d=Va(d,a,e);e=Ea(d,e);e.tag=1;e.payload=b;void 0!==c&&null!==c&&(e.callback=c);Fa(a,e);Ja(a,d)},enqueueForceUpdate:function(a,b){a=a._reactInternalFiber;var c=ka(),d=Vb.suspense;c=Va(c,a,d);d=Ea(c,d);d.tag=Jc;void 0!==b&&null!==b&&(d.callback=b);Fa(a,d);Ja(a,c)}},Qc=Array.isArray,wb=ah(!0),Fe=ah(!1),Sb={},ja={current:Sb},Ub={current:Sb},Tb={current:Sb},D={current:0},Sc=da.ReactCurrentDispatcher,X=da.ReactCurrentBatchConfig,Ia=0,z=null,K=null,J=null,Uc=!1,Tc={readContext:W,useCallback:S,useContext:S,
useEffect:S,useImperativeHandle:S,useLayoutEffect:S,useMemo:S,useReducer:S,useRef:S,useState:S,useDebugValue:S,useResponder:S,useDeferredValue:S,useTransition:S},dj={readContext:W,useCallback:ih,useContext:W,useEffect:eh,useImperativeHandle:function(a,b,c){c=null!==c&&void 0!==c?c.concat([a]):null;return ze(4,2,gh.bind(null,b,a),c)},useLayoutEffect:function(a,b){return ze(4,2,a,b)},useMemo:function(a,b){var c=ub();b=void 0===b?null:b;a=a();c.memoizedState=[a,b];return a},useReducer:function(a,b,c){var d=
ub();b=void 0!==c?c(b):b;d.memoizedState=d.baseState=b;a=d.queue={pending:null,dispatch:null,lastRenderedReducer:a,lastRenderedState:b};a=a.dispatch=ch.bind(null,z,a);return[d.memoizedState,a]},useRef:function(a){var b=ub();a={current:a};return b.memoizedState=a},useState:xe,useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=xe(a),d=c[0],e=c[1];eh(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=
xe(!1),c=b[0];b=b[1];return[ih(Ce.bind(null,b,a),[b,a]),c]}},ej={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Vc,useRef:dh,useState:function(a){return Vc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Vc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Vc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,
b,a),[b,a]),c]}},fj={readContext:W,useCallback:Yc,useContext:W,useEffect:Xc,useImperativeHandle:hh,useLayoutEffect:fh,useMemo:jh,useReducer:Wc,useRef:dh,useState:function(a){return Wc(Ua)},useDebugValue:Be,useResponder:ue,useDeferredValue:function(a,b){var c=Wc(Ua),d=c[0],e=c[1];Xc(function(){var c=X.suspense;X.suspense=void 0===b?null:b;try{e(a)}finally{X.suspense=c}},[a,b]);return d},useTransition:function(a){var b=Wc(Ua),c=b[0];b=b[1];return[Yc(Ce.bind(null,b,a),[b,a]),c]}},ra=null,Ka=null,Wa=
!1,gj=da.ReactCurrentOwner,ia=!1,Je={dehydrated:null,retryTime:0};var jj=function(a,b,c,d){for(c=b.child;null!==c;){if(5===c.tag||6===c.tag)a.appendChild(c.stateNode);else if(4!==c.tag&&null!==c.child){c.child.return=c;c=c.child;continue}if(c===b)break;for(;null===c.sibling;){if(null===c.return||c.return===b)return;c=c.return}c.sibling.return=c.return;c=c.sibling}};var wh=function(a){};var ij=function(a,b,c,d,e){var f=a.memoizedProps;if(f!==d){var g=b.stateNode;Ta(ja.current);a=null;switch(c){case "input":f=
Cd(g,f);d=Cd(g,d);a=[];break;case "option":f=Fd(g,f);d=Fd(g,d);a=[];break;case "select":f=M({},f,{value:void 0});d=M({},d,{value:void 0});a=[];break;case "textarea":f=Gd(g,f);d=Gd(g,d);a=[];break;default:"function"!==typeof f.onClick&&"function"===typeof d.onClick&&(g.onclick=uc)}Ud(c,d);var h,m;c=null;for(h in f)if(!d.hasOwnProperty(h)&&f.hasOwnProperty(h)&&null!=f[h])if("style"===h)for(m in g=f[h],g)g.hasOwnProperty(m)&&(c||(c={}),c[m]="");else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==
h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(db.hasOwnProperty(h)?a||(a=[]):(a=a||[]).push(h,null));for(h in d){var k=d[h];g=null!=f?f[h]:void 0;if(d.hasOwnProperty(h)&&k!==g&&(null!=k||null!=g))if("style"===h)if(g){for(m in g)!g.hasOwnProperty(m)||k&&k.hasOwnProperty(m)||(c||(c={}),c[m]="");for(m in k)k.hasOwnProperty(m)&&g[m]!==k[m]&&(c||(c={}),c[m]=k[m])}else c||(a||(a=[]),a.push(h,c)),c=k;else"dangerouslySetInnerHTML"===h?(k=k?k.__html:void 0,g=g?g.__html:void 0,null!=k&&g!==k&&(a=a||
[]).push(h,k)):"children"===h?g===k||"string"!==typeof k&&"number"!==typeof k||(a=a||[]).push(h,""+k):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(db.hasOwnProperty(h)?(null!=k&&oa(e,h),a||g===k||(a=[])):(a=a||[]).push(h,k))}c&&(a=a||[]).push("style",c);e=a;if(b.updateQueue=e)b.effectTag|=4}};var kj=function(a,b,c,d){c!==d&&(b.effectTag|=4)};var pj="function"===typeof WeakSet?WeakSet:Set,wj="function"===typeof WeakMap?WeakMap:Map,sj=Math.ceil,gd=da.ReactCurrentDispatcher,
Uh=da.ReactCurrentOwner,H=0,Ye=8,ca=16,ma=32,Xa=0,hd=1,Oh=2,ad=3,bd=4,Xe=5,p=H,U=null,t=null,P=0,F=Xa,id=null,ta=1073741823,Yb=1073741823,kd=null,Xb=0,jd=!1,Re=0,Ph=500,l=null,cd=!1,Se=null,La=null,ld=!1,Zb=null,$b=90,bb=null,ac=0,af=null,dd=0,Ja=function(a,b){if(50<ac)throw ac=0,af=null,Error(k(185));a=ed(a,b);if(null!==a){var c=Cc();1073741823===b?(p&Ye)!==H&&(p&(ca|ma))===H?Te(a):(V(a),p===H&&ha()):V(a);(p&4)===H||98!==c&&99!==c||(null===bb?bb=new Map([[a,b]]):(c=bb.get(a),(void 0===c||c>b)&&bb.set(a,
b)))}};var zj=function(a,b,c){var d=b.expirationTime;if(null!==a){var e=b.pendingProps;if(a.memoizedProps!==e||G.current)ia=!0;else{if(d<c){ia=!1;switch(b.tag){case 3:sh(b);Ee();break;case 5:bh(b);if(b.mode&4&&1!==c&&e.hidden)return b.expirationTime=b.childExpirationTime=1,null;break;case 1:N(b.type)&&Bc(b);break;case 4:se(b,b.stateNode.containerInfo);break;case 10:d=b.memoizedProps.value;e=b.type._context;y(Ic,e._currentValue);e._currentValue=d;break;case 13:if(null!==b.memoizedState){d=b.child.childExpirationTime;
if(0!==d&&d>=c)return th(a,b,c);y(D,D.current&1);b=sa(a,b,c);return null!==b?b.sibling:null}y(D,D.current&1);break;case 19:d=b.childExpirationTime>=c;if(0!==(a.effectTag&64)){if(d)return vh(a,b,c);b.effectTag|=64}e=b.memoizedState;null!==e&&(e.rendering=null,e.tail=null);y(D,D.current);if(!d)return null}return sa(a,b,c)}ia=!1}}else ia=!1;b.expirationTime=0;switch(b.tag){case 2:d=b.type;null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;e=pb(b,B.current);rb(b,c);e=we(null,
b,d,a,e,c);b.effectTag|=1;if("object"===typeof e&&null!==e&&"function"===typeof e.render&&void 0===e.$$typeof){b.tag=1;b.memoizedState=null;b.updateQueue=null;if(N(d)){var f=!0;Bc(b)}else f=!1;b.memoizedState=null!==e.state&&void 0!==e.state?e.state:null;ne(b);var g=d.getDerivedStateFromProps;"function"===typeof g&&Lc(b,d,g,a);e.updater=Mc;b.stateNode=e;e._reactInternalFiber=b;pe(b,d,a,c);b=Ie(null,b,d,!0,f,c)}else b.tag=0,T(null,b,e,c),b=b.child;return b;case 16:a:{e=b.elementType;null!==a&&(a.alternate=
null,b.alternate=null,b.effectTag|=2);a=b.pendingProps;ri(e);if(1!==e._status)throw e._result;e=e._result;b.type=e;f=b.tag=Gj(e);a=aa(e,a);switch(f){case 0:b=He(null,b,e,a,c);break a;case 1:b=rh(null,b,e,a,c);break a;case 11:b=nh(null,b,e,a,c);break a;case 14:b=oh(null,b,e,aa(e.type,a),d,c);break a}throw Error(k(306,e,""));}return b;case 0:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),He(a,b,d,e,c);case 1:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),rh(a,b,d,e,c);
case 3:sh(b);d=b.updateQueue;if(null===a||null===d)throw Error(k(282));d=b.pendingProps;e=b.memoizedState;e=null!==e?e.element:null;oe(a,b);Qb(b,d,null,c);d=b.memoizedState.element;if(d===e)Ee(),b=sa(a,b,c);else{if(e=b.stateNode.hydrate)Ka=kb(b.stateNode.containerInfo.firstChild),ra=b,e=Wa=!0;if(e)for(c=Fe(b,null,d,c),b.child=c;c;)c.effectTag=c.effectTag&-3|1024,c=c.sibling;else T(a,b,d,c),Ee();b=b.child}return b;case 5:return bh(b),null===a&&De(b),d=b.type,e=b.pendingProps,f=null!==a?a.memoizedProps:
null,g=e.children,Yd(d,e)?g=null:null!==f&&Yd(d,f)&&(b.effectTag|=16),qh(a,b),b.mode&4&&1!==c&&e.hidden?(b.expirationTime=b.childExpirationTime=1,b=null):(T(a,b,g,c),b=b.child),b;case 6:return null===a&&De(b),null;case 13:return th(a,b,c);case 4:return se(b,b.stateNode.containerInfo),d=b.pendingProps,null===a?b.child=wb(b,null,d,c):T(a,b,d,c),b.child;case 11:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),nh(a,b,d,e,c);case 7:return T(a,b,b.pendingProps,c),b.child;case 8:return T(a,
b,b.pendingProps.children,c),b.child;case 12:return T(a,b,b.pendingProps.children,c),b.child;case 10:a:{d=b.type._context;e=b.pendingProps;g=b.memoizedProps;f=e.value;var h=b.type._context;y(Ic,h._currentValue);h._currentValue=f;if(null!==g)if(h=g.value,f=Qa(h,f)?0:("function"===typeof d._calculateChangedBits?d._calculateChangedBits(h,f):1073741823)|0,0===f){if(g.children===e.children&&!G.current){b=sa(a,b,c);break a}}else for(h=b.child,null!==h&&(h.return=b);null!==h;){var m=h.dependencies;if(null!==
m){g=h.child;for(var l=m.firstContext;null!==l;){if(l.context===d&&0!==(l.observedBits&f)){1===h.tag&&(l=Ea(c,null),l.tag=Jc,Fa(h,l));h.expirationTime<c&&(h.expirationTime=c);l=h.alternate;null!==l&&l.expirationTime<c&&(l.expirationTime=c);Sg(h.return,c);m.expirationTime<c&&(m.expirationTime=c);break}l=l.next}}else g=10===h.tag?h.type===b.type?null:h.child:h.child;if(null!==g)g.return=h;else for(g=h;null!==g;){if(g===b){g=null;break}h=g.sibling;if(null!==h){h.return=g.return;g=h;break}g=g.return}h=
g}T(a,b,e.children,c);b=b.child}return b;case 9:return e=b.type,f=b.pendingProps,d=f.children,rb(b,c),e=W(e,f.unstable_observedBits),d=d(e),b.effectTag|=1,T(a,b,d,c),b.child;case 14:return e=b.type,f=aa(e,b.pendingProps),f=aa(e.type,f),oh(a,b,e,f,d,c);case 15:return ph(a,b,b.type,b.pendingProps,d,c);case 17:return d=b.type,e=b.pendingProps,e=b.elementType===d?e:aa(d,e),null!==a&&(a.alternate=null,b.alternate=null,b.effectTag|=2),b.tag=1,N(d)?(a=!0,Bc(b)):a=!1,rb(b,c),Yg(b,d,e),pe(b,d,e,c),Ie(null,
b,d,!0,a,c);case 19:return vh(a,b,c)}throw Error(k(156,b.tag));};var bf=null,Ne=null,la=function(a,b,c,d){return new Fj(a,b,c,d)};ef.prototype.render=function(a){md(a,this._internalRoot,null,null)};ef.prototype.unmount=function(){var a=this._internalRoot,b=a.containerInfo;md(null,a,null,function(){b[Lb]=null})};var Di=function(a){if(13===a.tag){var b=Fc(ka(),150,100);Ja(a,b);df(a,b)}};var Yf=function(a){13===a.tag&&(Ja(a,3),df(a,3))};var Bi=function(a){if(13===a.tag){var b=ka();b=Va(b,a,null);Ja(a,
b);df(a,b)}};sd=function(a,b,c){switch(b){case "input":Dd(a,c);b=c.name;if("radio"===c.type&&null!=b){for(c=a;c.parentNode;)c=c.parentNode;c=c.querySelectorAll("input[name="+JSON.stringify(""+b)+'][type="radio"]');for(b=0;b<c.length;b++){var d=c[b];if(d!==a&&d.form===a.form){var e=ae(d);if(!e)throw Error(k(90));Gf(d);Dd(d,e)}}}break;case "textarea":Lf(a,c);break;case "select":b=c.value,null!=b&&hb(a,!!c.multiple,b,!1)}};(function(a,b,c,d){ee=a;eg=b;vd=c;vf=d})(Qh,function(a,b,c,d,e){var f=p;p|=4;
try{return Da(98,a.bind(null,b,c,d,e))}finally{p=f,p===H&&ha()}},function(){(p&(1|ca|ma))===H&&(uj(),xb())},function(a,b){var c=p;p|=2;try{return a(b)}finally{p=c,p===H&&ha()}});var mk={Events:[Hb,Pa,ae,pf,qd,lb,function(a){Kd(a,Ki)},sf,tf,sc,pc,xb,{current:!1}]};(function(a){var b=a.findFiberByHostInstance;return Ej(M({},a,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:da.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){a=Sf(a);
return null===a?null:a.stateNode},findFiberByHostInstance:function(a){return b?b(a):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))})({findFiberByHostInstance:Bb,bundleType:0,version:"16.13.1",rendererPackageName:"react-dom"});I.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mk;I.createPortal=Xh;I.findDOMNode=function(a){if(null==a)return null;if(1===a.nodeType)return a;var b=a._reactInternalFiber;if(void 0===
b){if("function"===typeof a.render)throw Error(k(188));throw Error(k(268,Object.keys(a)));}a=Sf(b);a=null===a?null:a.stateNode;return a};I.flushSync=function(a,b){if((p&(ca|ma))!==H)throw Error(k(187));var c=p;p|=1;try{return Da(99,a.bind(null,b))}finally{p=c,ha()}};I.hydrate=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!0,c)};I.render=function(a,b,c){if(!bc(b))throw Error(k(200));return nd(null,a,b,!1,c)};I.unmountComponentAtNode=function(a){if(!bc(a))throw Error(k(40));return a._reactRootContainer?
(Rh(function(){nd(null,null,a,!1,function(){a._reactRootContainer=null;a[Lb]=null})}),!0):!1};I.unstable_batchedUpdates=Qh;I.unstable_createPortal=function(a,b){return Xh(a,b,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)};I.unstable_renderSubtreeIntoContainer=function(a,b,c,d){if(!bc(c))throw Error(k(200));if(null==a||void 0===a._reactInternalFiber)throw Error(k(38));return nd(a,b,c,!1,d)};I.version="16.13.1"});
</script>
    <script>const e = React.createElement;

function pathToString(path) {
  if (path[0] === '/') {
    return '/' + path.slice(1).join('/');
  } else {
    return path.join('/');
  }
}

function findCommonPath(files) {
  if (!files || !files.length) {
    return [];
  }

  function isPrefix(arr, prefix) {
    if (arr.length < prefix.length) {
      return false;
    }
    for (let i = prefix.length - 1; i >= 0; --i) {
      if (arr[i] !== prefix[i]) {
        return false;
      }
    }
    return true;
  }

  let commonPath = files[0].path.slice(0, -1);
  while (commonPath.length) {
    if (files.every(file => isPrefix(file.path, commonPath))) {
      break;
    }
    commonPath.pop();
  }
  return commonPath;
}

function findFolders(files) {
  if (!files || !files.length) {
    return [];
  }

  let folders = files.filter(file => file.path.length > 1).map(file => file.path[0]);
  folders = [...new Set(folders)]; // unique
  folders.sort();

  folders = folders.map(folder => {
    let filesInFolder = files
      .filter(file => file.path[0] === folder)
      .map(file => ({
        ...file,
        path: file.path.slice(1),
        parent: [...file.parent, file.path[0]],
      }));

    const children = findFolders(filesInFolder); // recursion

    return {
      is_folder: true,
      path: [folder],
      parent: files[0].parent,
      children,
      covered: children.reduce((sum, file) => sum + file.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.coverable, 0),
      prevRun: {
        covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
        coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
      }
    };
  });

  return [
    ...folders,
    ...files.filter(file => file.path.length === 1),
  ];
}

class App extends React.Component {
  constructor(...args) {
    super(...args);

    this.state = {
      current: [],
    };
  }

  componentDidMount() {
    this.updateStateFromLocation();
    window.addEventListener("hashchange", () => this.updateStateFromLocation(), false);
  }

  updateStateFromLocation() {
    if (window.location.hash.length > 1) {
      const current = window.location.hash.substr(1).split('/');
      this.setState({current});
    } else {
      this.setState({current: []});
    }
  }

  getCurrentPath() {
    let file = this.props.root;
    let path = [file];
    for (let p of this.state.current) {
      file = file.children.find(file => file.path[0] === p);
      if (!file) {
        return path;
      }
      path.push(file);
    }
    return path;
  }

  render() {
    const path = this.getCurrentPath();
    const file = path[path.length - 1];

    let w = null;
    if (file.is_folder) {
      w = e(FilesList, {
        folder: file,
        onSelectFile: this.selectFile.bind(this),
        onBack: path.length > 1 ? this.back.bind(this) : null,
      });
    } else {
      w = e(DisplayFile, {
        file,
        onBack: this.back.bind(this),
      });
    }

    return e('div', {className: 'app'}, w);
  }

  selectFile(file) {
    this.setState(({current}) => {
      return {current: [...current, file.path[0]]};
    }, () => this.updateHash());
  }

  back(file) {
    this.setState(({current}) => {
      return {current: current.slice(0, current.length - 1)};
    }, () => this.updateHash());
  }

  updateHash() {
    if (!this.state.current || !this.state.current.length) {
      window.location = '#';
    } else {
      window.location = '#' + this.state.current.join('/');
    }
  }
}

function FilesList({folder, onSelectFile, onBack}) {
  let files = folder.children;
  return e('div', {className: 'display-folder'},
    e(FileHeader, {file: folder, onBack}),
    e('table', {className: 'files-list'},
      e('thead', {className: 'files-list__head'},
        e('tr', null,
          e('th', null, "Path"),
          e('th', null, "Coverage")
        )
      ),
      e('tbody', {className: 'files-list__body'},
        files.map(file => e(File, {file, onClick: onSelectFile}))
      )
    )
  );
}

function File({file, onClick}) {
  const coverage = file.coverable ? file.covered / file.coverable * 100 : -1;
  const coverageDelta = file.prevRun &&
    (file.covered / file.coverable * 100 - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('tr', {
      className: 'files-list__file'
        + (coverage >= 0 && coverage < 50 ? ' files-list__file_low': '')
        + (coverage >= 50 && coverage < 80 ? ' files-list__file_medium': '')
        + (coverage >= 80 ? ' files-list__file_high': '')
        + (file.is_folder ? ' files-list__file_folder': ''),
      onClick: () => onClick(file),
    },
    e('td', null, pathToString(file.path)),
    e('td', null,
      file.covered + ' / ' + file.coverable +
      (coverage >= 0 ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function DisplayFile({file, onBack}) {
  return e('div', {className: 'display-file'},
    e(FileHeader, {file, onBack}),
    e(FileContent, {file})
  );
}

function FileHeader({file, onBack}) {
  const coverage = file.covered / file.coverable * 100;
  const coverageDelta = file.prevRun && (coverage - file.prevRun.covered / file.prevRun.coverable * 100);

  return e('div', {className: 'file-header'},
    onBack ? e('a', {className: 'file-header__back', onClick: onBack}, 'Back') : null,
    e('div', {className: 'file-header__name'}, pathToString([...file.parent, ...file.path])),
    e('div', {className: 'file-header__stat'},
      'Covered: ' + file.covered + ' of ' + file.coverable +
      (file.coverable ? ' (' + coverage.toFixed(2) + '%)' : ''),
      e('span', {title: 'Change from the previous run'},
        (coverageDelta ? ` (${coverageDelta > 0 ? '+' : ''}${coverageDelta.toFixed(2)}%)` : ''))
    )
  );
}

function FileContent({file}) {
  return e('div', {className: 'file-content'},
    file.content.split(/\r?\n/).map((line, index) => {
      const trace = file.traces.find(trace => trace.line === index + 1);
      const covered = trace && trace.stats.Line;
      const uncovered = trace && !trace.stats.Line;
      return e('pre', {
          className: 'code-line'
            + (covered ? ' code-line_covered' : '')
            + (uncovered ? ' code-line_uncovered' : ''),
          title: trace ? JSON.stringify(trace.stats, null, 2) : null,
        }, line);
    })
  );
}

(function(){
  const commonPath = findCommonPath(data.files);
  const prevFilesMap = new Map();

  previousData && previousData.files.forEach((file) => {
    const path = file.path.slice(commonPath.length).join('/');
    prevFilesMap.set(path, file);
  });

  const files = data.files.map((file) => {
    const path = file.path.slice(commonPath.length);
    const { covered = 0, coverable = 0 } = prevFilesMap.get(path.join('/')) || {};
    return {
      ...file,
      path,
      parent: commonPath,
      prevRun: { covered, coverable },
    };
  });

  const children = findFolders(files);

  const root = {
    is_folder: true,
    children,
    path: commonPath,
    parent: [],
    covered: children.reduce((sum, file) => sum + file.covered, 0),
    coverable: children.reduce((sum, file) => sum + file.coverable, 0),
    prevRun: {
      covered: children.reduce((sum, file) => sum + file.prevRun.covered, 0),
      coverable: children.reduce((sum, file) => sum + file.prevRun.coverable, 0),
    }
  };

  ReactDOM.render(e(App, {root, prevFilesMap}), document.getElementById('root'));
}());
</script>
</body>
</html>